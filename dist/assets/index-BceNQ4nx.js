(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();function aa(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function tx(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function i(){var r=!1;try{r=this instanceof i}catch{}return r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}),t}var jd={exports:{}},go={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jv;function nx(){if(Jv)return go;Jv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,r,a){var l=null;if(a!==void 0&&(l=""+a),r.key!==void 0&&(l=""+r.key),"key"in r){a={};for(var c in r)c!=="key"&&(a[c]=r[c])}else a=r;return r=a.ref,{$$typeof:n,type:i,key:l,ref:r!==void 0?r:null,props:a}}return go.Fragment=e,go.jsx=t,go.jsxs=t,go}var Kv;function ix(){return Kv||(Kv=1,jd.exports=nx()),jd.exports}var Ne=ix(),Jd={exports:{}},we={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yv;function rx(){if(Yv)return we;Yv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),_=Symbol.iterator;function v(I){return I===null||typeof I!="object"?null:(I=_&&I[_]||I["@@iterator"],typeof I=="function"?I:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,S={};function C(I,G,K){this.props=I,this.context=G,this.refs=S,this.updater=K||w}C.prototype.isReactComponent={},C.prototype.setState=function(I,G){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,G,"setState")},C.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function x(){}x.prototype=C.prototype;function M(I,G,K){this.props=I,this.context=G,this.refs=S,this.updater=K||w}var R=M.prototype=new x;R.constructor=M,T(R,C.prototype),R.isPureReactComponent=!0;var P=Array.isArray,O={H:null,A:null,T:null,S:null,V:null},V=Object.prototype.hasOwnProperty;function J(I,G,K,X,se,de){return K=de.ref,{$$typeof:n,type:I,key:G,ref:K!==void 0?K:null,props:de}}function Z(I,G){return J(I.type,G,void 0,void 0,void 0,I.props)}function re(I){return typeof I=="object"&&I!==null&&I.$$typeof===n}function Se(I){var G={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(K){return G[K]})}var ye=/\/+/g;function Ue(I,G){return typeof I=="object"&&I!==null&&I.key!=null?Se(""+I.key):G.toString(36)}function Gt(){}function ne(I){switch(I.status){case"fulfilled":return I.value;case"rejected":throw I.reason;default:switch(typeof I.status=="string"?I.then(Gt,Gt):(I.status="pending",I.then(function(G){I.status==="pending"&&(I.status="fulfilled",I.value=G)},function(G){I.status==="pending"&&(I.status="rejected",I.reason=G)})),I.status){case"fulfilled":return I.value;case"rejected":throw I.reason}}throw I}function Y(I,G,K,X,se){var de=typeof I;(de==="undefined"||de==="boolean")&&(I=null);var pe=!1;if(I===null)pe=!0;else switch(de){case"bigint":case"string":case"number":pe=!0;break;case"object":switch(I.$$typeof){case n:case e:pe=!0;break;case g:return pe=I._init,Y(pe(I._payload),G,K,X,se)}}if(pe)return se=se(I),pe=X===""?"."+Ue(I,0):X,P(se)?(K="",pe!=null&&(K=pe.replace(ye,"$&/")+"/"),Y(se,G,K,"",function(vi){return vi})):se!=null&&(re(se)&&(se=Z(se,K+(se.key==null||I&&I.key===se.key?"":(""+se.key).replace(ye,"$&/")+"/")+pe)),G.push(se)),1;pe=0;var Qt=X===""?".":X+":";if(P(I))for(var Qe=0;Qe<I.length;Qe++)X=I[Qe],de=Qt+Ue(X,Qe),pe+=Y(X,G,K,de,se);else if(Qe=v(I),typeof Qe=="function")for(I=Qe.call(I),Qe=0;!(X=I.next()).done;)X=X.value,de=Qt+Ue(X,Qe++),pe+=Y(X,G,K,de,se);else if(de==="object"){if(typeof I.then=="function")return Y(ne(I),G,K,X,se);throw G=String(I),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.")}return pe}function L(I,G,K){if(I==null)return I;var X=[],se=0;return Y(I,X,"","",function(de){return G.call(K,de,se++)}),X}function F(I){if(I._status===-1){var G=I._result;G=G(),G.then(function(K){(I._status===0||I._status===-1)&&(I._status=1,I._result=K)},function(K){(I._status===0||I._status===-1)&&(I._status=2,I._result=K)}),I._status===-1&&(I._status=0,I._result=G)}if(I._status===1)return I._result.default;throw I._result}var Q=typeof reportError=="function"?reportError:function(I){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var G=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof I=="object"&&I!==null&&typeof I.message=="string"?String(I.message):String(I),error:I});if(!window.dispatchEvent(G))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",I);return}console.error(I)};function te(){}return we.Children={map:L,forEach:function(I,G,K){L(I,function(){G.apply(this,arguments)},K)},count:function(I){var G=0;return L(I,function(){G++}),G},toArray:function(I){return L(I,function(G){return G})||[]},only:function(I){if(!re(I))throw Error("React.Children.only expected to receive a single React element child.");return I}},we.Component=C,we.Fragment=t,we.Profiler=r,we.PureComponent=M,we.StrictMode=i,we.Suspense=f,we.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,we.__COMPILER_RUNTIME={__proto__:null,c:function(I){return O.H.useMemoCache(I)}},we.cache=function(I){return function(){return I.apply(null,arguments)}},we.cloneElement=function(I,G,K){if(I==null)throw Error("The argument must be a React element, but you passed "+I+".");var X=T({},I.props),se=I.key,de=void 0;if(G!=null)for(pe in G.ref!==void 0&&(de=void 0),G.key!==void 0&&(se=""+G.key),G)!V.call(G,pe)||pe==="key"||pe==="__self"||pe==="__source"||pe==="ref"&&G.ref===void 0||(X[pe]=G[pe]);var pe=arguments.length-2;if(pe===1)X.children=K;else if(1<pe){for(var Qt=Array(pe),Qe=0;Qe<pe;Qe++)Qt[Qe]=arguments[Qe+2];X.children=Qt}return J(I.type,se,void 0,void 0,de,X)},we.createContext=function(I){return I={$$typeof:l,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null},I.Provider=I,I.Consumer={$$typeof:a,_context:I},I},we.createElement=function(I,G,K){var X,se={},de=null;if(G!=null)for(X in G.key!==void 0&&(de=""+G.key),G)V.call(G,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(se[X]=G[X]);var pe=arguments.length-2;if(pe===1)se.children=K;else if(1<pe){for(var Qt=Array(pe),Qe=0;Qe<pe;Qe++)Qt[Qe]=arguments[Qe+2];se.children=Qt}if(I&&I.defaultProps)for(X in pe=I.defaultProps,pe)se[X]===void 0&&(se[X]=pe[X]);return J(I,de,void 0,void 0,null,se)},we.createRef=function(){return{current:null}},we.forwardRef=function(I){return{$$typeof:c,render:I}},we.isValidElement=re,we.lazy=function(I){return{$$typeof:g,_payload:{_status:-1,_result:I},_init:F}},we.memo=function(I,G){return{$$typeof:d,type:I,compare:G===void 0?null:G}},we.startTransition=function(I){var G=O.T,K={};O.T=K;try{var X=I(),se=O.S;se!==null&&se(K,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(te,Q)}catch(de){Q(de)}finally{O.T=G}},we.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},we.use=function(I){return O.H.use(I)},we.useActionState=function(I,G,K){return O.H.useActionState(I,G,K)},we.useCallback=function(I,G){return O.H.useCallback(I,G)},we.useContext=function(I){return O.H.useContext(I)},we.useDebugValue=function(){},we.useDeferredValue=function(I,G){return O.H.useDeferredValue(I,G)},we.useEffect=function(I,G,K){var X=O.H;if(typeof K=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return X.useEffect(I,G)},we.useId=function(){return O.H.useId()},we.useImperativeHandle=function(I,G,K){return O.H.useImperativeHandle(I,G,K)},we.useInsertionEffect=function(I,G){return O.H.useInsertionEffect(I,G)},we.useLayoutEffect=function(I,G){return O.H.useLayoutEffect(I,G)},we.useMemo=function(I,G){return O.H.useMemo(I,G)},we.useOptimistic=function(I,G){return O.H.useOptimistic(I,G)},we.useReducer=function(I,G,K){return O.H.useReducer(I,G,K)},we.useRef=function(I){return O.H.useRef(I)},we.useState=function(I){return O.H.useState(I)},we.useSyncExternalStore=function(I,G,K){return O.H.useSyncExternalStore(I,G,K)},we.useTransition=function(){return O.H.useTransition()},we.version="19.1.1",we}var Zv;function bm(){return Zv||(Zv=1,Jd.exports=rx()),Jd.exports}var Mt=bm(),Kd={exports:{}},yo={},Yd={exports:{}},Zd={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qv;function sx(){return Qv||(Qv=1,function(n){function e(L,F){var Q=L.length;L.push(F);e:for(;0<Q;){var te=Q-1>>>1,I=L[te];if(0<r(I,F))L[te]=F,L[Q]=I,Q=te;else break e}}function t(L){return L.length===0?null:L[0]}function i(L){if(L.length===0)return null;var F=L[0],Q=L.pop();if(Q!==F){L[0]=Q;e:for(var te=0,I=L.length,G=I>>>1;te<G;){var K=2*(te+1)-1,X=L[K],se=K+1,de=L[se];if(0>r(X,Q))se<I&&0>r(de,X)?(L[te]=de,L[se]=Q,te=se):(L[te]=X,L[K]=Q,te=K);else if(se<I&&0>r(de,Q))L[te]=de,L[se]=Q,te=se;else break e}}return F}function r(L,F){var Q=L.sortIndex-F.sortIndex;return Q!==0?Q:L.id-F.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var l=Date,c=l.now();n.unstable_now=function(){return l.now()-c}}var f=[],d=[],g=1,_=null,v=3,w=!1,T=!1,S=!1,C=!1,x=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function P(L){for(var F=t(d);F!==null;){if(F.callback===null)i(d);else if(F.startTime<=L)i(d),F.sortIndex=F.expirationTime,e(f,F);else break;F=t(d)}}function O(L){if(S=!1,P(L),!T)if(t(f)!==null)T=!0,V||(V=!0,Ue());else{var F=t(d);F!==null&&Y(O,F.startTime-L)}}var V=!1,J=-1,Z=5,re=-1;function Se(){return C?!0:!(n.unstable_now()-re<Z)}function ye(){if(C=!1,V){var L=n.unstable_now();re=L;var F=!0;try{e:{T=!1,S&&(S=!1,M(J),J=-1),w=!0;var Q=v;try{t:{for(P(L),_=t(f);_!==null&&!(_.expirationTime>L&&Se());){var te=_.callback;if(typeof te=="function"){_.callback=null,v=_.priorityLevel;var I=te(_.expirationTime<=L);if(L=n.unstable_now(),typeof I=="function"){_.callback=I,P(L),F=!0;break t}_===t(f)&&i(f),P(L)}else i(f);_=t(f)}if(_!==null)F=!0;else{var G=t(d);G!==null&&Y(O,G.startTime-L),F=!1}}break e}finally{_=null,v=Q,w=!1}F=void 0}}finally{F?Ue():V=!1}}}var Ue;if(typeof R=="function")Ue=function(){R(ye)};else if(typeof MessageChannel<"u"){var Gt=new MessageChannel,ne=Gt.port2;Gt.port1.onmessage=ye,Ue=function(){ne.postMessage(null)}}else Ue=function(){x(ye,0)};function Y(L,F){J=x(function(){L(n.unstable_now())},F)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(L){L.callback=null},n.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Z=0<L?Math.floor(1e3/L):5},n.unstable_getCurrentPriorityLevel=function(){return v},n.unstable_next=function(L){switch(v){case 1:case 2:case 3:var F=3;break;default:F=v}var Q=v;v=F;try{return L()}finally{v=Q}},n.unstable_requestPaint=function(){C=!0},n.unstable_runWithPriority=function(L,F){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var Q=v;v=L;try{return F()}finally{v=Q}},n.unstable_scheduleCallback=function(L,F,Q){var te=n.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?te+Q:te):Q=te,L){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=Q+I,L={id:g++,callback:F,priorityLevel:L,startTime:Q,expirationTime:I,sortIndex:-1},Q>te?(L.sortIndex=Q,e(d,L),t(f)===null&&L===t(d)&&(S?(M(J),J=-1):S=!0,Y(O,Q-te))):(L.sortIndex=I,e(f,L),T||w||(T=!0,V||(V=!0,Ue()))),L},n.unstable_shouldYield=Se,n.unstable_wrapCallback=function(L){var F=v;return function(){var Q=v;v=F;try{return L.apply(this,arguments)}finally{v=Q}}}}(Zd)),Zd}var Xv;function ax(){return Xv||(Xv=1,Yd.exports=sx()),Yd.exports}var Qd={exports:{}},xt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wv;function ox(){if(Wv)return xt;Wv=1;var n=bm();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function a(f,d,g){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:_==null?null:""+_,children:f,containerInfo:d,implementation:g}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return xt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,xt.createPortal=function(f,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return a(f,d,null,g)},xt.flushSync=function(f){var d=l.T,g=i.p;try{if(l.T=null,i.p=2,f)return f()}finally{l.T=d,i.p=g,i.d.f()}},xt.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,i.d.C(f,d))},xt.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},xt.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var g=d.as,_=c(g,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,w=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;g==="style"?i.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:_,integrity:v,fetchPriority:w}):g==="script"&&i.d.X(f,{crossOrigin:_,integrity:v,fetchPriority:w,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},xt.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var g=c(d.as,d.crossOrigin);i.d.M(f,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&i.d.M(f)},xt.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var g=d.as,_=c(g,d.crossOrigin);i.d.L(f,g,{crossOrigin:_,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},xt.preloadModule=function(f,d){if(typeof f=="string")if(d){var g=c(d.as,d.crossOrigin);i.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else i.d.m(f)},xt.requestFormReset=function(f){i.d.r(f)},xt.unstable_batchedUpdates=function(f,d){return f(d)},xt.useFormState=function(f,d,g){return l.H.useFormState(f,d,g)},xt.useFormStatus=function(){return l.H.useHostTransitionStatus()},xt.version="19.1.1",xt}var eb;function lx(){if(eb)return Qd.exports;eb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Qd.exports=ox(),Qd.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tb;function ux(){if(tb)return yo;tb=1;var n=ax(),e=bm(),t=lx();function i(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var o=s,u=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(u=o.return),s=o.return;while(s)}return o.tag===3?u:null}function l(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function c(s){if(a(s)!==s)throw Error(i(188))}function f(s){var o=s.alternate;if(!o){if(o=a(s),o===null)throw Error(i(188));return o!==s?null:s}for(var u=s,m=o;;){var y=u.return;if(y===null)break;var b=y.alternate;if(b===null){if(m=y.return,m!==null){u=m;continue}break}if(y.child===b.child){for(b=y.child;b;){if(b===u)return c(y),s;if(b===m)return c(y),o;b=b.sibling}throw Error(i(188))}if(u.return!==m.return)u=y,m=b;else{for(var E=!1,A=y.child;A;){if(A===u){E=!0,u=y,m=b;break}if(A===m){E=!0,m=y,u=b;break}A=A.sibling}if(!E){for(A=b.child;A;){if(A===u){E=!0,u=b,m=y;break}if(A===m){E=!0,m=b,u=y;break}A=A.sibling}if(!E)throw Error(i(189))}}if(u.alternate!==m)throw Error(i(190))}if(u.tag!==3)throw Error(i(188));return u.stateNode.current===u?s:o}function d(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=d(s),o!==null)return o;s=s.sibling}return null}var g=Object.assign,_=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),M=Symbol.for("react.consumer"),R=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),V=Symbol.for("react.suspense_list"),J=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),re=Symbol.for("react.activity"),Se=Symbol.for("react.memo_cache_sentinel"),ye=Symbol.iterator;function Ue(s){return s===null||typeof s!="object"?null:(s=ye&&s[ye]||s["@@iterator"],typeof s=="function"?s:null)}var Gt=Symbol.for("react.client.reference");function ne(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===Gt?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case T:return"Fragment";case C:return"Profiler";case S:return"StrictMode";case O:return"Suspense";case V:return"SuspenseList";case re:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case w:return"Portal";case R:return(s.displayName||"Context")+".Provider";case M:return(s._context.displayName||"Context")+".Consumer";case P:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case J:return o=s.displayName||null,o!==null?o:ne(s.type)||"Memo";case Z:o=s._payload,s=s._init;try{return ne(s(o))}catch{}}return null}var Y=Array.isArray,L=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q={pending:!1,data:null,method:null,action:null},te=[],I=-1;function G(s){return{current:s}}function K(s){0>I||(s.current=te[I],te[I]=null,I--)}function X(s,o){I++,te[I]=s.current,s.current=o}var se=G(null),de=G(null),pe=G(null),Qt=G(null);function Qe(s,o){switch(X(pe,o),X(de,s),X(se,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?wv(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=wv(o),s=Tv(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}K(se),X(se,s)}function vi(){K(se),K(de),K(pe)}function Mc(s){s.memoizedState!==null&&X(Qt,s);var o=se.current,u=Tv(o,s.type);o!==u&&(X(de,s),X(se,u))}function cl(s){de.current===s&&(K(se),K(de)),Qt.current===s&&(K(Qt),co._currentValue=Q)}var Nc=Object.prototype.hasOwnProperty,Oc=n.unstable_scheduleCallback,kc=n.unstable_cancelCallback,kC=n.unstable_shouldYield,PC=n.unstable_requestPaint,Bn=n.unstable_now,DC=n.unstable_getCurrentPriorityLevel,tg=n.unstable_ImmediatePriority,ng=n.unstable_UserBlockingPriority,fl=n.unstable_NormalPriority,LC=n.unstable_LowPriority,ig=n.unstable_IdlePriority,UC=n.log,$C=n.unstable_setDisableYieldValue,_a=null,Xt=null;function bi(s){if(typeof UC=="function"&&$C(s),Xt&&typeof Xt.setStrictMode=="function")try{Xt.setStrictMode(_a,s)}catch{}}var Wt=Math.clz32?Math.clz32:GC,qC=Math.log,BC=Math.LN2;function GC(s){return s>>>=0,s===0?32:31-(qC(s)/BC|0)|0}var dl=256,hl=4194304;function hr(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function pl(s,o,u){var m=s.pendingLanes;if(m===0)return 0;var y=0,b=s.suspendedLanes,E=s.pingedLanes;s=s.warmLanes;var A=m&134217727;return A!==0?(m=A&~b,m!==0?y=hr(m):(E&=A,E!==0?y=hr(E):u||(u=A&~s,u!==0&&(y=hr(u))))):(A=m&~b,A!==0?y=hr(A):E!==0?y=hr(E):u||(u=m&~s,u!==0&&(y=hr(u)))),y===0?0:o!==0&&o!==y&&(o&b)===0&&(b=y&-y,u=o&-o,b>=u||b===32&&(u&4194048)!==0)?o:y}function va(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function VC(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rg(){var s=dl;return dl<<=1,(dl&4194048)===0&&(dl=256),s}function sg(){var s=hl;return hl<<=1,(hl&62914560)===0&&(hl=4194304),s}function Pc(s){for(var o=[],u=0;31>u;u++)o.push(s);return o}function ba(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function FC(s,o,u,m,y,b){var E=s.pendingLanes;s.pendingLanes=u,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=u,s.entangledLanes&=u,s.errorRecoveryDisabledLanes&=u,s.shellSuspendCounter=0;var A=s.entanglements,N=s.expirationTimes,$=s.hiddenUpdates;for(u=E&~u;0<u;){var H=31-Wt(u),j=1<<H;A[H]=0,N[H]=-1;var q=$[H];if(q!==null)for($[H]=null,H=0;H<q.length;H++){var B=q[H];B!==null&&(B.lane&=-536870913)}u&=~j}m!==0&&ag(s,m,0),b!==0&&y===0&&s.tag!==0&&(s.suspendedLanes|=b&~(E&~o))}function ag(s,o,u){s.pendingLanes|=o,s.suspendedLanes&=~o;var m=31-Wt(o);s.entangledLanes|=o,s.entanglements[m]=s.entanglements[m]|1073741824|u&4194090}function og(s,o){var u=s.entangledLanes|=o;for(s=s.entanglements;u;){var m=31-Wt(u),y=1<<m;y&o|s[m]&o&&(s[m]|=o),u&=~y}}function Dc(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Lc(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function lg(){var s=F.p;return s!==0?s:(s=window.event,s===void 0?32:Gv(s.type))}function HC(s,o){var u=F.p;try{return F.p=s,o()}finally{F.p=u}}var wi=Math.random().toString(36).slice(2),At="__reactFiber$"+wi,Vt="__reactProps$"+wi,Hr="__reactContainer$"+wi,Uc="__reactEvents$"+wi,zC="__reactListeners$"+wi,jC="__reactHandles$"+wi,ug="__reactResources$"+wi,wa="__reactMarker$"+wi;function $c(s){delete s[At],delete s[Vt],delete s[Uc],delete s[zC],delete s[jC]}function zr(s){var o=s[At];if(o)return o;for(var u=s.parentNode;u;){if(o=u[Hr]||u[At]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(s=Av(s);s!==null;){if(u=s[At])return u;s=Av(s)}return o}s=u,u=s.parentNode}return null}function jr(s){if(s=s[At]||s[Hr]){var o=s.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return s}return null}function Ta(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(i(33))}function Jr(s){var o=s[ug];return o||(o=s[ug]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function ht(s){s[wa]=!0}var cg=new Set,fg={};function pr(s,o){Kr(s,o),Kr(s+"Capture",o)}function Kr(s,o){for(fg[s]=o,s=0;s<o.length;s++)cg.add(o[s])}var JC=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),dg={},hg={};function KC(s){return Nc.call(hg,s)?!0:Nc.call(dg,s)?!1:JC.test(s)?hg[s]=!0:(dg[s]=!0,!1)}function ml(s,o,u){if(KC(o))if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var m=o.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+u)}}function gl(s,o,u){if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+u)}}function Zn(s,o,u,m){if(m===null)s.removeAttribute(u);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(u);return}s.setAttributeNS(o,u,""+m)}}var qc,pg;function Yr(s){if(qc===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);qc=o&&o[1]||"",pg=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+qc+s+pg}var Bc=!1;function Gc(s,o){if(!s||Bc)return"";Bc=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(o){var j=function(){throw Error()};if(Object.defineProperty(j.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(j,[])}catch(B){var q=B}Reflect.construct(s,[],j)}else{try{j.call()}catch(B){q=B}s.call(j.prototype)}}else{try{throw Error()}catch(B){q=B}(j=s())&&typeof j.catch=="function"&&j.catch(function(){})}}catch(B){if(B&&q&&typeof B.stack=="string")return[B.stack,q.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=m.DetermineComponentFrameRoot(),E=b[0],A=b[1];if(E&&A){var N=E.split(`
`),$=A.split(`
`);for(y=m=0;m<N.length&&!N[m].includes("DetermineComponentFrameRoot");)m++;for(;y<$.length&&!$[y].includes("DetermineComponentFrameRoot");)y++;if(m===N.length||y===$.length)for(m=N.length-1,y=$.length-1;1<=m&&0<=y&&N[m]!==$[y];)y--;for(;1<=m&&0<=y;m--,y--)if(N[m]!==$[y]){if(m!==1||y!==1)do if(m--,y--,0>y||N[m]!==$[y]){var H=`
`+N[m].replace(" at new "," at ");return s.displayName&&H.includes("<anonymous>")&&(H=H.replace("<anonymous>",s.displayName)),H}while(1<=m&&0<=y);break}}}finally{Bc=!1,Error.prepareStackTrace=u}return(u=s?s.displayName||s.name:"")?Yr(u):""}function YC(s){switch(s.tag){case 26:case 27:case 5:return Yr(s.type);case 16:return Yr("Lazy");case 13:return Yr("Suspense");case 19:return Yr("SuspenseList");case 0:case 15:return Gc(s.type,!1);case 11:return Gc(s.type.render,!1);case 1:return Gc(s.type,!0);case 31:return Yr("Activity");default:return""}}function mg(s){try{var o="";do o+=YC(s),s=s.return;while(s);return o}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function hn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function gg(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function ZC(s){var o=gg(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),m=""+s[o];if(!s.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var y=u.get,b=u.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return y.call(this)},set:function(E){m=""+E,b.call(this,E)}}),Object.defineProperty(s,o,{enumerable:u.enumerable}),{getValue:function(){return m},setValue:function(E){m=""+E},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function yl(s){s._valueTracker||(s._valueTracker=ZC(s))}function yg(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var u=o.getValue(),m="";return s&&(m=gg(s)?s.checked?"true":"false":s.value),s=m,s!==u?(o.setValue(s),!0):!1}function _l(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var QC=/[\n"\\]/g;function pn(s){return s.replace(QC,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Vc(s,o,u,m,y,b,E,A){s.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?s.type=E:s.removeAttribute("type"),o!=null?E==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+hn(o)):s.value!==""+hn(o)&&(s.value=""+hn(o)):E!=="submit"&&E!=="reset"||s.removeAttribute("value"),o!=null?Fc(s,E,hn(o)):u!=null?Fc(s,E,hn(u)):m!=null&&s.removeAttribute("value"),y==null&&b!=null&&(s.defaultChecked=!!b),y!=null&&(s.checked=y&&typeof y!="function"&&typeof y!="symbol"),A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?s.name=""+hn(A):s.removeAttribute("name")}function _g(s,o,u,m,y,b,E,A){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(s.type=b),o!=null||u!=null){if(!(b!=="submit"&&b!=="reset"||o!=null))return;u=u!=null?""+hn(u):"",o=o!=null?""+hn(o):u,A||o===s.value||(s.value=o),s.defaultValue=o}m=m??y,m=typeof m!="function"&&typeof m!="symbol"&&!!m,s.checked=A?s.checked:!!m,s.defaultChecked=!!m,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(s.name=E)}function Fc(s,o,u){o==="number"&&_l(s.ownerDocument)===s||s.defaultValue===""+u||(s.defaultValue=""+u)}function Zr(s,o,u,m){if(s=s.options,o){o={};for(var y=0;y<u.length;y++)o["$"+u[y]]=!0;for(u=0;u<s.length;u++)y=o.hasOwnProperty("$"+s[u].value),s[u].selected!==y&&(s[u].selected=y),y&&m&&(s[u].defaultSelected=!0)}else{for(u=""+hn(u),o=null,y=0;y<s.length;y++){if(s[y].value===u){s[y].selected=!0,m&&(s[y].defaultSelected=!0);return}o!==null||s[y].disabled||(o=s[y])}o!==null&&(o.selected=!0)}}function vg(s,o,u){if(o!=null&&(o=""+hn(o),o!==s.value&&(s.value=o),u==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=u!=null?""+hn(u):""}function bg(s,o,u,m){if(o==null){if(m!=null){if(u!=null)throw Error(i(92));if(Y(m)){if(1<m.length)throw Error(i(93));m=m[0]}u=m}u==null&&(u=""),o=u}u=hn(o),s.defaultValue=u,m=s.textContent,m===u&&m!==""&&m!==null&&(s.value=m)}function Qr(s,o){if(o){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=o;return}}s.textContent=o}var XC=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function wg(s,o,u){var m=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?m?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":m?s.setProperty(o,u):typeof u!="number"||u===0||XC.has(o)?o==="float"?s.cssFloat=u:s[o]=(""+u).trim():s[o]=u+"px"}function Tg(s,o,u){if(o!=null&&typeof o!="object")throw Error(i(62));if(s=s.style,u!=null){for(var m in u)!u.hasOwnProperty(m)||o!=null&&o.hasOwnProperty(m)||(m.indexOf("--")===0?s.setProperty(m,""):m==="float"?s.cssFloat="":s[m]="");for(var y in o)m=o[y],o.hasOwnProperty(y)&&u[y]!==m&&wg(s,y,m)}else for(var b in o)o.hasOwnProperty(b)&&wg(s,b,o[b])}function Hc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var WC=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),eA=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function vl(s){return eA.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var zc=null;function jc(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Xr=null,Wr=null;function Eg(s){var o=jr(s);if(o&&(s=o.stateNode)){var u=s[Vt]||null;e:switch(s=o.stateNode,o.type){case"input":if(Vc(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+pn(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var m=u[o];if(m!==s&&m.form===s.form){var y=m[Vt]||null;if(!y)throw Error(i(90));Vc(m,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(o=0;o<u.length;o++)m=u[o],m.form===s.form&&yg(m)}break e;case"textarea":vg(s,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&Zr(s,!!u.multiple,o,!1)}}}var Jc=!1;function Sg(s,o,u){if(Jc)return s(o,u);Jc=!0;try{var m=s(o);return m}finally{if(Jc=!1,(Xr!==null||Wr!==null)&&(ru(),Xr&&(o=Xr,s=Wr,Wr=Xr=null,Eg(o),s)))for(o=0;o<s.length;o++)Eg(s[o])}}function Ea(s,o){var u=s.stateNode;if(u===null)return null;var m=u[Vt]||null;if(m===null)return null;u=m[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(s=s.type,m=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!m;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(i(231,o,typeof u));return u}var Qn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Kc=!1;if(Qn)try{var Sa={};Object.defineProperty(Sa,"passive",{get:function(){Kc=!0}}),window.addEventListener("test",Sa,Sa),window.removeEventListener("test",Sa,Sa)}catch{Kc=!1}var Ti=null,Yc=null,bl=null;function Cg(){if(bl)return bl;var s,o=Yc,u=o.length,m,y="value"in Ti?Ti.value:Ti.textContent,b=y.length;for(s=0;s<u&&o[s]===y[s];s++);var E=u-s;for(m=1;m<=E&&o[u-m]===y[b-m];m++);return bl=y.slice(s,1<m?1-m:void 0)}function wl(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function Tl(){return!0}function Ag(){return!1}function Ft(s){function o(u,m,y,b,E){this._reactName=u,this._targetInst=y,this.type=m,this.nativeEvent=b,this.target=E,this.currentTarget=null;for(var A in s)s.hasOwnProperty(A)&&(u=s[A],this[A]=u?u(b):b[A]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?Tl:Ag,this.isPropagationStopped=Ag,this}return g(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Tl)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Tl)},persist:function(){},isPersistent:Tl}),o}var mr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},El=Ft(mr),Ca=g({},mr,{view:0,detail:0}),tA=Ft(Ca),Zc,Qc,Aa,Sl=g({},Ca,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wc,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Aa&&(Aa&&s.type==="mousemove"?(Zc=s.screenX-Aa.screenX,Qc=s.screenY-Aa.screenY):Qc=Zc=0,Aa=s),Zc)},movementY:function(s){return"movementY"in s?s.movementY:Qc}}),Rg=Ft(Sl),nA=g({},Sl,{dataTransfer:0}),iA=Ft(nA),rA=g({},Ca,{relatedTarget:0}),Xc=Ft(rA),sA=g({},mr,{animationName:0,elapsedTime:0,pseudoElement:0}),aA=Ft(sA),oA=g({},mr,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),lA=Ft(oA),uA=g({},mr,{data:0}),xg=Ft(uA),cA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hA(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=dA[s])?!!o[s]:!1}function Wc(){return hA}var pA=g({},Ca,{key:function(s){if(s.key){var o=cA[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=wl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?fA[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wc,charCode:function(s){return s.type==="keypress"?wl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?wl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),mA=Ft(pA),gA=g({},Sl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ig=Ft(gA),yA=g({},Ca,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wc}),_A=Ft(yA),vA=g({},mr,{propertyName:0,elapsedTime:0,pseudoElement:0}),bA=Ft(vA),wA=g({},Sl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),TA=Ft(wA),EA=g({},mr,{newState:0,oldState:0}),SA=Ft(EA),CA=[9,13,27,32],ef=Qn&&"CompositionEvent"in window,Ra=null;Qn&&"documentMode"in document&&(Ra=document.documentMode);var AA=Qn&&"TextEvent"in window&&!Ra,Mg=Qn&&(!ef||Ra&&8<Ra&&11>=Ra),Ng=" ",Og=!1;function kg(s,o){switch(s){case"keyup":return CA.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pg(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var es=!1;function RA(s,o){switch(s){case"compositionend":return Pg(o);case"keypress":return o.which!==32?null:(Og=!0,Ng);case"textInput":return s=o.data,s===Ng&&Og?null:s;default:return null}}function xA(s,o){if(es)return s==="compositionend"||!ef&&kg(s,o)?(s=Cg(),bl=Yc=Ti=null,es=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Mg&&o.locale!=="ko"?null:o.data;default:return null}}var IA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dg(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!IA[s.type]:o==="textarea"}function Lg(s,o,u,m){Xr?Wr?Wr.push(m):Wr=[m]:Xr=m,o=cu(o,"onChange"),0<o.length&&(u=new El("onChange","change",null,u,m),s.push({event:u,listeners:o}))}var xa=null,Ia=null;function MA(s){gv(s,0)}function Cl(s){var o=Ta(s);if(yg(o))return s}function Ug(s,o){if(s==="change")return o}var $g=!1;if(Qn){var tf;if(Qn){var nf="oninput"in document;if(!nf){var qg=document.createElement("div");qg.setAttribute("oninput","return;"),nf=typeof qg.oninput=="function"}tf=nf}else tf=!1;$g=tf&&(!document.documentMode||9<document.documentMode)}function Bg(){xa&&(xa.detachEvent("onpropertychange",Gg),Ia=xa=null)}function Gg(s){if(s.propertyName==="value"&&Cl(Ia)){var o=[];Lg(o,Ia,s,jc(s)),Sg(MA,o)}}function NA(s,o,u){s==="focusin"?(Bg(),xa=o,Ia=u,xa.attachEvent("onpropertychange",Gg)):s==="focusout"&&Bg()}function OA(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Cl(Ia)}function kA(s,o){if(s==="click")return Cl(o)}function PA(s,o){if(s==="input"||s==="change")return Cl(o)}function DA(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var en=typeof Object.is=="function"?Object.is:DA;function Ma(s,o){if(en(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var u=Object.keys(s),m=Object.keys(o);if(u.length!==m.length)return!1;for(m=0;m<u.length;m++){var y=u[m];if(!Nc.call(o,y)||!en(s[y],o[y]))return!1}return!0}function Vg(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Fg(s,o){var u=Vg(s);s=0;for(var m;u;){if(u.nodeType===3){if(m=s+u.textContent.length,s<=o&&m>=o)return{node:u,offset:o-s};s=m}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Vg(u)}}function Hg(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?Hg(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function zg(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=_l(s.document);o instanceof s.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)s=o.contentWindow;else break;o=_l(s.document)}return o}function rf(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var LA=Qn&&"documentMode"in document&&11>=document.documentMode,ts=null,sf=null,Na=null,af=!1;function jg(s,o,u){var m=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;af||ts==null||ts!==_l(m)||(m=ts,"selectionStart"in m&&rf(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Na&&Ma(Na,m)||(Na=m,m=cu(sf,"onSelect"),0<m.length&&(o=new El("onSelect","select",null,o,u),s.push({event:o,listeners:m}),o.target=ts)))}function gr(s,o){var u={};return u[s.toLowerCase()]=o.toLowerCase(),u["Webkit"+s]="webkit"+o,u["Moz"+s]="moz"+o,u}var ns={animationend:gr("Animation","AnimationEnd"),animationiteration:gr("Animation","AnimationIteration"),animationstart:gr("Animation","AnimationStart"),transitionrun:gr("Transition","TransitionRun"),transitionstart:gr("Transition","TransitionStart"),transitioncancel:gr("Transition","TransitionCancel"),transitionend:gr("Transition","TransitionEnd")},of={},Jg={};Qn&&(Jg=document.createElement("div").style,"AnimationEvent"in window||(delete ns.animationend.animation,delete ns.animationiteration.animation,delete ns.animationstart.animation),"TransitionEvent"in window||delete ns.transitionend.transition);function yr(s){if(of[s])return of[s];if(!ns[s])return s;var o=ns[s],u;for(u in o)if(o.hasOwnProperty(u)&&u in Jg)return of[s]=o[u];return s}var Kg=yr("animationend"),Yg=yr("animationiteration"),Zg=yr("animationstart"),UA=yr("transitionrun"),$A=yr("transitionstart"),qA=yr("transitioncancel"),Qg=yr("transitionend"),Xg=new Map,lf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");lf.push("scrollEnd");function An(s,o){Xg.set(s,o),pr(o,[s])}var Wg=new WeakMap;function mn(s,o){if(typeof s=="object"&&s!==null){var u=Wg.get(s);return u!==void 0?u:(o={value:s,source:o,stack:mg(o)},Wg.set(s,o),o)}return{value:s,source:o,stack:mg(o)}}var gn=[],is=0,uf=0;function Al(){for(var s=is,o=uf=is=0;o<s;){var u=gn[o];gn[o++]=null;var m=gn[o];gn[o++]=null;var y=gn[o];gn[o++]=null;var b=gn[o];if(gn[o++]=null,m!==null&&y!==null){var E=m.pending;E===null?y.next=y:(y.next=E.next,E.next=y),m.pending=y}b!==0&&ey(u,y,b)}}function Rl(s,o,u,m){gn[is++]=s,gn[is++]=o,gn[is++]=u,gn[is++]=m,uf|=m,s.lanes|=m,s=s.alternate,s!==null&&(s.lanes|=m)}function cf(s,o,u,m){return Rl(s,o,u,m),xl(s)}function rs(s,o){return Rl(s,null,null,o),xl(s)}function ey(s,o,u){s.lanes|=u;var m=s.alternate;m!==null&&(m.lanes|=u);for(var y=!1,b=s.return;b!==null;)b.childLanes|=u,m=b.alternate,m!==null&&(m.childLanes|=u),b.tag===22&&(s=b.stateNode,s===null||s._visibility&1||(y=!0)),s=b,b=b.return;return s.tag===3?(b=s.stateNode,y&&o!==null&&(y=31-Wt(u),s=b.hiddenUpdates,m=s[y],m===null?s[y]=[o]:m.push(o),o.lane=u|536870912),b):null}function xl(s){if(50<no)throw no=0,gd=null,Error(i(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var ss={};function BA(s,o,u,m){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tn(s,o,u,m){return new BA(s,o,u,m)}function ff(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Xn(s,o){var u=s.alternate;return u===null?(u=tn(s.tag,o,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=o,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&65011712,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,o=s.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u.refCleanup=s.refCleanup,u}function ty(s,o){s.flags&=65011714;var u=s.alternate;return u===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,o=u.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function Il(s,o,u,m,y,b){var E=0;if(m=s,typeof s=="function")ff(s)&&(E=1);else if(typeof s=="string")E=VR(s,u,se.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case re:return s=tn(31,u,o,y),s.elementType=re,s.lanes=b,s;case T:return _r(u.children,y,b,o);case S:E=8,y|=24;break;case C:return s=tn(12,u,o,y|2),s.elementType=C,s.lanes=b,s;case O:return s=tn(13,u,o,y),s.elementType=O,s.lanes=b,s;case V:return s=tn(19,u,o,y),s.elementType=V,s.lanes=b,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case x:case R:E=10;break e;case M:E=9;break e;case P:E=11;break e;case J:E=14;break e;case Z:E=16,m=null;break e}E=29,u=Error(i(130,s===null?"null":typeof s,"")),m=null}return o=tn(E,u,o,y),o.elementType=s,o.type=m,o.lanes=b,o}function _r(s,o,u,m){return s=tn(7,s,m,o),s.lanes=u,s}function df(s,o,u){return s=tn(6,s,null,o),s.lanes=u,s}function hf(s,o,u){return o=tn(4,s.children!==null?s.children:[],s.key,o),o.lanes=u,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var as=[],os=0,Ml=null,Nl=0,yn=[],_n=0,vr=null,Wn=1,ei="";function br(s,o){as[os++]=Nl,as[os++]=Ml,Ml=s,Nl=o}function ny(s,o,u){yn[_n++]=Wn,yn[_n++]=ei,yn[_n++]=vr,vr=s;var m=Wn;s=ei;var y=32-Wt(m)-1;m&=~(1<<y),u+=1;var b=32-Wt(o)+y;if(30<b){var E=y-y%5;b=(m&(1<<E)-1).toString(32),m>>=E,y-=E,Wn=1<<32-Wt(o)+y|u<<y|m,ei=b+s}else Wn=1<<b|u<<y|m,ei=s}function pf(s){s.return!==null&&(br(s,1),ny(s,1,0))}function mf(s){for(;s===Ml;)Ml=as[--os],as[os]=null,Nl=as[--os],as[os]=null;for(;s===vr;)vr=yn[--_n],yn[_n]=null,ei=yn[--_n],yn[_n]=null,Wn=yn[--_n],yn[_n]=null}var Pt=null,et=null,$e=!1,wr=null,Gn=!1,gf=Error(i(519));function Tr(s){var o=Error(i(418,""));throw Pa(mn(o,s)),gf}function iy(s){var o=s.stateNode,u=s.type,m=s.memoizedProps;switch(o[At]=s,o[Vt]=m,u){case"dialog":Ie("cancel",o),Ie("close",o);break;case"iframe":case"object":case"embed":Ie("load",o);break;case"video":case"audio":for(u=0;u<ro.length;u++)Ie(ro[u],o);break;case"source":Ie("error",o);break;case"img":case"image":case"link":Ie("error",o),Ie("load",o);break;case"details":Ie("toggle",o);break;case"input":Ie("invalid",o),_g(o,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0),yl(o);break;case"select":Ie("invalid",o);break;case"textarea":Ie("invalid",o),bg(o,m.value,m.defaultValue,m.children),yl(o)}u=m.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||m.suppressHydrationWarning===!0||bv(o.textContent,u)?(m.popover!=null&&(Ie("beforetoggle",o),Ie("toggle",o)),m.onScroll!=null&&Ie("scroll",o),m.onScrollEnd!=null&&Ie("scrollend",o),m.onClick!=null&&(o.onclick=fu),o=!0):o=!1,o||Tr(s)}function ry(s){for(Pt=s.return;Pt;)switch(Pt.tag){case 5:case 13:Gn=!1;return;case 27:case 3:Gn=!0;return;default:Pt=Pt.return}}function Oa(s){if(s!==Pt)return!1;if(!$e)return ry(s),$e=!0,!1;var o=s.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=s.type,u=!(u!=="form"&&u!=="button")||Od(s.type,s.memoizedProps)),u=!u),u&&et&&Tr(s),ry(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));e:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8)if(u=s.data,u==="/$"){if(o===0){et=xn(s.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++;s=s.nextSibling}et=null}}else o===27?(o=et,$i(s.type)?(s=Ld,Ld=null,et=s):et=o):et=Pt?xn(s.stateNode.nextSibling):null;return!0}function ka(){et=Pt=null,$e=!1}function sy(){var s=wr;return s!==null&&(jt===null?jt=s:jt.push.apply(jt,s),wr=null),s}function Pa(s){wr===null?wr=[s]:wr.push(s)}var yf=G(null),Er=null,ti=null;function Ei(s,o,u){X(yf,o._currentValue),o._currentValue=u}function ni(s){s._currentValue=yf.current,K(yf)}function _f(s,o,u){for(;s!==null;){var m=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,m!==null&&(m.childLanes|=o)):m!==null&&(m.childLanes&o)!==o&&(m.childLanes|=o),s===u)break;s=s.return}}function vf(s,o,u,m){var y=s.child;for(y!==null&&(y.return=s);y!==null;){var b=y.dependencies;if(b!==null){var E=y.child;b=b.firstContext;e:for(;b!==null;){var A=b;b=y;for(var N=0;N<o.length;N++)if(A.context===o[N]){b.lanes|=u,A=b.alternate,A!==null&&(A.lanes|=u),_f(b.return,u,s),m||(E=null);break e}b=A.next}}else if(y.tag===18){if(E=y.return,E===null)throw Error(i(341));E.lanes|=u,b=E.alternate,b!==null&&(b.lanes|=u),_f(E,u,s),E=null}else E=y.child;if(E!==null)E.return=y;else for(E=y;E!==null;){if(E===s){E=null;break}if(y=E.sibling,y!==null){y.return=E.return,E=y;break}E=E.return}y=E}}function Da(s,o,u,m){s=null;for(var y=o,b=!1;y!==null;){if(!b){if((y.flags&524288)!==0)b=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var E=y.alternate;if(E===null)throw Error(i(387));if(E=E.memoizedProps,E!==null){var A=y.type;en(y.pendingProps.value,E.value)||(s!==null?s.push(A):s=[A])}}else if(y===Qt.current){if(E=y.alternate,E===null)throw Error(i(387));E.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(s!==null?s.push(co):s=[co])}y=y.return}s!==null&&vf(o,s,u,m),o.flags|=262144}function Ol(s){for(s=s.firstContext;s!==null;){if(!en(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Sr(s){Er=s,ti=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Rt(s){return ay(Er,s)}function kl(s,o){return Er===null&&Sr(s),ay(s,o)}function ay(s,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},ti===null){if(s===null)throw Error(i(308));ti=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else ti=ti.next=o;return u}var GA=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(u,m){s.push(m)}};this.abort=function(){o.aborted=!0,s.forEach(function(u){return u()})}},VA=n.unstable_scheduleCallback,FA=n.unstable_NormalPriority,ut={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function bf(){return{controller:new GA,data:new Map,refCount:0}}function La(s){s.refCount--,s.refCount===0&&VA(FA,function(){s.controller.abort()})}var Ua=null,wf=0,ls=0,us=null;function HA(s,o){if(Ua===null){var u=Ua=[];wf=0,ls=Ed(),us={status:"pending",value:void 0,then:function(m){u.push(m)}}}return wf++,o.then(oy,oy),o}function oy(){if(--wf===0&&Ua!==null){us!==null&&(us.status="fulfilled");var s=Ua;Ua=null,ls=0,us=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function zA(s,o){var u=[],m={status:"pending",value:null,reason:null,then:function(y){u.push(y)}};return s.then(function(){m.status="fulfilled",m.value=o;for(var y=0;y<u.length;y++)(0,u[y])(o)},function(y){for(m.status="rejected",m.reason=y,y=0;y<u.length;y++)(0,u[y])(void 0)}),m}var ly=L.S;L.S=function(s,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&HA(s,o),ly!==null&&ly(s,o)};var Cr=G(null);function Tf(){var s=Cr.current;return s!==null?s:Ke.pooledCache}function Pl(s,o){o===null?X(Cr,Cr.current):X(Cr,o.pool)}function uy(){var s=Tf();return s===null?null:{parent:ut._currentValue,pool:s}}var $a=Error(i(460)),cy=Error(i(474)),Dl=Error(i(542)),Ef={then:function(){}};function fy(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Ll(){}function dy(s,o,u){switch(u=s[u],u===void 0?s.push(o):u!==o&&(o.then(Ll,Ll),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,py(s),s;default:if(typeof o.status=="string")o.then(Ll,Ll);else{if(s=Ke,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=o,s.status="pending",s.then(function(m){if(o.status==="pending"){var y=o;y.status="fulfilled",y.value=m}},function(m){if(o.status==="pending"){var y=o;y.status="rejected",y.reason=m}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,py(s),s}throw qa=o,$a}}var qa=null;function hy(){if(qa===null)throw Error(i(459));var s=qa;return qa=null,s}function py(s){if(s===$a||s===Dl)throw Error(i(483))}var Si=!1;function Sf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Cf(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ci(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ai(s,o,u){var m=s.updateQueue;if(m===null)return null;if(m=m.shared,(Be&2)!==0){var y=m.pending;return y===null?o.next=o:(o.next=y.next,y.next=o),m.pending=o,o=xl(s),ey(s,null,u),o}return Rl(s,m,o,u),xl(s)}function Ba(s,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var m=o.lanes;m&=s.pendingLanes,u|=m,o.lanes=u,og(s,u)}}function Af(s,o){var u=s.updateQueue,m=s.alternate;if(m!==null&&(m=m.updateQueue,u===m)){var y=null,b=null;if(u=u.firstBaseUpdate,u!==null){do{var E={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};b===null?y=b=E:b=b.next=E,u=u.next}while(u!==null);b===null?y=b=o:b=b.next=o}else y=b=o;u={baseState:m.baseState,firstBaseUpdate:y,lastBaseUpdate:b,shared:m.shared,callbacks:m.callbacks},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=o:s.next=o,u.lastBaseUpdate=o}var Rf=!1;function Ga(){if(Rf){var s=us;if(s!==null)throw s}}function Va(s,o,u,m){Rf=!1;var y=s.updateQueue;Si=!1;var b=y.firstBaseUpdate,E=y.lastBaseUpdate,A=y.shared.pending;if(A!==null){y.shared.pending=null;var N=A,$=N.next;N.next=null,E===null?b=$:E.next=$,E=N;var H=s.alternate;H!==null&&(H=H.updateQueue,A=H.lastBaseUpdate,A!==E&&(A===null?H.firstBaseUpdate=$:A.next=$,H.lastBaseUpdate=N))}if(b!==null){var j=y.baseState;E=0,H=$=N=null,A=b;do{var q=A.lane&-536870913,B=q!==A.lane;if(B?(Oe&q)===q:(m&q)===q){q!==0&&q===ls&&(Rf=!0),H!==null&&(H=H.next={lane:0,tag:A.tag,payload:A.payload,callback:null,next:null});e:{var ge=s,he=A;q=o;var je=u;switch(he.tag){case 1:if(ge=he.payload,typeof ge=="function"){j=ge.call(je,j,q);break e}j=ge;break e;case 3:ge.flags=ge.flags&-65537|128;case 0:if(ge=he.payload,q=typeof ge=="function"?ge.call(je,j,q):ge,q==null)break e;j=g({},j,q);break e;case 2:Si=!0}}q=A.callback,q!==null&&(s.flags|=64,B&&(s.flags|=8192),B=y.callbacks,B===null?y.callbacks=[q]:B.push(q))}else B={lane:q,tag:A.tag,payload:A.payload,callback:A.callback,next:null},H===null?($=H=B,N=j):H=H.next=B,E|=q;if(A=A.next,A===null){if(A=y.shared.pending,A===null)break;B=A,A=B.next,B.next=null,y.lastBaseUpdate=B,y.shared.pending=null}}while(!0);H===null&&(N=j),y.baseState=N,y.firstBaseUpdate=$,y.lastBaseUpdate=H,b===null&&(y.shared.lanes=0),Pi|=E,s.lanes=E,s.memoizedState=j}}function my(s,o){if(typeof s!="function")throw Error(i(191,s));s.call(o)}function gy(s,o){var u=s.callbacks;if(u!==null)for(s.callbacks=null,s=0;s<u.length;s++)my(u[s],o)}var cs=G(null),Ul=G(0);function yy(s,o){s=ui,X(Ul,s),X(cs,o),ui=s|o.baseLanes}function xf(){X(Ul,ui),X(cs,cs.current)}function If(){ui=Ul.current,K(cs),K(Ul)}var Ri=0,Ce=null,He=null,rt=null,$l=!1,fs=!1,Ar=!1,ql=0,Fa=0,ds=null,jA=0;function nt(){throw Error(i(321))}function Mf(s,o){if(o===null)return!1;for(var u=0;u<o.length&&u<s.length;u++)if(!en(s[u],o[u]))return!1;return!0}function Nf(s,o,u,m,y,b){return Ri=b,Ce=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,L.H=s===null||s.memoizedState===null?e_:t_,Ar=!1,b=u(m,y),Ar=!1,fs&&(b=vy(o,u,m,y)),_y(s),b}function _y(s){L.H=zl;var o=He!==null&&He.next!==null;if(Ri=0,rt=He=Ce=null,$l=!1,Fa=0,ds=null,o)throw Error(i(300));s===null||pt||(s=s.dependencies,s!==null&&Ol(s)&&(pt=!0))}function vy(s,o,u,m){Ce=s;var y=0;do{if(fs&&(ds=null),Fa=0,fs=!1,25<=y)throw Error(i(301));if(y+=1,rt=He=null,s.updateQueue!=null){var b=s.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}L.H=WA,b=o(u,m)}while(fs);return b}function JA(){var s=L.H,o=s.useState()[0];return o=typeof o.then=="function"?Ha(o):o,s=s.useState()[0],(He!==null?He.memoizedState:null)!==s&&(Ce.flags|=1024),o}function Of(){var s=ql!==0;return ql=0,s}function kf(s,o,u){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~u}function Pf(s){if($l){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}$l=!1}Ri=0,rt=He=Ce=null,fs=!1,Fa=ql=0,ds=null}function Ht(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rt===null?Ce.memoizedState=rt=s:rt=rt.next=s,rt}function st(){if(He===null){var s=Ce.alternate;s=s!==null?s.memoizedState:null}else s=He.next;var o=rt===null?Ce.memoizedState:rt.next;if(o!==null)rt=o,He=s;else{if(s===null)throw Ce.alternate===null?Error(i(467)):Error(i(310));He=s,s={memoizedState:He.memoizedState,baseState:He.baseState,baseQueue:He.baseQueue,queue:He.queue,next:null},rt===null?Ce.memoizedState=rt=s:rt=rt.next=s}return rt}function Df(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ha(s){var o=Fa;return Fa+=1,ds===null&&(ds=[]),s=dy(ds,s,o),o=Ce,(rt===null?o.memoizedState:rt.next)===null&&(o=o.alternate,L.H=o===null||o.memoizedState===null?e_:t_),s}function Bl(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Ha(s);if(s.$$typeof===R)return Rt(s)}throw Error(i(438,String(s)))}function Lf(s){var o=null,u=Ce.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var m=Ce.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(o={data:m.data.map(function(y){return y.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=Df(),Ce.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(s),m=0;m<s;m++)u[m]=Se;return o.index++,u}function ii(s,o){return typeof o=="function"?o(s):o}function Gl(s){var o=st();return Uf(o,He,s)}function Uf(s,o,u){var m=s.queue;if(m===null)throw Error(i(311));m.lastRenderedReducer=u;var y=s.baseQueue,b=m.pending;if(b!==null){if(y!==null){var E=y.next;y.next=b.next,b.next=E}o.baseQueue=y=b,m.pending=null}if(b=s.baseState,y===null)s.memoizedState=b;else{o=y.next;var A=E=null,N=null,$=o,H=!1;do{var j=$.lane&-536870913;if(j!==$.lane?(Oe&j)===j:(Ri&j)===j){var q=$.revertLane;if(q===0)N!==null&&(N=N.next={lane:0,revertLane:0,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null}),j===ls&&(H=!0);else if((Ri&q)===q){$=$.next,q===ls&&(H=!0);continue}else j={lane:0,revertLane:$.revertLane,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},N===null?(A=N=j,E=b):N=N.next=j,Ce.lanes|=q,Pi|=q;j=$.action,Ar&&u(b,j),b=$.hasEagerState?$.eagerState:u(b,j)}else q={lane:j,revertLane:$.revertLane,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},N===null?(A=N=q,E=b):N=N.next=q,Ce.lanes|=j,Pi|=j;$=$.next}while($!==null&&$!==o);if(N===null?E=b:N.next=A,!en(b,s.memoizedState)&&(pt=!0,H&&(u=us,u!==null)))throw u;s.memoizedState=b,s.baseState=E,s.baseQueue=N,m.lastRenderedState=b}return y===null&&(m.lanes=0),[s.memoizedState,m.dispatch]}function $f(s){var o=st(),u=o.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=s;var m=u.dispatch,y=u.pending,b=o.memoizedState;if(y!==null){u.pending=null;var E=y=y.next;do b=s(b,E.action),E=E.next;while(E!==y);en(b,o.memoizedState)||(pt=!0),o.memoizedState=b,o.baseQueue===null&&(o.baseState=b),u.lastRenderedState=b}return[b,m]}function by(s,o,u){var m=Ce,y=st(),b=$e;if(b){if(u===void 0)throw Error(i(407));u=u()}else u=o();var E=!en((He||y).memoizedState,u);E&&(y.memoizedState=u,pt=!0),y=y.queue;var A=Ey.bind(null,m,y,s);if(za(2048,8,A,[s]),y.getSnapshot!==o||E||rt!==null&&rt.memoizedState.tag&1){if(m.flags|=2048,hs(9,Vl(),Ty.bind(null,m,y,u,o),null),Ke===null)throw Error(i(349));b||(Ri&124)!==0||wy(m,o,u)}return u}function wy(s,o,u){s.flags|=16384,s={getSnapshot:o,value:u},o=Ce.updateQueue,o===null?(o=Df(),Ce.updateQueue=o,o.stores=[s]):(u=o.stores,u===null?o.stores=[s]:u.push(s))}function Ty(s,o,u,m){o.value=u,o.getSnapshot=m,Sy(o)&&Cy(s)}function Ey(s,o,u){return u(function(){Sy(o)&&Cy(s)})}function Sy(s){var o=s.getSnapshot;s=s.value;try{var u=o();return!en(s,u)}catch{return!0}}function Cy(s){var o=rs(s,2);o!==null&&on(o,s,2)}function qf(s){var o=Ht();if(typeof s=="function"){var u=s;if(s=u(),Ar){bi(!0);try{u()}finally{bi(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ii,lastRenderedState:s},o}function Ay(s,o,u,m){return s.baseState=u,Uf(s,He,typeof m=="function"?m:ii)}function KA(s,o,u,m,y){if(Hl(s))throw Error(i(485));if(s=o.action,s!==null){var b={payload:y,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){b.listeners.push(E)}};L.T!==null?u(!0):b.isTransition=!1,m(b),u=o.pending,u===null?(b.next=o.pending=b,Ry(o,b)):(b.next=u.next,o.pending=u.next=b)}}function Ry(s,o){var u=o.action,m=o.payload,y=s.state;if(o.isTransition){var b=L.T,E={};L.T=E;try{var A=u(y,m),N=L.S;N!==null&&N(E,A),xy(s,o,A)}catch($){Bf(s,o,$)}finally{L.T=b}}else try{b=u(y,m),xy(s,o,b)}catch($){Bf(s,o,$)}}function xy(s,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(m){Iy(s,o,m)},function(m){return Bf(s,o,m)}):Iy(s,o,u)}function Iy(s,o,u){o.status="fulfilled",o.value=u,My(o),s.state=u,o=s.pending,o!==null&&(u=o.next,u===o?s.pending=null:(u=u.next,o.next=u,Ry(s,u)))}function Bf(s,o,u){var m=s.pending;if(s.pending=null,m!==null){m=m.next;do o.status="rejected",o.reason=u,My(o),o=o.next;while(o!==m)}s.action=null}function My(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function Ny(s,o){return o}function Oy(s,o){if($e){var u=Ke.formState;if(u!==null){e:{var m=Ce;if($e){if(et){t:{for(var y=et,b=Gn;y.nodeType!==8;){if(!b){y=null;break t}if(y=xn(y.nextSibling),y===null){y=null;break t}}b=y.data,y=b==="F!"||b==="F"?y:null}if(y){et=xn(y.nextSibling),m=y.data==="F!";break e}}Tr(m)}m=!1}m&&(o=u[0])}}return u=Ht(),u.memoizedState=u.baseState=o,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ny,lastRenderedState:o},u.queue=m,u=Qy.bind(null,Ce,m),m.dispatch=u,m=qf(!1),b=zf.bind(null,Ce,!1,m.queue),m=Ht(),y={state:o,dispatch:null,action:s,pending:null},m.queue=y,u=KA.bind(null,Ce,y,b,u),y.dispatch=u,m.memoizedState=s,[o,u,!1]}function ky(s){var o=st();return Py(o,He,s)}function Py(s,o,u){if(o=Uf(s,o,Ny)[0],s=Gl(ii)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var m=Ha(o)}catch(E){throw E===$a?Dl:E}else m=o;o=st();var y=o.queue,b=y.dispatch;return u!==o.memoizedState&&(Ce.flags|=2048,hs(9,Vl(),YA.bind(null,y,u),null)),[m,b,s]}function YA(s,o){s.action=o}function Dy(s){var o=st(),u=He;if(u!==null)return Py(o,u,s);st(),o=o.memoizedState,u=st();var m=u.queue.dispatch;return u.memoizedState=s,[o,m,!1]}function hs(s,o,u,m){return s={tag:s,create:u,deps:m,inst:o,next:null},o=Ce.updateQueue,o===null&&(o=Df(),Ce.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=s.next=s:(m=u.next,u.next=s,s.next=m,o.lastEffect=s),s}function Vl(){return{destroy:void 0,resource:void 0}}function Ly(){return st().memoizedState}function Fl(s,o,u,m){var y=Ht();m=m===void 0?null:m,Ce.flags|=s,y.memoizedState=hs(1|o,Vl(),u,m)}function za(s,o,u,m){var y=st();m=m===void 0?null:m;var b=y.memoizedState.inst;He!==null&&m!==null&&Mf(m,He.memoizedState.deps)?y.memoizedState=hs(o,b,u,m):(Ce.flags|=s,y.memoizedState=hs(1|o,b,u,m))}function Uy(s,o){Fl(8390656,8,s,o)}function $y(s,o){za(2048,8,s,o)}function qy(s,o){return za(4,2,s,o)}function By(s,o){return za(4,4,s,o)}function Gy(s,o){if(typeof o=="function"){s=s();var u=o(s);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function Vy(s,o,u){u=u!=null?u.concat([s]):null,za(4,4,Gy.bind(null,o,s),u)}function Gf(){}function Fy(s,o){var u=st();o=o===void 0?null:o;var m=u.memoizedState;return o!==null&&Mf(o,m[1])?m[0]:(u.memoizedState=[s,o],s)}function Hy(s,o){var u=st();o=o===void 0?null:o;var m=u.memoizedState;if(o!==null&&Mf(o,m[1]))return m[0];if(m=s(),Ar){bi(!0);try{s()}finally{bi(!1)}}return u.memoizedState=[m,o],m}function Vf(s,o,u){return u===void 0||(Ri&1073741824)!==0?s.memoizedState=o:(s.memoizedState=u,s=J_(),Ce.lanes|=s,Pi|=s,u)}function zy(s,o,u,m){return en(u,o)?u:cs.current!==null?(s=Vf(s,u,m),en(s,o)||(pt=!0),s):(Ri&42)===0?(pt=!0,s.memoizedState=u):(s=J_(),Ce.lanes|=s,Pi|=s,o)}function jy(s,o,u,m,y){var b=F.p;F.p=b!==0&&8>b?b:8;var E=L.T,A={};L.T=A,zf(s,!1,o,u);try{var N=y(),$=L.S;if($!==null&&$(A,N),N!==null&&typeof N=="object"&&typeof N.then=="function"){var H=zA(N,m);ja(s,o,H,an(s))}else ja(s,o,m,an(s))}catch(j){ja(s,o,{then:function(){},status:"rejected",reason:j},an())}finally{F.p=b,L.T=E}}function ZA(){}function Ff(s,o,u,m){if(s.tag!==5)throw Error(i(476));var y=Jy(s).queue;jy(s,y,o,Q,u===null?ZA:function(){return Ky(s),u(m)})}function Jy(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:Q,baseState:Q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ii,lastRenderedState:Q},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ii,lastRenderedState:u},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function Ky(s){var o=Jy(s).next.queue;ja(s,o,{},an())}function Hf(){return Rt(co)}function Yy(){return st().memoizedState}function Zy(){return st().memoizedState}function QA(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var u=an();s=Ci(u);var m=Ai(o,s,u);m!==null&&(on(m,o,u),Ba(m,o,u)),o={cache:bf()},s.payload=o;return}o=o.return}}function XA(s,o,u){var m=an();u={lane:m,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},Hl(s)?Xy(o,u):(u=cf(s,o,u,m),u!==null&&(on(u,s,m),Wy(u,o,m)))}function Qy(s,o,u){var m=an();ja(s,o,u,m)}function ja(s,o,u,m){var y={lane:m,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(Hl(s))Xy(o,y);else{var b=s.alternate;if(s.lanes===0&&(b===null||b.lanes===0)&&(b=o.lastRenderedReducer,b!==null))try{var E=o.lastRenderedState,A=b(E,u);if(y.hasEagerState=!0,y.eagerState=A,en(A,E))return Rl(s,o,y,0),Ke===null&&Al(),!1}catch{}finally{}if(u=cf(s,o,y,m),u!==null)return on(u,s,m),Wy(u,o,m),!0}return!1}function zf(s,o,u,m){if(m={lane:2,revertLane:Ed(),action:m,hasEagerState:!1,eagerState:null,next:null},Hl(s)){if(o)throw Error(i(479))}else o=cf(s,u,m,2),o!==null&&on(o,s,2)}function Hl(s){var o=s.alternate;return s===Ce||o!==null&&o===Ce}function Xy(s,o){fs=$l=!0;var u=s.pending;u===null?o.next=o:(o.next=u.next,u.next=o),s.pending=o}function Wy(s,o,u){if((u&4194048)!==0){var m=o.lanes;m&=s.pendingLanes,u|=m,o.lanes=u,og(s,u)}}var zl={readContext:Rt,use:Bl,useCallback:nt,useContext:nt,useEffect:nt,useImperativeHandle:nt,useLayoutEffect:nt,useInsertionEffect:nt,useMemo:nt,useReducer:nt,useRef:nt,useState:nt,useDebugValue:nt,useDeferredValue:nt,useTransition:nt,useSyncExternalStore:nt,useId:nt,useHostTransitionStatus:nt,useFormState:nt,useActionState:nt,useOptimistic:nt,useMemoCache:nt,useCacheRefresh:nt},e_={readContext:Rt,use:Bl,useCallback:function(s,o){return Ht().memoizedState=[s,o===void 0?null:o],s},useContext:Rt,useEffect:Uy,useImperativeHandle:function(s,o,u){u=u!=null?u.concat([s]):null,Fl(4194308,4,Gy.bind(null,o,s),u)},useLayoutEffect:function(s,o){return Fl(4194308,4,s,o)},useInsertionEffect:function(s,o){Fl(4,2,s,o)},useMemo:function(s,o){var u=Ht();o=o===void 0?null:o;var m=s();if(Ar){bi(!0);try{s()}finally{bi(!1)}}return u.memoizedState=[m,o],m},useReducer:function(s,o,u){var m=Ht();if(u!==void 0){var y=u(o);if(Ar){bi(!0);try{u(o)}finally{bi(!1)}}}else y=o;return m.memoizedState=m.baseState=y,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:y},m.queue=s,s=s.dispatch=XA.bind(null,Ce,s),[m.memoizedState,s]},useRef:function(s){var o=Ht();return s={current:s},o.memoizedState=s},useState:function(s){s=qf(s);var o=s.queue,u=Qy.bind(null,Ce,o);return o.dispatch=u,[s.memoizedState,u]},useDebugValue:Gf,useDeferredValue:function(s,o){var u=Ht();return Vf(u,s,o)},useTransition:function(){var s=qf(!1);return s=jy.bind(null,Ce,s.queue,!0,!1),Ht().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,u){var m=Ce,y=Ht();if($e){if(u===void 0)throw Error(i(407));u=u()}else{if(u=o(),Ke===null)throw Error(i(349));(Oe&124)!==0||wy(m,o,u)}y.memoizedState=u;var b={value:u,getSnapshot:o};return y.queue=b,Uy(Ey.bind(null,m,b,s),[s]),m.flags|=2048,hs(9,Vl(),Ty.bind(null,m,b,u,o),null),u},useId:function(){var s=Ht(),o=Ke.identifierPrefix;if($e){var u=ei,m=Wn;u=(m&~(1<<32-Wt(m)-1)).toString(32)+u,o="«"+o+"R"+u,u=ql++,0<u&&(o+="H"+u.toString(32)),o+="»"}else u=jA++,o="«"+o+"r"+u.toString(32)+"»";return s.memoizedState=o},useHostTransitionStatus:Hf,useFormState:Oy,useActionState:Oy,useOptimistic:function(s){var o=Ht();o.memoizedState=o.baseState=s;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=zf.bind(null,Ce,!0,u),u.dispatch=o,[s,o]},useMemoCache:Lf,useCacheRefresh:function(){return Ht().memoizedState=QA.bind(null,Ce)}},t_={readContext:Rt,use:Bl,useCallback:Fy,useContext:Rt,useEffect:$y,useImperativeHandle:Vy,useInsertionEffect:qy,useLayoutEffect:By,useMemo:Hy,useReducer:Gl,useRef:Ly,useState:function(){return Gl(ii)},useDebugValue:Gf,useDeferredValue:function(s,o){var u=st();return zy(u,He.memoizedState,s,o)},useTransition:function(){var s=Gl(ii)[0],o=st().memoizedState;return[typeof s=="boolean"?s:Ha(s),o]},useSyncExternalStore:by,useId:Yy,useHostTransitionStatus:Hf,useFormState:ky,useActionState:ky,useOptimistic:function(s,o){var u=st();return Ay(u,He,s,o)},useMemoCache:Lf,useCacheRefresh:Zy},WA={readContext:Rt,use:Bl,useCallback:Fy,useContext:Rt,useEffect:$y,useImperativeHandle:Vy,useInsertionEffect:qy,useLayoutEffect:By,useMemo:Hy,useReducer:$f,useRef:Ly,useState:function(){return $f(ii)},useDebugValue:Gf,useDeferredValue:function(s,o){var u=st();return He===null?Vf(u,s,o):zy(u,He.memoizedState,s,o)},useTransition:function(){var s=$f(ii)[0],o=st().memoizedState;return[typeof s=="boolean"?s:Ha(s),o]},useSyncExternalStore:by,useId:Yy,useHostTransitionStatus:Hf,useFormState:Dy,useActionState:Dy,useOptimistic:function(s,o){var u=st();return He!==null?Ay(u,He,s,o):(u.baseState=s,[s,u.queue.dispatch])},useMemoCache:Lf,useCacheRefresh:Zy},ps=null,Ja=0;function jl(s){var o=Ja;return Ja+=1,ps===null&&(ps=[]),dy(ps,s,o)}function Ka(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function Jl(s,o){throw o.$$typeof===_?Error(i(525)):(s=Object.prototype.toString.call(o),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function n_(s){var o=s._init;return o(s._payload)}function i_(s){function o(D,k){if(s){var U=D.deletions;U===null?(D.deletions=[k],D.flags|=16):U.push(k)}}function u(D,k){if(!s)return null;for(;k!==null;)o(D,k),k=k.sibling;return null}function m(D){for(var k=new Map;D!==null;)D.key!==null?k.set(D.key,D):k.set(D.index,D),D=D.sibling;return k}function y(D,k){return D=Xn(D,k),D.index=0,D.sibling=null,D}function b(D,k,U){return D.index=U,s?(U=D.alternate,U!==null?(U=U.index,U<k?(D.flags|=67108866,k):U):(D.flags|=67108866,k)):(D.flags|=1048576,k)}function E(D){return s&&D.alternate===null&&(D.flags|=67108866),D}function A(D,k,U,z){return k===null||k.tag!==6?(k=df(U,D.mode,z),k.return=D,k):(k=y(k,U),k.return=D,k)}function N(D,k,U,z){var ae=U.type;return ae===T?H(D,k,U.props.children,z,U.key):k!==null&&(k.elementType===ae||typeof ae=="object"&&ae!==null&&ae.$$typeof===Z&&n_(ae)===k.type)?(k=y(k,U.props),Ka(k,U),k.return=D,k):(k=Il(U.type,U.key,U.props,null,D.mode,z),Ka(k,U),k.return=D,k)}function $(D,k,U,z){return k===null||k.tag!==4||k.stateNode.containerInfo!==U.containerInfo||k.stateNode.implementation!==U.implementation?(k=hf(U,D.mode,z),k.return=D,k):(k=y(k,U.children||[]),k.return=D,k)}function H(D,k,U,z,ae){return k===null||k.tag!==7?(k=_r(U,D.mode,z,ae),k.return=D,k):(k=y(k,U),k.return=D,k)}function j(D,k,U){if(typeof k=="string"&&k!==""||typeof k=="number"||typeof k=="bigint")return k=df(""+k,D.mode,U),k.return=D,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case v:return U=Il(k.type,k.key,k.props,null,D.mode,U),Ka(U,k),U.return=D,U;case w:return k=hf(k,D.mode,U),k.return=D,k;case Z:var z=k._init;return k=z(k._payload),j(D,k,U)}if(Y(k)||Ue(k))return k=_r(k,D.mode,U,null),k.return=D,k;if(typeof k.then=="function")return j(D,jl(k),U);if(k.$$typeof===R)return j(D,kl(D,k),U);Jl(D,k)}return null}function q(D,k,U,z){var ae=k!==null?k.key:null;if(typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint")return ae!==null?null:A(D,k,""+U,z);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case v:return U.key===ae?N(D,k,U,z):null;case w:return U.key===ae?$(D,k,U,z):null;case Z:return ae=U._init,U=ae(U._payload),q(D,k,U,z)}if(Y(U)||Ue(U))return ae!==null?null:H(D,k,U,z,null);if(typeof U.then=="function")return q(D,k,jl(U),z);if(U.$$typeof===R)return q(D,k,kl(D,U),z);Jl(D,U)}return null}function B(D,k,U,z,ae){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return D=D.get(U)||null,A(k,D,""+z,ae);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case v:return D=D.get(z.key===null?U:z.key)||null,N(k,D,z,ae);case w:return D=D.get(z.key===null?U:z.key)||null,$(k,D,z,ae);case Z:var Ae=z._init;return z=Ae(z._payload),B(D,k,U,z,ae)}if(Y(z)||Ue(z))return D=D.get(U)||null,H(k,D,z,ae,null);if(typeof z.then=="function")return B(D,k,U,jl(z),ae);if(z.$$typeof===R)return B(D,k,U,kl(k,z),ae);Jl(k,z)}return null}function ge(D,k,U,z){for(var ae=null,Ae=null,ce=k,me=k=0,gt=null;ce!==null&&me<U.length;me++){ce.index>me?(gt=ce,ce=null):gt=ce.sibling;var Pe=q(D,ce,U[me],z);if(Pe===null){ce===null&&(ce=gt);break}s&&ce&&Pe.alternate===null&&o(D,ce),k=b(Pe,k,me),Ae===null?ae=Pe:Ae.sibling=Pe,Ae=Pe,ce=gt}if(me===U.length)return u(D,ce),$e&&br(D,me),ae;if(ce===null){for(;me<U.length;me++)ce=j(D,U[me],z),ce!==null&&(k=b(ce,k,me),Ae===null?ae=ce:Ae.sibling=ce,Ae=ce);return $e&&br(D,me),ae}for(ce=m(ce);me<U.length;me++)gt=B(ce,D,me,U[me],z),gt!==null&&(s&&gt.alternate!==null&&ce.delete(gt.key===null?me:gt.key),k=b(gt,k,me),Ae===null?ae=gt:Ae.sibling=gt,Ae=gt);return s&&ce.forEach(function(Fi){return o(D,Fi)}),$e&&br(D,me),ae}function he(D,k,U,z){if(U==null)throw Error(i(151));for(var ae=null,Ae=null,ce=k,me=k=0,gt=null,Pe=U.next();ce!==null&&!Pe.done;me++,Pe=U.next()){ce.index>me?(gt=ce,ce=null):gt=ce.sibling;var Fi=q(D,ce,Pe.value,z);if(Fi===null){ce===null&&(ce=gt);break}s&&ce&&Fi.alternate===null&&o(D,ce),k=b(Fi,k,me),Ae===null?ae=Fi:Ae.sibling=Fi,Ae=Fi,ce=gt}if(Pe.done)return u(D,ce),$e&&br(D,me),ae;if(ce===null){for(;!Pe.done;me++,Pe=U.next())Pe=j(D,Pe.value,z),Pe!==null&&(k=b(Pe,k,me),Ae===null?ae=Pe:Ae.sibling=Pe,Ae=Pe);return $e&&br(D,me),ae}for(ce=m(ce);!Pe.done;me++,Pe=U.next())Pe=B(ce,D,me,Pe.value,z),Pe!==null&&(s&&Pe.alternate!==null&&ce.delete(Pe.key===null?me:Pe.key),k=b(Pe,k,me),Ae===null?ae=Pe:Ae.sibling=Pe,Ae=Pe);return s&&ce.forEach(function(ex){return o(D,ex)}),$e&&br(D,me),ae}function je(D,k,U,z){if(typeof U=="object"&&U!==null&&U.type===T&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case v:e:{for(var ae=U.key;k!==null;){if(k.key===ae){if(ae=U.type,ae===T){if(k.tag===7){u(D,k.sibling),z=y(k,U.props.children),z.return=D,D=z;break e}}else if(k.elementType===ae||typeof ae=="object"&&ae!==null&&ae.$$typeof===Z&&n_(ae)===k.type){u(D,k.sibling),z=y(k,U.props),Ka(z,U),z.return=D,D=z;break e}u(D,k);break}else o(D,k);k=k.sibling}U.type===T?(z=_r(U.props.children,D.mode,z,U.key),z.return=D,D=z):(z=Il(U.type,U.key,U.props,null,D.mode,z),Ka(z,U),z.return=D,D=z)}return E(D);case w:e:{for(ae=U.key;k!==null;){if(k.key===ae)if(k.tag===4&&k.stateNode.containerInfo===U.containerInfo&&k.stateNode.implementation===U.implementation){u(D,k.sibling),z=y(k,U.children||[]),z.return=D,D=z;break e}else{u(D,k);break}else o(D,k);k=k.sibling}z=hf(U,D.mode,z),z.return=D,D=z}return E(D);case Z:return ae=U._init,U=ae(U._payload),je(D,k,U,z)}if(Y(U))return ge(D,k,U,z);if(Ue(U)){if(ae=Ue(U),typeof ae!="function")throw Error(i(150));return U=ae.call(U),he(D,k,U,z)}if(typeof U.then=="function")return je(D,k,jl(U),z);if(U.$$typeof===R)return je(D,k,kl(D,U),z);Jl(D,U)}return typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint"?(U=""+U,k!==null&&k.tag===6?(u(D,k.sibling),z=y(k,U),z.return=D,D=z):(u(D,k),z=df(U,D.mode,z),z.return=D,D=z),E(D)):u(D,k)}return function(D,k,U,z){try{Ja=0;var ae=je(D,k,U,z);return ps=null,ae}catch(ce){if(ce===$a||ce===Dl)throw ce;var Ae=tn(29,ce,null,D.mode);return Ae.lanes=z,Ae.return=D,Ae}finally{}}}var ms=i_(!0),r_=i_(!1),vn=G(null),Vn=null;function xi(s){var o=s.alternate;X(ct,ct.current&1),X(vn,s),Vn===null&&(o===null||cs.current!==null||o.memoizedState!==null)&&(Vn=s)}function s_(s){if(s.tag===22){if(X(ct,ct.current),X(vn,s),Vn===null){var o=s.alternate;o!==null&&o.memoizedState!==null&&(Vn=s)}}else Ii()}function Ii(){X(ct,ct.current),X(vn,vn.current)}function ri(s){K(vn),Vn===s&&(Vn=null),K(ct)}var ct=G(0);function Kl(s){for(var o=s;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||Dd(u)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function jf(s,o,u,m){o=s.memoizedState,u=u(m,o),u=u==null?o:g({},o,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var Jf={enqueueSetState:function(s,o,u){s=s._reactInternals;var m=an(),y=Ci(m);y.payload=o,u!=null&&(y.callback=u),o=Ai(s,y,m),o!==null&&(on(o,s,m),Ba(o,s,m))},enqueueReplaceState:function(s,o,u){s=s._reactInternals;var m=an(),y=Ci(m);y.tag=1,y.payload=o,u!=null&&(y.callback=u),o=Ai(s,y,m),o!==null&&(on(o,s,m),Ba(o,s,m))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var u=an(),m=Ci(u);m.tag=2,o!=null&&(m.callback=o),o=Ai(s,m,u),o!==null&&(on(o,s,u),Ba(o,s,u))}};function a_(s,o,u,m,y,b,E){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(m,b,E):o.prototype&&o.prototype.isPureReactComponent?!Ma(u,m)||!Ma(y,b):!0}function o_(s,o,u,m){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,m),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,m),o.state!==s&&Jf.enqueueReplaceState(o,o.state,null)}function Rr(s,o){var u=o;if("ref"in o){u={};for(var m in o)m!=="ref"&&(u[m]=o[m])}if(s=s.defaultProps){u===o&&(u=g({},u));for(var y in s)u[y]===void 0&&(u[y]=s[y])}return u}var Yl=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function l_(s){Yl(s)}function u_(s){console.error(s)}function c_(s){Yl(s)}function Zl(s,o){try{var u=s.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(m){setTimeout(function(){throw m})}}function f_(s,o,u){try{var m=s.onCaughtError;m(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Kf(s,o,u){return u=Ci(u),u.tag=3,u.payload={element:null},u.callback=function(){Zl(s,o)},u}function d_(s){return s=Ci(s),s.tag=3,s}function h_(s,o,u,m){var y=u.type.getDerivedStateFromError;if(typeof y=="function"){var b=m.value;s.payload=function(){return y(b)},s.callback=function(){f_(o,u,m)}}var E=u.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(s.callback=function(){f_(o,u,m),typeof y!="function"&&(Di===null?Di=new Set([this]):Di.add(this));var A=m.stack;this.componentDidCatch(m.value,{componentStack:A!==null?A:""})})}function eR(s,o,u,m,y){if(u.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(o=u.alternate,o!==null&&Da(o,u,y,!0),u=vn.current,u!==null){switch(u.tag){case 13:return Vn===null?_d():u.alternate===null&&tt===0&&(tt=3),u.flags&=-257,u.flags|=65536,u.lanes=y,m===Ef?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([m]):o.add(m),bd(s,m,y)),!1;case 22:return u.flags|=65536,m===Ef?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([m])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([m]):u.add(m)),bd(s,m,y)),!1}throw Error(i(435,u.tag))}return bd(s,m,y),_d(),!1}if($e)return o=vn.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=y,m!==gf&&(s=Error(i(422),{cause:m}),Pa(mn(s,u)))):(m!==gf&&(o=Error(i(423),{cause:m}),Pa(mn(o,u))),s=s.current.alternate,s.flags|=65536,y&=-y,s.lanes|=y,m=mn(m,u),y=Kf(s.stateNode,m,y),Af(s,y),tt!==4&&(tt=2)),!1;var b=Error(i(520),{cause:m});if(b=mn(b,u),to===null?to=[b]:to.push(b),tt!==4&&(tt=2),o===null)return!0;m=mn(m,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,s=y&-y,u.lanes|=s,s=Kf(u.stateNode,m,s),Af(u,s),!1;case 1:if(o=u.type,b=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Di===null||!Di.has(b))))return u.flags|=65536,y&=-y,u.lanes|=y,y=d_(y),h_(y,s,u,m),Af(u,y),!1}u=u.return}while(u!==null);return!1}var p_=Error(i(461)),pt=!1;function wt(s,o,u,m){o.child=s===null?r_(o,null,u,m):ms(o,s.child,u,m)}function m_(s,o,u,m,y){u=u.render;var b=o.ref;if("ref"in m){var E={};for(var A in m)A!=="ref"&&(E[A]=m[A])}else E=m;return Sr(o),m=Nf(s,o,u,E,b,y),A=Of(),s!==null&&!pt?(kf(s,o,y),si(s,o,y)):($e&&A&&pf(o),o.flags|=1,wt(s,o,m,y),o.child)}function g_(s,o,u,m,y){if(s===null){var b=u.type;return typeof b=="function"&&!ff(b)&&b.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=b,y_(s,o,b,m,y)):(s=Il(u.type,null,m,o,o.mode,y),s.ref=o.ref,s.return=o,o.child=s)}if(b=s.child,!nd(s,y)){var E=b.memoizedProps;if(u=u.compare,u=u!==null?u:Ma,u(E,m)&&s.ref===o.ref)return si(s,o,y)}return o.flags|=1,s=Xn(b,m),s.ref=o.ref,s.return=o,o.child=s}function y_(s,o,u,m,y){if(s!==null){var b=s.memoizedProps;if(Ma(b,m)&&s.ref===o.ref)if(pt=!1,o.pendingProps=m=b,nd(s,y))(s.flags&131072)!==0&&(pt=!0);else return o.lanes=s.lanes,si(s,o,y)}return Yf(s,o,u,m,y)}function __(s,o,u){var m=o.pendingProps,y=m.children,b=s!==null?s.memoizedState:null;if(m.mode==="hidden"){if((o.flags&128)!==0){if(m=b!==null?b.baseLanes|u:u,s!==null){for(y=o.child=s.child,b=0;y!==null;)b=b|y.lanes|y.childLanes,y=y.sibling;o.childLanes=b&~m}else o.childLanes=0,o.child=null;return v_(s,o,m,u)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&Pl(o,b!==null?b.cachePool:null),b!==null?yy(o,b):xf(),s_(o);else return o.lanes=o.childLanes=536870912,v_(s,o,b!==null?b.baseLanes|u:u,u)}else b!==null?(Pl(o,b.cachePool),yy(o,b),Ii(),o.memoizedState=null):(s!==null&&Pl(o,null),xf(),Ii());return wt(s,o,y,u),o.child}function v_(s,o,u,m){var y=Tf();return y=y===null?null:{parent:ut._currentValue,pool:y},o.memoizedState={baseLanes:u,cachePool:y},s!==null&&Pl(o,null),xf(),s_(o),s!==null&&Da(s,o,m,!0),null}function Ql(s,o){var u=o.ref;if(u===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(i(284));(s===null||s.ref!==u)&&(o.flags|=4194816)}}function Yf(s,o,u,m,y){return Sr(o),u=Nf(s,o,u,m,void 0,y),m=Of(),s!==null&&!pt?(kf(s,o,y),si(s,o,y)):($e&&m&&pf(o),o.flags|=1,wt(s,o,u,y),o.child)}function b_(s,o,u,m,y,b){return Sr(o),o.updateQueue=null,u=vy(o,m,u,y),_y(s),m=Of(),s!==null&&!pt?(kf(s,o,b),si(s,o,b)):($e&&m&&pf(o),o.flags|=1,wt(s,o,u,b),o.child)}function w_(s,o,u,m,y){if(Sr(o),o.stateNode===null){var b=ss,E=u.contextType;typeof E=="object"&&E!==null&&(b=Rt(E)),b=new u(m,b),o.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=Jf,o.stateNode=b,b._reactInternals=o,b=o.stateNode,b.props=m,b.state=o.memoizedState,b.refs={},Sf(o),E=u.contextType,b.context=typeof E=="object"&&E!==null?Rt(E):ss,b.state=o.memoizedState,E=u.getDerivedStateFromProps,typeof E=="function"&&(jf(o,u,E,m),b.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(E=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),E!==b.state&&Jf.enqueueReplaceState(b,b.state,null),Va(o,m,b,y),Ga(),b.state=o.memoizedState),typeof b.componentDidMount=="function"&&(o.flags|=4194308),m=!0}else if(s===null){b=o.stateNode;var A=o.memoizedProps,N=Rr(u,A);b.props=N;var $=b.context,H=u.contextType;E=ss,typeof H=="object"&&H!==null&&(E=Rt(H));var j=u.getDerivedStateFromProps;H=typeof j=="function"||typeof b.getSnapshotBeforeUpdate=="function",A=o.pendingProps!==A,H||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(A||$!==E)&&o_(o,b,m,E),Si=!1;var q=o.memoizedState;b.state=q,Va(o,m,b,y),Ga(),$=o.memoizedState,A||q!==$||Si?(typeof j=="function"&&(jf(o,u,j,m),$=o.memoizedState),(N=Si||a_(o,u,N,m,q,$,E))?(H||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(o.flags|=4194308)):(typeof b.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=m,o.memoizedState=$),b.props=m,b.state=$,b.context=E,m=N):(typeof b.componentDidMount=="function"&&(o.flags|=4194308),m=!1)}else{b=o.stateNode,Cf(s,o),E=o.memoizedProps,H=Rr(u,E),b.props=H,j=o.pendingProps,q=b.context,$=u.contextType,N=ss,typeof $=="object"&&$!==null&&(N=Rt($)),A=u.getDerivedStateFromProps,($=typeof A=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(E!==j||q!==N)&&o_(o,b,m,N),Si=!1,q=o.memoizedState,b.state=q,Va(o,m,b,y),Ga();var B=o.memoizedState;E!==j||q!==B||Si||s!==null&&s.dependencies!==null&&Ol(s.dependencies)?(typeof A=="function"&&(jf(o,u,A,m),B=o.memoizedState),(H=Si||a_(o,u,H,m,q,B,N)||s!==null&&s.dependencies!==null&&Ol(s.dependencies))?($||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(m,B,N),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(m,B,N)),typeof b.componentDidUpdate=="function"&&(o.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof b.componentDidUpdate!="function"||E===s.memoizedProps&&q===s.memoizedState||(o.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||E===s.memoizedProps&&q===s.memoizedState||(o.flags|=1024),o.memoizedProps=m,o.memoizedState=B),b.props=m,b.state=B,b.context=N,m=H):(typeof b.componentDidUpdate!="function"||E===s.memoizedProps&&q===s.memoizedState||(o.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||E===s.memoizedProps&&q===s.memoizedState||(o.flags|=1024),m=!1)}return b=m,Ql(s,o),m=(o.flags&128)!==0,b||m?(b=o.stateNode,u=m&&typeof u.getDerivedStateFromError!="function"?null:b.render(),o.flags|=1,s!==null&&m?(o.child=ms(o,s.child,null,y),o.child=ms(o,null,u,y)):wt(s,o,u,y),o.memoizedState=b.state,s=o.child):s=si(s,o,y),s}function T_(s,o,u,m){return ka(),o.flags|=256,wt(s,o,u,m),o.child}var Zf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Qf(s){return{baseLanes:s,cachePool:uy()}}function Xf(s,o,u){return s=s!==null?s.childLanes&~u:0,o&&(s|=bn),s}function E_(s,o,u){var m=o.pendingProps,y=!1,b=(o.flags&128)!==0,E;if((E=b)||(E=s!==null&&s.memoizedState===null?!1:(ct.current&2)!==0),E&&(y=!0,o.flags&=-129),E=(o.flags&32)!==0,o.flags&=-33,s===null){if($e){if(y?xi(o):Ii(),$e){var A=et,N;if(N=A){e:{for(N=A,A=Gn;N.nodeType!==8;){if(!A){A=null;break e}if(N=xn(N.nextSibling),N===null){A=null;break e}}A=N}A!==null?(o.memoizedState={dehydrated:A,treeContext:vr!==null?{id:Wn,overflow:ei}:null,retryLane:536870912,hydrationErrors:null},N=tn(18,null,null,0),N.stateNode=A,N.return=o,o.child=N,Pt=o,et=null,N=!0):N=!1}N||Tr(o)}if(A=o.memoizedState,A!==null&&(A=A.dehydrated,A!==null))return Dd(A)?o.lanes=32:o.lanes=536870912,null;ri(o)}return A=m.children,m=m.fallback,y?(Ii(),y=o.mode,A=Xl({mode:"hidden",children:A},y),m=_r(m,y,u,null),A.return=o,m.return=o,A.sibling=m,o.child=A,y=o.child,y.memoizedState=Qf(u),y.childLanes=Xf(s,E,u),o.memoizedState=Zf,m):(xi(o),Wf(o,A))}if(N=s.memoizedState,N!==null&&(A=N.dehydrated,A!==null)){if(b)o.flags&256?(xi(o),o.flags&=-257,o=ed(s,o,u)):o.memoizedState!==null?(Ii(),o.child=s.child,o.flags|=128,o=null):(Ii(),y=m.fallback,A=o.mode,m=Xl({mode:"visible",children:m.children},A),y=_r(y,A,u,null),y.flags|=2,m.return=o,y.return=o,m.sibling=y,o.child=m,ms(o,s.child,null,u),m=o.child,m.memoizedState=Qf(u),m.childLanes=Xf(s,E,u),o.memoizedState=Zf,o=y);else if(xi(o),Dd(A)){if(E=A.nextSibling&&A.nextSibling.dataset,E)var $=E.dgst;E=$,m=Error(i(419)),m.stack="",m.digest=E,Pa({value:m,source:null,stack:null}),o=ed(s,o,u)}else if(pt||Da(s,o,u,!1),E=(u&s.childLanes)!==0,pt||E){if(E=Ke,E!==null&&(m=u&-u,m=(m&42)!==0?1:Dc(m),m=(m&(E.suspendedLanes|u))!==0?0:m,m!==0&&m!==N.retryLane))throw N.retryLane=m,rs(s,m),on(E,s,m),p_;A.data==="$?"||_d(),o=ed(s,o,u)}else A.data==="$?"?(o.flags|=192,o.child=s.child,o=null):(s=N.treeContext,et=xn(A.nextSibling),Pt=o,$e=!0,wr=null,Gn=!1,s!==null&&(yn[_n++]=Wn,yn[_n++]=ei,yn[_n++]=vr,Wn=s.id,ei=s.overflow,vr=o),o=Wf(o,m.children),o.flags|=4096);return o}return y?(Ii(),y=m.fallback,A=o.mode,N=s.child,$=N.sibling,m=Xn(N,{mode:"hidden",children:m.children}),m.subtreeFlags=N.subtreeFlags&65011712,$!==null?y=Xn($,y):(y=_r(y,A,u,null),y.flags|=2),y.return=o,m.return=o,m.sibling=y,o.child=m,m=y,y=o.child,A=s.child.memoizedState,A===null?A=Qf(u):(N=A.cachePool,N!==null?($=ut._currentValue,N=N.parent!==$?{parent:$,pool:$}:N):N=uy(),A={baseLanes:A.baseLanes|u,cachePool:N}),y.memoizedState=A,y.childLanes=Xf(s,E,u),o.memoizedState=Zf,m):(xi(o),u=s.child,s=u.sibling,u=Xn(u,{mode:"visible",children:m.children}),u.return=o,u.sibling=null,s!==null&&(E=o.deletions,E===null?(o.deletions=[s],o.flags|=16):E.push(s)),o.child=u,o.memoizedState=null,u)}function Wf(s,o){return o=Xl({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function Xl(s,o){return s=tn(22,s,null,o),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function ed(s,o,u){return ms(o,s.child,null,u),s=Wf(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function S_(s,o,u){s.lanes|=o;var m=s.alternate;m!==null&&(m.lanes|=o),_f(s.return,o,u)}function td(s,o,u,m,y){var b=s.memoizedState;b===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:m,tail:u,tailMode:y}:(b.isBackwards=o,b.rendering=null,b.renderingStartTime=0,b.last=m,b.tail=u,b.tailMode=y)}function C_(s,o,u){var m=o.pendingProps,y=m.revealOrder,b=m.tail;if(wt(s,o,m.children,u),m=ct.current,(m&2)!==0)m=m&1|2,o.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&S_(s,u,o);else if(s.tag===19)S_(s,u,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}m&=1}switch(X(ct,m),y){case"forwards":for(u=o.child,y=null;u!==null;)s=u.alternate,s!==null&&Kl(s)===null&&(y=u),u=u.sibling;u=y,u===null?(y=o.child,o.child=null):(y=u.sibling,u.sibling=null),td(o,!1,y,u,b);break;case"backwards":for(u=null,y=o.child,o.child=null;y!==null;){if(s=y.alternate,s!==null&&Kl(s)===null){o.child=y;break}s=y.sibling,y.sibling=u,u=y,y=s}td(o,!0,u,null,b);break;case"together":td(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function si(s,o,u){if(s!==null&&(o.dependencies=s.dependencies),Pi|=o.lanes,(u&o.childLanes)===0)if(s!==null){if(Da(s,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(i(153));if(o.child!==null){for(s=o.child,u=Xn(s,s.pendingProps),o.child=u,u.return=o;s.sibling!==null;)s=s.sibling,u=u.sibling=Xn(s,s.pendingProps),u.return=o;u.sibling=null}return o.child}function nd(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&Ol(s)))}function tR(s,o,u){switch(o.tag){case 3:Qe(o,o.stateNode.containerInfo),Ei(o,ut,s.memoizedState.cache),ka();break;case 27:case 5:Mc(o);break;case 4:Qe(o,o.stateNode.containerInfo);break;case 10:Ei(o,o.type,o.memoizedProps.value);break;case 13:var m=o.memoizedState;if(m!==null)return m.dehydrated!==null?(xi(o),o.flags|=128,null):(u&o.child.childLanes)!==0?E_(s,o,u):(xi(o),s=si(s,o,u),s!==null?s.sibling:null);xi(o);break;case 19:var y=(s.flags&128)!==0;if(m=(u&o.childLanes)!==0,m||(Da(s,o,u,!1),m=(u&o.childLanes)!==0),y){if(m)return C_(s,o,u);o.flags|=128}if(y=o.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),X(ct,ct.current),m)break;return null;case 22:case 23:return o.lanes=0,__(s,o,u);case 24:Ei(o,ut,s.memoizedState.cache)}return si(s,o,u)}function A_(s,o,u){if(s!==null)if(s.memoizedProps!==o.pendingProps)pt=!0;else{if(!nd(s,u)&&(o.flags&128)===0)return pt=!1,tR(s,o,u);pt=(s.flags&131072)!==0}else pt=!1,$e&&(o.flags&1048576)!==0&&ny(o,Nl,o.index);switch(o.lanes=0,o.tag){case 16:e:{s=o.pendingProps;var m=o.elementType,y=m._init;if(m=y(m._payload),o.type=m,typeof m=="function")ff(m)?(s=Rr(m,s),o.tag=1,o=w_(null,o,m,s,u)):(o.tag=0,o=Yf(null,o,m,s,u));else{if(m!=null){if(y=m.$$typeof,y===P){o.tag=11,o=m_(null,o,m,s,u);break e}else if(y===J){o.tag=14,o=g_(null,o,m,s,u);break e}}throw o=ne(m)||m,Error(i(306,o,""))}}return o;case 0:return Yf(s,o,o.type,o.pendingProps,u);case 1:return m=o.type,y=Rr(m,o.pendingProps),w_(s,o,m,y,u);case 3:e:{if(Qe(o,o.stateNode.containerInfo),s===null)throw Error(i(387));m=o.pendingProps;var b=o.memoizedState;y=b.element,Cf(s,o),Va(o,m,null,u);var E=o.memoizedState;if(m=E.cache,Ei(o,ut,m),m!==b.cache&&vf(o,[ut],u,!0),Ga(),m=E.element,b.isDehydrated)if(b={element:m,isDehydrated:!1,cache:E.cache},o.updateQueue.baseState=b,o.memoizedState=b,o.flags&256){o=T_(s,o,m,u);break e}else if(m!==y){y=mn(Error(i(424)),o),Pa(y),o=T_(s,o,m,u);break e}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(et=xn(s.firstChild),Pt=o,$e=!0,wr=null,Gn=!0,u=r_(o,null,m,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(ka(),m===y){o=si(s,o,u);break e}wt(s,o,m,u)}o=o.child}return o;case 26:return Ql(s,o),s===null?(u=Mv(o.type,null,o.pendingProps,null))?o.memoizedState=u:$e||(u=o.type,s=o.pendingProps,m=du(pe.current).createElement(u),m[At]=o,m[Vt]=s,Et(m,u,s),ht(m),o.stateNode=m):o.memoizedState=Mv(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return Mc(o),s===null&&$e&&(m=o.stateNode=Rv(o.type,o.pendingProps,pe.current),Pt=o,Gn=!0,y=et,$i(o.type)?(Ld=y,et=xn(m.firstChild)):et=y),wt(s,o,o.pendingProps.children,u),Ql(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&$e&&((y=m=et)&&(m=IR(m,o.type,o.pendingProps,Gn),m!==null?(o.stateNode=m,Pt=o,et=xn(m.firstChild),Gn=!1,y=!0):y=!1),y||Tr(o)),Mc(o),y=o.type,b=o.pendingProps,E=s!==null?s.memoizedProps:null,m=b.children,Od(y,b)?m=null:E!==null&&Od(y,E)&&(o.flags|=32),o.memoizedState!==null&&(y=Nf(s,o,JA,null,null,u),co._currentValue=y),Ql(s,o),wt(s,o,m,u),o.child;case 6:return s===null&&$e&&((s=u=et)&&(u=MR(u,o.pendingProps,Gn),u!==null?(o.stateNode=u,Pt=o,et=null,s=!0):s=!1),s||Tr(o)),null;case 13:return E_(s,o,u);case 4:return Qe(o,o.stateNode.containerInfo),m=o.pendingProps,s===null?o.child=ms(o,null,m,u):wt(s,o,m,u),o.child;case 11:return m_(s,o,o.type,o.pendingProps,u);case 7:return wt(s,o,o.pendingProps,u),o.child;case 8:return wt(s,o,o.pendingProps.children,u),o.child;case 12:return wt(s,o,o.pendingProps.children,u),o.child;case 10:return m=o.pendingProps,Ei(o,o.type,m.value),wt(s,o,m.children,u),o.child;case 9:return y=o.type._context,m=o.pendingProps.children,Sr(o),y=Rt(y),m=m(y),o.flags|=1,wt(s,o,m,u),o.child;case 14:return g_(s,o,o.type,o.pendingProps,u);case 15:return y_(s,o,o.type,o.pendingProps,u);case 19:return C_(s,o,u);case 31:return m=o.pendingProps,u=o.mode,m={mode:m.mode,children:m.children},s===null?(u=Xl(m,u),u.ref=o.ref,o.child=u,u.return=o,o=u):(u=Xn(s.child,m),u.ref=o.ref,o.child=u,u.return=o,o=u),o;case 22:return __(s,o,u);case 24:return Sr(o),m=Rt(ut),s===null?(y=Tf(),y===null&&(y=Ke,b=bf(),y.pooledCache=b,b.refCount++,b!==null&&(y.pooledCacheLanes|=u),y=b),o.memoizedState={parent:m,cache:y},Sf(o),Ei(o,ut,y)):((s.lanes&u)!==0&&(Cf(s,o),Va(o,null,null,u),Ga()),y=s.memoizedState,b=o.memoizedState,y.parent!==m?(y={parent:m,cache:m},o.memoizedState=y,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=y),Ei(o,ut,m)):(m=b.cache,Ei(o,ut,m),m!==y.cache&&vf(o,[ut],u,!0))),wt(s,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(i(156,o.tag))}function ai(s){s.flags|=4}function R_(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Dv(o)){if(o=vn.current,o!==null&&((Oe&4194048)===Oe?Vn!==null:(Oe&62914560)!==Oe&&(Oe&536870912)===0||o!==Vn))throw qa=Ef,cy;s.flags|=8192}}function Wl(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?sg():536870912,s.lanes|=o,vs|=o)}function Ya(s,o){if(!$e)switch(s.tailMode){case"hidden":o=s.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:m.sibling=null}}function We(s){var o=s.alternate!==null&&s.alternate.child===s.child,u=0,m=0;if(o)for(var y=s.child;y!==null;)u|=y.lanes|y.childLanes,m|=y.subtreeFlags&65011712,m|=y.flags&65011712,y.return=s,y=y.sibling;else for(y=s.child;y!==null;)u|=y.lanes|y.childLanes,m|=y.subtreeFlags,m|=y.flags,y.return=s,y=y.sibling;return s.subtreeFlags|=m,s.childLanes=u,o}function nR(s,o,u){var m=o.pendingProps;switch(mf(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return We(o),null;case 1:return We(o),null;case 3:return u=o.stateNode,m=null,s!==null&&(m=s.memoizedState.cache),o.memoizedState.cache!==m&&(o.flags|=2048),ni(ut),vi(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(s===null||s.child===null)&&(Oa(o)?ai(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,sy())),We(o),null;case 26:return u=o.memoizedState,s===null?(ai(o),u!==null?(We(o),R_(o,u)):(We(o),o.flags&=-16777217)):u?u!==s.memoizedState?(ai(o),We(o),R_(o,u)):(We(o),o.flags&=-16777217):(s.memoizedProps!==m&&ai(o),We(o),o.flags&=-16777217),null;case 27:cl(o),u=pe.current;var y=o.type;if(s!==null&&o.stateNode!=null)s.memoizedProps!==m&&ai(o);else{if(!m){if(o.stateNode===null)throw Error(i(166));return We(o),null}s=se.current,Oa(o)?iy(o):(s=Rv(y,m,u),o.stateNode=s,ai(o))}return We(o),null;case 5:if(cl(o),u=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==m&&ai(o);else{if(!m){if(o.stateNode===null)throw Error(i(166));return We(o),null}if(s=se.current,Oa(o))iy(o);else{switch(y=du(pe.current),s){case 1:s=y.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:s=y.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":s=y.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":s=y.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":s=y.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof m.is=="string"?y.createElement("select",{is:m.is}):y.createElement("select"),m.multiple?s.multiple=!0:m.size&&(s.size=m.size);break;default:s=typeof m.is=="string"?y.createElement(u,{is:m.is}):y.createElement(u)}}s[At]=o,s[Vt]=m;e:for(y=o.child;y!==null;){if(y.tag===5||y.tag===6)s.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===o)break e;for(;y.sibling===null;){if(y.return===null||y.return===o)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}o.stateNode=s;e:switch(Et(s,u,m),u){case"button":case"input":case"select":case"textarea":s=!!m.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&ai(o)}}return We(o),o.flags&=-16777217,null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==m&&ai(o);else{if(typeof m!="string"&&o.stateNode===null)throw Error(i(166));if(s=pe.current,Oa(o)){if(s=o.stateNode,u=o.memoizedProps,m=null,y=Pt,y!==null)switch(y.tag){case 27:case 5:m=y.memoizedProps}s[At]=o,s=!!(s.nodeValue===u||m!==null&&m.suppressHydrationWarning===!0||bv(s.nodeValue,u)),s||Tr(o)}else s=du(s).createTextNode(m),s[At]=o,o.stateNode=s}return We(o),null;case 13:if(m=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(y=Oa(o),m!==null&&m.dehydrated!==null){if(s===null){if(!y)throw Error(i(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(i(317));y[At]=o}else ka(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;We(o),y=!1}else y=sy(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=y),y=!0;if(!y)return o.flags&256?(ri(o),o):(ri(o),null)}if(ri(o),(o.flags&128)!==0)return o.lanes=u,o;if(u=m!==null,s=s!==null&&s.memoizedState!==null,u){m=o.child,y=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(y=m.alternate.memoizedState.cachePool.pool);var b=null;m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(b=m.memoizedState.cachePool.pool),b!==y&&(m.flags|=2048)}return u!==s&&u&&(o.child.flags|=8192),Wl(o,o.updateQueue),We(o),null;case 4:return vi(),s===null&&Rd(o.stateNode.containerInfo),We(o),null;case 10:return ni(o.type),We(o),null;case 19:if(K(ct),y=o.memoizedState,y===null)return We(o),null;if(m=(o.flags&128)!==0,b=y.rendering,b===null)if(m)Ya(y,!1);else{if(tt!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(b=Kl(s),b!==null){for(o.flags|=128,Ya(y,!1),s=b.updateQueue,o.updateQueue=s,Wl(o,s),o.subtreeFlags=0,s=u,u=o.child;u!==null;)ty(u,s),u=u.sibling;return X(ct,ct.current&1|2),o.child}s=s.sibling}y.tail!==null&&Bn()>nu&&(o.flags|=128,m=!0,Ya(y,!1),o.lanes=4194304)}else{if(!m)if(s=Kl(b),s!==null){if(o.flags|=128,m=!0,s=s.updateQueue,o.updateQueue=s,Wl(o,s),Ya(y,!0),y.tail===null&&y.tailMode==="hidden"&&!b.alternate&&!$e)return We(o),null}else 2*Bn()-y.renderingStartTime>nu&&u!==536870912&&(o.flags|=128,m=!0,Ya(y,!1),o.lanes=4194304);y.isBackwards?(b.sibling=o.child,o.child=b):(s=y.last,s!==null?s.sibling=b:o.child=b,y.last=b)}return y.tail!==null?(o=y.tail,y.rendering=o,y.tail=o.sibling,y.renderingStartTime=Bn(),o.sibling=null,s=ct.current,X(ct,m?s&1|2:s&1),o):(We(o),null);case 22:case 23:return ri(o),If(),m=o.memoizedState!==null,s!==null?s.memoizedState!==null!==m&&(o.flags|=8192):m&&(o.flags|=8192),m?(u&536870912)!==0&&(o.flags&128)===0&&(We(o),o.subtreeFlags&6&&(o.flags|=8192)):We(o),u=o.updateQueue,u!==null&&Wl(o,u.retryQueue),u=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),m=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(m=o.memoizedState.cachePool.pool),m!==u&&(o.flags|=2048),s!==null&&K(Cr),null;case 24:return u=null,s!==null&&(u=s.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),ni(ut),We(o),null;case 25:return null;case 30:return null}throw Error(i(156,o.tag))}function iR(s,o){switch(mf(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return ni(ut),vi(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return cl(o),null;case 13:if(ri(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(i(340));ka()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return K(ct),null;case 4:return vi(),null;case 10:return ni(o.type),null;case 22:case 23:return ri(o),If(),s!==null&&K(Cr),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return ni(ut),null;case 25:return null;default:return null}}function x_(s,o){switch(mf(o),o.tag){case 3:ni(ut),vi();break;case 26:case 27:case 5:cl(o);break;case 4:vi();break;case 13:ri(o);break;case 19:K(ct);break;case 10:ni(o.type);break;case 22:case 23:ri(o),If(),s!==null&&K(Cr);break;case 24:ni(ut)}}function Za(s,o){try{var u=o.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var y=m.next;u=y;do{if((u.tag&s)===s){m=void 0;var b=u.create,E=u.inst;m=b(),E.destroy=m}u=u.next}while(u!==y)}}catch(A){Je(o,o.return,A)}}function Mi(s,o,u){try{var m=o.updateQueue,y=m!==null?m.lastEffect:null;if(y!==null){var b=y.next;m=b;do{if((m.tag&s)===s){var E=m.inst,A=E.destroy;if(A!==void 0){E.destroy=void 0,y=o;var N=u,$=A;try{$()}catch(H){Je(y,N,H)}}}m=m.next}while(m!==b)}}catch(H){Je(o,o.return,H)}}function I_(s){var o=s.updateQueue;if(o!==null){var u=s.stateNode;try{gy(o,u)}catch(m){Je(s,s.return,m)}}}function M_(s,o,u){u.props=Rr(s.type,s.memoizedProps),u.state=s.memoizedState;try{u.componentWillUnmount()}catch(m){Je(s,o,m)}}function Qa(s,o){try{var u=s.ref;if(u!==null){switch(s.tag){case 26:case 27:case 5:var m=s.stateNode;break;case 30:m=s.stateNode;break;default:m=s.stateNode}typeof u=="function"?s.refCleanup=u(m):u.current=m}}catch(y){Je(s,o,y)}}function Fn(s,o){var u=s.ref,m=s.refCleanup;if(u!==null)if(typeof m=="function")try{m()}catch(y){Je(s,o,y)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(y){Je(s,o,y)}else u.current=null}function N_(s){var o=s.type,u=s.memoizedProps,m=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&m.focus();break e;case"img":u.src?m.src=u.src:u.srcSet&&(m.srcset=u.srcSet)}}catch(y){Je(s,s.return,y)}}function id(s,o,u){try{var m=s.stateNode;SR(m,s.type,u,o),m[Vt]=o}catch(y){Je(s,s.return,y)}}function O_(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&$i(s.type)||s.tag===4}function rd(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||O_(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&$i(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function sd(s,o,u){var m=s.tag;if(m===5||m===6)s=s.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(s,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(s),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=fu));else if(m!==4&&(m===27&&$i(s.type)&&(u=s.stateNode,o=null),s=s.child,s!==null))for(sd(s,o,u),s=s.sibling;s!==null;)sd(s,o,u),s=s.sibling}function eu(s,o,u){var m=s.tag;if(m===5||m===6)s=s.stateNode,o?u.insertBefore(s,o):u.appendChild(s);else if(m!==4&&(m===27&&$i(s.type)&&(u=s.stateNode),s=s.child,s!==null))for(eu(s,o,u),s=s.sibling;s!==null;)eu(s,o,u),s=s.sibling}function k_(s){var o=s.stateNode,u=s.memoizedProps;try{for(var m=s.type,y=o.attributes;y.length;)o.removeAttributeNode(y[0]);Et(o,m,u),o[At]=s,o[Vt]=u}catch(b){Je(s,s.return,b)}}var oi=!1,it=!1,ad=!1,P_=typeof WeakSet=="function"?WeakSet:Set,mt=null;function rR(s,o){if(s=s.containerInfo,Md=_u,s=zg(s),rf(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var m=u.getSelection&&u.getSelection();if(m&&m.rangeCount!==0){u=m.anchorNode;var y=m.anchorOffset,b=m.focusNode;m=m.focusOffset;try{u.nodeType,b.nodeType}catch{u=null;break e}var E=0,A=-1,N=-1,$=0,H=0,j=s,q=null;t:for(;;){for(var B;j!==u||y!==0&&j.nodeType!==3||(A=E+y),j!==b||m!==0&&j.nodeType!==3||(N=E+m),j.nodeType===3&&(E+=j.nodeValue.length),(B=j.firstChild)!==null;)q=j,j=B;for(;;){if(j===s)break t;if(q===u&&++$===y&&(A=E),q===b&&++H===m&&(N=E),(B=j.nextSibling)!==null)break;j=q,q=j.parentNode}j=B}u=A===-1||N===-1?null:{start:A,end:N}}else u=null}u=u||{start:0,end:0}}else u=null;for(Nd={focusedElem:s,selectionRange:u},_u=!1,mt=o;mt!==null;)if(o=mt,s=o.child,(o.subtreeFlags&1024)!==0&&s!==null)s.return=o,mt=s;else for(;mt!==null;){switch(o=mt,b=o.alternate,s=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&b!==null){s=void 0,u=o,y=b.memoizedProps,b=b.memoizedState,m=u.stateNode;try{var ge=Rr(u.type,y,u.elementType===u.type);s=m.getSnapshotBeforeUpdate(ge,b),m.__reactInternalSnapshotBeforeUpdate=s}catch(he){Je(u,u.return,he)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,u=s.nodeType,u===9)Pd(s);else if(u===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Pd(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=o.sibling,s!==null){s.return=o.return,mt=s;break}mt=o.return}}function D_(s,o,u){var m=u.flags;switch(u.tag){case 0:case 11:case 15:Ni(s,u),m&4&&Za(5,u);break;case 1:if(Ni(s,u),m&4)if(s=u.stateNode,o===null)try{s.componentDidMount()}catch(E){Je(u,u.return,E)}else{var y=Rr(u.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(y,o,s.__reactInternalSnapshotBeforeUpdate)}catch(E){Je(u,u.return,E)}}m&64&&I_(u),m&512&&Qa(u,u.return);break;case 3:if(Ni(s,u),m&64&&(s=u.updateQueue,s!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{gy(s,o)}catch(E){Je(u,u.return,E)}}break;case 27:o===null&&m&4&&k_(u);case 26:case 5:Ni(s,u),o===null&&m&4&&N_(u),m&512&&Qa(u,u.return);break;case 12:Ni(s,u);break;case 13:Ni(s,u),m&4&&$_(s,u),m&64&&(s=u.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(u=hR.bind(null,u),NR(s,u))));break;case 22:if(m=u.memoizedState!==null||oi,!m){o=o!==null&&o.memoizedState!==null||it,y=oi;var b=it;oi=m,(it=o)&&!b?Oi(s,u,(u.subtreeFlags&8772)!==0):Ni(s,u),oi=y,it=b}break;case 30:break;default:Ni(s,u)}}function L_(s){var o=s.alternate;o!==null&&(s.alternate=null,L_(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&$c(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Xe=null,zt=!1;function li(s,o,u){for(u=u.child;u!==null;)U_(s,o,u),u=u.sibling}function U_(s,o,u){if(Xt&&typeof Xt.onCommitFiberUnmount=="function")try{Xt.onCommitFiberUnmount(_a,u)}catch{}switch(u.tag){case 26:it||Fn(u,o),li(s,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:it||Fn(u,o);var m=Xe,y=zt;$i(u.type)&&(Xe=u.stateNode,zt=!1),li(s,o,u),ao(u.stateNode),Xe=m,zt=y;break;case 5:it||Fn(u,o);case 6:if(m=Xe,y=zt,Xe=null,li(s,o,u),Xe=m,zt=y,Xe!==null)if(zt)try{(Xe.nodeType===9?Xe.body:Xe.nodeName==="HTML"?Xe.ownerDocument.body:Xe).removeChild(u.stateNode)}catch(b){Je(u,o,b)}else try{Xe.removeChild(u.stateNode)}catch(b){Je(u,o,b)}break;case 18:Xe!==null&&(zt?(s=Xe,Cv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,u.stateNode),mo(s)):Cv(Xe,u.stateNode));break;case 4:m=Xe,y=zt,Xe=u.stateNode.containerInfo,zt=!0,li(s,o,u),Xe=m,zt=y;break;case 0:case 11:case 14:case 15:it||Mi(2,u,o),it||Mi(4,u,o),li(s,o,u);break;case 1:it||(Fn(u,o),m=u.stateNode,typeof m.componentWillUnmount=="function"&&M_(u,o,m)),li(s,o,u);break;case 21:li(s,o,u);break;case 22:it=(m=it)||u.memoizedState!==null,li(s,o,u),it=m;break;default:li(s,o,u)}}function $_(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{mo(s)}catch(u){Je(o,o.return,u)}}function sR(s){switch(s.tag){case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new P_),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new P_),o;default:throw Error(i(435,s.tag))}}function od(s,o){var u=sR(s);o.forEach(function(m){var y=pR.bind(null,s,m);u.has(m)||(u.add(m),m.then(y,y))})}function nn(s,o){var u=o.deletions;if(u!==null)for(var m=0;m<u.length;m++){var y=u[m],b=s,E=o,A=E;e:for(;A!==null;){switch(A.tag){case 27:if($i(A.type)){Xe=A.stateNode,zt=!1;break e}break;case 5:Xe=A.stateNode,zt=!1;break e;case 3:case 4:Xe=A.stateNode.containerInfo,zt=!0;break e}A=A.return}if(Xe===null)throw Error(i(160));U_(b,E,y),Xe=null,zt=!1,b=y.alternate,b!==null&&(b.return=null),y.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)q_(o,s),o=o.sibling}var Rn=null;function q_(s,o){var u=s.alternate,m=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:nn(o,s),rn(s),m&4&&(Mi(3,s,s.return),Za(3,s),Mi(5,s,s.return));break;case 1:nn(o,s),rn(s),m&512&&(it||u===null||Fn(u,u.return)),m&64&&oi&&(s=s.updateQueue,s!==null&&(m=s.callbacks,m!==null&&(u=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=u===null?m:u.concat(m))));break;case 26:var y=Rn;if(nn(o,s),rn(s),m&512&&(it||u===null||Fn(u,u.return)),m&4){var b=u!==null?u.memoizedState:null;if(m=s.memoizedState,u===null)if(m===null)if(s.stateNode===null){e:{m=s.type,u=s.memoizedProps,y=y.ownerDocument||y;t:switch(m){case"title":b=y.getElementsByTagName("title")[0],(!b||b[wa]||b[At]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=y.createElement(m),y.head.insertBefore(b,y.querySelector("head > title"))),Et(b,m,u),b[At]=s,ht(b),m=b;break e;case"link":var E=kv("link","href",y).get(m+(u.href||""));if(E){for(var A=0;A<E.length;A++)if(b=E[A],b.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&b.getAttribute("rel")===(u.rel==null?null:u.rel)&&b.getAttribute("title")===(u.title==null?null:u.title)&&b.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){E.splice(A,1);break t}}b=y.createElement(m),Et(b,m,u),y.head.appendChild(b);break;case"meta":if(E=kv("meta","content",y).get(m+(u.content||""))){for(A=0;A<E.length;A++)if(b=E[A],b.getAttribute("content")===(u.content==null?null:""+u.content)&&b.getAttribute("name")===(u.name==null?null:u.name)&&b.getAttribute("property")===(u.property==null?null:u.property)&&b.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&b.getAttribute("charset")===(u.charSet==null?null:u.charSet)){E.splice(A,1);break t}}b=y.createElement(m),Et(b,m,u),y.head.appendChild(b);break;default:throw Error(i(468,m))}b[At]=s,ht(b),m=b}s.stateNode=m}else Pv(y,s.type,s.stateNode);else s.stateNode=Ov(y,m,s.memoizedProps);else b!==m?(b===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):b.count--,m===null?Pv(y,s.type,s.stateNode):Ov(y,m,s.memoizedProps)):m===null&&s.stateNode!==null&&id(s,s.memoizedProps,u.memoizedProps)}break;case 27:nn(o,s),rn(s),m&512&&(it||u===null||Fn(u,u.return)),u!==null&&m&4&&id(s,s.memoizedProps,u.memoizedProps);break;case 5:if(nn(o,s),rn(s),m&512&&(it||u===null||Fn(u,u.return)),s.flags&32){y=s.stateNode;try{Qr(y,"")}catch(B){Je(s,s.return,B)}}m&4&&s.stateNode!=null&&(y=s.memoizedProps,id(s,y,u!==null?u.memoizedProps:y)),m&1024&&(ad=!0);break;case 6:if(nn(o,s),rn(s),m&4){if(s.stateNode===null)throw Error(i(162));m=s.memoizedProps,u=s.stateNode;try{u.nodeValue=m}catch(B){Je(s,s.return,B)}}break;case 3:if(mu=null,y=Rn,Rn=hu(o.containerInfo),nn(o,s),Rn=y,rn(s),m&4&&u!==null&&u.memoizedState.isDehydrated)try{mo(o.containerInfo)}catch(B){Je(s,s.return,B)}ad&&(ad=!1,B_(s));break;case 4:m=Rn,Rn=hu(s.stateNode.containerInfo),nn(o,s),rn(s),Rn=m;break;case 12:nn(o,s),rn(s);break;case 13:nn(o,s),rn(s),s.child.flags&8192&&s.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(hd=Bn()),m&4&&(m=s.updateQueue,m!==null&&(s.updateQueue=null,od(s,m)));break;case 22:y=s.memoizedState!==null;var N=u!==null&&u.memoizedState!==null,$=oi,H=it;if(oi=$||y,it=H||N,nn(o,s),it=H,oi=$,rn(s),m&8192)e:for(o=s.stateNode,o._visibility=y?o._visibility&-2:o._visibility|1,y&&(u===null||N||oi||it||xr(s)),u=null,o=s;;){if(o.tag===5||o.tag===26){if(u===null){N=u=o;try{if(b=N.stateNode,y)E=b.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{A=N.stateNode;var j=N.memoizedProps.style,q=j!=null&&j.hasOwnProperty("display")?j.display:null;A.style.display=q==null||typeof q=="boolean"?"":(""+q).trim()}}catch(B){Je(N,N.return,B)}}}else if(o.tag===6){if(u===null){N=o;try{N.stateNode.nodeValue=y?"":N.memoizedProps}catch(B){Je(N,N.return,B)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}m&4&&(m=s.updateQueue,m!==null&&(u=m.retryQueue,u!==null&&(m.retryQueue=null,od(s,u))));break;case 19:nn(o,s),rn(s),m&4&&(m=s.updateQueue,m!==null&&(s.updateQueue=null,od(s,m)));break;case 30:break;case 21:break;default:nn(o,s),rn(s)}}function rn(s){var o=s.flags;if(o&2){try{for(var u,m=s.return;m!==null;){if(O_(m)){u=m;break}m=m.return}if(u==null)throw Error(i(160));switch(u.tag){case 27:var y=u.stateNode,b=rd(s);eu(s,b,y);break;case 5:var E=u.stateNode;u.flags&32&&(Qr(E,""),u.flags&=-33);var A=rd(s);eu(s,A,E);break;case 3:case 4:var N=u.stateNode.containerInfo,$=rd(s);sd(s,$,N);break;default:throw Error(i(161))}}catch(H){Je(s,s.return,H)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function B_(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;B_(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function Ni(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)D_(s,o.alternate,o),o=o.sibling}function xr(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:Mi(4,o,o.return),xr(o);break;case 1:Fn(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&M_(o,o.return,u),xr(o);break;case 27:ao(o.stateNode);case 26:case 5:Fn(o,o.return),xr(o);break;case 22:o.memoizedState===null&&xr(o);break;case 30:xr(o);break;default:xr(o)}s=s.sibling}}function Oi(s,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var m=o.alternate,y=s,b=o,E=b.flags;switch(b.tag){case 0:case 11:case 15:Oi(y,b,u),Za(4,b);break;case 1:if(Oi(y,b,u),m=b,y=m.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch($){Je(m,m.return,$)}if(m=b,y=m.updateQueue,y!==null){var A=m.stateNode;try{var N=y.shared.hiddenCallbacks;if(N!==null)for(y.shared.hiddenCallbacks=null,y=0;y<N.length;y++)my(N[y],A)}catch($){Je(m,m.return,$)}}u&&E&64&&I_(b),Qa(b,b.return);break;case 27:k_(b);case 26:case 5:Oi(y,b,u),u&&m===null&&E&4&&N_(b),Qa(b,b.return);break;case 12:Oi(y,b,u);break;case 13:Oi(y,b,u),u&&E&4&&$_(y,b);break;case 22:b.memoizedState===null&&Oi(y,b,u),Qa(b,b.return);break;case 30:break;default:Oi(y,b,u)}o=o.sibling}}function ld(s,o){var u=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==u&&(s!=null&&s.refCount++,u!=null&&La(u))}function ud(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&La(s))}function Hn(s,o,u,m){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)G_(s,o,u,m),o=o.sibling}function G_(s,o,u,m){var y=o.flags;switch(o.tag){case 0:case 11:case 15:Hn(s,o,u,m),y&2048&&Za(9,o);break;case 1:Hn(s,o,u,m);break;case 3:Hn(s,o,u,m),y&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&La(s)));break;case 12:if(y&2048){Hn(s,o,u,m),s=o.stateNode;try{var b=o.memoizedProps,E=b.id,A=b.onPostCommit;typeof A=="function"&&A(E,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(N){Je(o,o.return,N)}}else Hn(s,o,u,m);break;case 13:Hn(s,o,u,m);break;case 23:break;case 22:b=o.stateNode,E=o.alternate,o.memoizedState!==null?b._visibility&2?Hn(s,o,u,m):Xa(s,o):b._visibility&2?Hn(s,o,u,m):(b._visibility|=2,gs(s,o,u,m,(o.subtreeFlags&10256)!==0)),y&2048&&ld(E,o);break;case 24:Hn(s,o,u,m),y&2048&&ud(o.alternate,o);break;default:Hn(s,o,u,m)}}function gs(s,o,u,m,y){for(y=y&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var b=s,E=o,A=u,N=m,$=E.flags;switch(E.tag){case 0:case 11:case 15:gs(b,E,A,N,y),Za(8,E);break;case 23:break;case 22:var H=E.stateNode;E.memoizedState!==null?H._visibility&2?gs(b,E,A,N,y):Xa(b,E):(H._visibility|=2,gs(b,E,A,N,y)),y&&$&2048&&ld(E.alternate,E);break;case 24:gs(b,E,A,N,y),y&&$&2048&&ud(E.alternate,E);break;default:gs(b,E,A,N,y)}o=o.sibling}}function Xa(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=s,m=o,y=m.flags;switch(m.tag){case 22:Xa(u,m),y&2048&&ld(m.alternate,m);break;case 24:Xa(u,m),y&2048&&ud(m.alternate,m);break;default:Xa(u,m)}o=o.sibling}}var Wa=8192;function ys(s){if(s.subtreeFlags&Wa)for(s=s.child;s!==null;)V_(s),s=s.sibling}function V_(s){switch(s.tag){case 26:ys(s),s.flags&Wa&&s.memoizedState!==null&&HR(Rn,s.memoizedState,s.memoizedProps);break;case 5:ys(s);break;case 3:case 4:var o=Rn;Rn=hu(s.stateNode.containerInfo),ys(s),Rn=o;break;case 22:s.memoizedState===null&&(o=s.alternate,o!==null&&o.memoizedState!==null?(o=Wa,Wa=16777216,ys(s),Wa=o):ys(s));break;default:ys(s)}}function F_(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function eo(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var m=o[u];mt=m,z_(m,s)}F_(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)H_(s),s=s.sibling}function H_(s){switch(s.tag){case 0:case 11:case 15:eo(s),s.flags&2048&&Mi(9,s,s.return);break;case 3:eo(s);break;case 12:eo(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,tu(s)):eo(s);break;default:eo(s)}}function tu(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var m=o[u];mt=m,z_(m,s)}F_(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:Mi(8,o,o.return),tu(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,tu(o));break;default:tu(o)}s=s.sibling}}function z_(s,o){for(;mt!==null;){var u=mt;switch(u.tag){case 0:case 11:case 15:Mi(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var m=u.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:La(u.memoizedState.cache)}if(m=u.child,m!==null)m.return=u,mt=m;else e:for(u=s;mt!==null;){m=mt;var y=m.sibling,b=m.return;if(L_(m),m===u){mt=null;break e}if(y!==null){y.return=b,mt=y;break e}mt=b}}}var aR={getCacheForType:function(s){var o=Rt(ut),u=o.data.get(s);return u===void 0&&(u=s(),o.data.set(s,u)),u}},oR=typeof WeakMap=="function"?WeakMap:Map,Be=0,Ke=null,xe=null,Oe=0,Ge=0,sn=null,ki=!1,_s=!1,cd=!1,ui=0,tt=0,Pi=0,Ir=0,fd=0,bn=0,vs=0,to=null,jt=null,dd=!1,hd=0,nu=1/0,iu=null,Di=null,Tt=0,Li=null,bs=null,ws=0,pd=0,md=null,j_=null,no=0,gd=null;function an(){if((Be&2)!==0&&Oe!==0)return Oe&-Oe;if(L.T!==null){var s=ls;return s!==0?s:Ed()}return lg()}function J_(){bn===0&&(bn=(Oe&536870912)===0||$e?rg():536870912);var s=vn.current;return s!==null&&(s.flags|=32),bn}function on(s,o,u){(s===Ke&&(Ge===2||Ge===9)||s.cancelPendingCommit!==null)&&(Ts(s,0),Ui(s,Oe,bn,!1)),ba(s,u),((Be&2)===0||s!==Ke)&&(s===Ke&&((Be&2)===0&&(Ir|=u),tt===4&&Ui(s,Oe,bn,!1)),zn(s))}function K_(s,o,u){if((Be&6)!==0)throw Error(i(327));var m=!u&&(o&124)===0&&(o&s.expiredLanes)===0||va(s,o),y=m?cR(s,o):vd(s,o,!0),b=m;do{if(y===0){_s&&!m&&Ui(s,o,0,!1);break}else{if(u=s.current.alternate,b&&!lR(u)){y=vd(s,o,!1),b=!1;continue}if(y===2){if(b=o,s.errorRecoveryDisabledLanes&b)var E=0;else E=s.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){o=E;e:{var A=s;y=to;var N=A.current.memoizedState.isDehydrated;if(N&&(Ts(A,E).flags|=256),E=vd(A,E,!1),E!==2){if(cd&&!N){A.errorRecoveryDisabledLanes|=b,Ir|=b,y=4;break e}b=jt,jt=y,b!==null&&(jt===null?jt=b:jt.push.apply(jt,b))}y=E}if(b=!1,y!==2)continue}}if(y===1){Ts(s,0),Ui(s,o,0,!0);break}e:{switch(m=s,b=y,b){case 0:case 1:throw Error(i(345));case 4:if((o&4194048)!==o)break;case 6:Ui(m,o,bn,!ki);break e;case 2:jt=null;break;case 3:case 5:break;default:throw Error(i(329))}if((o&62914560)===o&&(y=hd+300-Bn(),10<y)){if(Ui(m,o,bn,!ki),pl(m,0,!0)!==0)break e;m.timeoutHandle=Ev(Y_.bind(null,m,u,jt,iu,dd,o,bn,Ir,vs,ki,b,2,-0,0),y);break e}Y_(m,u,jt,iu,dd,o,bn,Ir,vs,ki,b,0,-0,0)}}break}while(!0);zn(s)}function Y_(s,o,u,m,y,b,E,A,N,$,H,j,q,B){if(s.timeoutHandle=-1,j=o.subtreeFlags,(j&8192||(j&16785408)===16785408)&&(uo={stylesheets:null,count:0,unsuspend:FR},V_(o),j=zR(),j!==null)){s.cancelPendingCommit=j(nv.bind(null,s,o,b,u,m,y,E,A,N,H,1,q,B)),Ui(s,b,E,!$);return}nv(s,o,b,u,m,y,E,A,N)}function lR(s){for(var o=s;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var m=0;m<u.length;m++){var y=u[m],b=y.getSnapshot;y=y.value;try{if(!en(b(),y))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ui(s,o,u,m){o&=~fd,o&=~Ir,s.suspendedLanes|=o,s.pingedLanes&=~o,m&&(s.warmLanes|=o),m=s.expirationTimes;for(var y=o;0<y;){var b=31-Wt(y),E=1<<b;m[b]=-1,y&=~E}u!==0&&ag(s,u,o)}function ru(){return(Be&6)===0?(io(0),!1):!0}function yd(){if(xe!==null){if(Ge===0)var s=xe.return;else s=xe,ti=Er=null,Pf(s),ps=null,Ja=0,s=xe;for(;s!==null;)x_(s.alternate,s),s=s.return;xe=null}}function Ts(s,o){var u=s.timeoutHandle;u!==-1&&(s.timeoutHandle=-1,AR(u)),u=s.cancelPendingCommit,u!==null&&(s.cancelPendingCommit=null,u()),yd(),Ke=s,xe=u=Xn(s.current,null),Oe=o,Ge=0,sn=null,ki=!1,_s=va(s,o),cd=!1,vs=bn=fd=Ir=Pi=tt=0,jt=to=null,dd=!1,(o&8)!==0&&(o|=o&32);var m=s.entangledLanes;if(m!==0)for(s=s.entanglements,m&=o;0<m;){var y=31-Wt(m),b=1<<y;o|=s[y],m&=~b}return ui=o,Al(),u}function Z_(s,o){Ce=null,L.H=zl,o===$a||o===Dl?(o=hy(),Ge=3):o===cy?(o=hy(),Ge=4):Ge=o===p_?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,sn=o,xe===null&&(tt=1,Zl(s,mn(o,s.current)))}function Q_(){var s=L.H;return L.H=zl,s===null?zl:s}function X_(){var s=L.A;return L.A=aR,s}function _d(){tt=4,ki||(Oe&4194048)!==Oe&&vn.current!==null||(_s=!0),(Pi&134217727)===0&&(Ir&134217727)===0||Ke===null||Ui(Ke,Oe,bn,!1)}function vd(s,o,u){var m=Be;Be|=2;var y=Q_(),b=X_();(Ke!==s||Oe!==o)&&(iu=null,Ts(s,o)),o=!1;var E=tt;e:do try{if(Ge!==0&&xe!==null){var A=xe,N=sn;switch(Ge){case 8:yd(),E=6;break e;case 3:case 2:case 9:case 6:vn.current===null&&(o=!0);var $=Ge;if(Ge=0,sn=null,Es(s,A,N,$),u&&_s){E=0;break e}break;default:$=Ge,Ge=0,sn=null,Es(s,A,N,$)}}uR(),E=tt;break}catch(H){Z_(s,H)}while(!0);return o&&s.shellSuspendCounter++,ti=Er=null,Be=m,L.H=y,L.A=b,xe===null&&(Ke=null,Oe=0,Al()),E}function uR(){for(;xe!==null;)W_(xe)}function cR(s,o){var u=Be;Be|=2;var m=Q_(),y=X_();Ke!==s||Oe!==o?(iu=null,nu=Bn()+500,Ts(s,o)):_s=va(s,o);e:do try{if(Ge!==0&&xe!==null){o=xe;var b=sn;t:switch(Ge){case 1:Ge=0,sn=null,Es(s,o,b,1);break;case 2:case 9:if(fy(b)){Ge=0,sn=null,ev(o);break}o=function(){Ge!==2&&Ge!==9||Ke!==s||(Ge=7),zn(s)},b.then(o,o);break e;case 3:Ge=7;break e;case 4:Ge=5;break e;case 7:fy(b)?(Ge=0,sn=null,ev(o)):(Ge=0,sn=null,Es(s,o,b,7));break;case 5:var E=null;switch(xe.tag){case 26:E=xe.memoizedState;case 5:case 27:var A=xe;if(!E||Dv(E)){Ge=0,sn=null;var N=A.sibling;if(N!==null)xe=N;else{var $=A.return;$!==null?(xe=$,su($)):xe=null}break t}}Ge=0,sn=null,Es(s,o,b,5);break;case 6:Ge=0,sn=null,Es(s,o,b,6);break;case 8:yd(),tt=6;break e;default:throw Error(i(462))}}fR();break}catch(H){Z_(s,H)}while(!0);return ti=Er=null,L.H=m,L.A=y,Be=u,xe!==null?0:(Ke=null,Oe=0,Al(),tt)}function fR(){for(;xe!==null&&!kC();)W_(xe)}function W_(s){var o=A_(s.alternate,s,ui);s.memoizedProps=s.pendingProps,o===null?su(s):xe=o}function ev(s){var o=s,u=o.alternate;switch(o.tag){case 15:case 0:o=b_(u,o,o.pendingProps,o.type,void 0,Oe);break;case 11:o=b_(u,o,o.pendingProps,o.type.render,o.ref,Oe);break;case 5:Pf(o);default:x_(u,o),o=xe=ty(o,ui),o=A_(u,o,ui)}s.memoizedProps=s.pendingProps,o===null?su(s):xe=o}function Es(s,o,u,m){ti=Er=null,Pf(o),ps=null,Ja=0;var y=o.return;try{if(eR(s,y,o,u,Oe)){tt=1,Zl(s,mn(u,s.current)),xe=null;return}}catch(b){if(y!==null)throw xe=y,b;tt=1,Zl(s,mn(u,s.current)),xe=null;return}o.flags&32768?($e||m===1?s=!0:_s||(Oe&536870912)!==0?s=!1:(ki=s=!0,(m===2||m===9||m===3||m===6)&&(m=vn.current,m!==null&&m.tag===13&&(m.flags|=16384))),tv(o,s)):su(o)}function su(s){var o=s;do{if((o.flags&32768)!==0){tv(o,ki);return}s=o.return;var u=nR(o.alternate,o,ui);if(u!==null){xe=u;return}if(o=o.sibling,o!==null){xe=o;return}xe=o=s}while(o!==null);tt===0&&(tt=5)}function tv(s,o){do{var u=iR(s.alternate,s);if(u!==null){u.flags&=32767,xe=u;return}if(u=s.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(s=s.sibling,s!==null)){xe=s;return}xe=s=u}while(s!==null);tt=6,xe=null}function nv(s,o,u,m,y,b,E,A,N){s.cancelPendingCommit=null;do au();while(Tt!==0);if((Be&6)!==0)throw Error(i(327));if(o!==null){if(o===s.current)throw Error(i(177));if(b=o.lanes|o.childLanes,b|=uf,FC(s,u,b,E,A,N),s===Ke&&(xe=Ke=null,Oe=0),bs=o,Li=s,ws=u,pd=b,md=y,j_=m,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,mR(fl,function(){return ov(),null})):(s.callbackNode=null,s.callbackPriority=0),m=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||m){m=L.T,L.T=null,y=F.p,F.p=2,E=Be,Be|=4;try{rR(s,o,u)}finally{Be=E,F.p=y,L.T=m}}Tt=1,iv(),rv(),sv()}}function iv(){if(Tt===1){Tt=0;var s=Li,o=bs,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=L.T,L.T=null;var m=F.p;F.p=2;var y=Be;Be|=4;try{q_(o,s);var b=Nd,E=zg(s.containerInfo),A=b.focusedElem,N=b.selectionRange;if(E!==A&&A&&A.ownerDocument&&Hg(A.ownerDocument.documentElement,A)){if(N!==null&&rf(A)){var $=N.start,H=N.end;if(H===void 0&&(H=$),"selectionStart"in A)A.selectionStart=$,A.selectionEnd=Math.min(H,A.value.length);else{var j=A.ownerDocument||document,q=j&&j.defaultView||window;if(q.getSelection){var B=q.getSelection(),ge=A.textContent.length,he=Math.min(N.start,ge),je=N.end===void 0?he:Math.min(N.end,ge);!B.extend&&he>je&&(E=je,je=he,he=E);var D=Fg(A,he),k=Fg(A,je);if(D&&k&&(B.rangeCount!==1||B.anchorNode!==D.node||B.anchorOffset!==D.offset||B.focusNode!==k.node||B.focusOffset!==k.offset)){var U=j.createRange();U.setStart(D.node,D.offset),B.removeAllRanges(),he>je?(B.addRange(U),B.extend(k.node,k.offset)):(U.setEnd(k.node,k.offset),B.addRange(U))}}}}for(j=[],B=A;B=B.parentNode;)B.nodeType===1&&j.push({element:B,left:B.scrollLeft,top:B.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<j.length;A++){var z=j[A];z.element.scrollLeft=z.left,z.element.scrollTop=z.top}}_u=!!Md,Nd=Md=null}finally{Be=y,F.p=m,L.T=u}}s.current=o,Tt=2}}function rv(){if(Tt===2){Tt=0;var s=Li,o=bs,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=L.T,L.T=null;var m=F.p;F.p=2;var y=Be;Be|=4;try{D_(s,o.alternate,o)}finally{Be=y,F.p=m,L.T=u}}Tt=3}}function sv(){if(Tt===4||Tt===3){Tt=0,PC();var s=Li,o=bs,u=ws,m=j_;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Tt=5:(Tt=0,bs=Li=null,av(s,s.pendingLanes));var y=s.pendingLanes;if(y===0&&(Di=null),Lc(u),o=o.stateNode,Xt&&typeof Xt.onCommitFiberRoot=="function")try{Xt.onCommitFiberRoot(_a,o,void 0,(o.current.flags&128)===128)}catch{}if(m!==null){o=L.T,y=F.p,F.p=2,L.T=null;try{for(var b=s.onRecoverableError,E=0;E<m.length;E++){var A=m[E];b(A.value,{componentStack:A.stack})}}finally{L.T=o,F.p=y}}(ws&3)!==0&&au(),zn(s),y=s.pendingLanes,(u&4194090)!==0&&(y&42)!==0?s===gd?no++:(no=0,gd=s):no=0,io(0)}}function av(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,La(o)))}function au(s){return iv(),rv(),sv(),ov()}function ov(){if(Tt!==5)return!1;var s=Li,o=pd;pd=0;var u=Lc(ws),m=L.T,y=F.p;try{F.p=32>u?32:u,L.T=null,u=md,md=null;var b=Li,E=ws;if(Tt=0,bs=Li=null,ws=0,(Be&6)!==0)throw Error(i(331));var A=Be;if(Be|=4,H_(b.current),G_(b,b.current,E,u),Be=A,io(0,!1),Xt&&typeof Xt.onPostCommitFiberRoot=="function")try{Xt.onPostCommitFiberRoot(_a,b)}catch{}return!0}finally{F.p=y,L.T=m,av(s,o)}}function lv(s,o,u){o=mn(u,o),o=Kf(s.stateNode,o,2),s=Ai(s,o,2),s!==null&&(ba(s,2),zn(s))}function Je(s,o,u){if(s.tag===3)lv(s,s,u);else for(;o!==null;){if(o.tag===3){lv(o,s,u);break}else if(o.tag===1){var m=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Di===null||!Di.has(m))){s=mn(u,s),u=d_(2),m=Ai(o,u,2),m!==null&&(h_(u,m,o,s),ba(m,2),zn(m));break}}o=o.return}}function bd(s,o,u){var m=s.pingCache;if(m===null){m=s.pingCache=new oR;var y=new Set;m.set(o,y)}else y=m.get(o),y===void 0&&(y=new Set,m.set(o,y));y.has(u)||(cd=!0,y.add(u),s=dR.bind(null,s,o,u),o.then(s,s))}function dR(s,o,u){var m=s.pingCache;m!==null&&m.delete(o),s.pingedLanes|=s.suspendedLanes&u,s.warmLanes&=~u,Ke===s&&(Oe&u)===u&&(tt===4||tt===3&&(Oe&62914560)===Oe&&300>Bn()-hd?(Be&2)===0&&Ts(s,0):fd|=u,vs===Oe&&(vs=0)),zn(s)}function uv(s,o){o===0&&(o=sg()),s=rs(s,o),s!==null&&(ba(s,o),zn(s))}function hR(s){var o=s.memoizedState,u=0;o!==null&&(u=o.retryLane),uv(s,u)}function pR(s,o){var u=0;switch(s.tag){case 13:var m=s.stateNode,y=s.memoizedState;y!==null&&(u=y.retryLane);break;case 19:m=s.stateNode;break;case 22:m=s.stateNode._retryCache;break;default:throw Error(i(314))}m!==null&&m.delete(o),uv(s,u)}function mR(s,o){return Oc(s,o)}var ou=null,Ss=null,wd=!1,lu=!1,Td=!1,Mr=0;function zn(s){s!==Ss&&s.next===null&&(Ss===null?ou=Ss=s:Ss=Ss.next=s),lu=!0,wd||(wd=!0,yR())}function io(s,o){if(!Td&&lu){Td=!0;do for(var u=!1,m=ou;m!==null;){if(s!==0){var y=m.pendingLanes;if(y===0)var b=0;else{var E=m.suspendedLanes,A=m.pingedLanes;b=(1<<31-Wt(42|s)+1)-1,b&=y&~(E&~A),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(u=!0,hv(m,b))}else b=Oe,b=pl(m,m===Ke?b:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(b&3)===0||va(m,b)||(u=!0,hv(m,b));m=m.next}while(u);Td=!1}}function gR(){cv()}function cv(){lu=wd=!1;var s=0;Mr!==0&&(CR()&&(s=Mr),Mr=0);for(var o=Bn(),u=null,m=ou;m!==null;){var y=m.next,b=fv(m,o);b===0?(m.next=null,u===null?ou=y:u.next=y,y===null&&(Ss=u)):(u=m,(s!==0||(b&3)!==0)&&(lu=!0)),m=y}io(s)}function fv(s,o){for(var u=s.suspendedLanes,m=s.pingedLanes,y=s.expirationTimes,b=s.pendingLanes&-62914561;0<b;){var E=31-Wt(b),A=1<<E,N=y[E];N===-1?((A&u)===0||(A&m)!==0)&&(y[E]=VC(A,o)):N<=o&&(s.expiredLanes|=A),b&=~A}if(o=Ke,u=Oe,u=pl(s,s===o?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),m=s.callbackNode,u===0||s===o&&(Ge===2||Ge===9)||s.cancelPendingCommit!==null)return m!==null&&m!==null&&kc(m),s.callbackNode=null,s.callbackPriority=0;if((u&3)===0||va(s,u)){if(o=u&-u,o===s.callbackPriority)return o;switch(m!==null&&kc(m),Lc(u)){case 2:case 8:u=ng;break;case 32:u=fl;break;case 268435456:u=ig;break;default:u=fl}return m=dv.bind(null,s),u=Oc(u,m),s.callbackPriority=o,s.callbackNode=u,o}return m!==null&&m!==null&&kc(m),s.callbackPriority=2,s.callbackNode=null,2}function dv(s,o){if(Tt!==0&&Tt!==5)return s.callbackNode=null,s.callbackPriority=0,null;var u=s.callbackNode;if(au()&&s.callbackNode!==u)return null;var m=Oe;return m=pl(s,s===Ke?m:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),m===0?null:(K_(s,m,o),fv(s,Bn()),s.callbackNode!=null&&s.callbackNode===u?dv.bind(null,s):null)}function hv(s,o){if(au())return null;K_(s,o,!0)}function yR(){RR(function(){(Be&6)!==0?Oc(tg,gR):cv()})}function Ed(){return Mr===0&&(Mr=rg()),Mr}function pv(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:vl(""+s)}function mv(s,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,s.id&&u.setAttribute("form",s.id),o.parentNode.insertBefore(u,o),s=new FormData(s),u.parentNode.removeChild(u),s}function _R(s,o,u,m,y){if(o==="submit"&&u&&u.stateNode===y){var b=pv((y[Vt]||null).action),E=m.submitter;E&&(o=(o=E[Vt]||null)?pv(o.formAction):E.getAttribute("formAction"),o!==null&&(b=o,E=null));var A=new El("action","action",null,m,y);s.push({event:A,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(Mr!==0){var N=E?mv(y,E):new FormData(y);Ff(u,{pending:!0,data:N,method:y.method,action:b},null,N)}}else typeof b=="function"&&(A.preventDefault(),N=E?mv(y,E):new FormData(y),Ff(u,{pending:!0,data:N,method:y.method,action:b},b,N))},currentTarget:y}]})}}for(var Sd=0;Sd<lf.length;Sd++){var Cd=lf[Sd],vR=Cd.toLowerCase(),bR=Cd[0].toUpperCase()+Cd.slice(1);An(vR,"on"+bR)}An(Kg,"onAnimationEnd"),An(Yg,"onAnimationIteration"),An(Zg,"onAnimationStart"),An("dblclick","onDoubleClick"),An("focusin","onFocus"),An("focusout","onBlur"),An(UA,"onTransitionRun"),An($A,"onTransitionStart"),An(qA,"onTransitionCancel"),An(Qg,"onTransitionEnd"),Kr("onMouseEnter",["mouseout","mouseover"]),Kr("onMouseLeave",["mouseout","mouseover"]),Kr("onPointerEnter",["pointerout","pointerover"]),Kr("onPointerLeave",["pointerout","pointerover"]),pr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),pr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),pr("onBeforeInput",["compositionend","keypress","textInput","paste"]),pr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),pr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),pr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ro="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wR=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ro));function gv(s,o){o=(o&4)!==0;for(var u=0;u<s.length;u++){var m=s[u],y=m.event;m=m.listeners;e:{var b=void 0;if(o)for(var E=m.length-1;0<=E;E--){var A=m[E],N=A.instance,$=A.currentTarget;if(A=A.listener,N!==b&&y.isPropagationStopped())break e;b=A,y.currentTarget=$;try{b(y)}catch(H){Yl(H)}y.currentTarget=null,b=N}else for(E=0;E<m.length;E++){if(A=m[E],N=A.instance,$=A.currentTarget,A=A.listener,N!==b&&y.isPropagationStopped())break e;b=A,y.currentTarget=$;try{b(y)}catch(H){Yl(H)}y.currentTarget=null,b=N}}}}function Ie(s,o){var u=o[Uc];u===void 0&&(u=o[Uc]=new Set);var m=s+"__bubble";u.has(m)||(yv(o,s,2,!1),u.add(m))}function Ad(s,o,u){var m=0;o&&(m|=4),yv(u,s,m,o)}var uu="_reactListening"+Math.random().toString(36).slice(2);function Rd(s){if(!s[uu]){s[uu]=!0,cg.forEach(function(u){u!=="selectionchange"&&(wR.has(u)||Ad(u,!1,s),Ad(u,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[uu]||(o[uu]=!0,Ad("selectionchange",!1,o))}}function yv(s,o,u,m){switch(Gv(o)){case 2:var y=KR;break;case 8:y=YR;break;default:y=Gd}u=y.bind(null,o,u,s),y=void 0,!Kc||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(y=!0),m?y!==void 0?s.addEventListener(o,u,{capture:!0,passive:y}):s.addEventListener(o,u,!0):y!==void 0?s.addEventListener(o,u,{passive:y}):s.addEventListener(o,u,!1)}function xd(s,o,u,m,y){var b=m;if((o&1)===0&&(o&2)===0&&m!==null)e:for(;;){if(m===null)return;var E=m.tag;if(E===3||E===4){var A=m.stateNode.containerInfo;if(A===y)break;if(E===4)for(E=m.return;E!==null;){var N=E.tag;if((N===3||N===4)&&E.stateNode.containerInfo===y)return;E=E.return}for(;A!==null;){if(E=zr(A),E===null)return;if(N=E.tag,N===5||N===6||N===26||N===27){m=b=E;continue e}A=A.parentNode}}m=m.return}Sg(function(){var $=b,H=jc(u),j=[];e:{var q=Xg.get(s);if(q!==void 0){var B=El,ge=s;switch(s){case"keypress":if(wl(u)===0)break e;case"keydown":case"keyup":B=mA;break;case"focusin":ge="focus",B=Xc;break;case"focusout":ge="blur",B=Xc;break;case"beforeblur":case"afterblur":B=Xc;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":B=Rg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":B=iA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":B=_A;break;case Kg:case Yg:case Zg:B=aA;break;case Qg:B=bA;break;case"scroll":case"scrollend":B=tA;break;case"wheel":B=TA;break;case"copy":case"cut":case"paste":B=lA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":B=Ig;break;case"toggle":case"beforetoggle":B=SA}var he=(o&4)!==0,je=!he&&(s==="scroll"||s==="scrollend"),D=he?q!==null?q+"Capture":null:q;he=[];for(var k=$,U;k!==null;){var z=k;if(U=z.stateNode,z=z.tag,z!==5&&z!==26&&z!==27||U===null||D===null||(z=Ea(k,D),z!=null&&he.push(so(k,z,U))),je)break;k=k.return}0<he.length&&(q=new B(q,ge,null,u,H),j.push({event:q,listeners:he}))}}if((o&7)===0){e:{if(q=s==="mouseover"||s==="pointerover",B=s==="mouseout"||s==="pointerout",q&&u!==zc&&(ge=u.relatedTarget||u.fromElement)&&(zr(ge)||ge[Hr]))break e;if((B||q)&&(q=H.window===H?H:(q=H.ownerDocument)?q.defaultView||q.parentWindow:window,B?(ge=u.relatedTarget||u.toElement,B=$,ge=ge?zr(ge):null,ge!==null&&(je=a(ge),he=ge.tag,ge!==je||he!==5&&he!==27&&he!==6)&&(ge=null)):(B=null,ge=$),B!==ge)){if(he=Rg,z="onMouseLeave",D="onMouseEnter",k="mouse",(s==="pointerout"||s==="pointerover")&&(he=Ig,z="onPointerLeave",D="onPointerEnter",k="pointer"),je=B==null?q:Ta(B),U=ge==null?q:Ta(ge),q=new he(z,k+"leave",B,u,H),q.target=je,q.relatedTarget=U,z=null,zr(H)===$&&(he=new he(D,k+"enter",ge,u,H),he.target=U,he.relatedTarget=je,z=he),je=z,B&&ge)t:{for(he=B,D=ge,k=0,U=he;U;U=Cs(U))k++;for(U=0,z=D;z;z=Cs(z))U++;for(;0<k-U;)he=Cs(he),k--;for(;0<U-k;)D=Cs(D),U--;for(;k--;){if(he===D||D!==null&&he===D.alternate)break t;he=Cs(he),D=Cs(D)}he=null}else he=null;B!==null&&_v(j,q,B,he,!1),ge!==null&&je!==null&&_v(j,je,ge,he,!0)}}e:{if(q=$?Ta($):window,B=q.nodeName&&q.nodeName.toLowerCase(),B==="select"||B==="input"&&q.type==="file")var ae=Ug;else if(Dg(q))if($g)ae=PA;else{ae=OA;var Ae=NA}else B=q.nodeName,!B||B.toLowerCase()!=="input"||q.type!=="checkbox"&&q.type!=="radio"?$&&Hc($.elementType)&&(ae=Ug):ae=kA;if(ae&&(ae=ae(s,$))){Lg(j,ae,u,H);break e}Ae&&Ae(s,q,$),s==="focusout"&&$&&q.type==="number"&&$.memoizedProps.value!=null&&Fc(q,"number",q.value)}switch(Ae=$?Ta($):window,s){case"focusin":(Dg(Ae)||Ae.contentEditable==="true")&&(ts=Ae,sf=$,Na=null);break;case"focusout":Na=sf=ts=null;break;case"mousedown":af=!0;break;case"contextmenu":case"mouseup":case"dragend":af=!1,jg(j,u,H);break;case"selectionchange":if(LA)break;case"keydown":case"keyup":jg(j,u,H)}var ce;if(ef)e:{switch(s){case"compositionstart":var me="onCompositionStart";break e;case"compositionend":me="onCompositionEnd";break e;case"compositionupdate":me="onCompositionUpdate";break e}me=void 0}else es?kg(s,u)&&(me="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(me="onCompositionStart");me&&(Mg&&u.locale!=="ko"&&(es||me!=="onCompositionStart"?me==="onCompositionEnd"&&es&&(ce=Cg()):(Ti=H,Yc="value"in Ti?Ti.value:Ti.textContent,es=!0)),Ae=cu($,me),0<Ae.length&&(me=new xg(me,s,null,u,H),j.push({event:me,listeners:Ae}),ce?me.data=ce:(ce=Pg(u),ce!==null&&(me.data=ce)))),(ce=AA?RA(s,u):xA(s,u))&&(me=cu($,"onBeforeInput"),0<me.length&&(Ae=new xg("onBeforeInput","beforeinput",null,u,H),j.push({event:Ae,listeners:me}),Ae.data=ce)),_R(j,s,$,u,H)}gv(j,o)})}function so(s,o,u){return{instance:s,listener:o,currentTarget:u}}function cu(s,o){for(var u=o+"Capture",m=[];s!==null;){var y=s,b=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||b===null||(y=Ea(s,u),y!=null&&m.unshift(so(s,y,b)),y=Ea(s,o),y!=null&&m.push(so(s,y,b))),s.tag===3)return m;s=s.return}return[]}function Cs(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function _v(s,o,u,m,y){for(var b=o._reactName,E=[];u!==null&&u!==m;){var A=u,N=A.alternate,$=A.stateNode;if(A=A.tag,N!==null&&N===m)break;A!==5&&A!==26&&A!==27||$===null||(N=$,y?($=Ea(u,b),$!=null&&E.unshift(so(u,$,N))):y||($=Ea(u,b),$!=null&&E.push(so(u,$,N)))),u=u.return}E.length!==0&&s.push({event:o,listeners:E})}var TR=/\r\n?/g,ER=/\u0000|\uFFFD/g;function vv(s){return(typeof s=="string"?s:""+s).replace(TR,`
`).replace(ER,"")}function bv(s,o){return o=vv(o),vv(s)===o}function fu(){}function ze(s,o,u,m,y,b){switch(u){case"children":typeof m=="string"?o==="body"||o==="textarea"&&m===""||Qr(s,m):(typeof m=="number"||typeof m=="bigint")&&o!=="body"&&Qr(s,""+m);break;case"className":gl(s,"class",m);break;case"tabIndex":gl(s,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":gl(s,u,m);break;case"style":Tg(s,m,b);break;case"data":if(o!=="object"){gl(s,"data",m);break}case"src":case"href":if(m===""&&(o!=="a"||u!=="href")){s.removeAttribute(u);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){s.removeAttribute(u);break}m=vl(""+m),s.setAttribute(u,m);break;case"action":case"formAction":if(typeof m=="function"){s.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(u==="formAction"?(o!=="input"&&ze(s,o,"name",y.name,y,null),ze(s,o,"formEncType",y.formEncType,y,null),ze(s,o,"formMethod",y.formMethod,y,null),ze(s,o,"formTarget",y.formTarget,y,null)):(ze(s,o,"encType",y.encType,y,null),ze(s,o,"method",y.method,y,null),ze(s,o,"target",y.target,y,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){s.removeAttribute(u);break}m=vl(""+m),s.setAttribute(u,m);break;case"onClick":m!=null&&(s.onclick=fu);break;case"onScroll":m!=null&&Ie("scroll",s);break;case"onScrollEnd":m!=null&&Ie("scrollend",s);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(i(61));if(u=m.__html,u!=null){if(y.children!=null)throw Error(i(60));s.innerHTML=u}}break;case"multiple":s.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":s.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){s.removeAttribute("xlink:href");break}u=vl(""+m),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?s.setAttribute(u,""+m):s.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?s.setAttribute(u,""):s.removeAttribute(u);break;case"capture":case"download":m===!0?s.setAttribute(u,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?s.setAttribute(u,m):s.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?s.setAttribute(u,m):s.removeAttribute(u);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?s.removeAttribute(u):s.setAttribute(u,m);break;case"popover":Ie("beforetoggle",s),Ie("toggle",s),ml(s,"popover",m);break;case"xlinkActuate":Zn(s,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":Zn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":Zn(s,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":Zn(s,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":Zn(s,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":Zn(s,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":Zn(s,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":Zn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":Zn(s,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":ml(s,"is",m);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=WC.get(u)||u,ml(s,u,m))}}function Id(s,o,u,m,y,b){switch(u){case"style":Tg(s,m,b);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(i(61));if(u=m.__html,u!=null){if(y.children!=null)throw Error(i(60));s.innerHTML=u}}break;case"children":typeof m=="string"?Qr(s,m):(typeof m=="number"||typeof m=="bigint")&&Qr(s,""+m);break;case"onScroll":m!=null&&Ie("scroll",s);break;case"onScrollEnd":m!=null&&Ie("scrollend",s);break;case"onClick":m!=null&&(s.onclick=fu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!fg.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(y=u.endsWith("Capture"),o=u.slice(2,y?u.length-7:void 0),b=s[Vt]||null,b=b!=null?b[u]:null,typeof b=="function"&&s.removeEventListener(o,b,y),typeof m=="function")){typeof b!="function"&&b!==null&&(u in s?s[u]=null:s.hasAttribute(u)&&s.removeAttribute(u)),s.addEventListener(o,m,y);break e}u in s?s[u]=m:m===!0?s.setAttribute(u,""):ml(s,u,m)}}}function Et(s,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ie("error",s),Ie("load",s);var m=!1,y=!1,b;for(b in u)if(u.hasOwnProperty(b)){var E=u[b];if(E!=null)switch(b){case"src":m=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:ze(s,o,b,E,u,null)}}y&&ze(s,o,"srcSet",u.srcSet,u,null),m&&ze(s,o,"src",u.src,u,null);return;case"input":Ie("invalid",s);var A=b=E=y=null,N=null,$=null;for(m in u)if(u.hasOwnProperty(m)){var H=u[m];if(H!=null)switch(m){case"name":y=H;break;case"type":E=H;break;case"checked":N=H;break;case"defaultChecked":$=H;break;case"value":b=H;break;case"defaultValue":A=H;break;case"children":case"dangerouslySetInnerHTML":if(H!=null)throw Error(i(137,o));break;default:ze(s,o,m,H,u,null)}}_g(s,b,A,N,$,E,y,!1),yl(s);return;case"select":Ie("invalid",s),m=E=b=null;for(y in u)if(u.hasOwnProperty(y)&&(A=u[y],A!=null))switch(y){case"value":b=A;break;case"defaultValue":E=A;break;case"multiple":m=A;default:ze(s,o,y,A,u,null)}o=b,u=E,s.multiple=!!m,o!=null?Zr(s,!!m,o,!1):u!=null&&Zr(s,!!m,u,!0);return;case"textarea":Ie("invalid",s),b=y=m=null;for(E in u)if(u.hasOwnProperty(E)&&(A=u[E],A!=null))switch(E){case"value":m=A;break;case"defaultValue":y=A;break;case"children":b=A;break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(i(91));break;default:ze(s,o,E,A,u,null)}bg(s,m,y,b),yl(s);return;case"option":for(N in u)if(u.hasOwnProperty(N)&&(m=u[N],m!=null))switch(N){case"selected":s.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:ze(s,o,N,m,u,null)}return;case"dialog":Ie("beforetoggle",s),Ie("toggle",s),Ie("cancel",s),Ie("close",s);break;case"iframe":case"object":Ie("load",s);break;case"video":case"audio":for(m=0;m<ro.length;m++)Ie(ro[m],s);break;case"image":Ie("error",s),Ie("load",s);break;case"details":Ie("toggle",s);break;case"embed":case"source":case"link":Ie("error",s),Ie("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for($ in u)if(u.hasOwnProperty($)&&(m=u[$],m!=null))switch($){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:ze(s,o,$,m,u,null)}return;default:if(Hc(o)){for(H in u)u.hasOwnProperty(H)&&(m=u[H],m!==void 0&&Id(s,o,H,m,u,void 0));return}}for(A in u)u.hasOwnProperty(A)&&(m=u[A],m!=null&&ze(s,o,A,m,u,null))}function SR(s,o,u,m){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,b=null,E=null,A=null,N=null,$=null,H=null;for(B in u){var j=u[B];if(u.hasOwnProperty(B)&&j!=null)switch(B){case"checked":break;case"value":break;case"defaultValue":N=j;default:m.hasOwnProperty(B)||ze(s,o,B,null,m,j)}}for(var q in m){var B=m[q];if(j=u[q],m.hasOwnProperty(q)&&(B!=null||j!=null))switch(q){case"type":b=B;break;case"name":y=B;break;case"checked":$=B;break;case"defaultChecked":H=B;break;case"value":E=B;break;case"defaultValue":A=B;break;case"children":case"dangerouslySetInnerHTML":if(B!=null)throw Error(i(137,o));break;default:B!==j&&ze(s,o,q,B,m,j)}}Vc(s,E,A,N,$,H,b,y);return;case"select":B=E=A=q=null;for(b in u)if(N=u[b],u.hasOwnProperty(b)&&N!=null)switch(b){case"value":break;case"multiple":B=N;default:m.hasOwnProperty(b)||ze(s,o,b,null,m,N)}for(y in m)if(b=m[y],N=u[y],m.hasOwnProperty(y)&&(b!=null||N!=null))switch(y){case"value":q=b;break;case"defaultValue":A=b;break;case"multiple":E=b;default:b!==N&&ze(s,o,y,b,m,N)}o=A,u=E,m=B,q!=null?Zr(s,!!u,q,!1):!!m!=!!u&&(o!=null?Zr(s,!!u,o,!0):Zr(s,!!u,u?[]:"",!1));return;case"textarea":B=q=null;for(A in u)if(y=u[A],u.hasOwnProperty(A)&&y!=null&&!m.hasOwnProperty(A))switch(A){case"value":break;case"children":break;default:ze(s,o,A,null,m,y)}for(E in m)if(y=m[E],b=u[E],m.hasOwnProperty(E)&&(y!=null||b!=null))switch(E){case"value":q=y;break;case"defaultValue":B=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(i(91));break;default:y!==b&&ze(s,o,E,y,m,b)}vg(s,q,B);return;case"option":for(var ge in u)if(q=u[ge],u.hasOwnProperty(ge)&&q!=null&&!m.hasOwnProperty(ge))switch(ge){case"selected":s.selected=!1;break;default:ze(s,o,ge,null,m,q)}for(N in m)if(q=m[N],B=u[N],m.hasOwnProperty(N)&&q!==B&&(q!=null||B!=null))switch(N){case"selected":s.selected=q&&typeof q!="function"&&typeof q!="symbol";break;default:ze(s,o,N,q,m,B)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var he in u)q=u[he],u.hasOwnProperty(he)&&q!=null&&!m.hasOwnProperty(he)&&ze(s,o,he,null,m,q);for($ in m)if(q=m[$],B=u[$],m.hasOwnProperty($)&&q!==B&&(q!=null||B!=null))switch($){case"children":case"dangerouslySetInnerHTML":if(q!=null)throw Error(i(137,o));break;default:ze(s,o,$,q,m,B)}return;default:if(Hc(o)){for(var je in u)q=u[je],u.hasOwnProperty(je)&&q!==void 0&&!m.hasOwnProperty(je)&&Id(s,o,je,void 0,m,q);for(H in m)q=m[H],B=u[H],!m.hasOwnProperty(H)||q===B||q===void 0&&B===void 0||Id(s,o,H,q,m,B);return}}for(var D in u)q=u[D],u.hasOwnProperty(D)&&q!=null&&!m.hasOwnProperty(D)&&ze(s,o,D,null,m,q);for(j in m)q=m[j],B=u[j],!m.hasOwnProperty(j)||q===B||q==null&&B==null||ze(s,o,j,q,m,B)}var Md=null,Nd=null;function du(s){return s.nodeType===9?s:s.ownerDocument}function wv(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Tv(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function Od(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var kd=null;function CR(){var s=window.event;return s&&s.type==="popstate"?s===kd?!1:(kd=s,!0):(kd=null,!1)}var Ev=typeof setTimeout=="function"?setTimeout:void 0,AR=typeof clearTimeout=="function"?clearTimeout:void 0,Sv=typeof Promise=="function"?Promise:void 0,RR=typeof queueMicrotask=="function"?queueMicrotask:typeof Sv<"u"?function(s){return Sv.resolve(null).then(s).catch(xR)}:Ev;function xR(s){setTimeout(function(){throw s})}function $i(s){return s==="head"}function Cv(s,o){var u=o,m=0,y=0;do{var b=u.nextSibling;if(s.removeChild(u),b&&b.nodeType===8)if(u=b.data,u==="/$"){if(0<m&&8>m){u=m;var E=s.ownerDocument;if(u&1&&ao(E.documentElement),u&2&&ao(E.body),u&4)for(u=E.head,ao(u),E=u.firstChild;E;){var A=E.nextSibling,N=E.nodeName;E[wa]||N==="SCRIPT"||N==="STYLE"||N==="LINK"&&E.rel.toLowerCase()==="stylesheet"||u.removeChild(E),E=A}}if(y===0){s.removeChild(b),mo(o);return}y--}else u==="$"||u==="$?"||u==="$!"?y++:m=u.charCodeAt(0)-48;else m=0;u=b}while(u);mo(o)}function Pd(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Pd(u),$c(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}s.removeChild(u)}}function IR(s,o,u,m){for(;s.nodeType===1;){var y=u;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!m&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(m){if(!s[wa])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(b=s.getAttribute("rel"),b==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(b!==y.rel||s.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||s.getAttribute("title")!==(y.title==null?null:y.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(b=s.getAttribute("src"),(b!==(y.src==null?null:y.src)||s.getAttribute("type")!==(y.type==null?null:y.type)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&b&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var b=y.name==null?null:""+y.name;if(y.type==="hidden"&&s.getAttribute("name")===b)return s}else return s;if(s=xn(s.nextSibling),s===null)break}return null}function MR(s,o,u){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!u||(s=xn(s.nextSibling),s===null))return null;return s}function Dd(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function NR(s,o){var u=s.ownerDocument;if(s.data!=="$?"||u.readyState==="complete")o();else{var m=function(){o(),u.removeEventListener("DOMContentLoaded",m)};u.addEventListener("DOMContentLoaded",m),s._reactRetry=m}}function xn(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return s}var Ld=null;function Av(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return s;o--}else u==="/$"&&o++}s=s.previousSibling}return null}function Rv(s,o,u){switch(o=du(u),s){case"html":if(s=o.documentElement,!s)throw Error(i(452));return s;case"head":if(s=o.head,!s)throw Error(i(453));return s;case"body":if(s=o.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function ao(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);$c(s)}var wn=new Map,xv=new Set;function hu(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ci=F.d;F.d={f:OR,r:kR,D:PR,C:DR,L:LR,m:UR,X:qR,S:$R,M:BR};function OR(){var s=ci.f(),o=ru();return s||o}function kR(s){var o=jr(s);o!==null&&o.tag===5&&o.type==="form"?Ky(o):ci.r(s)}var As=typeof document>"u"?null:document;function Iv(s,o,u){var m=As;if(m&&typeof o=="string"&&o){var y=pn(o);y='link[rel="'+s+'"][href="'+y+'"]',typeof u=="string"&&(y+='[crossorigin="'+u+'"]'),xv.has(y)||(xv.add(y),s={rel:s,crossOrigin:u,href:o},m.querySelector(y)===null&&(o=m.createElement("link"),Et(o,"link",s),ht(o),m.head.appendChild(o)))}}function PR(s){ci.D(s),Iv("dns-prefetch",s,null)}function DR(s,o){ci.C(s,o),Iv("preconnect",s,o)}function LR(s,o,u){ci.L(s,o,u);var m=As;if(m&&s&&o){var y='link[rel="preload"][as="'+pn(o)+'"]';o==="image"&&u&&u.imageSrcSet?(y+='[imagesrcset="'+pn(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(y+='[imagesizes="'+pn(u.imageSizes)+'"]')):y+='[href="'+pn(s)+'"]';var b=y;switch(o){case"style":b=Rs(s);break;case"script":b=xs(s)}wn.has(b)||(s=g({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:s,as:o},u),wn.set(b,s),m.querySelector(y)!==null||o==="style"&&m.querySelector(oo(b))||o==="script"&&m.querySelector(lo(b))||(o=m.createElement("link"),Et(o,"link",s),ht(o),m.head.appendChild(o)))}}function UR(s,o){ci.m(s,o);var u=As;if(u&&s){var m=o&&typeof o.as=="string"?o.as:"script",y='link[rel="modulepreload"][as="'+pn(m)+'"][href="'+pn(s)+'"]',b=y;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=xs(s)}if(!wn.has(b)&&(s=g({rel:"modulepreload",href:s},o),wn.set(b,s),u.querySelector(y)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(lo(b)))return}m=u.createElement("link"),Et(m,"link",s),ht(m),u.head.appendChild(m)}}}function $R(s,o,u){ci.S(s,o,u);var m=As;if(m&&s){var y=Jr(m).hoistableStyles,b=Rs(s);o=o||"default";var E=y.get(b);if(!E){var A={loading:0,preload:null};if(E=m.querySelector(oo(b)))A.loading=5;else{s=g({rel:"stylesheet",href:s,"data-precedence":o},u),(u=wn.get(b))&&Ud(s,u);var N=E=m.createElement("link");ht(N),Et(N,"link",s),N._p=new Promise(function($,H){N.onload=$,N.onerror=H}),N.addEventListener("load",function(){A.loading|=1}),N.addEventListener("error",function(){A.loading|=2}),A.loading|=4,pu(E,o,m)}E={type:"stylesheet",instance:E,count:1,state:A},y.set(b,E)}}}function qR(s,o){ci.X(s,o);var u=As;if(u&&s){var m=Jr(u).hoistableScripts,y=xs(s),b=m.get(y);b||(b=u.querySelector(lo(y)),b||(s=g({src:s,async:!0},o),(o=wn.get(y))&&$d(s,o),b=u.createElement("script"),ht(b),Et(b,"link",s),u.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},m.set(y,b))}}function BR(s,o){ci.M(s,o);var u=As;if(u&&s){var m=Jr(u).hoistableScripts,y=xs(s),b=m.get(y);b||(b=u.querySelector(lo(y)),b||(s=g({src:s,async:!0,type:"module"},o),(o=wn.get(y))&&$d(s,o),b=u.createElement("script"),ht(b),Et(b,"link",s),u.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},m.set(y,b))}}function Mv(s,o,u,m){var y=(y=pe.current)?hu(y):null;if(!y)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=Rs(u.href),u=Jr(y).hoistableStyles,m=u.get(o),m||(m={type:"style",instance:null,count:0,state:null},u.set(o,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){s=Rs(u.href);var b=Jr(y).hoistableStyles,E=b.get(s);if(E||(y=y.ownerDocument||y,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(s,E),(b=y.querySelector(oo(s)))&&!b._p&&(E.instance=b,E.state.loading=5),wn.has(s)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},wn.set(s,u),b||GR(y,s,u,E.state))),o&&m===null)throw Error(i(528,""));return E}if(o&&m!==null)throw Error(i(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=xs(u),u=Jr(y).hoistableScripts,m=u.get(o),m||(m={type:"script",instance:null,count:0,state:null},u.set(o,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Rs(s){return'href="'+pn(s)+'"'}function oo(s){return'link[rel="stylesheet"]['+s+"]"}function Nv(s){return g({},s,{"data-precedence":s.precedence,precedence:null})}function GR(s,o,u,m){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?m.loading=1:(o=s.createElement("link"),m.preload=o,o.addEventListener("load",function(){return m.loading|=1}),o.addEventListener("error",function(){return m.loading|=2}),Et(o,"link",u),ht(o),s.head.appendChild(o))}function xs(s){return'[src="'+pn(s)+'"]'}function lo(s){return"script[async]"+s}function Ov(s,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var m=s.querySelector('style[data-href~="'+pn(u.href)+'"]');if(m)return o.instance=m,ht(m),m;var y=g({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return m=(s.ownerDocument||s).createElement("style"),ht(m),Et(m,"style",y),pu(m,u.precedence,s),o.instance=m;case"stylesheet":y=Rs(u.href);var b=s.querySelector(oo(y));if(b)return o.state.loading|=4,o.instance=b,ht(b),b;m=Nv(u),(y=wn.get(y))&&Ud(m,y),b=(s.ownerDocument||s).createElement("link"),ht(b);var E=b;return E._p=new Promise(function(A,N){E.onload=A,E.onerror=N}),Et(b,"link",m),o.state.loading|=4,pu(b,u.precedence,s),o.instance=b;case"script":return b=xs(u.src),(y=s.querySelector(lo(b)))?(o.instance=y,ht(y),y):(m=u,(y=wn.get(b))&&(m=g({},u),$d(m,y)),s=s.ownerDocument||s,y=s.createElement("script"),ht(y),Et(y,"link",m),s.head.appendChild(y),o.instance=y);case"void":return null;default:throw Error(i(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(m=o.instance,o.state.loading|=4,pu(m,u.precedence,s));return o.instance}function pu(s,o,u){for(var m=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=m.length?m[m.length-1]:null,b=y,E=0;E<m.length;E++){var A=m[E];if(A.dataset.precedence===o)b=A;else if(b!==y)break}b?b.parentNode.insertBefore(s,b.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(s,o.firstChild))}function Ud(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function $d(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var mu=null;function kv(s,o,u){if(mu===null){var m=new Map,y=mu=new Map;y.set(u,m)}else y=mu,m=y.get(u),m||(m=new Map,y.set(u,m));if(m.has(s))return m;for(m.set(s,null),u=u.getElementsByTagName(s),y=0;y<u.length;y++){var b=u[y];if(!(b[wa]||b[At]||s==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var E=b.getAttribute(o)||"";E=s+E;var A=m.get(E);A?A.push(b):m.set(E,[b])}}return m}function Pv(s,o,u){s=s.ownerDocument||s,s.head.insertBefore(u,o==="title"?s.querySelector("head > title"):null)}function VR(s,o,u){if(u===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function Dv(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var uo=null;function FR(){}function HR(s,o,u){if(uo===null)throw Error(i(475));var m=uo;if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var y=Rs(u.href),b=s.querySelector(oo(y));if(b){s=b._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(m.count++,m=gu.bind(m),s.then(m,m)),o.state.loading|=4,o.instance=b,ht(b);return}b=s.ownerDocument||s,u=Nv(u),(y=wn.get(y))&&Ud(u,y),b=b.createElement("link"),ht(b);var E=b;E._p=new Promise(function(A,N){E.onload=A,E.onerror=N}),Et(b,"link",u),o.instance=b}m.stylesheets===null&&(m.stylesheets=new Map),m.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(m.count++,o=gu.bind(m),s.addEventListener("load",o),s.addEventListener("error",o))}}function zR(){if(uo===null)throw Error(i(475));var s=uo;return s.stylesheets&&s.count===0&&qd(s,s.stylesheets),0<s.count?function(o){var u=setTimeout(function(){if(s.stylesheets&&qd(s,s.stylesheets),s.unsuspend){var m=s.unsuspend;s.unsuspend=null,m()}},6e4);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(u)}}:null}function gu(){if(this.count--,this.count===0){if(this.stylesheets)qd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var yu=null;function qd(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,yu=new Map,o.forEach(jR,s),yu=null,gu.call(s))}function jR(s,o){if(!(o.state.loading&4)){var u=yu.get(s);if(u)var m=u.get(null);else{u=new Map,yu.set(s,u);for(var y=s.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<y.length;b++){var E=y[b];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(u.set(E.dataset.precedence,E),m=E)}m&&u.set(null,m)}y=o.instance,E=y.getAttribute("data-precedence"),b=u.get(E)||m,b===m&&u.set(null,y),u.set(E,y),this.count++,m=gu.bind(this),y.addEventListener("load",m),y.addEventListener("error",m),b?b.parentNode.insertBefore(y,b.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(y,s.firstChild)),o.state.loading|=4}}var co={$$typeof:R,Provider:null,Consumer:null,_currentValue:Q,_currentValue2:Q,_threadCount:0};function JR(s,o,u,m,y,b,E,A){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Pc(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pc(0),this.hiddenUpdates=Pc(null),this.identifierPrefix=m,this.onUncaughtError=y,this.onCaughtError=b,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=A,this.incompleteTransitions=new Map}function Lv(s,o,u,m,y,b,E,A,N,$,H,j){return s=new JR(s,o,u,E,A,N,$,j),o=1,b===!0&&(o|=24),b=tn(3,null,null,o),s.current=b,b.stateNode=s,o=bf(),o.refCount++,s.pooledCache=o,o.refCount++,b.memoizedState={element:m,isDehydrated:u,cache:o},Sf(b),s}function Uv(s){return s?(s=ss,s):ss}function $v(s,o,u,m,y,b){y=Uv(y),m.context===null?m.context=y:m.pendingContext=y,m=Ci(o),m.payload={element:u},b=b===void 0?null:b,b!==null&&(m.callback=b),u=Ai(s,m,o),u!==null&&(on(u,s,o),Ba(u,s,o))}function qv(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<o?u:o}}function Bd(s,o){qv(s,o),(s=s.alternate)&&qv(s,o)}function Bv(s){if(s.tag===13){var o=rs(s,67108864);o!==null&&on(o,s,67108864),Bd(s,67108864)}}var _u=!0;function KR(s,o,u,m){var y=L.T;L.T=null;var b=F.p;try{F.p=2,Gd(s,o,u,m)}finally{F.p=b,L.T=y}}function YR(s,o,u,m){var y=L.T;L.T=null;var b=F.p;try{F.p=8,Gd(s,o,u,m)}finally{F.p=b,L.T=y}}function Gd(s,o,u,m){if(_u){var y=Vd(m);if(y===null)xd(s,o,m,vu,u),Vv(s,m);else if(QR(y,s,o,u,m))m.stopPropagation();else if(Vv(s,m),o&4&&-1<ZR.indexOf(s)){for(;y!==null;){var b=jr(y);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var E=hr(b.pendingLanes);if(E!==0){var A=b;for(A.pendingLanes|=2,A.entangledLanes|=2;E;){var N=1<<31-Wt(E);A.entanglements[1]|=N,E&=~N}zn(b),(Be&6)===0&&(nu=Bn()+500,io(0))}}break;case 13:A=rs(b,2),A!==null&&on(A,b,2),ru(),Bd(b,2)}if(b=Vd(m),b===null&&xd(s,o,m,vu,u),b===y)break;y=b}y!==null&&m.stopPropagation()}else xd(s,o,m,null,u)}}function Vd(s){return s=jc(s),Fd(s)}var vu=null;function Fd(s){if(vu=null,s=zr(s),s!==null){var o=a(s);if(o===null)s=null;else{var u=o.tag;if(u===13){if(s=l(o),s!==null)return s;s=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return vu=s,null}function Gv(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(DC()){case tg:return 2;case ng:return 8;case fl:case LC:return 32;case ig:return 268435456;default:return 32}default:return 32}}var Hd=!1,qi=null,Bi=null,Gi=null,fo=new Map,ho=new Map,Vi=[],ZR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Vv(s,o){switch(s){case"focusin":case"focusout":qi=null;break;case"dragenter":case"dragleave":Bi=null;break;case"mouseover":case"mouseout":Gi=null;break;case"pointerover":case"pointerout":fo.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":ho.delete(o.pointerId)}}function po(s,o,u,m,y,b){return s===null||s.nativeEvent!==b?(s={blockedOn:o,domEventName:u,eventSystemFlags:m,nativeEvent:b,targetContainers:[y]},o!==null&&(o=jr(o),o!==null&&Bv(o)),s):(s.eventSystemFlags|=m,o=s.targetContainers,y!==null&&o.indexOf(y)===-1&&o.push(y),s)}function QR(s,o,u,m,y){switch(o){case"focusin":return qi=po(qi,s,o,u,m,y),!0;case"dragenter":return Bi=po(Bi,s,o,u,m,y),!0;case"mouseover":return Gi=po(Gi,s,o,u,m,y),!0;case"pointerover":var b=y.pointerId;return fo.set(b,po(fo.get(b)||null,s,o,u,m,y)),!0;case"gotpointercapture":return b=y.pointerId,ho.set(b,po(ho.get(b)||null,s,o,u,m,y)),!0}return!1}function Fv(s){var o=zr(s.target);if(o!==null){var u=a(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){s.blockedOn=o,HC(s.priority,function(){if(u.tag===13){var m=an();m=Dc(m);var y=rs(u,m);y!==null&&on(y,u,m),Bd(u,m)}});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function bu(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var u=Vd(s.nativeEvent);if(u===null){u=s.nativeEvent;var m=new u.constructor(u.type,u);zc=m,u.target.dispatchEvent(m),zc=null}else return o=jr(u),o!==null&&Bv(o),s.blockedOn=u,!1;o.shift()}return!0}function Hv(s,o,u){bu(s)&&u.delete(o)}function XR(){Hd=!1,qi!==null&&bu(qi)&&(qi=null),Bi!==null&&bu(Bi)&&(Bi=null),Gi!==null&&bu(Gi)&&(Gi=null),fo.forEach(Hv),ho.forEach(Hv)}function wu(s,o){s.blockedOn===o&&(s.blockedOn=null,Hd||(Hd=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,XR)))}var Tu=null;function zv(s){Tu!==s&&(Tu=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Tu===s&&(Tu=null);for(var o=0;o<s.length;o+=3){var u=s[o],m=s[o+1],y=s[o+2];if(typeof m!="function"){if(Fd(m||u)===null)continue;break}var b=jr(u);b!==null&&(s.splice(o,3),o-=3,Ff(b,{pending:!0,data:y,method:u.method,action:m},m,y))}}))}function mo(s){function o(N){return wu(N,s)}qi!==null&&wu(qi,s),Bi!==null&&wu(Bi,s),Gi!==null&&wu(Gi,s),fo.forEach(o),ho.forEach(o);for(var u=0;u<Vi.length;u++){var m=Vi[u];m.blockedOn===s&&(m.blockedOn=null)}for(;0<Vi.length&&(u=Vi[0],u.blockedOn===null);)Fv(u),u.blockedOn===null&&Vi.shift();if(u=(s.ownerDocument||s).$$reactFormReplay,u!=null)for(m=0;m<u.length;m+=3){var y=u[m],b=u[m+1],E=y[Vt]||null;if(typeof b=="function")E||zv(u);else if(E){var A=null;if(b&&b.hasAttribute("formAction")){if(y=b,E=b[Vt]||null)A=E.formAction;else if(Fd(y)!==null)continue}else A=E.action;typeof A=="function"?u[m+1]=A:(u.splice(m,3),m-=3),zv(u)}}}function zd(s){this._internalRoot=s}Eu.prototype.render=zd.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(i(409));var u=o.current,m=an();$v(u,m,s,o,null,null)},Eu.prototype.unmount=zd.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;$v(s.current,2,null,s,null,null),ru(),o[Hr]=null}};function Eu(s){this._internalRoot=s}Eu.prototype.unstable_scheduleHydration=function(s){if(s){var o=lg();s={blockedOn:null,target:s,priority:o};for(var u=0;u<Vi.length&&o!==0&&o<Vi[u].priority;u++);Vi.splice(u,0,s),u===0&&Fv(s)}};var jv=e.version;if(jv!=="19.1.1")throw Error(i(527,jv,"19.1.1"));F.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=f(o),s=s!==null?d(s):null,s=s===null?null:s.stateNode,s};var WR={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Su=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Su.isDisabled&&Su.supportsFiber)try{_a=Su.inject(WR),Xt=Su}catch{}}return yo.createRoot=function(s,o){if(!r(s))throw Error(i(299));var u=!1,m="",y=l_,b=u_,E=c_,A=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(b=o.onCaughtError),o.onRecoverableError!==void 0&&(E=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(A=o.unstable_transitionCallbacks)),o=Lv(s,1,!1,null,null,u,m,y,b,E,A,null),s[Hr]=o.current,Rd(s),new zd(o)},yo.hydrateRoot=function(s,o,u){if(!r(s))throw Error(i(299));var m=!1,y="",b=l_,E=u_,A=c_,N=null,$=null;return u!=null&&(u.unstable_strictMode===!0&&(m=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onUncaughtError!==void 0&&(b=u.onUncaughtError),u.onCaughtError!==void 0&&(E=u.onCaughtError),u.onRecoverableError!==void 0&&(A=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(N=u.unstable_transitionCallbacks),u.formState!==void 0&&($=u.formState)),o=Lv(s,1,!0,o,u??null,m,y,b,E,A,N,$),o.context=Uv(null),u=o.current,m=an(),m=Dc(m),y=Ci(m),y.callback=null,Ai(u,y,m),u=m,o.current.lanes=u,ba(o,u),zn(o),s[Hr]=o.current,Rd(s),new Eu(o)},yo.version="19.1.1",yo}var nb;function cx(){if(nb)return Kd.exports;nb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Kd.exports=ux(),Kd.exports}var fx=cx();const dx="modulepreload",hx=function(n){return"/"+n},ib={},ir=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let f=function(d){return Promise.all(d.map(g=>Promise.resolve(g).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");r=f(t.map(d=>{if(d=hx(d),d in ib)return;ib[d]=!0;const g=d.endsWith(".css"),_=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${_}`))return;const v=document.createElement("link");if(v.rel=g?"stylesheet":dx,g||(v.as="script"),v.crossOrigin="",v.href=d,c&&v.setAttribute("nonce",c),document.head.appendChild(v),g)return new Promise((w,T)=>{v.addEventListener("load",w),v.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return r.then(l=>{for(const c of l||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};var Le;(function(n){n.assertEqual=r=>{};function e(r){}n.assertIs=e;function t(r){throw new Error}n.assertNever=t,n.arrayToEnum=r=>{const a={};for(const l of r)a[l]=l;return a},n.getValidEnumValues=r=>{const a=n.objectKeys(r).filter(c=>typeof r[r[c]]!="number"),l={};for(const c of a)l[c]=r[c];return n.objectValues(l)},n.objectValues=r=>n.objectKeys(r).map(function(a){return r[a]}),n.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{const a=[];for(const l in r)Object.prototype.hasOwnProperty.call(r,l)&&a.push(l);return a},n.find=(r,a)=>{for(const l of r)if(a(l))return l},n.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&Number.isFinite(r)&&Math.floor(r)===r;function i(r,a=" | "){return r.map(l=>typeof l=="string"?`'${l}'`:l).join(a)}n.joinValues=i,n.jsonStringifyReplacer=(r,a)=>typeof a=="bigint"?a.toString():a})(Le||(Le={}));var rb;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(rb||(rb={}));const oe=Le.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ki=n=>{switch(typeof n){case"undefined":return oe.undefined;case"string":return oe.string;case"number":return Number.isNaN(n)?oe.nan:oe.number;case"boolean":return oe.boolean;case"function":return oe.function;case"bigint":return oe.bigint;case"symbol":return oe.symbol;case"object":return Array.isArray(n)?oe.array:n===null?oe.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?oe.promise:typeof Map<"u"&&n instanceof Map?oe.map:typeof Set<"u"&&n instanceof Set?oe.set:typeof Date<"u"&&n instanceof Date?oe.date:oe.object;default:return oe.unknown}},W=Le.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class gi extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(a){return a.message},i={_errors:[]},r=a=>{for(const l of a.issues)if(l.code==="invalid_union")l.unionErrors.map(r);else if(l.code==="invalid_return_type")r(l.returnTypeError);else if(l.code==="invalid_arguments")r(l.argumentsError);else if(l.path.length===0)i._errors.push(t(l));else{let c=i,f=0;for(;f<l.path.length;){const d=l.path[f];f===l.path.length-1?(c[d]=c[d]||{_errors:[]},c[d]._errors.push(t(l))):c[d]=c[d]||{_errors:[]},c=c[d],f++}}};return r(this),i}static assert(e){if(!(e instanceof gi))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Le.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},i=[];for(const r of this.issues)if(r.path.length>0){const a=r.path[0];t[a]=t[a]||[],t[a].push(e(r))}else i.push(e(r));return{formErrors:i,fieldErrors:t}}get formErrors(){return this.flatten()}}gi.create=n=>new gi(n);const xp=(n,e)=>{let t;switch(n.code){case W.invalid_type:n.received===oe.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case W.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,Le.jsonStringifyReplacer)}`;break;case W.unrecognized_keys:t=`Unrecognized key(s) in object: ${Le.joinValues(n.keys,", ")}`;break;case W.invalid_union:t="Invalid input";break;case W.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${Le.joinValues(n.options)}`;break;case W.invalid_enum_value:t=`Invalid enum value. Expected ${Le.joinValues(n.options)}, received '${n.received}'`;break;case W.invalid_arguments:t="Invalid function arguments";break;case W.invalid_return_type:t="Invalid function return type";break;case W.invalid_date:t="Invalid date";break;case W.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:Le.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case W.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="bigint"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case W.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case W.custom:t="Invalid input";break;case W.invalid_intersection_types:t="Intersection results could not be merged";break;case W.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case W.not_finite:t="Number must be finite";break;default:t=e.defaultError,Le.assertNever(n)}return{message:t}};let px=xp;function mx(){return px}const gx=n=>{const{data:e,path:t,errorMaps:i,issueData:r}=n,a=[...t,...r.path||[]],l={...r,path:a};if(r.message!==void 0)return{...r,path:a,message:r.message};let c="";const f=i.filter(d=>!!d).slice().reverse();for(const d of f)c=d(l,{data:e,defaultError:c}).message;return{...r,path:a,message:c}};function ie(n,e){const t=mx(),i=gx({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===xp?void 0:xp].filter(r=>!!r)});n.common.issues.push(i)}class cn{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const i=[];for(const r of t){if(r.status==="aborted")return _e;r.status==="dirty"&&e.dirty(),i.push(r.value)}return{status:e.value,value:i}}static async mergeObjectAsync(e,t){const i=[];for(const r of t){const a=await r.key,l=await r.value;i.push({key:a,value:l})}return cn.mergeObjectSync(e,i)}static mergeObjectSync(e,t){const i={};for(const r of t){const{key:a,value:l}=r;if(a.status==="aborted"||l.status==="aborted")return _e;a.status==="dirty"&&e.dirty(),l.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof l.value<"u"||r.alwaysSet)&&(i[a.value]=l.value)}return{status:e.value,value:i}}}const _e=Object.freeze({status:"aborted"}),Co=n=>({status:"dirty",value:n}),Cn=n=>({status:"valid",value:n}),sb=n=>n.status==="aborted",ab=n=>n.status==="dirty",Qs=n=>n.status==="valid",ju=n=>typeof Promise<"u"&&n instanceof Promise;var le;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e?.message})(le||(le={}));class or{constructor(e,t,i,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=i,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const ob=(n,e)=>{if(Qs(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new gi(n.common.issues);return this._error=t,this._error}}};function Re(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:i,description:r}=n;if(e&&(t||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(l,c)=>{const{message:f}=n;return l.code==="invalid_enum_value"?{message:f??c.defaultError}:typeof c.data>"u"?{message:f??i??c.defaultError}:l.code!=="invalid_type"?{message:c.defaultError}:{message:f??t??c.defaultError}},description:r}}class ke{get description(){return this._def.description}_getType(e){return Ki(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Ki(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new cn,ctx:{common:e.parent.common,data:e.data,parsedType:Ki(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(ju(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const i=this.safeParse(e,t);if(i.success)return i.data;throw i.error}safeParse(e,t){const i={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ki(e)},r=this._parseSync({data:e,path:i.path,parent:i});return ob(i,r)}"~validate"(e){const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ki(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:t});return Qs(i)?{value:i.value}:{issues:t.common.issues}}catch(i){i?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(i=>Qs(i)?{value:i.value}:{issues:t.common.issues})}async parseAsync(e,t){const i=await this.safeParseAsync(e,t);if(i.success)return i.data;throw i.error}async safeParseAsync(e,t){const i={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ki(e)},r=this._parse({data:e,path:i.path,parent:i}),a=await(ju(r)?r:Promise.resolve(r));return ob(i,a)}refine(e,t){const i=r=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(r):t;return this._refinement((r,a)=>{const l=e(r),c=()=>a.addIssue({code:W.custom,...i(r)});return typeof Promise<"u"&&l instanceof Promise?l.then(f=>f?!0:(c(),!1)):l?!0:(c(),!1)})}refinement(e,t){return this._refinement((i,r)=>e(i)?!0:(r.addIssue(typeof t=="function"?t(i,r):t),!1))}_refinement(e){return new Ws({schema:this,typeName:ee.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return rr.create(this,this._def)}nullable(){return ea.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Jn.create(this)}promise(){return Zu.create(this,this._def)}or(e){return Ku.create([this,e],this._def)}and(e){return Yu.create(this,e,this._def)}transform(e){return new Ws({...Re(this._def),schema:this,typeName:ee.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Np({...Re(this._def),innerType:this,defaultValue:t,typeName:ee.ZodDefault})}brand(){return new qx({typeName:ee.ZodBranded,type:this,...Re(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new Op({...Re(this._def),innerType:this,catchValue:t,typeName:ee.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return wm.create(this,e)}readonly(){return kp.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const yx=/^c[^\s-]{8,}$/i,_x=/^[0-9a-z]+$/,vx=/^[0-9A-HJKMNP-TV-Z]{26}$/i,bx=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,wx=/^[a-z0-9_-]{21}$/i,Tx=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Ex=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Sx=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Cx="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Xd;const Ax=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Rx=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,xx=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Ix=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Mx=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Nx=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,OE="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Ox=new RegExp(`^${OE}$`);function kE(n){let e="[0-5]\\d";n.precision?e=`${e}\\.\\d{${n.precision}}`:n.precision==null&&(e=`${e}(\\.\\d+)?`);const t=n.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function kx(n){return new RegExp(`^${kE(n)}$`)}function Px(n){let e=`${OE}T${kE(n)}`;const t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function Dx(n,e){return!!((e==="v4"||!e)&&Ax.test(n)||(e==="v6"||!e)&&xx.test(n))}function Lx(n,e){if(!Tx.test(n))return!1;try{const[t]=n.split(".");if(!t)return!1;const i=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),r=JSON.parse(atob(i));return!(typeof r!="object"||r===null||"typ"in r&&r?.typ!=="JWT"||!r.alg||e&&r.alg!==e)}catch{return!1}}function Ux(n,e){return!!((e==="v4"||!e)&&Rx.test(n)||(e==="v6"||!e)&&Ix.test(n))}class Wi extends ke{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==oe.string){const a=this._getOrReturnCtx(e);return ie(a,{code:W.invalid_type,expected:oe.string,received:a.parsedType}),_e}const i=new cn;let r;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(r=this._getOrReturnCtx(e,r),ie(r,{code:W.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),i.dirty());else if(a.kind==="max")e.data.length>a.value&&(r=this._getOrReturnCtx(e,r),ie(r,{code:W.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),i.dirty());else if(a.kind==="length"){const l=e.data.length>a.value,c=e.data.length<a.value;(l||c)&&(r=this._getOrReturnCtx(e,r),l?ie(r,{code:W.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):c&&ie(r,{code:W.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),i.dirty())}else if(a.kind==="email")Sx.test(e.data)||(r=this._getOrReturnCtx(e,r),ie(r,{validation:"email",code:W.invalid_string,message:a.message}),i.dirty());else if(a.kind==="emoji")Xd||(Xd=new RegExp(Cx,"u")),Xd.test(e.data)||(r=this._getOrReturnCtx(e,r),ie(r,{validation:"emoji",code:W.invalid_string,message:a.message}),i.dirty());else if(a.kind==="uuid")bx.test(e.data)||(r=this._getOrReturnCtx(e,r),ie(r,{validation:"uuid",code:W.invalid_string,message:a.message}),i.dirty());else if(a.kind==="nanoid")wx.test(e.data)||(r=this._getOrReturnCtx(e,r),ie(r,{validation:"nanoid",code:W.invalid_string,message:a.message}),i.dirty());else if(a.kind==="cuid")yx.test(e.data)||(r=this._getOrReturnCtx(e,r),ie(r,{validation:"cuid",code:W.invalid_string,message:a.message}),i.dirty());else if(a.kind==="cuid2")_x.test(e.data)||(r=this._getOrReturnCtx(e,r),ie(r,{validation:"cuid2",code:W.invalid_string,message:a.message}),i.dirty());else if(a.kind==="ulid")vx.test(e.data)||(r=this._getOrReturnCtx(e,r),ie(r,{validation:"ulid",code:W.invalid_string,message:a.message}),i.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),ie(r,{validation:"url",code:W.invalid_string,message:a.message}),i.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),ie(r,{validation:"regex",code:W.invalid_string,message:a.message}),i.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(r=this._getOrReturnCtx(e,r),ie(r,{code:W.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),i.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(r=this._getOrReturnCtx(e,r),ie(r,{code:W.invalid_string,validation:{startsWith:a.value},message:a.message}),i.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(r=this._getOrReturnCtx(e,r),ie(r,{code:W.invalid_string,validation:{endsWith:a.value},message:a.message}),i.dirty()):a.kind==="datetime"?Px(a).test(e.data)||(r=this._getOrReturnCtx(e,r),ie(r,{code:W.invalid_string,validation:"datetime",message:a.message}),i.dirty()):a.kind==="date"?Ox.test(e.data)||(r=this._getOrReturnCtx(e,r),ie(r,{code:W.invalid_string,validation:"date",message:a.message}),i.dirty()):a.kind==="time"?kx(a).test(e.data)||(r=this._getOrReturnCtx(e,r),ie(r,{code:W.invalid_string,validation:"time",message:a.message}),i.dirty()):a.kind==="duration"?Ex.test(e.data)||(r=this._getOrReturnCtx(e,r),ie(r,{validation:"duration",code:W.invalid_string,message:a.message}),i.dirty()):a.kind==="ip"?Dx(e.data,a.version)||(r=this._getOrReturnCtx(e,r),ie(r,{validation:"ip",code:W.invalid_string,message:a.message}),i.dirty()):a.kind==="jwt"?Lx(e.data,a.alg)||(r=this._getOrReturnCtx(e,r),ie(r,{validation:"jwt",code:W.invalid_string,message:a.message}),i.dirty()):a.kind==="cidr"?Ux(e.data,a.version)||(r=this._getOrReturnCtx(e,r),ie(r,{validation:"cidr",code:W.invalid_string,message:a.message}),i.dirty()):a.kind==="base64"?Mx.test(e.data)||(r=this._getOrReturnCtx(e,r),ie(r,{validation:"base64",code:W.invalid_string,message:a.message}),i.dirty()):a.kind==="base64url"?Nx.test(e.data)||(r=this._getOrReturnCtx(e,r),ie(r,{validation:"base64url",code:W.invalid_string,message:a.message}),i.dirty()):Le.assertNever(a);return{status:i.value,value:e.data}}_regex(e,t,i){return this.refinement(r=>e.test(r),{validation:t,code:W.invalid_string,...le.errToObj(i)})}_addCheck(e){return new Wi({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...le.errToObj(e)})}url(e){return this._addCheck({kind:"url",...le.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...le.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...le.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...le.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...le.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...le.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...le.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...le.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...le.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...le.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...le.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...le.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...le.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...le.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...le.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...le.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...le.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...le.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...le.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...le.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...le.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...le.errToObj(t)})}nonempty(e){return this.min(1,le.errToObj(e))}trim(){return new Wi({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Wi({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Wi({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Wi.create=n=>new Wi({checks:[],typeName:ee.ZodString,coerce:n?.coerce??!1,...Re(n)});function $x(n,e){const t=(n.toString().split(".")[1]||"").length,i=(e.toString().split(".")[1]||"").length,r=t>i?t:i,a=Number.parseInt(n.toFixed(r).replace(".","")),l=Number.parseInt(e.toFixed(r).replace(".",""));return a%l/10**r}class qo extends ke{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==oe.number){const a=this._getOrReturnCtx(e);return ie(a,{code:W.invalid_type,expected:oe.number,received:a.parsedType}),_e}let i;const r=new cn;for(const a of this._def.checks)a.kind==="int"?Le.isInteger(e.data)||(i=this._getOrReturnCtx(e,i),ie(i,{code:W.invalid_type,expected:"integer",received:"float",message:a.message}),r.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(i=this._getOrReturnCtx(e,i),ie(i,{code:W.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(i=this._getOrReturnCtx(e,i),ie(i,{code:W.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):a.kind==="multipleOf"?$x(e.data,a.value)!==0&&(i=this._getOrReturnCtx(e,i),ie(i,{code:W.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(i=this._getOrReturnCtx(e,i),ie(i,{code:W.not_finite,message:a.message}),r.dirty()):Le.assertNever(a);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,le.toString(t))}gt(e,t){return this.setLimit("min",e,!1,le.toString(t))}lte(e,t){return this.setLimit("max",e,!0,le.toString(t))}lt(e,t){return this.setLimit("max",e,!1,le.toString(t))}setLimit(e,t,i,r){return new qo({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:i,message:le.toString(r)}]})}_addCheck(e){return new qo({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:le.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:le.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:le.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:le.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:le.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:le.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:le.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:le.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:le.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Le.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(t===null||i.value>t)&&(t=i.value):i.kind==="max"&&(e===null||i.value<e)&&(e=i.value)}return Number.isFinite(t)&&Number.isFinite(e)}}qo.create=n=>new qo({checks:[],typeName:ee.ZodNumber,coerce:n?.coerce||!1,...Re(n)});class Bo extends ke{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==oe.bigint)return this._getInvalidInput(e);let i;const r=new cn;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(i=this._getOrReturnCtx(e,i),ie(i,{code:W.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(i=this._getOrReturnCtx(e,i),ie(i,{code:W.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(i=this._getOrReturnCtx(e,i),ie(i,{code:W.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):Le.assertNever(a);return{status:r.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return ie(t,{code:W.invalid_type,expected:oe.bigint,received:t.parsedType}),_e}gte(e,t){return this.setLimit("min",e,!0,le.toString(t))}gt(e,t){return this.setLimit("min",e,!1,le.toString(t))}lte(e,t){return this.setLimit("max",e,!0,le.toString(t))}lt(e,t){return this.setLimit("max",e,!1,le.toString(t))}setLimit(e,t,i,r){return new Bo({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:i,message:le.toString(r)}]})}_addCheck(e){return new Bo({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:le.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:le.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:le.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:le.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:le.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Bo.create=n=>new Bo({checks:[],typeName:ee.ZodBigInt,coerce:n?.coerce??!1,...Re(n)});class lb extends ke{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==oe.boolean){const i=this._getOrReturnCtx(e);return ie(i,{code:W.invalid_type,expected:oe.boolean,received:i.parsedType}),_e}return Cn(e.data)}}lb.create=n=>new lb({typeName:ee.ZodBoolean,coerce:n?.coerce||!1,...Re(n)});class Ju extends ke{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==oe.date){const a=this._getOrReturnCtx(e);return ie(a,{code:W.invalid_type,expected:oe.date,received:a.parsedType}),_e}if(Number.isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return ie(a,{code:W.invalid_date}),_e}const i=new cn;let r;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(r=this._getOrReturnCtx(e,r),ie(r,{code:W.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),i.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(r=this._getOrReturnCtx(e,r),ie(r,{code:W.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),i.dirty()):Le.assertNever(a);return{status:i.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ju({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:le.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:le.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Ju.create=n=>new Ju({checks:[],coerce:n?.coerce||!1,typeName:ee.ZodDate,...Re(n)});class ub extends ke{_parse(e){if(this._getType(e)!==oe.symbol){const i=this._getOrReturnCtx(e);return ie(i,{code:W.invalid_type,expected:oe.symbol,received:i.parsedType}),_e}return Cn(e.data)}}ub.create=n=>new ub({typeName:ee.ZodSymbol,...Re(n)});class cb extends ke{_parse(e){if(this._getType(e)!==oe.undefined){const i=this._getOrReturnCtx(e);return ie(i,{code:W.invalid_type,expected:oe.undefined,received:i.parsedType}),_e}return Cn(e.data)}}cb.create=n=>new cb({typeName:ee.ZodUndefined,...Re(n)});class fb extends ke{_parse(e){if(this._getType(e)!==oe.null){const i=this._getOrReturnCtx(e);return ie(i,{code:W.invalid_type,expected:oe.null,received:i.parsedType}),_e}return Cn(e.data)}}fb.create=n=>new fb({typeName:ee.ZodNull,...Re(n)});class Ip extends ke{constructor(){super(...arguments),this._any=!0}_parse(e){return Cn(e.data)}}Ip.create=n=>new Ip({typeName:ee.ZodAny,...Re(n)});class db extends ke{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Cn(e.data)}}db.create=n=>new db({typeName:ee.ZodUnknown,...Re(n)});class lr extends ke{_parse(e){const t=this._getOrReturnCtx(e);return ie(t,{code:W.invalid_type,expected:oe.never,received:t.parsedType}),_e}}lr.create=n=>new lr({typeName:ee.ZodNever,...Re(n)});class hb extends ke{_parse(e){if(this._getType(e)!==oe.undefined){const i=this._getOrReturnCtx(e);return ie(i,{code:W.invalid_type,expected:oe.void,received:i.parsedType}),_e}return Cn(e.data)}}hb.create=n=>new hb({typeName:ee.ZodVoid,...Re(n)});class Jn extends ke{_parse(e){const{ctx:t,status:i}=this._processInputParams(e),r=this._def;if(t.parsedType!==oe.array)return ie(t,{code:W.invalid_type,expected:oe.array,received:t.parsedType}),_e;if(r.exactLength!==null){const l=t.data.length>r.exactLength.value,c=t.data.length<r.exactLength.value;(l||c)&&(ie(t,{code:l?W.too_big:W.too_small,minimum:c?r.exactLength.value:void 0,maximum:l?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),i.dirty())}if(r.minLength!==null&&t.data.length<r.minLength.value&&(ie(t,{code:W.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),i.dirty()),r.maxLength!==null&&t.data.length>r.maxLength.value&&(ie(t,{code:W.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),i.dirty()),t.common.async)return Promise.all([...t.data].map((l,c)=>r.type._parseAsync(new or(t,l,t.path,c)))).then(l=>cn.mergeArray(i,l));const a=[...t.data].map((l,c)=>r.type._parseSync(new or(t,l,t.path,c)));return cn.mergeArray(i,a)}get element(){return this._def.type}min(e,t){return new Jn({...this._def,minLength:{value:e,message:le.toString(t)}})}max(e,t){return new Jn({...this._def,maxLength:{value:e,message:le.toString(t)}})}length(e,t){return new Jn({...this._def,exactLength:{value:e,message:le.toString(t)}})}nonempty(e){return this.min(1,e)}}Jn.create=(n,e)=>new Jn({type:n,minLength:null,maxLength:null,exactLength:null,typeName:ee.ZodArray,...Re(e)});function Gs(n){if(n instanceof at){const e={};for(const t in n.shape){const i=n.shape[t];e[t]=rr.create(Gs(i))}return new at({...n._def,shape:()=>e})}else return n instanceof Jn?new Jn({...n._def,type:Gs(n.element)}):n instanceof rr?rr.create(Gs(n.unwrap())):n instanceof ea?ea.create(Gs(n.unwrap())):n instanceof Ur?Ur.create(n.items.map(e=>Gs(e))):n}class at extends ke{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=Le.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==oe.object){const d=this._getOrReturnCtx(e);return ie(d,{code:W.invalid_type,expected:oe.object,received:d.parsedType}),_e}const{status:i,ctx:r}=this._processInputParams(e),{shape:a,keys:l}=this._getCached(),c=[];if(!(this._def.catchall instanceof lr&&this._def.unknownKeys==="strip"))for(const d in r.data)l.includes(d)||c.push(d);const f=[];for(const d of l){const g=a[d],_=r.data[d];f.push({key:{status:"valid",value:d},value:g._parse(new or(r,_,r.path,d)),alwaysSet:d in r.data})}if(this._def.catchall instanceof lr){const d=this._def.unknownKeys;if(d==="passthrough")for(const g of c)f.push({key:{status:"valid",value:g},value:{status:"valid",value:r.data[g]}});else if(d==="strict")c.length>0&&(ie(r,{code:W.unrecognized_keys,keys:c}),i.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const g of c){const _=r.data[g];f.push({key:{status:"valid",value:g},value:d._parse(new or(r,_,r.path,g)),alwaysSet:g in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const d=[];for(const g of f){const _=await g.key,v=await g.value;d.push({key:_,value:v,alwaysSet:g.alwaysSet})}return d}).then(d=>cn.mergeObjectSync(i,d)):cn.mergeObjectSync(i,f)}get shape(){return this._def.shape()}strict(e){return le.errToObj,new at({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,i)=>{const r=this._def.errorMap?.(t,i).message??i.defaultError;return t.code==="unrecognized_keys"?{message:le.errToObj(e).message??r}:{message:r}}}:{}})}strip(){return new at({...this._def,unknownKeys:"strip"})}passthrough(){return new at({...this._def,unknownKeys:"passthrough"})}extend(e){return new at({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new at({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ee.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new at({...this._def,catchall:e})}pick(e){const t={};for(const i of Le.objectKeys(e))e[i]&&this.shape[i]&&(t[i]=this.shape[i]);return new at({...this._def,shape:()=>t})}omit(e){const t={};for(const i of Le.objectKeys(this.shape))e[i]||(t[i]=this.shape[i]);return new at({...this._def,shape:()=>t})}deepPartial(){return Gs(this)}partial(e){const t={};for(const i of Le.objectKeys(this.shape)){const r=this.shape[i];e&&!e[i]?t[i]=r:t[i]=r.optional()}return new at({...this._def,shape:()=>t})}required(e){const t={};for(const i of Le.objectKeys(this.shape))if(e&&!e[i])t[i]=this.shape[i];else{let a=this.shape[i];for(;a instanceof rr;)a=a._def.innerType;t[i]=a}return new at({...this._def,shape:()=>t})}keyof(){return PE(Le.objectKeys(this.shape))}}at.create=(n,e)=>new at({shape:()=>n,unknownKeys:"strip",catchall:lr.create(),typeName:ee.ZodObject,...Re(e)});at.strictCreate=(n,e)=>new at({shape:()=>n,unknownKeys:"strict",catchall:lr.create(),typeName:ee.ZodObject,...Re(e)});at.lazycreate=(n,e)=>new at({shape:n,unknownKeys:"strip",catchall:lr.create(),typeName:ee.ZodObject,...Re(e)});class Ku extends ke{_parse(e){const{ctx:t}=this._processInputParams(e),i=this._def.options;function r(a){for(const c of a)if(c.result.status==="valid")return c.result;for(const c of a)if(c.result.status==="dirty")return t.common.issues.push(...c.ctx.common.issues),c.result;const l=a.map(c=>new gi(c.ctx.common.issues));return ie(t,{code:W.invalid_union,unionErrors:l}),_e}if(t.common.async)return Promise.all(i.map(async a=>{const l={...t,common:{...t.common,issues:[]},parent:null};return{result:await a._parseAsync({data:t.data,path:t.path,parent:l}),ctx:l}})).then(r);{let a;const l=[];for(const f of i){const d={...t,common:{...t.common,issues:[]},parent:null},g=f._parseSync({data:t.data,path:t.path,parent:d});if(g.status==="valid")return g;g.status==="dirty"&&!a&&(a={result:g,ctx:d}),d.common.issues.length&&l.push(d.common.issues)}if(a)return t.common.issues.push(...a.ctx.common.issues),a.result;const c=l.map(f=>new gi(f));return ie(t,{code:W.invalid_union,unionErrors:c}),_e}}get options(){return this._def.options}}Ku.create=(n,e)=>new Ku({options:n,typeName:ee.ZodUnion,...Re(e)});function Mp(n,e){const t=Ki(n),i=Ki(e);if(n===e)return{valid:!0,data:n};if(t===oe.object&&i===oe.object){const r=Le.objectKeys(e),a=Le.objectKeys(n).filter(c=>r.indexOf(c)!==-1),l={...n,...e};for(const c of a){const f=Mp(n[c],e[c]);if(!f.valid)return{valid:!1};l[c]=f.data}return{valid:!0,data:l}}else if(t===oe.array&&i===oe.array){if(n.length!==e.length)return{valid:!1};const r=[];for(let a=0;a<n.length;a++){const l=n[a],c=e[a],f=Mp(l,c);if(!f.valid)return{valid:!1};r.push(f.data)}return{valid:!0,data:r}}else return t===oe.date&&i===oe.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class Yu extends ke{_parse(e){const{status:t,ctx:i}=this._processInputParams(e),r=(a,l)=>{if(sb(a)||sb(l))return _e;const c=Mp(a.value,l.value);return c.valid?((ab(a)||ab(l))&&t.dirty(),{status:t.value,value:c.data}):(ie(i,{code:W.invalid_intersection_types}),_e)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([a,l])=>r(a,l)):r(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}}Yu.create=(n,e,t)=>new Yu({left:n,right:e,typeName:ee.ZodIntersection,...Re(t)});class Ur extends ke{_parse(e){const{status:t,ctx:i}=this._processInputParams(e);if(i.parsedType!==oe.array)return ie(i,{code:W.invalid_type,expected:oe.array,received:i.parsedType}),_e;if(i.data.length<this._def.items.length)return ie(i,{code:W.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),_e;!this._def.rest&&i.data.length>this._def.items.length&&(ie(i,{code:W.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const a=[...i.data].map((l,c)=>{const f=this._def.items[c]||this._def.rest;return f?f._parse(new or(i,l,i.path,c)):null}).filter(l=>!!l);return i.common.async?Promise.all(a).then(l=>cn.mergeArray(t,l)):cn.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new Ur({...this._def,rest:e})}}Ur.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ur({items:n,typeName:ee.ZodTuple,rest:null,...Re(e)})};class pb extends ke{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:i}=this._processInputParams(e);if(i.parsedType!==oe.map)return ie(i,{code:W.invalid_type,expected:oe.map,received:i.parsedType}),_e;const r=this._def.keyType,a=this._def.valueType,l=[...i.data.entries()].map(([c,f],d)=>({key:r._parse(new or(i,c,i.path,[d,"key"])),value:a._parse(new or(i,f,i.path,[d,"value"]))}));if(i.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const f of l){const d=await f.key,g=await f.value;if(d.status==="aborted"||g.status==="aborted")return _e;(d.status==="dirty"||g.status==="dirty")&&t.dirty(),c.set(d.value,g.value)}return{status:t.value,value:c}})}else{const c=new Map;for(const f of l){const d=f.key,g=f.value;if(d.status==="aborted"||g.status==="aborted")return _e;(d.status==="dirty"||g.status==="dirty")&&t.dirty(),c.set(d.value,g.value)}return{status:t.value,value:c}}}}pb.create=(n,e,t)=>new pb({valueType:e,keyType:n,typeName:ee.ZodMap,...Re(t)});class Go extends ke{_parse(e){const{status:t,ctx:i}=this._processInputParams(e);if(i.parsedType!==oe.set)return ie(i,{code:W.invalid_type,expected:oe.set,received:i.parsedType}),_e;const r=this._def;r.minSize!==null&&i.data.size<r.minSize.value&&(ie(i,{code:W.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),r.maxSize!==null&&i.data.size>r.maxSize.value&&(ie(i,{code:W.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());const a=this._def.valueType;function l(f){const d=new Set;for(const g of f){if(g.status==="aborted")return _e;g.status==="dirty"&&t.dirty(),d.add(g.value)}return{status:t.value,value:d}}const c=[...i.data.values()].map((f,d)=>a._parse(new or(i,f,i.path,d)));return i.common.async?Promise.all(c).then(f=>l(f)):l(c)}min(e,t){return new Go({...this._def,minSize:{value:e,message:le.toString(t)}})}max(e,t){return new Go({...this._def,maxSize:{value:e,message:le.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Go.create=(n,e)=>new Go({valueType:n,minSize:null,maxSize:null,typeName:ee.ZodSet,...Re(e)});class mb extends ke{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}mb.create=(n,e)=>new mb({getter:n,typeName:ee.ZodLazy,...Re(e)});class gb extends ke{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return ie(t,{received:t.data,code:W.invalid_literal,expected:this._def.value}),_e}return{status:"valid",value:e.data}}get value(){return this._def.value}}gb.create=(n,e)=>new gb({value:n,typeName:ee.ZodLiteral,...Re(e)});function PE(n,e){return new Xs({values:n,typeName:ee.ZodEnum,...Re(e)})}class Xs extends ke{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),i=this._def.values;return ie(t,{expected:Le.joinValues(i),received:t.parsedType,code:W.invalid_type}),_e}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),i=this._def.values;return ie(t,{received:t.data,code:W.invalid_enum_value,options:i}),_e}return Cn(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Xs.create(e,{...this._def,...t})}exclude(e,t=this._def){return Xs.create(this.options.filter(i=>!e.includes(i)),{...this._def,...t})}}Xs.create=PE;class yb extends ke{_parse(e){const t=Le.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(e);if(i.parsedType!==oe.string&&i.parsedType!==oe.number){const r=Le.objectValues(t);return ie(i,{expected:Le.joinValues(r),received:i.parsedType,code:W.invalid_type}),_e}if(this._cache||(this._cache=new Set(Le.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const r=Le.objectValues(t);return ie(i,{received:i.data,code:W.invalid_enum_value,options:r}),_e}return Cn(e.data)}get enum(){return this._def.values}}yb.create=(n,e)=>new yb({values:n,typeName:ee.ZodNativeEnum,...Re(e)});class Zu extends ke{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==oe.promise&&t.common.async===!1)return ie(t,{code:W.invalid_type,expected:oe.promise,received:t.parsedType}),_e;const i=t.parsedType===oe.promise?t.data:Promise.resolve(t.data);return Cn(i.then(r=>this._def.type.parseAsync(r,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Zu.create=(n,e)=>new Zu({type:n,typeName:ee.ZodPromise,...Re(e)});class Ws extends ke{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ee.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:i}=this._processInputParams(e),r=this._def.effect||null,a={addIssue:l=>{ie(i,l),l.fatal?t.abort():t.dirty()},get path(){return i.path}};if(a.addIssue=a.addIssue.bind(a),r.type==="preprocess"){const l=r.transform(i.data,a);if(i.common.async)return Promise.resolve(l).then(async c=>{if(t.value==="aborted")return _e;const f=await this._def.schema._parseAsync({data:c,path:i.path,parent:i});return f.status==="aborted"?_e:f.status==="dirty"||t.value==="dirty"?Co(f.value):f});{if(t.value==="aborted")return _e;const c=this._def.schema._parseSync({data:l,path:i.path,parent:i});return c.status==="aborted"?_e:c.status==="dirty"||t.value==="dirty"?Co(c.value):c}}if(r.type==="refinement"){const l=c=>{const f=r.refinement(c,a);if(i.common.async)return Promise.resolve(f);if(f instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(i.common.async===!1){const c=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return c.status==="aborted"?_e:(c.status==="dirty"&&t.dirty(),l(c.value),{status:t.value,value:c.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(c=>c.status==="aborted"?_e:(c.status==="dirty"&&t.dirty(),l(c.value).then(()=>({status:t.value,value:c.value}))))}if(r.type==="transform")if(i.common.async===!1){const l=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!Qs(l))return _e;const c=r.transform(l.value,a);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:c}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(l=>Qs(l)?Promise.resolve(r.transform(l.value,a)).then(c=>({status:t.value,value:c})):_e);Le.assertNever(r)}}Ws.create=(n,e,t)=>new Ws({schema:n,typeName:ee.ZodEffects,effect:e,...Re(t)});Ws.createWithPreprocess=(n,e,t)=>new Ws({schema:e,effect:{type:"preprocess",transform:n},typeName:ee.ZodEffects,...Re(t)});class rr extends ke{_parse(e){return this._getType(e)===oe.undefined?Cn(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}rr.create=(n,e)=>new rr({innerType:n,typeName:ee.ZodOptional,...Re(e)});class ea extends ke{_parse(e){return this._getType(e)===oe.null?Cn(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ea.create=(n,e)=>new ea({innerType:n,typeName:ee.ZodNullable,...Re(e)});class Np extends ke{_parse(e){const{ctx:t}=this._processInputParams(e);let i=t.data;return t.parsedType===oe.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Np.create=(n,e)=>new Np({innerType:n,typeName:ee.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Re(e)});class Op extends ke{_parse(e){const{ctx:t}=this._processInputParams(e),i={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return ju(r)?r.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new gi(i.common.issues)},input:i.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new gi(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}}Op.create=(n,e)=>new Op({innerType:n,typeName:ee.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Re(e)});class _b extends ke{_parse(e){if(this._getType(e)!==oe.nan){const i=this._getOrReturnCtx(e);return ie(i,{code:W.invalid_type,expected:oe.nan,received:i.parsedType}),_e}return{status:"valid",value:e.data}}}_b.create=n=>new _b({typeName:ee.ZodNaN,...Re(n)});class qx extends ke{_parse(e){const{ctx:t}=this._processInputParams(e),i=t.data;return this._def.type._parse({data:i,path:t.path,parent:t})}unwrap(){return this._def.type}}class wm extends ke{_parse(e){const{status:t,ctx:i}=this._processInputParams(e);if(i.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return a.status==="aborted"?_e:a.status==="dirty"?(t.dirty(),Co(a.value)):this._def.out._parseAsync({data:a.value,path:i.path,parent:i})})();{const r=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return r.status==="aborted"?_e:r.status==="dirty"?(t.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:i.path,parent:i})}}static create(e,t){return new wm({in:e,out:t,typeName:ee.ZodPipeline})}}class kp extends ke{_parse(e){const t=this._def.innerType._parse(e),i=r=>(Qs(r)&&(r.value=Object.freeze(r.value)),r);return ju(t)?t.then(r=>i(r)):i(t)}unwrap(){return this._def.innerType}}kp.create=(n,e)=>new kp({innerType:n,typeName:ee.ZodReadonly,...Re(e)});var ee;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(ee||(ee={}));const Bx=Wi.create,vb=Ip.create;lr.create;Jn.create;const Gx=at.create;Ku.create;Yu.create;Ur.create;Xs.create;Zu.create;rr.create;ea.create;var _o={exports:{}},Wd={},eh,bb;function Vx(){if(bb)return eh;bb=1;function n(e,t){typeof t=="boolean"&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}return eh=n,n.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},n.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},n.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=new Date().getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var i=this._timeouts.shift();if(i===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),i=this._cachedTimeouts.slice(-1);else return!1;var r=this;return this._timer=setTimeout(function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout(function(){r._operationTimeoutCb(r._attempts)},r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)},i),this._options.unref&&this._timer.unref(),!0},n.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var i=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){i._operationTimeoutCb()},i._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},n.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},n.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},n.prototype.start=n.prototype.try,n.prototype.errors=function(){return this._errors},n.prototype.attempts=function(){return this._attempts},n.prototype.mainError=function(){if(this._errors.length===0)return null;for(var e={},t=null,i=0,r=0;r<this._errors.length;r++){var a=this._errors[r],l=a.message,c=(e[l]||0)+1;e[l]=c,c>=i&&(t=a,i=c)}return t},eh}var wb;function Fx(){return wb||(wb=1,function(n){var e=Vx();n.operation=function(t){var i=n.timeouts(t);return new e(i,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},n.timeouts=function(t){if(t instanceof Array)return[].concat(t);var i={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var r in t)i[r]=t[r];if(i.minTimeout>i.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var a=[],l=0;l<i.retries;l++)a.push(this.createTimeout(l,i));return t&&t.forever&&!a.length&&a.push(this.createTimeout(l,i)),a.sort(function(c,f){return c-f}),a},n.createTimeout=function(t,i){var r=i.randomize?Math.random()+1:1,a=Math.round(r*Math.max(i.minTimeout,1)*Math.pow(i.factor,t));return a=Math.min(a,i.maxTimeout),a},n.wrap=function(t,i,r){if(i instanceof Array&&(r=i,i=null),!r){r=[];for(var a in t)typeof t[a]=="function"&&r.push(a)}for(var l=0;l<r.length;l++){var c=r[l],f=t[c];t[c]=(function(g){var _=n.operation(i),v=Array.prototype.slice.call(arguments,1),w=v.pop();v.push(function(T){_.retry(T)||(T&&(arguments[0]=_.mainError()),w.apply(this,arguments))}),_.attempt(function(){g.apply(t,v)})}).bind(t,f),t[c].options=i}}}(Wd)),Wd}var th,Tb;function Hx(){return Tb||(Tb=1,th=Fx()),th}var Eb;function zx(){if(Eb)return _o.exports;Eb=1;const n=Hx(),e=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class t extends Error{constructor(c){super(),c instanceof Error?(this.originalError=c,{message:c}=c):(this.originalError=new Error(c),this.originalError.stack=this.stack),this.name="AbortError",this.message=c}}const i=(l,c,f)=>{const d=f.retries-(c-1);return l.attemptNumber=c,l.retriesLeft=d,l},r=l=>e.includes(l),a=(l,c)=>new Promise((f,d)=>{c={onFailedAttempt:()=>{},retries:10,...c};const g=n.operation(c);g.attempt(async _=>{try{f(await l(_))}catch(v){if(!(v instanceof Error)){d(new TypeError(`Non-error was thrown: "${v}". You should only throw errors.`));return}if(v instanceof t)g.stop(),d(v.originalError);else if(v instanceof TypeError&&!r(v.message))g.stop(),d(v);else{i(v,_,c);try{await c.onFailedAttempt(v)}catch(w){d(w);return}g.retry(v)||d(g.mainError())}}})});return _o.exports=a,_o.exports.default=a,_o.exports.AbortError=t,_o.exports}var jx=zx();const Qu=aa(jx),Jx=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function Mo(n){return typeof n=="string"&&Jx.test(n)}function Kx(n){if(!Mo(n))throw TypeError("Invalid UUID");var e,t=new Uint8Array(16);return t[0]=(e=parseInt(n.slice(0,8),16))>>>24,t[1]=e>>>16&255,t[2]=e>>>8&255,t[3]=e&255,t[4]=(e=parseInt(n.slice(9,13),16))>>>8,t[5]=e&255,t[6]=(e=parseInt(n.slice(14,18),16))>>>8,t[7]=e&255,t[8]=(e=parseInt(n.slice(19,23),16))>>>8,t[9]=e&255,t[10]=(e=parseInt(n.slice(24,36),16))/1099511627776&255,t[11]=e/4294967296&255,t[12]=e>>>24&255,t[13]=e>>>16&255,t[14]=e>>>8&255,t[15]=e&255,t}var St=[];for(var nh=0;nh<256;++nh)St.push((nh+256).toString(16).slice(1));function DE(n,e=0){return(St[n[e+0]]+St[n[e+1]]+St[n[e+2]]+St[n[e+3]]+"-"+St[n[e+4]]+St[n[e+5]]+"-"+St[n[e+6]]+St[n[e+7]]+"-"+St[n[e+8]]+St[n[e+9]]+"-"+St[n[e+10]]+St[n[e+11]]+St[n[e+12]]+St[n[e+13]]+St[n[e+14]]+St[n[e+15]]).toLowerCase()}var Cu,Yx=new Uint8Array(16);function Zx(){if(!Cu&&(Cu=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Cu))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Cu(Yx)}function Qx(n){n=unescape(encodeURIComponent(n));for(var e=[],t=0;t<n.length;++t)e.push(n.charCodeAt(t));return e}var Xx="6ba7b810-9dad-11d1-80b4-00c04fd430c8",Wx="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function eI(n,e,t){function i(r,a,l,c){var f;if(typeof r=="string"&&(r=Qx(r)),typeof a=="string"&&(a=Kx(a)),((f=a)===null||f===void 0?void 0:f.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var d=new Uint8Array(16+r.length);if(d.set(a),d.set(r,a.length),d=t(d),d[6]=d[6]&15|e,d[8]=d[8]&63|128,l){c=c||0;for(var g=0;g<16;++g)l[c+g]=d[g];return l}return DE(d)}try{i.name=n}catch{}return i.DNS=Xx,i.URL=Wx,i}var tI=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const Sb={randomUUID:tI};function Ut(n,e,t){if(Sb.randomUUID&&!n)return Sb.randomUUID();n=n||{};var i=n.random||(n.rng||Zx)();return i[6]=i[6]&15|64,i[8]=i[8]&63|128,DE(i)}function nI(n,e,t,i){switch(n){case 0:return e&t^~e&i;case 1:return e^t^i;case 2:return e&t^e&i^t&i;case 3:return e^t^i}}function ih(n,e){return n<<e|n>>>32-e}function iI(n){var e=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof n=="string"){var i=unescape(encodeURIComponent(n));n=[];for(var r=0;r<i.length;++r)n.push(i.charCodeAt(r))}else Array.isArray(n)||(n=Array.prototype.slice.call(n));n.push(128);for(var a=n.length/4+2,l=Math.ceil(a/16),c=new Array(l),f=0;f<l;++f){for(var d=new Uint32Array(16),g=0;g<16;++g)d[g]=n[f*64+g*4]<<24|n[f*64+g*4+1]<<16|n[f*64+g*4+2]<<8|n[f*64+g*4+3];c[f]=d}c[l-1][14]=(n.length-1)*8/Math.pow(2,32),c[l-1][14]=Math.floor(c[l-1][14]),c[l-1][15]=(n.length-1)*8&4294967295;for(var _=0;_<l;++_){for(var v=new Uint32Array(80),w=0;w<16;++w)v[w]=c[_][w];for(var T=16;T<80;++T)v[T]=ih(v[T-3]^v[T-8]^v[T-14]^v[T-16],1);for(var S=t[0],C=t[1],x=t[2],M=t[3],R=t[4],P=0;P<80;++P){var O=Math.floor(P/20),V=ih(S,5)+nI(O,C,x,M)+R+e[O]+v[P]>>>0;R=M,M=x,x=ih(C,30)>>>0,C=S,S=V}t[0]=t[0]+S>>>0,t[1]=t[1]+C>>>0,t[2]=t[2]+x>>>0,t[3]=t[3]+M>>>0,t[4]=t[4]+R>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}var Cb=eI("v5",80,iI);let rI=class{getStore(){}run(e,t){return t()}};const rh=Symbol.for("ls:tracing_async_local_storage"),sI=new rI;let aI=class{getInstance(){return globalThis[rh]??sI}initializeGlobalInstance(e){globalThis[rh]===void 0&&(globalThis[rh]=e)}};const oI=new aI;function lI(n=!1){const e=oI.getInstance().getStore();if(!n&&e===void 0)throw new Error(`Could not get the current run tree.

Please make sure you are calling this method within a traceable function and that tracing is enabled.`);return e}function Tm(n){return typeof n=="function"&&"langsmith:traceable"in n}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */const uI=Object.prototype.hasOwnProperty;function Pp(n,e){return uI.call(n,e)}function Dp(n){if(Array.isArray(n)){const t=new Array(n.length);for(let i=0;i<t.length;i++)t[i]=""+i;return t}if(Object.keys)return Object.keys(n);let e=[];for(let t in n)Pp(n,t)&&e.push(t);return e}function jn(n){switch(typeof n){case"object":return JSON.parse(JSON.stringify(n));case"undefined":return null;default:return n}}function Lp(n){let e=0;const t=n.length;let i;for(;e<t;){if(i=n.charCodeAt(e),i>=48&&i<=57){e++;continue}return!1}return!0}function Is(n){return n.indexOf("/")===-1&&n.indexOf("~")===-1?n:n.replace(/~/g,"~0").replace(/\//g,"~1")}function cI(n){return n.replace(/~1/g,"/").replace(/~0/g,"~")}function Up(n){if(n===void 0)return!0;if(n){if(Array.isArray(n)){for(let t=0,i=n.length;t<i;t++)if(Up(n[t]))return!0}else if(typeof n=="object"){const t=Dp(n),i=t.length;for(var e=0;e<i;e++)if(Up(n[t[e]]))return!0}}return!1}function Ab(n,e){const t=[n];for(const i in e){const r=typeof e[i]=="object"?JSON.stringify(e[i],null,2):e[i];typeof r<"u"&&t.push(`${i}: ${r}`)}return t.join(`
`)}class fI extends Error{constructor(e,t,i,r,a){super(Ab(e,{name:t,index:i,operation:r,tree:a})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.setPrototypeOf(this,new.target.prototype),this.message=Ab(e,{name:t,index:i,operation:r,tree:a})}}const ot=fI,Hs={add:function(n,e,t){return n[e]=this.value,{newDocument:t}},remove:function(n,e,t){var i=n[e];return delete n[e],{newDocument:t,removed:i}},replace:function(n,e,t){var i=n[e];return n[e]=this.value,{newDocument:t,removed:i}},move:function(n,e,t){let i=$p(t,this.path);i&&(i=jn(i));const r=No(t,{op:"remove",path:this.from}).removed;return No(t,{op:"add",path:this.path,value:r}),{newDocument:t,removed:i}},copy:function(n,e,t){const i=$p(t,this.from);return No(t,{op:"add",path:this.path,value:jn(i)}),{newDocument:t}},test:function(n,e,t){return{newDocument:t,test:Wu(n[e],this.value)}},_get:function(n,e,t){return this.value=n[e],{newDocument:t}}};var dI={add:function(n,e,t){return Lp(e)?n.splice(e,0,this.value):n[e]=this.value,{newDocument:t,index:e}},remove:function(n,e,t){var i=n.splice(e,1);return{newDocument:t,removed:i[0]}},replace:function(n,e,t){var i=n[e];return n[e]=this.value,{newDocument:t,removed:i}},move:Hs.move,copy:Hs.copy,test:Hs.test,_get:Hs._get};function $p(n,e){if(e=="")return n;var t={op:"_get",path:e};return No(n,t),t.value}function No(n,e,t=!1,i=!0,r=!0,a=0){if(t&&(typeof t=="function"?t(e,0,n,e.path):qp(e,0)),e.path===""){let l={newDocument:n};if(e.op==="add")return l.newDocument=e.value,l;if(e.op==="replace")return l.newDocument=e.value,l.removed=n,l;if(e.op==="move"||e.op==="copy")return l.newDocument=$p(n,e.from),e.op==="move"&&(l.removed=n),l;if(e.op==="test"){if(l.test=Wu(n,e.value),l.test===!1)throw new ot("Test operation failed","TEST_OPERATION_FAILED",a,e,n);return l.newDocument=n,l}else{if(e.op==="remove")return l.removed=n,l.newDocument=null,l;if(e.op==="_get")return e.value=n,l;if(t)throw new ot("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,e,n);return l}}else{i||(n=jn(n));const c=(e.path||"").split("/");let f=n,d=1,g=c.length,_,v,w;for(typeof t=="function"?w=t:w=qp;;){if(v=c[d],v&&v.indexOf("~")!=-1&&(v=cI(v)),r&&(v=="__proto__"||v=="prototype"&&d>0&&c[d-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(t&&_===void 0&&(f[v]===void 0?_=c.slice(0,d).join("/"):d==g-1&&(_=e.path),_!==void 0&&w(e,0,n,_)),d++,Array.isArray(f)){if(v==="-")v=f.length;else{if(t&&!Lp(v))throw new ot("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,e,n);Lp(v)&&(v=~~v)}if(d>=g){if(t&&e.op==="add"&&v>f.length)throw new ot("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,e,n);const T=dI[e.op].call(e,f,v,n);if(T.test===!1)throw new ot("Test operation failed","TEST_OPERATION_FAILED",a,e,n);return T}}else if(d>=g){const T=Hs[e.op].call(e,f,v,n);if(T.test===!1)throw new ot("Test operation failed","TEST_OPERATION_FAILED",a,e,n);return T}if(f=f[v],t&&d<g&&(!f||typeof f!="object"))throw new ot("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,e,n)}}}function Xu(n,e,t,i=!0,r=!0){if(t&&!Array.isArray(e))throw new ot("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(n=jn(n));const a=new Array(e.length);for(let l=0,c=e.length;l<c;l++)a[l]=No(n,e[l],t,!0,r,l),n=a[l].newDocument;return a.newDocument=n,a}function qp(n,e,t,i){if(typeof n!="object"||n===null||Array.isArray(n))throw new ot("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,n,t);if(Hs[n.op]){if(typeof n.path!="string")throw new ot("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,n,t);if(n.path.indexOf("/")!==0&&n.path.length>0)throw new ot('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,n,t);if((n.op==="move"||n.op==="copy")&&typeof n.from!="string")throw new ot("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,n,t);if((n.op==="add"||n.op==="replace"||n.op==="test")&&n.value===void 0)throw new ot("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,n,t);if((n.op==="add"||n.op==="replace"||n.op==="test")&&Up(n.value))throw new ot("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,n,t);if(t){if(n.op=="add"){var r=n.path.split("/").length,a=i.split("/").length;if(r!==a+1&&r!==a)throw new ot("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,n,t)}else if(n.op==="replace"||n.op==="remove"||n.op==="_get"){if(n.path!==i)throw new ot("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,n,t)}else if(n.op==="move"||n.op==="copy"){var l={op:"_get",path:n.from,value:void 0},c=hI([l],t);if(c&&c.name==="OPERATION_PATH_UNRESOLVABLE")throw new ot("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,n,t)}}}else throw new ot("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,n,t)}function hI(n,e,t){try{if(!Array.isArray(n))throw new ot("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)Xu(jn(e),jn(n),t||!0);else{t=t||qp;for(var i=0;i<n.length;i++)t(n[i],i,e,void 0)}}catch(r){if(r instanceof ot)return r;throw r}}function Wu(n,e){if(n===e)return!0;if(n&&e&&typeof n=="object"&&typeof e=="object"){var t=Array.isArray(n),i=Array.isArray(e),r,a,l;if(t&&i){if(a=n.length,a!=e.length)return!1;for(r=a;r--!==0;)if(!Wu(n[r],e[r]))return!1;return!0}if(t!=i)return!1;var c=Object.keys(n);if(a=c.length,a!==Object.keys(e).length)return!1;for(r=a;r--!==0;)if(!e.hasOwnProperty(c[r]))return!1;for(r=a;r--!==0;)if(l=c[r],!Wu(n[l],e[l]))return!1;return!0}return n!==n&&e!==e}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2013-2021 Joachim Wester
 * MIT license
 */function LE(n,e,t,i,r){if(e!==n){typeof e.toJSON=="function"&&(e=e.toJSON());for(var a=Dp(e),l=Dp(n),c=!1,f=l.length-1;f>=0;f--){var d=l[f],g=n[d];if(Pp(e,d)&&!(e[d]===void 0&&g!==void 0&&Array.isArray(e)===!1)){var _=e[d];typeof g=="object"&&g!=null&&typeof _=="object"&&_!=null&&Array.isArray(g)===Array.isArray(_)?LE(g,_,t,i+"/"+Is(d),r):g!==_&&(r&&t.push({op:"test",path:i+"/"+Is(d),value:jn(g)}),t.push({op:"replace",path:i+"/"+Is(d),value:jn(_)}))}else Array.isArray(n)===Array.isArray(e)?(r&&t.push({op:"test",path:i+"/"+Is(d),value:jn(g)}),t.push({op:"remove",path:i+"/"+Is(d)}),c=!0):(r&&t.push({op:"test",path:i,value:n}),t.push({op:"replace",path:i,value:e}))}if(!(!c&&a.length==l.length))for(var f=0;f<a.length;f++){var d=a[f];!Pp(n,d)&&e[d]!==void 0&&t.push({op:"add",path:i+"/"+Is(d),value:jn(e[d])})}}}function pI(n,e,t=!1){var i=[];return LE(n,e,i,"",t),i}const mI="gen_ai.operation.name",gI="gen_ai.system",Rb="gen_ai.request.model",yI="gen_ai.response.model",xb="gen_ai.usage.input_tokens",Ib="gen_ai.usage.output_tokens",Mb="gen_ai.usage.total_tokens",_I="gen_ai.request.max_tokens",vI="gen_ai.request.temperature",bI="gen_ai.request.top_p",wI="gen_ai.request.frequency_penalty",TI="gen_ai.request.presence_penalty",EI="gen_ai.response.finish_reasons",SI="gen_ai.prompt",CI="gen_ai.completion",AI="gen_ai.request.extra_query",RI="gen_ai.request.extra_body",xI="gen_ai.serialized.name",II="gen_ai.serialized.signature",MI="gen_ai.serialized.doc",NI="gen_ai.response.id",OI="gen_ai.response.service_tier",kI="gen_ai.response.system_fingerprint",PI="gen_ai.usage.input_token_details",DI="gen_ai.usage.output_token_details",LI="langsmith.trace.session_id",UI="langsmith.trace.session_name",$I="langsmith.span.kind",qI="langsmith.trace.name",BI="langsmith.metadata",Nb="langsmith.span.tags",GI="langsmith.request.streaming",VI="langsmith.request.headers",FI=(...n)=>fetch(...n),UE=Symbol.for("ls:fetch_implementation"),HI=()=>{const n=globalThis[UE];return n?typeof n=="function"&&"Headers"in n&&"Request"in n&&"Response"in n:!1},fe=n=>async(...e)=>{if(n||un("DEBUG")==="true"){const[i,r]=e;console.log(`→ ${r?.method||"GET"} ${i}`)}const t=await(globalThis[UE]??FI)(...e);return(n||un("DEBUG")==="true")&&console.log(`← ${t.status} ${t.statusText} ${t.url}`),t},$E=()=>un("PROJECT")??Kn("LANGCHAIN_SESSION")??"default",qE="0.3.52";var Bp={};let fi;const zI=()=>typeof window<"u"&&typeof window.document<"u",jI=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",JI=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&navigator.userAgent.includes("jsdom"),BE=()=>typeof Deno<"u",KI=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!BE(),YI=()=>fi||(zI()?fi="browser":KI()?fi="node":jI()?fi="webworker":JI()?fi="jsdom":BE()?fi="deno":fi="other",fi);let sh;function GE(){if(sh===void 0){const n=YI(),e=XI();sh={library:"langsmith",runtime:n,sdk:"langsmith-js",sdk_version:qE,...e}}return sh}function ZI(){const n=QI()||{},e={},t=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION","LANGSMITH_API_KEY","LANGSMITH_ENDPOINT","LANGSMITH_TRACING_V2","LANGSMITH_PROJECT","LANGSMITH_SESSION"];for(const[i,r]of Object.entries(n))(i.startsWith("LANGCHAIN_")||i.startsWith("LANGSMITH_"))&&typeof r=="string"&&!t.includes(i)&&!i.toLowerCase().includes("key")&&!i.toLowerCase().includes("secret")&&!i.toLowerCase().includes("token")&&(i==="LANGCHAIN_REVISION_ID"?e.revision_id=r:e[i]=r);return e}function QI(){try{return typeof process<"u"&&Bp?Object.entries(Bp).reduce((n,[e,t])=>(n[e]=String(t),n),{}):void 0}catch{return}}function Kn(n){try{return typeof process<"u"?Bp?.[n]:void 0}catch{return}}function un(n){return Kn(`LANGSMITH_${n}`)||Kn(`LANGCHAIN_${n}`)}let ah;function XI(){if(ah!==void 0)return ah;const n=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],e={};for(const t of n){const i=Kn(t);i!==void 0&&(e[t]=i)}return ah=e,e}function VE(){return Kn("OTEL_ENABLED")==="true"||un("OTEL_ENABLED")==="true"}class WI{constructor(){Object.defineProperty(this,"hasWarned",{enumerable:!0,configurable:!0,writable:!0,value:!1})}startActiveSpan(e,...t){!this.hasWarned&&VE()&&(console.warn('You have enabled OTEL export via the `OTEL_ENABLED` or `LANGSMITH_OTEL_ENABLED` environment variable, but have not initialized the required OTEL instances. Please add:\n```\nimport { initializeOTEL } from "langsmith/experimental/otel/setup";\ninitializeOTEL();\n```\nat the beginning of your code.'),this.hasWarned=!0);let i;if(t.length===1&&typeof t[0]=="function"?i=t[0]:t.length===2&&typeof t[1]=="function"?i=t[1]:t.length===3&&typeof t[2]=="function"&&(i=t[2]),typeof i=="function")return i()}}class eM{constructor(){Object.defineProperty(this,"mockTracer",{enumerable:!0,configurable:!0,writable:!0,value:new WI})}getTracer(e,t){return this.mockTracer}getActiveSpan(){}setSpan(e,t){return e}getSpan(e){}setSpanContext(e,t){return e}getTracerProvider(){}setGlobalTracerProvider(e){return!1}}class tM{active(){return{}}with(e,t){return t()}}const oh=Symbol.for("ls:otel_trace"),lh=Symbol.for("ls:otel_context"),Ob=Symbol.for("ls:otel_get_default_otlp_tracer_provider"),nM=new eM,iM=new tM;class rM{getTraceInstance(){return globalThis[oh]??nM}getContextInstance(){return globalThis[lh]??iM}initializeGlobalInstances(e){globalThis[oh]===void 0&&(globalThis[oh]=e.trace),globalThis[lh]===void 0&&(globalThis[lh]=e.context)}setDefaultOTLPTracerComponents(e){globalThis[Ob]=e}getDefaultOTLPTracerComponents(){return globalThis[Ob]??void 0}}const Em=new rM;function FE(){return Em.getTraceInstance()}function sM(){return Em.getContextInstance()}function aM(){return Em.getDefaultOTLPTracerComponents()}const oM={llm:"chat",tool:"execute_tool",retriever:"embeddings",embedding:"embeddings",prompt:"chat"};function lM(n){return oM[n]||n}class uM{constructor(){Object.defineProperty(this,"spans",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}exportBatch(e,t){for(const i of e)try{if(!i.run)continue;if(i.operation==="post"){const r=this.createSpanForRun(i,i.run,t.get(i.id));r&&!i.run.end_time&&this.spans.set(i.id,r)}else this.updateSpanForRun(i,i.run)}catch(r){console.error(`Error processing operation ${i.id}:`,r)}}createSpanForRun(e,t,i){const r=i&&FE().getSpan(i);if(r)try{return this.finishSpanSetup(r,t,e)}catch(a){console.error(`Failed to create span for run ${e.id}:`,a);return}}finishSpanSetup(e,t,i){return this.setSpanAttributes(e,t,i),t.error?(e.setStatus({code:2}),e.recordException(new Error(t.error))):e.setStatus({code:1}),t.end_time&&e.end(new Date(t.end_time)),e}updateSpanForRun(e,t){try{const i=this.spans.get(e.id);if(!i){console.debug(`No span found for run ${e.id} during update`);return}this.setSpanAttributes(i,t,e),t.error?(i.setStatus({code:2}),i.recordException(new Error(t.error))):i.setStatus({code:1});const r=t.end_time;r&&(i.end(new Date(r)),this.spans.delete(e.id))}catch(i){console.error(`Failed to update span for run ${e.id}:`,i)}}extractModelName(e){if(e.extra?.metadata){const t=e.extra.metadata;if(t.ls_model_name)return t.ls_model_name;if(t.invocation_params){const i=t.invocation_params;if(i.model)return i.model;if(i.model_name)return i.model_name}}}setSpanAttributes(e,t,i){if("run_type"in t&&t.run_type){e.setAttribute($I,t.run_type);const c=lM(t.run_type||"chain");e.setAttribute(mI,c)}"name"in t&&t.name&&e.setAttribute(qI,t.name),"session_id"in t&&t.session_id&&e.setAttribute(LI,t.session_id),"session_name"in t&&t.session_name&&e.setAttribute(UI,t.session_name),this.setGenAiSystem(e,t);const r=this.extractModelName(t);r&&e.setAttribute(Rb,r),"prompt_tokens"in t&&typeof t.prompt_tokens=="number"&&e.setAttribute(xb,t.prompt_tokens),"completion_tokens"in t&&typeof t.completion_tokens=="number"&&e.setAttribute(Ib,t.completion_tokens),"total_tokens"in t&&typeof t.total_tokens=="number"&&e.setAttribute(Mb,t.total_tokens),this.setInvocationParameters(e,t);const a=t.extra?.metadata||{};for(const[c,f]of Object.entries(a))f!=null&&e.setAttribute(`${BI}.${c}`,String(f));const l=t.tags;if(l&&Array.isArray(l)?e.setAttribute(Nb,l.join(", ")):l&&e.setAttribute(Nb,String(l)),"serialized"in t&&typeof t.serialized=="object"){const c=t.serialized;c.name&&e.setAttribute(xI,String(c.name)),c.signature&&e.setAttribute(II,String(c.signature)),c.doc&&e.setAttribute(MI,String(c.doc))}this.setIOAttributes(e,i)}setGenAiSystem(e,t){let i="langchain";const r=this.extractModelName(t);if(r){const a=r.toLowerCase();a.includes("anthropic")||a.startsWith("claude")?i="anthropic":a.includes("bedrock")?i="aws.bedrock":a.includes("azure")&&a.includes("openai")?i="az.ai.openai":a.includes("azure")&&a.includes("inference")?i="az.ai.inference":a.includes("cohere")?i="cohere":a.includes("deepseek")?i="deepseek":a.includes("gemini")?i="gemini":a.includes("groq")?i="groq":a.includes("watson")||a.includes("ibm")?i="ibm.watsonx.ai":a.includes("mistral")?i="mistral_ai":a.includes("gpt")||a.includes("openai")?i="openai":a.includes("perplexity")||a.includes("sonar")?i="perplexity":a.includes("vertex")?i="vertex_ai":(a.includes("xai")||a.includes("grok"))&&(i="xai")}e.setAttribute(gI,i)}setInvocationParameters(e,t){if(!t.extra?.metadata?.invocation_params)return;const i=t.extra.metadata.invocation_params;i.max_tokens!==void 0&&e.setAttribute(_I,i.max_tokens),i.temperature!==void 0&&e.setAttribute(vI,i.temperature),i.top_p!==void 0&&e.setAttribute(bI,i.top_p),i.frequency_penalty!==void 0&&e.setAttribute(wI,i.frequency_penalty),i.presence_penalty!==void 0&&e.setAttribute(TI,i.presence_penalty)}setIOAttributes(e,t){if(t.run.inputs)try{const i=t.run.inputs;typeof i=="object"&&i!==null&&(i.model&&Array.isArray(i.messages)&&e.setAttribute(Rb,i.model),i.stream!==void 0&&e.setAttribute(GI,i.stream),i.extra_headers&&e.setAttribute(VI,JSON.stringify(i.extra_headers)),i.extra_query&&e.setAttribute(AI,JSON.stringify(i.extra_query)),i.extra_body&&e.setAttribute(RI,JSON.stringify(i.extra_body))),e.setAttribute(SI,JSON.stringify(i))}catch(i){console.debug(`Failed to process inputs for run ${t.id}`,i)}if(t.run.outputs)try{const i=t.run.outputs,r=this.getUnifiedRunTokens(i);if(r&&(e.setAttribute(xb,r[0]),e.setAttribute(Ib,r[1]),e.setAttribute(Mb,r[0]+r[1])),i&&typeof i=="object"){if(i.model&&e.setAttribute(yI,String(i.model)),i.id&&e.setAttribute(NI,i.id),i.choices&&Array.isArray(i.choices)){const a=i.choices.map(l=>l.finish_reason).filter(l=>l).map(String);a.length>0&&e.setAttribute(EI,a.join(", "))}if(i.service_tier&&e.setAttribute(OI,i.service_tier),i.system_fingerprint&&e.setAttribute(kI,i.system_fingerprint),i.usage_metadata&&typeof i.usage_metadata=="object"){const a=i.usage_metadata;a.input_token_details&&e.setAttribute(PI,JSON.stringify(a.input_token_details)),a.output_token_details&&e.setAttribute(DI,JSON.stringify(a.output_token_details))}}e.setAttribute(CI,JSON.stringify(i))}catch(i){console.debug(`Failed to process outputs for run ${t.id}`,i)}}getUnifiedRunTokens(e){if(!e)return null;let t=this.extractUnifiedRunTokens(e.usage_metadata);if(t)return t;const i=Object.keys(e);for(const l of i){const c=e[l];if(!(!c||typeof c!="object")&&(t=this.extractUnifiedRunTokens(c.usage_metadata),t||c.lc===1&&c.kwargs&&typeof c.kwargs=="object"&&(t=this.extractUnifiedRunTokens(c.kwargs.usage_metadata),t)))return t}const r=e.generations||[];if(!Array.isArray(r))return null;const a=Array.isArray(r[0])?r.flat():r;for(const l of a)if(typeof l=="object"&&l.message&&typeof l.message=="object"&&l.message.kwargs&&typeof l.message.kwargs=="object"&&(t=this.extractUnifiedRunTokens(l.message.kwargs.usage_metadata),t))return t;return null}extractUnifiedRunTokens(e){return!e||typeof e!="object"||typeof e.input_tokens!="number"||typeof e.output_tokens!="number"?null:[e.input_tokens,e.output_tokens]}}var Au={},uh={exports:{}},kb;function cM(){return kb||(kb=1,function(n){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function r(f,d,g){this.fn=f,this.context=d,this.once=g||!1}function a(f,d,g,_,v){if(typeof g!="function")throw new TypeError("The listener must be a function");var w=new r(g,_||f,v),T=t?t+d:d;return f._events[T]?f._events[T].fn?f._events[T]=[f._events[T],w]:f._events[T].push(w):(f._events[T]=w,f._eventsCount++),f}function l(f,d){--f._eventsCount===0?f._events=new i:delete f._events[d]}function c(){this._events=new i,this._eventsCount=0}c.prototype.eventNames=function(){var d=[],g,_;if(this._eventsCount===0)return d;for(_ in g=this._events)e.call(g,_)&&d.push(t?_.slice(1):_);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(g)):d},c.prototype.listeners=function(d){var g=t?t+d:d,_=this._events[g];if(!_)return[];if(_.fn)return[_.fn];for(var v=0,w=_.length,T=new Array(w);v<w;v++)T[v]=_[v].fn;return T},c.prototype.listenerCount=function(d){var g=t?t+d:d,_=this._events[g];return _?_.fn?1:_.length:0},c.prototype.emit=function(d,g,_,v,w,T){var S=t?t+d:d;if(!this._events[S])return!1;var C=this._events[S],x=arguments.length,M,R;if(C.fn){switch(C.once&&this.removeListener(d,C.fn,void 0,!0),x){case 1:return C.fn.call(C.context),!0;case 2:return C.fn.call(C.context,g),!0;case 3:return C.fn.call(C.context,g,_),!0;case 4:return C.fn.call(C.context,g,_,v),!0;case 5:return C.fn.call(C.context,g,_,v,w),!0;case 6:return C.fn.call(C.context,g,_,v,w,T),!0}for(R=1,M=new Array(x-1);R<x;R++)M[R-1]=arguments[R];C.fn.apply(C.context,M)}else{var P=C.length,O;for(R=0;R<P;R++)switch(C[R].once&&this.removeListener(d,C[R].fn,void 0,!0),x){case 1:C[R].fn.call(C[R].context);break;case 2:C[R].fn.call(C[R].context,g);break;case 3:C[R].fn.call(C[R].context,g,_);break;case 4:C[R].fn.call(C[R].context,g,_,v);break;default:if(!M)for(O=1,M=new Array(x-1);O<x;O++)M[O-1]=arguments[O];C[R].fn.apply(C[R].context,M)}}return!0},c.prototype.on=function(d,g,_){return a(this,d,g,_,!1)},c.prototype.once=function(d,g,_){return a(this,d,g,_,!0)},c.prototype.removeListener=function(d,g,_,v){var w=t?t+d:d;if(!this._events[w])return this;if(!g)return l(this,w),this;var T=this._events[w];if(T.fn)T.fn===g&&(!v||T.once)&&(!_||T.context===_)&&l(this,w);else{for(var S=0,C=[],x=T.length;S<x;S++)(T[S].fn!==g||v&&!T[S].once||_&&T[S].context!==_)&&C.push(T[S]);C.length?this._events[w]=C.length===1?C[0]:C:l(this,w)}return this},c.prototype.removeAllListeners=function(d){var g;return d?(g=t?t+d:d,this._events[g]&&l(this,g)):(this._events=new i,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,n.exports=c}(uh)),uh.exports}var vo={exports:{}},ch,Pb;function fM(){return Pb||(Pb=1,ch=(n,e)=>(e=e||(()=>{}),n.then(t=>new Promise(i=>{i(e())}).then(()=>t),t=>new Promise(i=>{i(e())}).then(()=>{throw t})))),ch}var Db;function dM(){if(Db)return vo.exports;Db=1;const n=fM();class e extends Error{constructor(r){super(r),this.name="TimeoutError"}}const t=(i,r,a)=>new Promise((l,c)=>{if(typeof r!="number"||r<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(r===1/0){l(i);return}const f=setTimeout(()=>{if(typeof a=="function"){try{l(a())}catch(_){c(_)}return}const d=typeof a=="string"?a:`Promise timed out after ${r} milliseconds`,g=a instanceof Error?a:new e(d);typeof i.cancel=="function"&&i.cancel(),c(g)},r);n(i.then(l,c),()=>{clearTimeout(f)})});return vo.exports=t,vo.exports.default=t,vo.exports.TimeoutError=e,vo.exports}var Ru={},xu={},Lb;function hM(){if(Lb)return xu;Lb=1,Object.defineProperty(xu,"__esModule",{value:!0});function n(e,t,i){let r=0,a=e.length;for(;a>0;){const l=a/2|0;let c=r+l;i(e[c],t)<=0?(r=++c,a-=l+1):a=l}return r}return xu.default=n,xu}var Ub;function pM(){if(Ub)return Ru;Ub=1,Object.defineProperty(Ru,"__esModule",{value:!0});const n=hM();class e{constructor(){this._queue=[]}enqueue(i,r){r=Object.assign({priority:0},r);const a={priority:r.priority,run:i};if(this.size&&this._queue[this.size-1].priority>=r.priority){this._queue.push(a);return}const l=n.default(this._queue,a,(c,f)=>f.priority-c.priority);this._queue.splice(l,0,a)}dequeue(){const i=this._queue.shift();return i?.run}filter(i){return this._queue.filter(r=>r.priority===i.priority).map(r=>r.run)}get size(){return this._queue.length}}return Ru.default=e,Ru}var $b;function mM(){if($b)return Au;$b=1,Object.defineProperty(Au,"__esModule",{value:!0});const n=cM(),e=dM(),t=pM(),i=()=>{},r=new e.TimeoutError;class a extends n{constructor(c){var f,d,g,_;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=i,this._resolveIdle=i,c=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:t.default},c),!(typeof c.intervalCap=="number"&&c.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(d=(f=c.intervalCap)===null||f===void 0?void 0:f.toString())!==null&&d!==void 0?d:""}\` (${typeof c.intervalCap})`);if(c.interval===void 0||!(Number.isFinite(c.interval)&&c.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(_=(g=c.interval)===null||g===void 0?void 0:g.toString())!==null&&_!==void 0?_:""}\` (${typeof c.interval})`);this._carryoverConcurrencyCount=c.carryoverConcurrencyCount,this._isIntervalIgnored=c.intervalCap===1/0||c.interval===0,this._intervalCap=c.intervalCap,this._interval=c.interval,this._queue=new c.queueClass,this._queueClass=c.queueClass,this.concurrency=c.concurrency,this._timeout=c.timeout,this._throwOnTimeout=c.throwOnTimeout===!0,this._isPaused=c.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=i,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=i,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const c=Date.now();if(this._intervalId===void 0){const f=this._intervalEnd-c;if(f<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},f)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const c=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const f=this._queue.dequeue();return f?(this.emit("active"),f(),c&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(c){if(!(typeof c=="number"&&c>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${c}\` (${typeof c})`);this._concurrency=c,this._processQueue()}async add(c,f={}){return new Promise((d,g)=>{const _=async()=>{this._pendingCount++,this._intervalCount++;try{const v=this._timeout===void 0&&f.timeout===void 0?c():e.default(Promise.resolve(c()),f.timeout===void 0?this._timeout:f.timeout,()=>{(f.throwOnTimeout===void 0?this._throwOnTimeout:f.throwOnTimeout)&&g(r)});d(await v)}catch(v){g(v)}this._next()};this._queue.enqueue(_,f),this._tryToStartAnother(),this.emit("add")})}async addAll(c,f){return Promise.all(c.map(async d=>this.add(d,f)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(c=>{const f=this._resolveEmpty;this._resolveEmpty=()=>{f(),c()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(c=>{const f=this._resolveIdle;this._resolveIdle=()=>{f(),c()}})}get size(){return this._queue.size}sizeBy(c){return this._queue.filter(c).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(c){this._timeout=c}}return Au.default=a,Au}var gM=mM();const mi=aa(gM),yM=[400,401,403,404,405,406,407,408],_M=[409];let qb=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.debug=e.debug,"default"in mi?this.queue=new mi.default({concurrency:this.maxConcurrency}):this.queue=new mi({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e?.onFailedResponseHook}call(e,...t){const i=this.onFailedResponseHook;return this.queue.add(()=>Qu(()=>e(...t).catch(r=>{throw r instanceof Error?r:new Error(r)}),{async onFailedAttempt(r){if(r.message.startsWith("Cancel")||r.message.startsWith("TimeoutError")||r.message.startsWith("AbortError")||r?.code==="ECONNABORTED")throw r;const a=r?.response,l=a?.status;if(l){if(yM.includes(+l))throw r;if(_M.includes(+l))return;i&&await i(a)}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...i){return e.signal?Promise.race([this.call(t,...i),new Promise((r,a)=>{e.signal?.addEventListener("abort",()=>{a(new Error("AbortError"))})})]):this.call(t,...i)}fetch(...e){return this.call(()=>fe(this.debug)(...e).then(t=>t.ok?t:Promise.reject(t)))}};function Bb(n){return typeof n?._getType=="function"}function Gb(n){const e={type:n._getType(),data:{content:n.content}};return n?.additional_kwargs&&Object.keys(n.additional_kwargs).length>0&&(e.data.additional_kwargs={...n.additional_kwargs}),e}const vM=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function ve(n,e){if(!vM.test(n)){const t=e!==void 0?`Invalid UUID for ${e}: ${n}`:`Invalid UUID: ${n}`;throw new Error(t)}return n}const Vb={};function HE(n){Vb[n]||(console.warn(n),Vb[n]=!0)}var Iu={exports:{}},fh,Fb;function dc(){if(Fb)return fh;Fb=1;const n="2.0.0",e=256,t=Number.MAX_SAFE_INTEGER||9007199254740991,i=16,r=e-6;return fh={MAX_LENGTH:e,MAX_SAFE_COMPONENT_LENGTH:i,MAX_SAFE_BUILD_LENGTH:r,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:n,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},fh}var dh,Hb;function hc(){if(Hb)return dh;Hb=1;var n={};return dh=typeof process=="object"&&n&&n.NODE_DEBUG&&/\bsemver\b/i.test(n.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{},dh}var zb;function Qo(){return zb||(zb=1,function(n,e){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:r}=dc(),a=hc();e=n.exports={};const l=e.re=[],c=e.safeRe=[],f=e.src=[],d=e.safeSrc=[],g=e.t={};let _=0;const v="[a-zA-Z0-9-]",w=[["\\s",1],["\\d",r],[v,i]],T=C=>{for(const[x,M]of w)C=C.split(`${x}*`).join(`${x}{0,${M}}`).split(`${x}+`).join(`${x}{1,${M}}`);return C},S=(C,x,M)=>{const R=T(x),P=_++;a(C,P,x),g[C]=P,f[P]=x,d[P]=R,l[P]=new RegExp(x,M?"g":void 0),c[P]=new RegExp(R,M?"g":void 0)};S("NUMERICIDENTIFIER","0|[1-9]\\d*"),S("NUMERICIDENTIFIERLOOSE","\\d+"),S("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${v}*`),S("MAINVERSION",`(${f[g.NUMERICIDENTIFIER]})\\.(${f[g.NUMERICIDENTIFIER]})\\.(${f[g.NUMERICIDENTIFIER]})`),S("MAINVERSIONLOOSE",`(${f[g.NUMERICIDENTIFIERLOOSE]})\\.(${f[g.NUMERICIDENTIFIERLOOSE]})\\.(${f[g.NUMERICIDENTIFIERLOOSE]})`),S("PRERELEASEIDENTIFIER",`(?:${f[g.NONNUMERICIDENTIFIER]}|${f[g.NUMERICIDENTIFIER]})`),S("PRERELEASEIDENTIFIERLOOSE",`(?:${f[g.NONNUMERICIDENTIFIER]}|${f[g.NUMERICIDENTIFIERLOOSE]})`),S("PRERELEASE",`(?:-(${f[g.PRERELEASEIDENTIFIER]}(?:\\.${f[g.PRERELEASEIDENTIFIER]})*))`),S("PRERELEASELOOSE",`(?:-?(${f[g.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${f[g.PRERELEASEIDENTIFIERLOOSE]})*))`),S("BUILDIDENTIFIER",`${v}+`),S("BUILD",`(?:\\+(${f[g.BUILDIDENTIFIER]}(?:\\.${f[g.BUILDIDENTIFIER]})*))`),S("FULLPLAIN",`v?${f[g.MAINVERSION]}${f[g.PRERELEASE]}?${f[g.BUILD]}?`),S("FULL",`^${f[g.FULLPLAIN]}$`),S("LOOSEPLAIN",`[v=\\s]*${f[g.MAINVERSIONLOOSE]}${f[g.PRERELEASELOOSE]}?${f[g.BUILD]}?`),S("LOOSE",`^${f[g.LOOSEPLAIN]}$`),S("GTLT","((?:<|>)?=?)"),S("XRANGEIDENTIFIERLOOSE",`${f[g.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),S("XRANGEIDENTIFIER",`${f[g.NUMERICIDENTIFIER]}|x|X|\\*`),S("XRANGEPLAIN",`[v=\\s]*(${f[g.XRANGEIDENTIFIER]})(?:\\.(${f[g.XRANGEIDENTIFIER]})(?:\\.(${f[g.XRANGEIDENTIFIER]})(?:${f[g.PRERELEASE]})?${f[g.BUILD]}?)?)?`),S("XRANGEPLAINLOOSE",`[v=\\s]*(${f[g.XRANGEIDENTIFIERLOOSE]})(?:\\.(${f[g.XRANGEIDENTIFIERLOOSE]})(?:\\.(${f[g.XRANGEIDENTIFIERLOOSE]})(?:${f[g.PRERELEASELOOSE]})?${f[g.BUILD]}?)?)?`),S("XRANGE",`^${f[g.GTLT]}\\s*${f[g.XRANGEPLAIN]}$`),S("XRANGELOOSE",`^${f[g.GTLT]}\\s*${f[g.XRANGEPLAINLOOSE]}$`),S("COERCEPLAIN",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?`),S("COERCE",`${f[g.COERCEPLAIN]}(?:$|[^\\d])`),S("COERCEFULL",f[g.COERCEPLAIN]+`(?:${f[g.PRERELEASE]})?(?:${f[g.BUILD]})?(?:$|[^\\d])`),S("COERCERTL",f[g.COERCE],!0),S("COERCERTLFULL",f[g.COERCEFULL],!0),S("LONETILDE","(?:~>?)"),S("TILDETRIM",`(\\s*)${f[g.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",S("TILDE",`^${f[g.LONETILDE]}${f[g.XRANGEPLAIN]}$`),S("TILDELOOSE",`^${f[g.LONETILDE]}${f[g.XRANGEPLAINLOOSE]}$`),S("LONECARET","(?:\\^)"),S("CARETTRIM",`(\\s*)${f[g.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",S("CARET",`^${f[g.LONECARET]}${f[g.XRANGEPLAIN]}$`),S("CARETLOOSE",`^${f[g.LONECARET]}${f[g.XRANGEPLAINLOOSE]}$`),S("COMPARATORLOOSE",`^${f[g.GTLT]}\\s*(${f[g.LOOSEPLAIN]})$|^$`),S("COMPARATOR",`^${f[g.GTLT]}\\s*(${f[g.FULLPLAIN]})$|^$`),S("COMPARATORTRIM",`(\\s*)${f[g.GTLT]}\\s*(${f[g.LOOSEPLAIN]}|${f[g.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",S("HYPHENRANGE",`^\\s*(${f[g.XRANGEPLAIN]})\\s+-\\s+(${f[g.XRANGEPLAIN]})\\s*$`),S("HYPHENRANGELOOSE",`^\\s*(${f[g.XRANGEPLAINLOOSE]})\\s+-\\s+(${f[g.XRANGEPLAINLOOSE]})\\s*$`),S("STAR","(<|>)?=?\\s*\\*"),S("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),S("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(Iu,Iu.exports)),Iu.exports}var hh,jb;function Sm(){if(jb)return hh;jb=1;const n=Object.freeze({loose:!0}),e=Object.freeze({});return hh=i=>i?typeof i!="object"?n:i:e,hh}var ph,Jb;function zE(){if(Jb)return ph;Jb=1;const n=/^[0-9]+$/,e=(i,r)=>{const a=n.test(i),l=n.test(r);return a&&l&&(i=+i,r=+r),i===r?0:a&&!l?-1:l&&!a?1:i<r?-1:1};return ph={compareIdentifiers:e,rcompareIdentifiers:(i,r)=>e(r,i)},ph}var mh,Kb;function qt(){if(Kb)return mh;Kb=1;const n=hc(),{MAX_LENGTH:e,MAX_SAFE_INTEGER:t}=dc(),{safeRe:i,t:r}=Qo(),a=Sm(),{compareIdentifiers:l}=zE();class c{constructor(d,g){if(g=a(g),d instanceof c){if(d.loose===!!g.loose&&d.includePrerelease===!!g.includePrerelease)return d;d=d.version}else if(typeof d!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof d}".`);if(d.length>e)throw new TypeError(`version is longer than ${e} characters`);n("SemVer",d,g),this.options=g,this.loose=!!g.loose,this.includePrerelease=!!g.includePrerelease;const _=d.trim().match(g.loose?i[r.LOOSE]:i[r.FULL]);if(!_)throw new TypeError(`Invalid Version: ${d}`);if(this.raw=d,this.major=+_[1],this.minor=+_[2],this.patch=+_[3],this.major>t||this.major<0)throw new TypeError("Invalid major version");if(this.minor>t||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>t||this.patch<0)throw new TypeError("Invalid patch version");_[4]?this.prerelease=_[4].split(".").map(v=>{if(/^[0-9]+$/.test(v)){const w=+v;if(w>=0&&w<t)return w}return v}):this.prerelease=[],this.build=_[5]?_[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(d){if(n("SemVer.compare",this.version,this.options,d),!(d instanceof c)){if(typeof d=="string"&&d===this.version)return 0;d=new c(d,this.options)}return d.version===this.version?0:this.compareMain(d)||this.comparePre(d)}compareMain(d){return d instanceof c||(d=new c(d,this.options)),l(this.major,d.major)||l(this.minor,d.minor)||l(this.patch,d.patch)}comparePre(d){if(d instanceof c||(d=new c(d,this.options)),this.prerelease.length&&!d.prerelease.length)return-1;if(!this.prerelease.length&&d.prerelease.length)return 1;if(!this.prerelease.length&&!d.prerelease.length)return 0;let g=0;do{const _=this.prerelease[g],v=d.prerelease[g];if(n("prerelease compare",g,_,v),_===void 0&&v===void 0)return 0;if(v===void 0)return 1;if(_===void 0)return-1;if(_===v)continue;return l(_,v)}while(++g)}compareBuild(d){d instanceof c||(d=new c(d,this.options));let g=0;do{const _=this.build[g],v=d.build[g];if(n("build compare",g,_,v),_===void 0&&v===void 0)return 0;if(v===void 0)return 1;if(_===void 0)return-1;if(_===v)continue;return l(_,v)}while(++g)}inc(d,g,_){if(d.startsWith("pre")){if(!g&&_===!1)throw new Error("invalid increment argument: identifier is empty");if(g){const v=`-${g}`.match(this.options.loose?i[r.PRERELEASELOOSE]:i[r.PRERELEASE]);if(!v||v[1]!==g)throw new Error(`invalid identifier: ${g}`)}}switch(d){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",g,_);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",g,_);break;case"prepatch":this.prerelease.length=0,this.inc("patch",g,_),this.inc("pre",g,_);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",g,_),this.inc("pre",g,_);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const v=Number(_)?1:0;if(this.prerelease.length===0)this.prerelease=[v];else{let w=this.prerelease.length;for(;--w>=0;)typeof this.prerelease[w]=="number"&&(this.prerelease[w]++,w=-2);if(w===-1){if(g===this.prerelease.join(".")&&_===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(v)}}if(g){let w=[g,v];_===!1&&(w=[g]),l(this.prerelease[0],g)===0?isNaN(this.prerelease[1])&&(this.prerelease=w):this.prerelease=w}break}default:throw new Error(`invalid increment argument: ${d}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return mh=c,mh}var gh,Yb;function oa(){if(Yb)return gh;Yb=1;const n=qt();return gh=(t,i,r=!1)=>{if(t instanceof n)return t;try{return new n(t,i)}catch(a){if(!r)return null;throw a}},gh}var yh,Zb;function bM(){if(Zb)return yh;Zb=1;const n=oa();return yh=(t,i)=>{const r=n(t,i);return r?r.version:null},yh}var _h,Qb;function wM(){if(Qb)return _h;Qb=1;const n=oa();return _h=(t,i)=>{const r=n(t.trim().replace(/^[=v]+/,""),i);return r?r.version:null},_h}var vh,Xb;function TM(){if(Xb)return vh;Xb=1;const n=qt();return vh=(t,i,r,a,l)=>{typeof r=="string"&&(l=a,a=r,r=void 0);try{return new n(t instanceof n?t.version:t,r).inc(i,a,l).version}catch{return null}},vh}var bh,Wb;function EM(){if(Wb)return bh;Wb=1;const n=oa();return bh=(t,i)=>{const r=n(t,null,!0),a=n(i,null,!0),l=r.compare(a);if(l===0)return null;const c=l>0,f=c?r:a,d=c?a:r,g=!!f.prerelease.length;if(!!d.prerelease.length&&!g){if(!d.patch&&!d.minor)return"major";if(d.compareMain(f)===0)return d.minor&&!d.patch?"minor":"patch"}const v=g?"pre":"";return r.major!==a.major?v+"major":r.minor!==a.minor?v+"minor":r.patch!==a.patch?v+"patch":"prerelease"},bh}var wh,e0;function SM(){if(e0)return wh;e0=1;const n=qt();return wh=(t,i)=>new n(t,i).major,wh}var Th,t0;function CM(){if(t0)return Th;t0=1;const n=qt();return Th=(t,i)=>new n(t,i).minor,Th}var Eh,n0;function AM(){if(n0)return Eh;n0=1;const n=qt();return Eh=(t,i)=>new n(t,i).patch,Eh}var Sh,i0;function RM(){if(i0)return Sh;i0=1;const n=oa();return Sh=(t,i)=>{const r=n(t,i);return r&&r.prerelease.length?r.prerelease:null},Sh}var Ch,r0;function $n(){if(r0)return Ch;r0=1;const n=qt();return Ch=(t,i,r)=>new n(t,r).compare(new n(i,r)),Ch}var Ah,s0;function xM(){if(s0)return Ah;s0=1;const n=$n();return Ah=(t,i,r)=>n(i,t,r),Ah}var Rh,a0;function IM(){if(a0)return Rh;a0=1;const n=$n();return Rh=(t,i)=>n(t,i,!0),Rh}var xh,o0;function Cm(){if(o0)return xh;o0=1;const n=qt();return xh=(t,i,r)=>{const a=new n(t,r),l=new n(i,r);return a.compare(l)||a.compareBuild(l)},xh}var Ih,l0;function MM(){if(l0)return Ih;l0=1;const n=Cm();return Ih=(t,i)=>t.sort((r,a)=>n(r,a,i)),Ih}var Mh,u0;function NM(){if(u0)return Mh;u0=1;const n=Cm();return Mh=(t,i)=>t.sort((r,a)=>n(a,r,i)),Mh}var Nh,c0;function pc(){if(c0)return Nh;c0=1;const n=$n();return Nh=(t,i,r)=>n(t,i,r)>0,Nh}var Oh,f0;function Am(){if(f0)return Oh;f0=1;const n=$n();return Oh=(t,i,r)=>n(t,i,r)<0,Oh}var kh,d0;function jE(){if(d0)return kh;d0=1;const n=$n();return kh=(t,i,r)=>n(t,i,r)===0,kh}var Ph,h0;function JE(){if(h0)return Ph;h0=1;const n=$n();return Ph=(t,i,r)=>n(t,i,r)!==0,Ph}var Dh,p0;function Rm(){if(p0)return Dh;p0=1;const n=$n();return Dh=(t,i,r)=>n(t,i,r)>=0,Dh}var Lh,m0;function xm(){if(m0)return Lh;m0=1;const n=$n();return Lh=(t,i,r)=>n(t,i,r)<=0,Lh}var Uh,g0;function KE(){if(g0)return Uh;g0=1;const n=jE(),e=JE(),t=pc(),i=Rm(),r=Am(),a=xm();return Uh=(c,f,d,g)=>{switch(f){case"===":return typeof c=="object"&&(c=c.version),typeof d=="object"&&(d=d.version),c===d;case"!==":return typeof c=="object"&&(c=c.version),typeof d=="object"&&(d=d.version),c!==d;case"":case"=":case"==":return n(c,d,g);case"!=":return e(c,d,g);case">":return t(c,d,g);case">=":return i(c,d,g);case"<":return r(c,d,g);case"<=":return a(c,d,g);default:throw new TypeError(`Invalid operator: ${f}`)}},Uh}var $h,y0;function OM(){if(y0)return $h;y0=1;const n=qt(),e=oa(),{safeRe:t,t:i}=Qo();return $h=(a,l)=>{if(a instanceof n)return a;if(typeof a=="number"&&(a=String(a)),typeof a!="string")return null;l=l||{};let c=null;if(!l.rtl)c=a.match(l.includePrerelease?t[i.COERCEFULL]:t[i.COERCE]);else{const w=l.includePrerelease?t[i.COERCERTLFULL]:t[i.COERCERTL];let T;for(;(T=w.exec(a))&&(!c||c.index+c[0].length!==a.length);)(!c||T.index+T[0].length!==c.index+c[0].length)&&(c=T),w.lastIndex=T.index+T[1].length+T[2].length;w.lastIndex=-1}if(c===null)return null;const f=c[2],d=c[3]||"0",g=c[4]||"0",_=l.includePrerelease&&c[5]?`-${c[5]}`:"",v=l.includePrerelease&&c[6]?`+${c[6]}`:"";return e(`${f}.${d}.${g}${_}${v}`,l)},$h}var qh,_0;function kM(){if(_0)return qh;_0=1;class n{constructor(){this.max=1e3,this.map=new Map}get(t){const i=this.map.get(t);if(i!==void 0)return this.map.delete(t),this.map.set(t,i),i}delete(t){return this.map.delete(t)}set(t,i){if(!this.delete(t)&&i!==void 0){if(this.map.size>=this.max){const a=this.map.keys().next().value;this.delete(a)}this.map.set(t,i)}return this}}return qh=n,qh}var Bh,v0;function qn(){if(v0)return Bh;v0=1;const n=/\s+/g;class e{constructor(Y,L){if(L=r(L),Y instanceof e)return Y.loose===!!L.loose&&Y.includePrerelease===!!L.includePrerelease?Y:new e(Y.raw,L);if(Y instanceof a)return this.raw=Y.value,this.set=[[Y]],this.formatted=void 0,this;if(this.options=L,this.loose=!!L.loose,this.includePrerelease=!!L.includePrerelease,this.raw=Y.trim().replace(n," "),this.set=this.raw.split("||").map(F=>this.parseRange(F.trim())).filter(F=>F.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const F=this.set[0];if(this.set=this.set.filter(Q=>!S(Q[0])),this.set.length===0)this.set=[F];else if(this.set.length>1){for(const Q of this.set)if(Q.length===1&&C(Q[0])){this.set=[Q];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let Y=0;Y<this.set.length;Y++){Y>0&&(this.formatted+="||");const L=this.set[Y];for(let F=0;F<L.length;F++)F>0&&(this.formatted+=" "),this.formatted+=L[F].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(Y){const F=((this.options.includePrerelease&&w)|(this.options.loose&&T))+":"+Y,Q=i.get(F);if(Q)return Q;const te=this.options.loose,I=te?f[d.HYPHENRANGELOOSE]:f[d.HYPHENRANGE];Y=Y.replace(I,Ue(this.options.includePrerelease)),l("hyphen replace",Y),Y=Y.replace(f[d.COMPARATORTRIM],g),l("comparator trim",Y),Y=Y.replace(f[d.TILDETRIM],_),l("tilde trim",Y),Y=Y.replace(f[d.CARETTRIM],v),l("caret trim",Y);let G=Y.split(" ").map(de=>M(de,this.options)).join(" ").split(/\s+/).map(de=>ye(de,this.options));te&&(G=G.filter(de=>(l("loose invalid filter",de,this.options),!!de.match(f[d.COMPARATORLOOSE])))),l("range list",G);const K=new Map,X=G.map(de=>new a(de,this.options));for(const de of X){if(S(de))return[de];K.set(de.value,de)}K.size>1&&K.has("")&&K.delete("");const se=[...K.values()];return i.set(F,se),se}intersects(Y,L){if(!(Y instanceof e))throw new TypeError("a Range is required");return this.set.some(F=>x(F,L)&&Y.set.some(Q=>x(Q,L)&&F.every(te=>Q.every(I=>te.intersects(I,L)))))}test(Y){if(!Y)return!1;if(typeof Y=="string")try{Y=new c(Y,this.options)}catch{return!1}for(let L=0;L<this.set.length;L++)if(Gt(this.set[L],Y,this.options))return!0;return!1}}Bh=e;const t=kM(),i=new t,r=Sm(),a=mc(),l=hc(),c=qt(),{safeRe:f,t:d,comparatorTrimReplace:g,tildeTrimReplace:_,caretTrimReplace:v}=Qo(),{FLAG_INCLUDE_PRERELEASE:w,FLAG_LOOSE:T}=dc(),S=ne=>ne.value==="<0.0.0-0",C=ne=>ne.value==="",x=(ne,Y)=>{let L=!0;const F=ne.slice();let Q=F.pop();for(;L&&F.length;)L=F.every(te=>Q.intersects(te,Y)),Q=F.pop();return L},M=(ne,Y)=>(l("comp",ne,Y),ne=V(ne,Y),l("caret",ne),ne=P(ne,Y),l("tildes",ne),ne=Z(ne,Y),l("xrange",ne),ne=Se(ne,Y),l("stars",ne),ne),R=ne=>!ne||ne.toLowerCase()==="x"||ne==="*",P=(ne,Y)=>ne.trim().split(/\s+/).map(L=>O(L,Y)).join(" "),O=(ne,Y)=>{const L=Y.loose?f[d.TILDELOOSE]:f[d.TILDE];return ne.replace(L,(F,Q,te,I,G)=>{l("tilde",ne,F,Q,te,I,G);let K;return R(Q)?K="":R(te)?K=`>=${Q}.0.0 <${+Q+1}.0.0-0`:R(I)?K=`>=${Q}.${te}.0 <${Q}.${+te+1}.0-0`:G?(l("replaceTilde pr",G),K=`>=${Q}.${te}.${I}-${G} <${Q}.${+te+1}.0-0`):K=`>=${Q}.${te}.${I} <${Q}.${+te+1}.0-0`,l("tilde return",K),K})},V=(ne,Y)=>ne.trim().split(/\s+/).map(L=>J(L,Y)).join(" "),J=(ne,Y)=>{l("caret",ne,Y);const L=Y.loose?f[d.CARETLOOSE]:f[d.CARET],F=Y.includePrerelease?"-0":"";return ne.replace(L,(Q,te,I,G,K)=>{l("caret",ne,Q,te,I,G,K);let X;return R(te)?X="":R(I)?X=`>=${te}.0.0${F} <${+te+1}.0.0-0`:R(G)?te==="0"?X=`>=${te}.${I}.0${F} <${te}.${+I+1}.0-0`:X=`>=${te}.${I}.0${F} <${+te+1}.0.0-0`:K?(l("replaceCaret pr",K),te==="0"?I==="0"?X=`>=${te}.${I}.${G}-${K} <${te}.${I}.${+G+1}-0`:X=`>=${te}.${I}.${G}-${K} <${te}.${+I+1}.0-0`:X=`>=${te}.${I}.${G}-${K} <${+te+1}.0.0-0`):(l("no pr"),te==="0"?I==="0"?X=`>=${te}.${I}.${G}${F} <${te}.${I}.${+G+1}-0`:X=`>=${te}.${I}.${G}${F} <${te}.${+I+1}.0-0`:X=`>=${te}.${I}.${G} <${+te+1}.0.0-0`),l("caret return",X),X})},Z=(ne,Y)=>(l("replaceXRanges",ne,Y),ne.split(/\s+/).map(L=>re(L,Y)).join(" ")),re=(ne,Y)=>{ne=ne.trim();const L=Y.loose?f[d.XRANGELOOSE]:f[d.XRANGE];return ne.replace(L,(F,Q,te,I,G,K)=>{l("xRange",ne,F,Q,te,I,G,K);const X=R(te),se=X||R(I),de=se||R(G),pe=de;return Q==="="&&pe&&(Q=""),K=Y.includePrerelease?"-0":"",X?Q===">"||Q==="<"?F="<0.0.0-0":F="*":Q&&pe?(se&&(I=0),G=0,Q===">"?(Q=">=",se?(te=+te+1,I=0,G=0):(I=+I+1,G=0)):Q==="<="&&(Q="<",se?te=+te+1:I=+I+1),Q==="<"&&(K="-0"),F=`${Q+te}.${I}.${G}${K}`):se?F=`>=${te}.0.0${K} <${+te+1}.0.0-0`:de&&(F=`>=${te}.${I}.0${K} <${te}.${+I+1}.0-0`),l("xRange return",F),F})},Se=(ne,Y)=>(l("replaceStars",ne,Y),ne.trim().replace(f[d.STAR],"")),ye=(ne,Y)=>(l("replaceGTE0",ne,Y),ne.trim().replace(f[Y.includePrerelease?d.GTE0PRE:d.GTE0],"")),Ue=ne=>(Y,L,F,Q,te,I,G,K,X,se,de,pe)=>(R(F)?L="":R(Q)?L=`>=${F}.0.0${ne?"-0":""}`:R(te)?L=`>=${F}.${Q}.0${ne?"-0":""}`:I?L=`>=${L}`:L=`>=${L}${ne?"-0":""}`,R(X)?K="":R(se)?K=`<${+X+1}.0.0-0`:R(de)?K=`<${X}.${+se+1}.0-0`:pe?K=`<=${X}.${se}.${de}-${pe}`:ne?K=`<${X}.${se}.${+de+1}-0`:K=`<=${K}`,`${L} ${K}`.trim()),Gt=(ne,Y,L)=>{for(let F=0;F<ne.length;F++)if(!ne[F].test(Y))return!1;if(Y.prerelease.length&&!L.includePrerelease){for(let F=0;F<ne.length;F++)if(l(ne[F].semver),ne[F].semver!==a.ANY&&ne[F].semver.prerelease.length>0){const Q=ne[F].semver;if(Q.major===Y.major&&Q.minor===Y.minor&&Q.patch===Y.patch)return!0}return!1}return!0};return Bh}var Gh,b0;function mc(){if(b0)return Gh;b0=1;const n=Symbol("SemVer ANY");class e{static get ANY(){return n}constructor(g,_){if(_=t(_),g instanceof e){if(g.loose===!!_.loose)return g;g=g.value}g=g.trim().split(/\s+/).join(" "),l("comparator",g,_),this.options=_,this.loose=!!_.loose,this.parse(g),this.semver===n?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(g){const _=this.options.loose?i[r.COMPARATORLOOSE]:i[r.COMPARATOR],v=g.match(_);if(!v)throw new TypeError(`Invalid comparator: ${g}`);this.operator=v[1]!==void 0?v[1]:"",this.operator==="="&&(this.operator=""),v[2]?this.semver=new c(v[2],this.options.loose):this.semver=n}toString(){return this.value}test(g){if(l("Comparator.test",g,this.options.loose),this.semver===n||g===n)return!0;if(typeof g=="string")try{g=new c(g,this.options)}catch{return!1}return a(g,this.operator,this.semver,this.options)}intersects(g,_){if(!(g instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new f(g.value,_).test(this.value):g.operator===""?g.value===""?!0:new f(this.value,_).test(g.semver):(_=t(_),_.includePrerelease&&(this.value==="<0.0.0-0"||g.value==="<0.0.0-0")||!_.includePrerelease&&(this.value.startsWith("<0.0.0")||g.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&g.operator.startsWith(">")||this.operator.startsWith("<")&&g.operator.startsWith("<")||this.semver.version===g.semver.version&&this.operator.includes("=")&&g.operator.includes("=")||a(this.semver,"<",g.semver,_)&&this.operator.startsWith(">")&&g.operator.startsWith("<")||a(this.semver,">",g.semver,_)&&this.operator.startsWith("<")&&g.operator.startsWith(">")))}}Gh=e;const t=Sm(),{safeRe:i,t:r}=Qo(),a=KE(),l=hc(),c=qt(),f=qn();return Gh}var Vh,w0;function gc(){if(w0)return Vh;w0=1;const n=qn();return Vh=(t,i,r)=>{try{i=new n(i,r)}catch{return!1}return i.test(t)},Vh}var Fh,T0;function PM(){if(T0)return Fh;T0=1;const n=qn();return Fh=(t,i)=>new n(t,i).set.map(r=>r.map(a=>a.value).join(" ").trim().split(" ")),Fh}var Hh,E0;function DM(){if(E0)return Hh;E0=1;const n=qt(),e=qn();return Hh=(i,r,a)=>{let l=null,c=null,f=null;try{f=new e(r,a)}catch{return null}return i.forEach(d=>{f.test(d)&&(!l||c.compare(d)===-1)&&(l=d,c=new n(l,a))}),l},Hh}var zh,S0;function LM(){if(S0)return zh;S0=1;const n=qt(),e=qn();return zh=(i,r,a)=>{let l=null,c=null,f=null;try{f=new e(r,a)}catch{return null}return i.forEach(d=>{f.test(d)&&(!l||c.compare(d)===1)&&(l=d,c=new n(l,a))}),l},zh}var jh,C0;function UM(){if(C0)return jh;C0=1;const n=qt(),e=qn(),t=pc();return jh=(r,a)=>{r=new e(r,a);let l=new n("0.0.0");if(r.test(l)||(l=new n("0.0.0-0"),r.test(l)))return l;l=null;for(let c=0;c<r.set.length;++c){const f=r.set[c];let d=null;f.forEach(g=>{const _=new n(g.semver.version);switch(g.operator){case">":_.prerelease.length===0?_.patch++:_.prerelease.push(0),_.raw=_.format();case"":case">=":(!d||t(_,d))&&(d=_);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${g.operator}`)}}),d&&(!l||t(l,d))&&(l=d)}return l&&r.test(l)?l:null},jh}var Jh,A0;function $M(){if(A0)return Jh;A0=1;const n=qn();return Jh=(t,i)=>{try{return new n(t,i).range||"*"}catch{return null}},Jh}var Kh,R0;function Im(){if(R0)return Kh;R0=1;const n=qt(),e=mc(),{ANY:t}=e,i=qn(),r=gc(),a=pc(),l=Am(),c=xm(),f=Rm();return Kh=(g,_,v,w)=>{g=new n(g,w),_=new i(_,w);let T,S,C,x,M;switch(v){case">":T=a,S=c,C=l,x=">",M=">=";break;case"<":T=l,S=f,C=a,x="<",M="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(r(g,_,w))return!1;for(let R=0;R<_.set.length;++R){const P=_.set[R];let O=null,V=null;if(P.forEach(J=>{J.semver===t&&(J=new e(">=0.0.0")),O=O||J,V=V||J,T(J.semver,O.semver,w)?O=J:C(J.semver,V.semver,w)&&(V=J)}),O.operator===x||O.operator===M||(!V.operator||V.operator===x)&&S(g,V.semver))return!1;if(V.operator===M&&C(g,V.semver))return!1}return!0},Kh}var Yh,x0;function qM(){if(x0)return Yh;x0=1;const n=Im();return Yh=(t,i,r)=>n(t,i,">",r),Yh}var Zh,I0;function BM(){if(I0)return Zh;I0=1;const n=Im();return Zh=(t,i,r)=>n(t,i,"<",r),Zh}var Qh,M0;function GM(){if(M0)return Qh;M0=1;const n=qn();return Qh=(t,i,r)=>(t=new n(t,r),i=new n(i,r),t.intersects(i,r)),Qh}var Xh,N0;function VM(){if(N0)return Xh;N0=1;const n=gc(),e=$n();return Xh=(t,i,r)=>{const a=[];let l=null,c=null;const f=t.sort((v,w)=>e(v,w,r));for(const v of f)n(v,i,r)?(c=v,l||(l=v)):(c&&a.push([l,c]),c=null,l=null);l&&a.push([l,null]);const d=[];for(const[v,w]of a)v===w?d.push(v):!w&&v===f[0]?d.push("*"):w?v===f[0]?d.push(`<=${w}`):d.push(`${v} - ${w}`):d.push(`>=${v}`);const g=d.join(" || "),_=typeof i.raw=="string"?i.raw:String(i);return g.length<_.length?g:i},Xh}var Wh,O0;function FM(){if(O0)return Wh;O0=1;const n=qn(),e=mc(),{ANY:t}=e,i=gc(),r=$n(),a=(_,v,w={})=>{if(_===v)return!0;_=new n(_,w),v=new n(v,w);let T=!1;e:for(const S of _.set){for(const C of v.set){const x=f(S,C,w);if(T=T||x!==null,x)continue e}if(T)return!1}return!0},l=[new e(">=0.0.0-0")],c=[new e(">=0.0.0")],f=(_,v,w)=>{if(_===v)return!0;if(_.length===1&&_[0].semver===t){if(v.length===1&&v[0].semver===t)return!0;w.includePrerelease?_=l:_=c}if(v.length===1&&v[0].semver===t){if(w.includePrerelease)return!0;v=c}const T=new Set;let S,C;for(const Z of _)Z.operator===">"||Z.operator===">="?S=d(S,Z,w):Z.operator==="<"||Z.operator==="<="?C=g(C,Z,w):T.add(Z.semver);if(T.size>1)return null;let x;if(S&&C){if(x=r(S.semver,C.semver,w),x>0)return null;if(x===0&&(S.operator!==">="||C.operator!=="<="))return null}for(const Z of T){if(S&&!i(Z,String(S),w)||C&&!i(Z,String(C),w))return null;for(const re of v)if(!i(Z,String(re),w))return!1;return!0}let M,R,P,O,V=C&&!w.includePrerelease&&C.semver.prerelease.length?C.semver:!1,J=S&&!w.includePrerelease&&S.semver.prerelease.length?S.semver:!1;V&&V.prerelease.length===1&&C.operator==="<"&&V.prerelease[0]===0&&(V=!1);for(const Z of v){if(O=O||Z.operator===">"||Z.operator===">=",P=P||Z.operator==="<"||Z.operator==="<=",S){if(J&&Z.semver.prerelease&&Z.semver.prerelease.length&&Z.semver.major===J.major&&Z.semver.minor===J.minor&&Z.semver.patch===J.patch&&(J=!1),Z.operator===">"||Z.operator===">="){if(M=d(S,Z,w),M===Z&&M!==S)return!1}else if(S.operator===">="&&!i(S.semver,String(Z),w))return!1}if(C){if(V&&Z.semver.prerelease&&Z.semver.prerelease.length&&Z.semver.major===V.major&&Z.semver.minor===V.minor&&Z.semver.patch===V.patch&&(V=!1),Z.operator==="<"||Z.operator==="<="){if(R=g(C,Z,w),R===Z&&R!==C)return!1}else if(C.operator==="<="&&!i(C.semver,String(Z),w))return!1}if(!Z.operator&&(C||S)&&x!==0)return!1}return!(S&&P&&!C&&x!==0||C&&O&&!S&&x!==0||J||V)},d=(_,v,w)=>{if(!_)return v;const T=r(_.semver,v.semver,w);return T>0?_:T<0||v.operator===">"&&_.operator===">="?v:_},g=(_,v,w)=>{if(!_)return v;const T=r(_.semver,v.semver,w);return T<0?_:T>0||v.operator==="<"&&_.operator==="<="?v:_};return Wh=a,Wh}var ep,k0;function HM(){if(k0)return ep;k0=1;const n=Qo(),e=dc(),t=qt(),i=zE(),r=oa(),a=bM(),l=wM(),c=TM(),f=EM(),d=SM(),g=CM(),_=AM(),v=RM(),w=$n(),T=xM(),S=IM(),C=Cm(),x=MM(),M=NM(),R=pc(),P=Am(),O=jE(),V=JE(),J=Rm(),Z=xm(),re=KE(),Se=OM(),ye=mc(),Ue=qn(),Gt=gc(),ne=PM(),Y=DM(),L=LM(),F=UM(),Q=$M(),te=Im(),I=qM(),G=BM(),K=GM(),X=VM(),se=FM();return ep={parse:r,valid:a,clean:l,inc:c,diff:f,major:d,minor:g,patch:_,prerelease:v,compare:w,rcompare:T,compareLoose:S,compareBuild:C,sort:x,rsort:M,gt:R,lt:P,eq:O,neq:V,gte:J,lte:Z,cmp:re,coerce:Se,Comparator:ye,Range:Ue,satisfies:Gt,toComparators:ne,maxSatisfying:Y,minSatisfying:L,minVersion:F,validRange:Q,outside:te,gtr:I,ltr:G,intersects:K,simplifyRange:X,subset:se,SemVer:t,re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:e.SEMVER_SPEC_VERSION,RELEASE_TYPES:e.RELEASE_TYPES,compareIdentifiers:i.compareIdentifiers,rcompareIdentifiers:i.rcompareIdentifiers},ep}HM();function Hi(n){if(!n||n.split("/").length>2||n.startsWith("/")||n.endsWith("/")||n.split(":").length>2)throw new Error(`Invalid identifier format: ${n}`);const[e,t]=n.split(":"),i=t||"latest";if(e.includes("/")){const[r,a]=e.split("/",2);if(!r||!a)throw new Error(`Invalid identifier format: ${n}`);return[r,a,i]}else{if(!e)throw new Error(`Invalid identifier format: ${n}`);return["-",e,i]}}class zM extends Error{constructor(e){super(e),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="LangSmithConflictError",this.status=409}}async function Te(n,e,t){let i;if(n.ok){t&&(i=await n.text());return}i=await n.text();const r=`Failed to ${e}. Received status [${n.status}]: ${n.statusText}. Server response: ${i}`;if(n.status===409)throw new zM(r);const a=new Error(r);throw a.status=n.status,a}const YE="ERR_CONFLICTING_ENDPOINTS";class jM extends Error{constructor(){super("You cannot provide both LANGSMITH_ENDPOINT / LANGCHAIN_ENDPOINT and LANGSMITH_RUNS_ENDPOINTS."),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:YE}),this.name="ConflictingEndpointsError"}}function JM(n){return typeof n=="object"&&n!==null&&n.code===YE}var P0="[...]",KM={result:"[Circular]"},ec=[],zs=[];const YM=new TextEncoder;function ZM(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function Mu(n){return YM.encode(n)}function ZE(n){if(n&&typeof n=="object"&&n!==null){if(n instanceof Map)return Object.fromEntries(n);if(n instanceof Set)return Array.from(n);if(n instanceof Date)return n.toISOString();if(n instanceof RegExp)return n.toString();if(n instanceof Error)return{name:n.name,message:n.message}}else if(typeof n=="bigint")return n.toString();return n}function QM(n){return function(e,t){return ZE(t)}}function ln(n,e,t,i,r){try{const a=JSON.stringify(n,QM(t),i);return Mu(a)}catch(a){if(!a.message?.includes("Converting circular structure to JSON"))return console.warn(`[WARNING]: LangSmith received unserializable value.${e?`
Context: ${e}`:""}`),Mu("[Unserializable]");un("SUPPRESS_CIRCULAR_JSON_WARNINGS")!=="true"&&console.warn(`[WARNING]: LangSmith received circular JSON. This will decrease tracer performance. ${e?`
Context: ${e}`:""}`),typeof r>"u"&&(r=ZM()),Gp(n,"",0,[],void 0,0,r);let l;try{zs.length===0?l=JSON.stringify(n,t,i):l=JSON.stringify(n,XM(t),i)}catch{return Mu("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;ec.length!==0;){const c=ec.pop();c.length===4?Object.defineProperty(c[0],c[1],c[3]):c[0][c[1]]=c[2]}}return Mu(l)}}function tp(n,e,t,i){var r=Object.getOwnPropertyDescriptor(i,t);r.get!==void 0?r.configurable?(Object.defineProperty(i,t,{value:n}),ec.push([i,t,e,r])):zs.push([e,t,n]):(i[t]=n,ec.push([i,t,e]))}function Gp(n,e,t,i,r,a,l){a+=1;var c;if(typeof n=="object"&&n!==null){for(c=0;c<i.length;c++)if(i[c]===n){tp(KM,n,e,r);return}if(typeof l.depthLimit<"u"&&a>l.depthLimit){tp(P0,n,e,r);return}if(typeof l.edgesLimit<"u"&&t+1>l.edgesLimit){tp(P0,n,e,r);return}if(i.push(n),Array.isArray(n))for(c=0;c<n.length;c++)Gp(n[c],c,c,i,n,a,l);else{n=ZE(n);var f=Object.keys(n);for(c=0;c<f.length;c++){var d=f[c];Gp(n[d],d,c,i,n,a,l)}}i.pop()}}function XM(n){return n=typeof n<"u"?n:function(e,t){return t},function(e,t){if(zs.length>0)for(var i=0;i<zs.length;i++){var r=zs[i];if(r[1]===e&&r[0]===t){t=r[2],zs.splice(i,1);break}}return n.call(this,e,t)}}function D0(n){const e=GE(),t=ZI(),i=n.extra??{},r=i.metadata;return n.extra={...i,runtime:{...e,...i?.runtime},metadata:{...t,...t.revision_id||"revision_id"in n&&n.revision_id?{revision_id:("revision_id"in n?n.revision_id:void 0)??t.revision_id}:{},...r}},n}const WM=n=>{const e=n?.toString()??un("TRACING_SAMPLING_RATE");if(e===void 0)return;const t=parseFloat(e);if(t<0||t>1)throw new Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${t}`);return t},eN=n=>{const t=n.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return t==="localhost"||t==="127.0.0.1"||t==="::1"};async function tN(n){const e=[];for await(const t of n)e.push(t);return e}function np(n){if(n!==void 0)return n.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}const nN=async n=>{if(n?.status===429){const e=parseInt(n.headers.get("retry-after")??"30",10)*1e3;if(e>0)return await new Promise(t=>setTimeout(t,e)),!0}return!1};function L0(n){return typeof n=="number"?Number(n.toFixed(4)):n}class iN{constructor(){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0})}peek(){return this.items[0]}push(e){let t;const i=new Promise(a=>{t=a}),r=ln(e.item,`Serializing run with id: ${e.item.id}`).length;return this.items.push({action:e.action,payload:e.item,otelContext:e.otelContext,apiKey:e.apiKey,apiUrl:e.apiUrl,itemPromiseResolve:t,itemPromise:i,size:r}),this.sizeBytes+=r,i}pop(e){if(e<1)throw new Error("Number of bytes to pop off may not be less than 1.");const t=[];let i=0;for(;i+(this.peek()?.size??0)<e&&this.items.length>0;){const r=this.items.shift();r&&(t.push(r),i+=r.size,this.sizeBytes-=r.size)}if(t.length===0&&this.items.length>0){const r=this.items.shift();t.push(r),i+=r.size,this.sizeBytes-=r.size}return[t.map(r=>({action:r.action,item:r.payload,otelContext:r.otelContext,apiKey:r.apiKey,apiUrl:r.apiUrl})),()=>t.forEach(r=>r.itemPromiseResolve())]}}const rN=20971520,sN=2500,U0="https://api.smith.langchain.com";class Vo{constructor(e={}){Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new iN}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:Kn("LANGSMITH_TRACING_BACKGROUND")==="false"}),Object.defineProperty(this,"traceBatchConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"manualFlushMode",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"langSmithToOTELTranslator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"multipartStreamingDisabled",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:Kn("LANGSMITH_DEBUG")==="true"});const t=Vo.getDefaultClientConfig();if(this.tracingSampleRate=WM(e.tracingSamplingRate),this.apiUrl=np(e.apiUrl??t.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=np(e.apiKey??t.apiKey),this.webUrl=np(e.webUrl??t.webUrl),this.webUrl?.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.timeout_ms=e.timeout_ms??9e4,this.caller=new qb({...e.callerOptions??{},debug:e.debug??this.debug}),this.traceBatchConcurrency=e.traceBatchConcurrency??this.traceBatchConcurrency,this.traceBatchConcurrency<1)throw new Error("Trace batch concurrency must be positive.");this.debug=e.debug??this.debug,this.batchIngestCaller=new qb({maxRetries:2,maxConcurrency:this.traceBatchConcurrency,...e.callerOptions??{},onFailedResponseHook:nN,debug:e.debug??this.debug}),this.hideInputs=e.hideInputs??e.anonymizer??t.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??t.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.blockOnRootRunFinalization=e.blockOnRootRunFinalization??this.blockOnRootRunFinalization,this.batchSizeBytesLimit=e.batchSizeBytesLimit,this.fetchOptions=e.fetchOptions||{},this.manualFlushMode=e.manualFlushMode??this.manualFlushMode,VE()&&(this.langSmithToOTELTranslator=new uM)}static getDefaultClientConfig(){const e=un("API_KEY"),t=un("ENDPOINT")??U0,i=un("HIDE_INPUTS")==="true",r=un("HIDE_OUTPUTS")==="true";return{apiUrl:t,apiKey:e,webUrl:void 0,hideInputs:i,hideOutputs:r}}getHostUrl(){return this.webUrl?this.webUrl:eN(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.endsWith("/api/v1")?(this.webUrl=this.apiUrl.replace("/api/v1",""),this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("beta")?(this.webUrl="https://beta.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){const e={"User-Agent":`langsmith-js/${qE}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}_getPlatformEndpointPath(e){return this.apiUrl.slice(-3)!=="/v1"&&this.apiUrl.slice(-4)!=="/v1/"?`/v1/platform/${e}`:`/platform/${e}`}async processInputs(e){return this.hideInputs===!1?e:this.hideInputs===!0?{}:typeof this.hideInputs=="function"?this.hideInputs(e):e}async processOutputs(e){return this.hideOutputs===!1?e:this.hideOutputs===!0?{}:typeof this.hideOutputs=="function"?this.hideOutputs(e):e}async prepareRunCreateOrUpdateInputs(e){const t={...e};return t.inputs!==void 0&&(t.inputs=await this.processInputs(t.inputs)),t.outputs!==void 0&&(t.outputs=await this.processOutputs(t.outputs)),t}async _getResponse(e,t){const i=t?.toString()??"",r=`${this.apiUrl}${e}?${i}`,a=await this.caller.call(fe(this.debug),r,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Te(a,`Failed to fetch ${e}`),a}async _get(e,t){return(await this._getResponse(e,t)).json()}async*_getPaginated(e,t=new URLSearchParams,i){let r=Number(t.get("offset"))||0;const a=Number(t.get("limit"))||100;for(;;){t.set("offset",String(r)),t.set("limit",String(a));const l=`${this.apiUrl}${e}?${t}`,c=await this.caller.call(fe(this.debug),l,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(c,`Failed to fetch ${e}`);const f=i?i(await c.json()):await c.json();if(f.length===0||(yield f,f.length<a))break;r+=f.length}}async*_getCursorPaginatedList(e,t=null,i="POST",r="runs"){const a=t?{...t}:{};for(;;){const c=await(await this.caller.call(fe(this.debug),`${this.apiUrl}${e}`,{method:i,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:JSON.stringify(a)})).json();if(!c||!c[r])break;yield c[r];const f=c.cursors;if(!f||!f.next)break;a.cursor=f.next}}_shouldSample(){return this.tracingSampleRate===void 0?!0:Math.random()<this.tracingSampleRate}_filterForSampling(e,t=!1){if(this.tracingSampleRate===void 0)return e;if(t){const i=[];for(const r of e)this.filteredPostUuids.has(r.trace_id)?r.id===r.trace_id&&this.filteredPostUuids.delete(r.trace_id):i.push(r);return i}else{const i=[];for(const r of e){const a=r.trace_id??r.id;this.filteredPostUuids.has(a)||(r.id===a?this._shouldSample()?i.push(r):this.filteredPostUuids.add(a):i.push(r))}return i}}async _getBatchSizeLimitBytes(){const e=await this._ensureServerInfo();return this.batchSizeBytesLimit??e.batch_ingest_config?.size_limit_bytes??rN}async _getMultiPartSupport(){return(await this._ensureServerInfo()).instance_flags?.dataset_examples_multipart_enabled??!1}drainAutoBatchQueue(e){const t=[];for(;this.autoBatchQueue.items.length>0;){const[i,r]=this.autoBatchQueue.pop(e);if(!i.length){r();break}const a=i.reduce((f,d)=>{const g=d.apiUrl??this.apiUrl,_=d.apiKey??this.apiKey,w=d.apiKey===this.apiKey&&d.apiUrl===this.apiUrl?"default":`${g}|${_}`;return f[w]||(f[w]=[]),f[w].push(d),f},{}),l=[];for(const[f,d]of Object.entries(a)){const g=this._processBatch(d,{apiUrl:f==="default"?void 0:f.split("|")[0],apiKey:f==="default"?void 0:f.split("|")[1]});l.push(g)}const c=Promise.all(l).finally(r);t.push(c)}return Promise.all(t)}async _processBatch(e,t){if(e.length)try{if(this.langSmithToOTELTranslator!==void 0)this._sendBatchToOTELTranslator(e);else{const i={runCreates:e.filter(a=>a.action==="create").map(a=>a.item),runUpdates:e.filter(a=>a.action==="update").map(a=>a.item)};(await this._ensureServerInfo())?.batch_ingest_config?.use_multipart_endpoint?await this.multipartIngestRuns(i,t):await this.batchIngestRuns(i,t)}}catch(i){console.error("Error exporting batch:",i)}}_sendBatchToOTELTranslator(e){if(this.langSmithToOTELTranslator!==void 0){const t=new Map,i=[];for(const r of e)r.item.id&&r.otelContext&&(t.set(r.item.id,r.otelContext),r.action==="create"?i.push({operation:"post",id:r.item.id,trace_id:r.item.trace_id??r.item.id,run:r.item}):i.push({operation:"patch",id:r.item.id,trace_id:r.item.trace_id??r.item.id,run:r.item}));this.langSmithToOTELTranslator.exportBatch(i,t)}}async processRunOperation(e){clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,e.item=D0(e.item);const t=this.autoBatchQueue.push(e);if(this.manualFlushMode)return t;const i=await this._getBatchSizeLimitBytes();return this.autoBatchQueue.sizeBytes>i&&this.drainAutoBatchQueue(i),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue(i)},this.autoBatchAggregationDelayMs)),t}async _getServerInfo(){const e=await this.caller.call(fe(this.debug),`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(sN),...this.fetchOptions});await Te(e,"get server info");const t=await e.json();return this.debug&&console.log(`
=== LangSmith Server Configuration ===
`+JSON.stringify(t,null,2)+`
`),t}async _ensureServerInfo(){return this._getServerInfoPromise===void 0&&(this._getServerInfoPromise=(async()=>{if(this._serverInfo===void 0)try{this._serverInfo=await this._getServerInfo()}catch(e){console.warn(`[WARNING]: LangSmith failed to fetch info on supported operations with status code ${e.status}. Falling back to batch operations and default limits.`)}return this._serverInfo??{}})()),this._getServerInfoPromise.then(e=>(this._serverInfo===void 0&&(this._getServerInfoPromise=void 0),e))}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async flush(){const e=await this._getBatchSizeLimitBytes();await this.drainAutoBatchQueue(e)}_cloneCurrentOTELContext(){const e=FE(),t=sM();if(this.langSmithToOTELTranslator!==void 0){const i=e.getActiveSpan();if(i)return e.setSpan(t.active(),i)}}async createRun(e,t){if(!this._filterForSampling([e]).length)return;const i={...this.headers,"Content-Type":"application/json"},r=e.project_name;delete e.project_name;const a=await this.prepareRunCreateOrUpdateInputs({session_name:r,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&a.trace_id!==void 0&&a.dotted_order!==void 0){const f=this._cloneCurrentOTELContext();this.processRunOperation({action:"create",item:a,otelContext:f,apiKey:t?.apiKey,apiUrl:t?.apiUrl}).catch(console.error);return}const l=D0(a);t?.apiKey!==void 0&&(i["x-api-key"]=t.apiKey);const c=await this.caller.call(fe(this.debug),`${t?.apiUrl??this.apiUrl}/runs`,{method:"POST",headers:i,body:ln(l,`Creating run with id: ${l.id}`),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(c,"create run",!0)}async batchIngestRuns({runCreates:e,runUpdates:t},i){if(e===void 0&&t===void 0)return;let r=await Promise.all(e?.map(f=>this.prepareRunCreateOrUpdateInputs(f))??[]),a=await Promise.all(t?.map(f=>this.prepareRunCreateOrUpdateInputs(f))??[]);if(r.length>0&&a.length>0){const f=r.reduce((g,_)=>(_.id&&(g[_.id]=_),g),{}),d=[];for(const g of a)g.id!==void 0&&f[g.id]?f[g.id]={...f[g.id],...g}:d.push(g);r=Object.values(f),a=d}const l={post:r,patch:a};if(!l.post.length&&!l.patch.length)return;const c={post:[],patch:[]};for(const f of["post","patch"]){const d=f,g=l[d].reverse();let _=g.pop();for(;_!==void 0;)c[d].push(_),_=g.pop()}if(c.post.length>0||c.patch.length>0){const f=c.post.map(d=>d.id).concat(c.patch.map(d=>d.id)).join(",");await this._postBatchIngestRuns(ln(c,`Ingesting runs with ids: ${f}`),i)}}async _postBatchIngestRuns(e,t){const i={...this.headers,"Content-Type":"application/json",Accept:"application/json"};t?.apiKey!==void 0&&(i["x-api-key"]=t.apiKey);const r=await this.batchIngestCaller.call(fe(this.debug),`${t?.apiUrl??this.apiUrl}/runs/batch`,{method:"POST",headers:i,body:e,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(r,"batch create run",!0)}async multipartIngestRuns({runCreates:e,runUpdates:t},i){if(e===void 0&&t===void 0)return;const r={};let a=[];for(const _ of e??[]){const v=await this.prepareRunCreateOrUpdateInputs(_);v.id!==void 0&&v.attachments!==void 0&&(r[v.id]=v.attachments),delete v.attachments,a.push(v)}let l=[];for(const _ of t??[])l.push(await this.prepareRunCreateOrUpdateInputs(_));if(a.find(_=>_.trace_id===void 0||_.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');if(l.find(_=>_.trace_id===void 0||_.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');if(a.length>0&&l.length>0){const _=a.reduce((w,T)=>(T.id&&(w[T.id]=T),w),{}),v=[];for(const w of l)w.id!==void 0&&_[w.id]?_[w.id]={..._[w.id],...w}:v.push(w);a=Object.values(_),l=v}if(a.length===0&&l.length===0)return;const d=[],g=[];for(const[_,v]of[["post",a],["patch",l]])for(const w of v){const{inputs:T,outputs:S,events:C,attachments:x,...M}=w,R={inputs:T,outputs:S,events:C},P=ln(M,`Serializing for multipart ingestion of run with id: ${M.id}`);g.push({name:`${_}.${M.id}`,payload:new Blob([P],{type:`application/json; length=${P.length}`})});for(const[O,V]of Object.entries(R)){if(V===void 0)continue;const J=ln(V,`Serializing ${O} for multipart ingestion of run with id: ${M.id}`);g.push({name:`${_}.${M.id}.${O}`,payload:new Blob([J],{type:`application/json; length=${J.length}`})})}if(M.id!==void 0){const O=r[M.id];if(O){delete r[M.id];for(const[V,J]of Object.entries(O)){let Z,re;if(Array.isArray(J)?[Z,re]=J:(Z=J.mimeType,re=J.data),V.includes(".")){console.warn(`Skipping attachment '${V}' for run ${M.id}: Invalid attachment name. Attachment names must not contain periods ('.'). Please rename the attachment and try again.`);continue}g.push({name:`attachment.${M.id}.${V}`,payload:new Blob([re],{type:`${Z}; length=${re.byteLength}`})})}}}d.push(`trace=${M.trace_id},id=${M.id}`)}await this._sendMultipartRequest(g,d.join("; "),i)}async _createNodeFetchBody(e,t){const i=[];for(const l of e)i.push(new Blob([`--${t}\r
`])),i.push(new Blob([`Content-Disposition: form-data; name="${l.name}"\r
`,`Content-Type: ${l.payload.type}\r
\r
`])),i.push(l.payload),i.push(new Blob([`\r
`]));return i.push(new Blob([`--${t}--\r
`])),await new Blob(i).arrayBuffer()}async _createMultipartStream(e,t){const i=new TextEncoder;return new ReadableStream({async start(a){const l=async c=>{typeof c=="string"?a.enqueue(i.encode(c)):a.enqueue(c)};for(const c of e){await l(`--${t}\r
`),await l(`Content-Disposition: form-data; name="${c.name}"\r
`),await l(`Content-Type: ${c.payload.type}\r
\r
`);const d=c.payload.stream().getReader();try{let g;for(;!(g=await d.read()).done;)a.enqueue(g.value)}finally{d.releaseLock()}await l(`\r
`)}await l(`--${t}--\r
`),a.close()}})}async _sendMultipartRequest(e,t,i){const r="----LangSmithFormBoundary"+Math.random().toString(36).slice(2),a=HI(),l=()=>this._createNodeFetchBody(e,r),c=()=>this._createMultipartStream(e,r),f=async d=>{const g={...this.headers,"Content-Type":`multipart/form-data; boundary=${r}`};return i?.apiKey!==void 0&&(g["x-api-key"]=i.apiKey),this.batchIngestCaller.call(fe(this.debug),`${i?.apiUrl??this.apiUrl}/runs/multipart`,{method:"POST",headers:g,body:d,duplex:"half",signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})};try{let d,g=!1;!a&&!this.multipartStreamingDisabled?(g=!0,d=await f(await c())):d=await f(await l()),(!this.multipartStreamingDisabled||g)&&d.status===422&&(i?.apiUrl??this.apiUrl)!==U0&&(console.warn(`Streaming multipart upload to ${i?.apiUrl??this.apiUrl}/runs/multipart failed. This usually means the host does not support chunked uploads. Retrying with a buffered upload for operation "${t}".`),this.multipartStreamingDisabled=!0,d=await f(await l())),await Te(d,"ingest multipart runs",!0)}catch(d){console.warn(`${d.message.trim()}

Context: ${t}`)}}async updateRun(e,t,i){ve(e),t.inputs&&(t.inputs=await this.processInputs(t.inputs)),t.outputs&&(t.outputs=await this.processOutputs(t.outputs));const r={...t,id:e};if(!this._filterForSampling([r],!0).length)return;if(this.autoBatchTracing&&r.trace_id!==void 0&&r.dotted_order!==void 0){const c=this._cloneCurrentOTELContext();if(t.end_time!==void 0&&r.parent_run_id===void 0&&this.blockOnRootRunFinalization&&!this.manualFlushMode){await this.processRunOperation({action:"update",item:r,otelContext:c,apiKey:i?.apiKey,apiUrl:i?.apiUrl}).catch(console.error);return}else this.processRunOperation({action:"update",item:r,otelContext:c,apiKey:i?.apiKey,apiUrl:i?.apiUrl}).catch(console.error);return}const a={...this.headers,"Content-Type":"application/json"};i?.apiKey!==void 0&&(a["x-api-key"]=i.apiKey);const l=await this.caller.call(fe(this.debug),`${i?.apiUrl??this.apiUrl}/runs/${e}`,{method:"PATCH",headers:a,body:ln(t,`Serializing payload to update run with id: ${e}`),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(l,"update run",!0)}async readRun(e,{loadChildRuns:t}={loadChildRuns:!1}){ve(e);let i=await this._get(`/runs/${e}`);return t&&(i=await this._loadChildRuns(i)),i}async getRunUrl({runId:e,run:t,projectOpts:i}){if(t!==void 0){let r;t.session_id?r=t.session_id:i?.projectName?r=(await this.readProject({projectName:i?.projectName})).id:i?.projectId?r=i?.projectId:r=(await this.readProject({projectName:un("PROJECT")||"default"})).id;const a=await this._getTenantId();return`${this.getHostUrl()}/o/${a}/projects/p/${r}/r/${t.id}?poll=true`}else if(e!==void 0){const r=await this.readRun(e);if(!r.app_path)throw new Error(`Run ${e} has no app_path`);return`${this.getHostUrl()}${r.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(e){const t=await tN(this.listRuns({isRoot:!1,projectId:e.session_id,traceId:e.trace_id})),i={},r={};t.sort((a,l)=>(a?.dotted_order??"").localeCompare(l?.dotted_order??""));for(const a of t){if(a.parent_run_id===null||a.parent_run_id===void 0)throw new Error(`Child run ${a.id} has no parent`);a.dotted_order?.startsWith(e.dotted_order??"")&&a.id!==e.id&&(a.parent_run_id in i||(i[a.parent_run_id]=[]),i[a.parent_run_id].push(a),r[a.id]=a)}e.child_runs=i[e.id]||[];for(const a in i)a!==e.id&&(r[a].child_runs=i[a]);return e}async*listRuns(e){const{projectId:t,projectName:i,parentRunId:r,traceId:a,referenceExampleId:l,startTime:c,executionOrder:f,isRoot:d,runType:g,error:_,id:v,query:w,filter:T,traceFilter:S,treeFilter:C,limit:x,select:M,order:R}=e;let P=[];if(t&&(P=Array.isArray(t)?t:[t]),i){const Z=Array.isArray(i)?i:[i],re=await Promise.all(Z.map(Se=>this.readProject({projectName:Se}).then(ye=>ye.id)));P.push(...re)}const O=["app_path","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],V={session:P.length?P:null,run_type:g,reference_example:l,query:w,filter:T,trace_filter:S,tree_filter:C,execution_order:f,parent_run:r,start_time:c?c.toISOString():null,error:_,id:v,limit:x,trace:a,select:M||O,is_root:d,order:R};let J=0;for await(const Z of this._getCursorPaginatedList("/runs/query",V))if(x){if(J>=x)break;if(Z.length+J>x){yield*Z.slice(0,x-J);break}J+=Z.length,yield*Z}else yield*Z}async*listGroupRuns(e){const{projectId:t,projectName:i,groupBy:r,filter:a,startTime:l,endTime:c,limit:f,offset:d}=e,_={session_id:t||(await this.readProject({projectName:i})).id,group_by:r,filter:a,start_time:l?l.toISOString():null,end_time:c?c.toISOString():null,limit:Number(f)||100};let v=Number(d)||0;const w="/runs/group",T=`${this.apiUrl}${w}`;for(;;){const S={..._,offset:v},C=Object.fromEntries(Object.entries(S).filter(([O,V])=>V!==void 0)),x=await this.caller.call(fe(),T,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(C),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(x,`Failed to fetch ${w}`);const M=await x.json(),{groups:R,total:P}=M;if(R.length===0)break;for(const O of R)yield O;if(v+=R.length,v>=P)break}}async getRunStats({id:e,trace:t,parentRun:i,runType:r,projectNames:a,projectIds:l,referenceExampleIds:c,startTime:f,endTime:d,error:g,query:_,filter:v,traceFilter:w,treeFilter:T,isRoot:S,dataSourceType:C}){let x=l||[];a&&(x=[...l||[],...await Promise.all(a.map(V=>this.readProject({projectName:V}).then(J=>J.id)))]);const R=Object.fromEntries(Object.entries({id:e,trace:t,parent_run:i,run_type:r,session:x,reference_example:c,start_time:f,end_time:d,error:g,query:_,filter:v,trace_filter:w,tree_filter:T,is_root:S,data_source_type:C}).filter(([V,J])=>J!==void 0));return await(await this.caller.call(fe(this.debug),`${this.apiUrl}/runs/stats`,{method:"POST",headers:this.headers,body:JSON.stringify(R),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async shareRun(e,{shareId:t}={}){const i={run_id:e,share_token:t||Ut()};ve(e);const a=await(await this.caller.call(fe(this.debug),`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(a===null||!("share_token"in a))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${a.share_token}/r`}async unshareRun(e){ve(e);const t=await this.caller.call(fe(this.debug),`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(t,"unshare run",!0)}async readRunSharedLink(e){ve(e);const i=await(await this.caller.call(fe(this.debug),`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(!(i===null||!("share_token"in i)))return`${this.getHostUrl()}/public/${i.share_token}/r`}async listSharedRuns(e,{runIds:t}={}){const i=new URLSearchParams({share_token:e});if(t!==void 0)for(const l of t)i.append("id",l);return ve(e),await(await this.caller.call(fe(this.debug),`${this.apiUrl}/public/${e}/runs${i}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async readDatasetSharedSchema(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id),ve(e);const r=await(await this.caller.call(fe(this.debug),`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return r.url=`${this.getHostUrl()}/public/${r.share_token}/d`,r}async shareDataset(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id);const i={dataset_id:e};ve(e);const a=await(await this.caller.call(fe(this.debug),`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return a.url=`${this.getHostUrl()}/public/${a.share_token}/d`,a}async unshareDataset(e){ve(e);const t=await this.caller.call(fe(this.debug),`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(t,"unshare dataset",!0)}async readSharedDataset(e){return ve(e),await(await this.caller.call(fe(this.debug),`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async listSharedExamples(e,t){const i={};t?.exampleIds&&(i.id=t.exampleIds);const r=new URLSearchParams;Object.entries(i).forEach(([c,f])=>{Array.isArray(f)?f.forEach(d=>r.append(c,d)):r.append(c,f)});const a=await this.caller.call(fe(this.debug),`${this.apiUrl}/public/${e}/examples?${r.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),l=await a.json();if(!a.ok)throw"detail"in l?new Error(`Failed to list shared examples.
Status: ${a.status}
Message: ${Array.isArray(l.detail)?l.detail.join(`
`):"Unspecified error"}`):new Error(`Failed to list shared examples: ${a.status} ${a.statusText}`);return l.map(c=>({...c,_hostUrl:this.getHostUrl()}))}async createProject({projectName:e,description:t=null,metadata:i=null,upsert:r=!1,projectExtra:a=null,referenceDatasetId:l=null}){const c=r?"?upsert=true":"",f=`${this.apiUrl}/sessions${c}`,d=a||{};i&&(d.metadata=i);const g={name:e,extra:d,description:t};l!==null&&(g.reference_dataset_id=l);const _=await this.caller.call(fe(this.debug),f,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(g),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Te(_,"create project"),await _.json()}async updateProject(e,{name:t=null,description:i=null,metadata:r=null,projectExtra:a=null,endTime:l=null}){const c=`${this.apiUrl}/sessions/${e}`;let f=a;r&&(f={...f||{},metadata:r});const d={name:t,extra:f,description:i,end_time:l?new Date(l).toISOString():null},g=await this.caller.call(fe(this.debug),c,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(d),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Te(g,"update project"),await g.json()}async hasProject({projectId:e,projectName:t}){let i="/sessions";const r=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)ve(e),i+=`/${e}`;else if(t!==void 0)r.append("name",t);else throw new Error("Must provide projectName or projectId");const a=await this.caller.call(fe(this.debug),`${this.apiUrl}${i}?${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});try{const l=await a.json();return a.ok?Array.isArray(l)?l.length>0:!0:!1}catch{return!1}}async readProject({projectId:e,projectName:t,includeStats:i}){let r="/sessions";const a=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)ve(e),r+=`/${e}`;else if(t!==void 0)a.append("name",t);else throw new Error("Must provide projectName or projectId");i!==void 0&&a.append("include_stats",i.toString());const l=await this._get(r,a);let c;if(Array.isArray(l)){if(l.length===0)throw new Error(`Project[id=${e}, name=${t}] not found`);c=l[0]}else c=l;return c}async getProjectUrl({projectId:e,projectName:t}){if(e===void 0&&t===void 0)throw new Error("Must provide either projectName or projectId");const i=await this.readProject({projectId:e,projectName:t}),r=await this._getTenantId();return`${this.getHostUrl()}/o/${r}/projects/p/${i.id}`}async getDatasetUrl({datasetId:e,datasetName:t}){if(e===void 0&&t===void 0)throw new Error("Must provide either datasetName or datasetId");const i=await this.readDataset({datasetId:e,datasetName:t}),r=await this._getTenantId();return`${this.getHostUrl()}/o/${r}/datasets/${i.id}`}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;const e=new URLSearchParams({limit:"1"});for await(const t of this._getPaginated("/sessions",e))return this._tenantId=t[0].tenant_id,t[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:e,name:t,nameContains:i,referenceDatasetId:r,referenceDatasetName:a,referenceFree:l,metadata:c}={}){const f=new URLSearchParams;if(e!==void 0)for(const d of e)f.append("id",d);if(t!==void 0&&f.append("name",t),i!==void 0&&f.append("name_contains",i),r!==void 0)f.append("reference_dataset",r);else if(a!==void 0){const d=await this.readDataset({datasetName:a});f.append("reference_dataset",d.id)}l!==void 0&&f.append("reference_free",l.toString()),c!==void 0&&f.append("metadata",JSON.stringify(c));for await(const d of this._getPaginated("/sessions",f))yield*d}async deleteProject({projectId:e,projectName:t}){let i;if(e===void 0&&t===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?i=(await this.readProject({projectName:t})).id:i=e,ve(i);const r=await this.caller.call(fe(this.debug),`${this.apiUrl}/sessions/${i}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(r,`delete session ${i} (${t})`,!0)}async uploadCsv({csvFile:e,fileName:t,inputKeys:i,outputKeys:r,description:a,dataType:l,name:c}){const f=`${this.apiUrl}/datasets/upload`,d=new FormData;d.append("file",e,t),i.forEach(v=>{d.append("input_keys",v)}),r.forEach(v=>{d.append("output_keys",v)}),a&&d.append("description",a),l&&d.append("data_type",l),c&&d.append("name",c);const g=await this.caller.call(fe(this.debug),f,{method:"POST",headers:this.headers,body:d,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Te(g,"upload CSV"),await g.json()}async createDataset(e,{description:t,dataType:i,inputsSchema:r,outputsSchema:a,metadata:l}={}){const c={name:e,description:t,extra:l?{metadata:l}:void 0};i&&(c.data_type=i),r&&(c.inputs_schema_definition=r),a&&(c.outputs_schema_definition=a);const f=await this.caller.call(fe(this.debug),`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Te(f,"create dataset"),await f.json()}async readDataset({datasetId:e,datasetName:t}){let i="/datasets";const r=new URLSearchParams({limit:"1"});if(e&&t)throw new Error("Must provide either datasetName or datasetId, not both");if(e)ve(e),i+=`/${e}`;else if(t)r.append("name",t);else throw new Error("Must provide datasetName or datasetId");const a=await this._get(i,r);let l;if(Array.isArray(a)){if(a.length===0)throw new Error(`Dataset[id=${e}, name=${t}] not found`);l=a[0]}else l=a;return l}async hasDataset({datasetId:e,datasetName:t}){try{return await this.readDataset({datasetId:e,datasetName:t}),!0}catch(i){if(i instanceof Error&&i.message.toLocaleLowerCase().includes("not found"))return!1;throw i}}async diffDatasetVersions({datasetId:e,datasetName:t,fromVersion:i,toVersion:r}){let a=e;if(a===void 0&&t===void 0)throw new Error("Must provide either datasetName or datasetId");if(a!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");a===void 0&&(a=(await this.readDataset({datasetName:t})).id);const l=new URLSearchParams({from_version:typeof i=="string"?i:i.toISOString(),to_version:typeof r=="string"?r:r.toISOString()});return await this._get(`/datasets/${a}/versions/diff`,l)}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:t}){const i="/datasets";if(e===void 0)if(t!==void 0)e=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide either datasetName or datasetId");return(await(await this._getResponse(`${i}/${e}/openai_ft`)).text()).trim().split(`
`).map(c=>JSON.parse(c))}async*listDatasets({limit:e=100,offset:t=0,datasetIds:i,datasetName:r,datasetNameContains:a,metadata:l}={}){const c="/datasets",f=new URLSearchParams({limit:e.toString(),offset:t.toString()});if(i!==void 0)for(const d of i)f.append("id",d);r!==void 0&&f.append("name",r),a!==void 0&&f.append("name_contains",a),l!==void 0&&f.append("metadata",JSON.stringify(l));for await(const d of this._getPaginated(c,f))yield*d}async updateDataset(e){const{datasetId:t,datasetName:i,...r}=e;if(!t&&!i)throw new Error("Must provide either datasetName or datasetId");const a=t??(await this.readDataset({datasetName:i})).id;ve(a);const l=await this.caller.call(fe(this.debug),`${this.apiUrl}/datasets/${a}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Te(l,"update dataset"),await l.json()}async updateDatasetTag(e){const{datasetId:t,datasetName:i,asOf:r,tag:a}=e;if(!t&&!i)throw new Error("Must provide either datasetName or datasetId");const l=t??(await this.readDataset({datasetName:i})).id;ve(l);const c=await this.caller.call(fe(this.debug),`${this.apiUrl}/datasets/${l}/tags`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({as_of:typeof r=="string"?r:r.toISOString(),tag:a}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(c,"update dataset tags")}async deleteDataset({datasetId:e,datasetName:t}){let i="/datasets",r=e;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(t!==void 0&&(r=(await this.readDataset({datasetName:t})).id),r!==void 0)ve(r),i+=`/${r}`;else throw new Error("Must provide datasetName or datasetId");const a=await this.caller.call(fe(this.debug),this.apiUrl+i,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(a,`delete ${i}`),await a.json()}async indexDataset({datasetId:e,datasetName:t,tag:i}){let r=e;if(!r&&!t)throw new Error("Must provide either datasetName or datasetId");if(r&&t)throw new Error("Must provide either datasetName or datasetId, not both");r||(r=(await this.readDataset({datasetName:t})).id),ve(r);const a={tag:i},l=await this.caller.call(fe(this.debug),`${this.apiUrl}/datasets/${r}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(l,"index dataset"),await l.json()}async similarExamples(e,t,i,{filter:r}={}){const a={limit:i,inputs:e};r!==void 0&&(a.filter=r),ve(t);const l=await this.caller.call(fe(this.debug),`${this.apiUrl}/datasets/${t}/search`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Te(l,"fetch similar examples"),(await l.json()).examples}async createExample(e,t,i){if($0(e)&&(t!==void 0||i!==void 0))throw new Error("Cannot provide outputs or options when using ExampleCreate object");let r=t?i?.datasetId:e.dataset_id;const a=t?i?.datasetName:e.dataset_name;if(r===void 0&&a===void 0)throw new Error("Must provide either datasetName or datasetId");if(r!==void 0&&a!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");r===void 0&&(r=(await this.readDataset({datasetName:a})).id);const l=(t?i?.createdAt:e.created_at)||new Date;let c;$0(e)?c=e:c={inputs:e,outputs:t,created_at:l?.toISOString(),id:i?.exampleId,metadata:i?.metadata,split:i?.split,source_run_id:i?.sourceRunId,use_source_run_io:i?.useSourceRunIO,use_source_run_attachments:i?.useSourceRunAttachments,attachments:i?.attachments};const f=await this._uploadExamplesMultipart(r,[c]);return await this.readExample(f.example_ids?.[0]??Ut())}async createExamples(e){if(Array.isArray(e)){if(e.length===0)return[];const M=e;let R=M[0].dataset_id;const P=M[0].dataset_name;if(R===void 0&&P===void 0)throw new Error("Must provide either datasetName or datasetId");if(R!==void 0&&P!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");R===void 0&&(R=(await this.readDataset({datasetName:P})).id);const O=await this._uploadExamplesMultipart(R,M);return await Promise.all(O.example_ids.map(J=>this.readExample(J)))}const{inputs:t,outputs:i,metadata:r,splits:a,sourceRunIds:l,useSourceRunIOs:c,useSourceRunAttachments:f,attachments:d,exampleIds:g,datasetId:_,datasetName:v}=e;if(t===void 0)throw new Error("Must provide inputs when using legacy parameters");let w=_;const T=v;if(w===void 0&&T===void 0)throw new Error("Must provide either datasetName or datasetId");if(w!==void 0&&T!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");w===void 0&&(w=(await this.readDataset({datasetName:T})).id);const S=t.map((M,R)=>({dataset_id:w,inputs:M,outputs:i?.[R],metadata:r?.[R],split:a?.[R],id:g?.[R],attachments:d?.[R],source_run_id:l?.[R],use_source_run_io:c?.[R],use_source_run_attachments:f?.[R]})),C=await this._uploadExamplesMultipart(w,S);return await Promise.all(C.example_ids.map(M=>this.readExample(M)))}async createLLMExample(e,t,i){return this.createExample({input:e},{output:t},i)}async createChatExample(e,t,i){const r=e.map(l=>Bb(l)?Gb(l):l),a=Bb(t)?Gb(t):t;return this.createExample({input:r},{output:a},i)}async readExample(e){ve(e);const t=`/examples/${e}`,i=await this._get(t),{attachment_urls:r,...a}=i,l=a;return r&&(l.attachments=Object.entries(r).reduce((c,[f,d])=>(c[f.slice(11)]={presigned_url:d.presigned_url,mime_type:d.mime_type},c),{})),l}async*listExamples({datasetId:e,datasetName:t,exampleIds:i,asOf:r,splits:a,inlineS3Urls:l,metadata:c,limit:f,offset:d,filter:g,includeAttachments:_}={}){let v;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)v=e;else if(t!==void 0)v=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide a datasetName or datasetId");const w=new URLSearchParams({dataset:v}),T=r?typeof r=="string"?r:r?.toISOString():void 0;T&&w.append("as_of",T);const S=l??!0;if(w.append("inline_s3_urls",S.toString()),i!==void 0)for(const x of i)w.append("id",x);if(a!==void 0)for(const x of a)w.append("splits",x);if(c!==void 0){const x=JSON.stringify(c);w.append("metadata",x)}f!==void 0&&w.append("limit",f.toString()),d!==void 0&&w.append("offset",d.toString()),g!==void 0&&w.append("filter",g),_===!0&&["attachment_urls","outputs","metadata"].forEach(x=>w.append("select",x));let C=0;for await(const x of this._getPaginated("/examples",w)){for(const M of x){const{attachment_urls:R,...P}=M,O=P;R&&(O.attachments=Object.entries(R).reduce((V,[J,Z])=>(V[J.slice(11)]={presigned_url:Z.presigned_url,mime_type:Z.mime_type||void 0},V),{})),yield O,C++}if(f!==void 0&&C>=f)break}}async deleteExample(e){ve(e);const t=`/examples/${e}`,i=await this.caller.call(fe(this.debug),this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(i,`delete ${t}`),await i.json()}async updateExample(e,t){let i;t?i=e:i=e.id,ve(i);let r;t?r={id:i,...t}:r=e;let a;return r.dataset_id!==void 0?a=r.dataset_id:a=(await this.readExample(i)).dataset_id,this._updateExamplesMultipart(a,[r])}async updateExamples(e){let t;return e[0].dataset_id===void 0?t=(await this.readExample(e[0].id)).dataset_id:t=e[0].dataset_id,this._updateExamplesMultipart(t,e)}async readDatasetVersion({datasetId:e,datasetName:t,asOf:i,tag:r}){let a;if(e?a=e:a=(await this.readDataset({datasetName:t})).id,ve(a),i&&r||!i&&!r)throw new Error("Exactly one of asOf and tag must be specified.");const l=new URLSearchParams;i!==void 0&&l.append("as_of",typeof i=="string"?i:i.toISOString()),r!==void 0&&l.append("tag",r);const c=await this.caller.call(fe(this.debug),`${this.apiUrl}/datasets/${a}/version?${l.toString()}`,{method:"GET",headers:{...this.headers},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Te(c,"read dataset version"),await c.json()}async listDatasetSplits({datasetId:e,datasetName:t,asOf:i}){let r;if(e===void 0&&t===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?r=(await this.readDataset({datasetName:t})).id:r=e,ve(r);const a=new URLSearchParams,l=i?typeof i=="string"?i:i?.toISOString():void 0;return l&&a.append("as_of",l),await this._get(`/datasets/${r}/splits`,a)}async updateDatasetSplits({datasetId:e,datasetName:t,splitName:i,exampleIds:r,remove:a=!1}){let l;if(e===void 0&&t===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?l=(await this.readDataset({datasetName:t})).id:l=e,ve(l);const c={split_name:i,examples:r.map(d=>(ve(d),d)),remove:a},f=await this.caller.call(fe(this.debug),`${this.apiUrl}/datasets/${l}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(f,"update dataset splits",!0)}async evaluateRun(e,t,{sourceInfo:i,loadChildRuns:r,referenceExample:a}={loadChildRuns:!1}){HE("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead.");let l;if(typeof e=="string")l=await this.readRun(e,{loadChildRuns:r});else if(typeof e=="object"&&"id"in e)l=e;else throw new Error(`Invalid run type: ${typeof e}`);l.reference_example_id!==null&&l.reference_example_id!==void 0&&(a=await this.readExample(l.reference_example_id));const c=await t.evaluateRun(l,a),[f,d]=await this._logEvaluationFeedback(c,l,i);return d[0]}async createFeedback(e,t,{score:i,value:r,correction:a,comment:l,sourceInfo:c,feedbackSourceType:f="api",sourceRunId:d,feedbackId:g,feedbackConfig:_,projectId:v,comparativeExperimentId:w}){if(!e&&!v)throw new Error("One of runId or projectId must be provided");if(e&&v)throw new Error("Only one of runId or projectId can be provided");const T={type:f??"api",metadata:c??{}};d!==void 0&&T?.metadata!==void 0&&!T.metadata.__run&&(T.metadata.__run={run_id:d}),T?.metadata!==void 0&&T.metadata.__run?.run_id!==void 0&&ve(T.metadata.__run.run_id);const S={id:g??Ut(),run_id:e,key:t,score:L0(i),value:r,correction:a,comment:l,feedback_source:T,comparative_experiment_id:w,feedbackConfig:_,session_id:v},C=`${this.apiUrl}/feedback`,x=await this.caller.call(fe(this.debug),C,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(S),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Te(x,"create feedback",!0),S}async updateFeedback(e,{score:t,value:i,correction:r,comment:a}){const l={};t!=null&&(l.score=L0(t)),i!=null&&(l.value=i),r!=null&&(l.correction=r),a!=null&&(l.comment=a),ve(e);const c=await this.caller.call(fe(this.debug),`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(c,"update feedback",!0)}async readFeedback(e){ve(e);const t=`/feedback/${e}`;return await this._get(t)}async deleteFeedback(e){ve(e);const t=`/feedback/${e}`,i=await this.caller.call(fe(this.debug),this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(i,`delete ${t}`),await i.json()}async*listFeedback({runIds:e,feedbackKeys:t,feedbackSourceTypes:i}={}){const r=new URLSearchParams;if(e&&r.append("run",e.join(",")),t)for(const a of t)r.append("key",a);if(i)for(const a of i)r.append("source",a);for await(const a of this._getPaginated("/feedback",r))yield*a}async createPresignedFeedbackToken(e,t,{expiration:i,feedbackConfig:r}={}){const a={run_id:e,feedback_key:t,feedback_config:r};return i?typeof i=="string"?a.expires_at=i:(i?.hours||i?.minutes||i?.days)&&(a.expires_in=i):a.expires_in={hours:3},await(await this.caller.call(fe(this.debug),`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async createComparativeExperiment({name:e,experimentIds:t,referenceDatasetId:i,createdAt:r,description:a,metadata:l,id:c}){if(t.length===0)throw new Error("At least one experiment is required");if(i||(i=(await this.readProject({projectId:t[0]})).reference_dataset_id),!i==null)throw new Error("A reference dataset is required");const f={id:c,name:e,experiment_ids:t,reference_dataset_id:i,description:a,created_at:(r??new Date)?.toISOString(),extra:{}};return l&&(f.extra.metadata=l),await(await this.caller.call(fe(this.debug),`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(f),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async*listPresignedFeedbackTokens(e){ve(e);const t=new URLSearchParams({run_id:e});for await(const i of this._getPaginated("/feedback/tokens",t))yield*i}_selectEvalResults(e){let t;return"results"in e?t=e.results:Array.isArray(e)?t=e:t=[e],t}async _logEvaluationFeedback(e,t,i){const r=this._selectEvalResults(e),a=[];for(const l of r){let c=i||{};l.evaluatorInfo&&(c={...l.evaluatorInfo,...c});let f=null;l.targetRunId?f=l.targetRunId:t&&(f=t.id),a.push(await this.createFeedback(f,l.key,{score:l.score,value:l.value,comment:l.comment,correction:l.correction,sourceInfo:c,sourceRunId:l.sourceRunId,feedbackConfig:l.feedbackConfig,feedbackSourceType:"model"}))}return[r,a]}async logEvaluationFeedback(e,t,i){const[r]=await this._logEvaluationFeedback(e,t,i);return r}async*listAnnotationQueues(e={}){const{queueIds:t,name:i,nameContains:r,limit:a}=e,l=new URLSearchParams;t&&t.forEach((f,d)=>{ve(f,`queueIds[${d}]`),l.append("ids",f)}),i&&l.append("name",i),r&&l.append("name_contains",r),l.append("limit",(a!==void 0?Math.min(a,100):100).toString());let c=0;for await(const f of this._getPaginated("/annotation-queues",l))if(yield*f,c++,a!==void 0&&c>=a)break}async createAnnotationQueue(e){const{name:t,description:i,queueId:r,rubricInstructions:a}=e,l={name:t,description:i,id:r||Ut(),rubric_instructions:a},c=await this.caller.call(fe(this.debug),`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(Object.entries(l).filter(([d,g])=>g!==void 0))),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Te(c,"create annotation queue"),await c.json()}async readAnnotationQueue(e){const t=await this.caller.call(fe(this.debug),`${this.apiUrl}/annotation-queues/${ve(e,"queueId")}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Te(t,"read annotation queue"),await t.json()}async updateAnnotationQueue(e,t){const{name:i,description:r,rubricInstructions:a}=t,l=await this.caller.call(fe(this.debug),`${this.apiUrl}/annotation-queues/${ve(e,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:i,description:r,rubric_instructions:a}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(l,"update annotation queue")}async deleteAnnotationQueue(e){const t=await this.caller.call(fe(this.debug),`${this.apiUrl}/annotation-queues/${ve(e,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(t,"delete annotation queue")}async addRunsToAnnotationQueue(e,t){const i=await this.caller.call(fe(this.debug),`${this.apiUrl}/annotation-queues/${ve(e,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(t.map((r,a)=>ve(r,`runIds[${a}]`).toString())),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(i,"add runs to annotation queue")}async getRunFromAnnotationQueue(e,t){const i=`/annotation-queues/${ve(e,"queueId")}/run`,r=await this.caller.call(fe(this.debug),`${this.apiUrl}${i}/${t}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Te(r,"get run from annotation queue"),await r.json()}async deleteRunFromAnnotationQueue(e,t){const i=await this.caller.call(fe(this.debug),`${this.apiUrl}/annotation-queues/${ve(e,"queueId")}/runs/${ve(t,"queueRunId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(i,"delete run from annotation queue")}async getSizeFromAnnotationQueue(e){const t=await this.caller.call(fe(this.debug),`${this.apiUrl}/annotation-queues/${ve(e,"queueId")}/size`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Te(t,"get size from annotation queue"),await t.json()}async _currentTenantIsOwner(e){const t=await this._getSettings();return e=="-"||t.tenant_handle===e}async _ownerConflictError(e,t){const i=await this._getSettings();return new Error(`Cannot ${e} for another tenant.

      Current tenant: ${i.tenant_handle}

      Requested tenant: ${t}`)}async _getLatestCommitHash(e){const t=await this.caller.call(fe(this.debug),`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),i=await t.json();if(!t.ok){const r=typeof i.detail=="string"?i.detail:JSON.stringify(i.detail),a=new Error(`Error ${t.status}: ${t.statusText}
${r}`);throw a.statusCode=t.status,a}if(i.commits.length!==0)return i.commits[0].commit_hash}async _likeOrUnlikePrompt(e,t){const[i,r,a]=Hi(e),l=await this.caller.call(fe(this.debug),`${this.apiUrl}/likes/${i}/${r}`,{method:"POST",body:JSON.stringify({like:t}),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Te(l,`${t?"like":"unlike"} prompt`),await l.json()}async _getPromptUrl(e){const[t,i,r]=Hi(e);if(await this._currentTenantIsOwner(t)){const a=await this._getSettings();return r!=="latest"?`${this.getHostUrl()}/prompts/${i}/${r.substring(0,8)}?organizationId=${a.id}`:`${this.getHostUrl()}/prompts/${i}?organizationId=${a.id}`}else return r!=="latest"?`${this.getHostUrl()}/hub/${t}/${i}/${r.substring(0,8)}`:`${this.getHostUrl()}/hub/${t}/${i}`}async promptExists(e){return!!await this.getPrompt(e)}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async*listCommits(e){for await(const t of this._getPaginated(`/commits/${e}/`,new URLSearchParams,i=>i.commits))yield*t}async*listPrompts(e){const t=new URLSearchParams;t.append("sort_field",e?.sortField??"updated_at"),t.append("sort_direction","desc"),t.append("is_archived",(!!e?.isArchived).toString()),e?.isPublic!==void 0&&t.append("is_public",e.isPublic.toString()),e?.query&&t.append("query",e.query);for await(const i of this._getPaginated("/repos",t,r=>r.repos))yield*i}async getPrompt(e){const[t,i,r]=Hi(e),a=await this.caller.call(fe(this.debug),`${this.apiUrl}/repos/${t}/${i}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(a.status===404)return null;await Te(a,"get prompt");const l=await a.json();return l.repo?l.repo:null}async createPrompt(e,t){const i=await this._getSettings();if(t?.isPublic&&!i.tenant_handle)throw new Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle.
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);const[r,a,l]=Hi(e);if(!await this._currentTenantIsOwner(r))throw await this._ownerConflictError("create a prompt",r);const c={repo_handle:a,...t?.description&&{description:t.description},...t?.readme&&{readme:t.readme},...t?.tags&&{tags:t.tags},is_public:!!t?.isPublic},f=await this.caller.call(fe(this.debug),`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(f,"create prompt");const{repo:d}=await f.json();return d}async createCommit(e,t,i){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[r,a,l]=Hi(e),c=i?.parentCommitHash==="latest"||!i?.parentCommitHash?await this._getLatestCommitHash(`${r}/${a}`):i?.parentCommitHash,f={manifest:JSON.parse(JSON.stringify(t)),parent_commit:c},d=await this.caller.call(fe(this.debug),`${this.apiUrl}/commits/${r}/${a}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(f),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(d,"create commit");const g=await d.json();return this._getPromptUrl(`${r}/${a}${g.commit_hash?`:${g.commit_hash}`:""}`)}async updateExamplesMultipart(e,t=[]){return this._updateExamplesMultipart(e,t)}async _updateExamplesMultipart(e,t=[]){if(!await this._getMultiPartSupport())throw new Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");const i=new FormData;for(const c of t){const f=c.id,d={...c.metadata&&{metadata:c.metadata},...c.split&&{split:c.split}},g=ln(d,`Serializing body for example with id: ${f}`),_=new Blob([g],{type:"application/json"});if(i.append(f,_),c.inputs){const v=ln(c.inputs,`Serializing inputs for example with id: ${f}`),w=new Blob([v],{type:"application/json"});i.append(`${f}.inputs`,w)}if(c.outputs){const v=ln(c.outputs,`Serializing outputs whle updating example with id: ${f}`),w=new Blob([v],{type:"application/json"});i.append(`${f}.outputs`,w)}if(c.attachments)for(const[v,w]of Object.entries(c.attachments)){let T,S;Array.isArray(w)?[T,S]=w:(T=w.mimeType,S=w.data);const C=new Blob([S],{type:`${T}; length=${S.byteLength}`});i.append(`${f}.attachment.${v}`,C)}if(c.attachments_operations){const v=ln(c.attachments_operations,`Serializing attachments while updating example with id: ${f}`),w=new Blob([v],{type:"application/json"});i.append(`${f}.attachments_operations`,w)}}const r=e??t[0]?.dataset_id;return await(await this.caller.call(fe(this.debug),`${this.apiUrl}${this._getPlatformEndpointPath(`datasets/${r}/examples`)}`,{method:"PATCH",headers:this.headers,body:i})).json()}async uploadExamplesMultipart(e,t=[]){return this._uploadExamplesMultipart(e,t)}async _uploadExamplesMultipart(e,t=[]){if(!await this._getMultiPartSupport())throw new Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");const i=new FormData;for(const l of t){const c=(l.id??Ut()).toString(),f={created_at:l.created_at,...l.metadata&&{metadata:l.metadata},...l.split&&{split:l.split},...l.source_run_id&&{source_run_id:l.source_run_id},...l.use_source_run_io&&{use_source_run_io:l.use_source_run_io},...l.use_source_run_attachments&&{use_source_run_attachments:l.use_source_run_attachments}},d=ln(f,`Serializing body for uploaded example with id: ${c}`),g=new Blob([d],{type:"application/json"});if(i.append(c,g),l.inputs){const _=ln(l.inputs,`Serializing inputs for uploaded example with id: ${c}`),v=new Blob([_],{type:"application/json"});i.append(`${c}.inputs`,v)}if(l.outputs){const _=ln(l.outputs,`Serializing outputs for uploaded example with id: ${c}`),v=new Blob([_],{type:"application/json"});i.append(`${c}.outputs`,v)}if(l.attachments)for(const[_,v]of Object.entries(l.attachments)){let w,T;Array.isArray(v)?[w,T]=v:(w=v.mimeType,T=v.data);const S=new Blob([T],{type:`${w}; length=${T.byteLength}`});i.append(`${c}.attachment.${_}`,S)}}const r=await this.caller.call(fe(this.debug),`${this.apiUrl}${this._getPlatformEndpointPath(`datasets/${e}/examples`)}`,{method:"POST",headers:this.headers,body:i});return await Te(r,"upload examples"),await r.json()}async updatePrompt(e,t){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[i,r]=Hi(e);if(!await this._currentTenantIsOwner(i))throw await this._ownerConflictError("update a prompt",i);const a={};if(t?.description!==void 0&&(a.description=t.description),t?.readme!==void 0&&(a.readme=t.readme),t?.tags!==void 0&&(a.tags=t.tags),t?.isPublic!==void 0&&(a.is_public=t.isPublic),t?.isArchived!==void 0&&(a.is_archived=t.isArchived),Object.keys(a).length===0)throw new Error("No valid update options provided");const l=await this.caller.call(fe(this.debug),`${this.apiUrl}/repos/${i}/${r}`,{method:"PATCH",body:JSON.stringify(a),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Te(l,"update prompt"),l.json()}async deletePrompt(e){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[t,i,r]=Hi(e);if(!await this._currentTenantIsOwner(t))throw await this._ownerConflictError("delete a prompt",t);return await(await this.caller.call(fe(this.debug),`${this.apiUrl}/repos/${t}/${i}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async pullPromptCommit(e,t){const[i,r,a]=Hi(e),l=await this.caller.call(fe(this.debug),`${this.apiUrl}/commits/${i}/${r}/${a}${t?.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Te(l,"pull prompt commit");const c=await l.json();return{owner:i,repo:r,commit_hash:c.commit_hash,manifest:c.manifest,examples:c.examples}}async _pullPrompt(e,t){const i=await this.pullPromptCommit(e,{includeModel:t?.includeModel});return JSON.stringify(i.manifest)}async pushPrompt(e,t){return await this.promptExists(e)?t&&Object.keys(t).some(r=>r!=="object")&&await this.updatePrompt(e,{description:t?.description,readme:t?.readme,tags:t?.tags,isPublic:t?.isPublic}):await this.createPrompt(e,{description:t?.description,readme:t?.readme,tags:t?.tags,isPublic:t?.isPublic}),t?.object?await this.createCommit(e,t?.object,{parentCommitHash:t?.parentCommitHash}):await this._getPromptUrl(e)}async clonePublicDataset(e,t={}){const{sourceApiUrl:i=this.apiUrl,datasetName:r}=t,[a,l]=this.parseTokenOrUrl(e,i),c=new Vo({apiUrl:a,apiKey:"placeholder"}),f=await c.readSharedDataset(l),d=r||f.name;try{if(await this.hasDataset({datasetId:d})){console.log(`Dataset ${d} already exists in your tenant. Skipping.`);return}}catch{}const g=await c.listSharedExamples(l),_=await this.createDataset(d,{description:f.description,dataType:f.data_type||"kv",inputsSchema:f.inputs_schema_definition??void 0,outputsSchema:f.outputs_schema_definition??void 0});try{await this.createExamples({inputs:g.map(v=>v.inputs),outputs:g.flatMap(v=>v.outputs?[v.outputs]:[]),datasetId:_.id})}catch(v){throw console.error(`An error occurred while creating dataset ${d}. You should delete it manually.`),v}}parseTokenOrUrl(e,t,i=2,r="dataset"){try{return ve(e),[t,e]}catch{}try{const l=new URL(e).pathname.split("/").filter(c=>c!=="");if(l.length>=i){const c=l[l.length-i];return[t,c]}else throw new Error(`Invalid public ${r} URL: ${e}`)}catch{throw new Error(`Invalid public ${r} URL or token: ${e}`)}}async awaitPendingTraceBatches(){if(this.manualFlushMode)return console.warn("[WARNING]: When tracing in manual flush mode, you must call `await client.flush()` manually to submit trace batches."),Promise.resolve();await Promise.all([...this.autoBatchQueue.items.map(({itemPromise:e})=>e),this.batchIngestCaller.queue.onIdle()]),this.langSmithToOTELTranslator!==void 0&&await aM()?.DEFAULT_LANGSMITH_SPAN_PROCESSOR?.forceFlush()}}function $0(n){return"dataset_id"in n||"dataset_name"in n}const aN=n=>!!["TRACING_V2","TRACING"].find(t=>un(t)==="true"),ip=Symbol.for("lc:context_variables");function oN(n){return n.replace(/[-:.]/g,"")}function QE(n,e,t=1){const i=t.toFixed(0).slice(0,3).padStart(3,"0"),r=`${new Date(n).toISOString().slice(0,-1)}${i}Z`;return{dottedOrder:oN(r)+e,microsecondPrecisionDatestring:r}}class tc{constructor(e,t,i,r){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"replicas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=t,this.project_name=i,this.replicas=r}static fromHeader(e){const t=e.split(",");let i={},r=[],a,l;for(const c of t){const[f,d]=c.split("="),g=decodeURIComponent(d);f==="langsmith-metadata"?i=JSON.parse(g):f==="langsmith-tags"?r=g.split(","):f==="langsmith-project"?a=g:f==="langsmith-replicas"&&(l=JSON.parse(g))}return new tc(i,r,a,l)}toHeader(){const e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),this.project_name&&e.push(`langsmith-project=${encodeURIComponent(this.project_name)}`),e.join(",")}}class Yt{constructor(e){if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"attachments",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"replicas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_serialized_start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),lN(e)){Object.assign(this,{...e});return}const t=Yt.getDefaultConfig(),{metadata:i,...r}=e,a=r.client??Yt.getSharedClient(),l={...i,...r?.extra?.metadata};if(r.extra={...r.extra,metadata:l},Object.assign(this,{...t,...r,client:a}),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.replicas=hN(this.replicas),this.execution_order??=1,this.child_execution_order??=1,!this.dotted_order){const{dottedOrder:c,microsecondPrecisionDatestring:f}=QE(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+c:this.dotted_order=c,this._serialized_start_time=f}}set metadata(e){this.extra={...this.extra,metadata:{...this.extra?.metadata,...e}}}get metadata(){return this.extra?.metadata}static getDefaultConfig(){return{id:Ut(),run_type:"chain",project_name:$E(),child_runs:[],api_url:Kn("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:Kn("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}static getSharedClient(){return Yt.sharedClient||(Yt.sharedClient=new Vo),Yt.sharedClient}createChild(e){const t=this.child_execution_order+1,i=new Yt({...e,parent_run:this,project_name:this.project_name,replicas:this.replicas,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:t,child_execution_order:t});ip in this&&(i[ip]=this[ip]);const r=Symbol.for("lc:child_config"),a=e.extra?.[r]??this.extra[r];if(cN(a)){const f={...a},d=uN(f.callbacks)?f.callbacks.copy?.():void 0;d&&(Object.assign(d,{_parentRunId:i.id}),d.handlers?.find(XE)?.updateFromRunTree?.(i),f.callbacks=d),i.extra[r]=f}const l=new Set;let c=this;for(;c!=null&&!l.has(c.id);)l.add(c.id),c.child_execution_order=Math.max(c.child_execution_order,t),c=c.parent_run;return this.child_runs.push(i),i}async end(e,t,i=Date.now(),r){this.outputs=this.outputs??e,this.error=this.error??t,this.end_time=this.end_time??i,r&&Object.keys(r).length>0&&(this.extra=this.extra?{...this.extra,metadata:{...this.extra.metadata,...r}}:{metadata:r})}_convertToCreate(e,t,i=!0){const r=e.extra??{};if(r?.runtime?.library===void 0&&(r.runtime||(r.runtime={}),t))for(const[c,f]of Object.entries(t))r.runtime[c]||(r.runtime[c]=f);let a,l;return i?(l=e.parent_run?.id??e.parent_run_id,a=[]):(a=e.child_runs.map(c=>this._convertToCreate(c,t,i)),l=void 0),{id:e.id,name:e.name,start_time:e._serialized_start_time??e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:r,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:a,parent_run_id:l,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags,attachments:e.attachments,events:e.events}}_remapForProject(e,t,i=!0){const r=this._convertToCreate(this,t,i);if(e===this.project_name)return r;const a=_=>Cb(`${_}:${e}`,Cb.DNS),l=a(r.id),c=r.trace_id?a(r.trace_id):void 0,f=r.parent_run_id?a(r.parent_run_id):void 0;let d;if(r.dotted_order){const _=fN(r.dotted_order),v=[];for(let T=0;T<_.length-1;T++){const[S,C]=_[T],x=a(C);v.push(S.toISOString().replace(/[-:]/g,"").replace(".","")+x)}const[w]=_[_.length-1];v.push(w.toISOString().replace(/[-:]/g,"").replace(".","")+l),d=v.join(".")}else d=void 0;return{...r,id:l,trace_id:c,parent_run_id:f,dotted_order:d,session_name:e}}async postRun(e=!0){try{const t=GE();if(this.replicas&&this.replicas.length>0)for(const{projectName:i,apiKey:r,apiUrl:a}of this.replicas){const l=this._remapForProject(i??this.project_name,t,!0);await this.client.createRun(l,{apiKey:r,apiUrl:a})}else{const i=this._convertToCreate(this,t,e);await this.client.createRun(i)}if(!e){HE("Posting with excludeChildRuns=false is deprecated and will be removed in a future version.");for(const i of this.child_runs)await i.postRun(!1)}}catch(t){console.error(`Error in postRun for run ${this.id}:`,t)}}async patchRun(){if(this.replicas&&this.replicas.length>0)for(const{projectName:e,apiKey:t,apiUrl:i,updates:r}of this.replicas){const a=this._remapForProject(e??this.project_name);await this.client.updateRun(a.id,{inputs:a.inputs,outputs:a.outputs,error:a.error,parent_run_id:a.parent_run_id,session_name:a.session_name,reference_example_id:a.reference_example_id,end_time:a.end_time,dotted_order:a.dotted_order,trace_id:a.trace_id,events:a.events,tags:a.tags,extra:a.extra,attachments:this.attachments,...r},{apiKey:t,apiUrl:i})}else try{const e={end_time:this.end_time,error:this.error,inputs:this.inputs,outputs:this.outputs,parent_run_id:this.parent_run?.id??this.parent_run_id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags,attachments:this.attachments,session_name:this.project_name};await this.client.updateRun(this.id,e)}catch(e){console.error(`Error in patchRun for run ${this.id}`,e)}}toJSON(){return this._convertToCreate(this,void 0,!1)}addEvent(e){this.events||(this.events=[]),typeof e=="string"?this.events.push({name:"event",time:new Date().toISOString(),message:e}):this.events.push({...e,time:e.time??new Date().toISOString()})}static fromRunnableConfig(e,t){const i=e?.callbacks;let r,a,l,c=aN();if(i){const d=i?.getParentRunId?.()??"",g=i?.handlers?.find(_=>_?.name=="langchain_tracer");r=g?.getRun?.(d),a=g?.projectName,l=g?.client,c=c||!!g}return r?new Yt({name:r.name,id:r.id,trace_id:r.trace_id,dotted_order:r.dotted_order,client:l,tracingEnabled:c,project_name:a,tags:[...new Set((r?.tags??[]).concat(e?.tags??[]))],extra:{metadata:{...r?.extra?.metadata,...e?.metadata}}}).createChild(t):new Yt({...t,client:l,tracingEnabled:c,project_name:a})}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,t){const i="get"in e&&typeof e.get=="function"?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,r=i["langsmith-trace"];if(!r||typeof r!="string")return;const a=r.trim(),l=a.split(".").map(d=>{const[g,_]=d.split("Z");return{strTime:g,time:Date.parse(g+"Z"),uuid:_}}),c=l[0].uuid,f={...t,name:t?.name??"parent",run_type:t?.run_type??"chain",start_time:t?.start_time??Date.now(),id:l.at(-1)?.uuid,trace_id:c,dotted_order:a};if(i.baggage&&typeof i.baggage=="string"){const d=tc.fromHeader(i.baggage);f.metadata=d.metadata,f.tags=d.tags,f.project_name=d.project_name,f.replicas=d.replicas}return new Yt(f)}toHeaders(e){const t={"langsmith-trace":this.dotted_order,baggage:new tc(this.extra?.metadata,this.tags,this.project_name,this.replicas).toHeader()};if(e)for(const[i,r]of Object.entries(t))e.set(i,r);return t}}Object.defineProperty(Yt,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null});function lN(n){return n!==void 0&&typeof n.createChild=="function"&&typeof n.postRun=="function"}function XE(n){return typeof n=="object"&&n!=null&&typeof n.name=="string"&&n.name==="langchain_tracer"}function q0(n){return Array.isArray(n)&&n.some(e=>XE(e))}function uN(n){return typeof n=="object"&&n!=null&&Array.isArray(n.handlers)}function cN(n){return n!==void 0&&typeof n.callbacks=="object"&&(q0(n.callbacks?.handlers)||q0(n.callbacks))}function fN(n){return n.split(".").map(t=>{const i=t.slice(0,-36),r=t.slice(-36),a=parseInt(i.slice(0,4)),l=parseInt(i.slice(4,6))-1,c=parseInt(i.slice(6,8)),f=parseInt(i.slice(9,11)),d=parseInt(i.slice(11,13)),g=parseInt(i.slice(13,15)),_=parseInt(i.slice(15,21));return[new Date(a,l,c,f,d,g,_/1e3),r]})}function dN(){const n=Kn("LANGSMITH_RUNS_ENDPOINTS");if(!n)return[];try{const e=JSON.parse(n);if(Array.isArray(e)){const t=[];for(const i of e){if(typeof i!="object"||i===null){console.warn(`Invalid item type in LANGSMITH_RUNS_ENDPOINTS: expected object, got ${typeof i}`);continue}if(typeof i.api_url!="string"){console.warn(`Invalid api_url type in LANGSMITH_RUNS_ENDPOINTS: expected string, got ${typeof i.api_url}`);continue}if(typeof i.api_key!="string"){console.warn(`Invalid api_key type in LANGSMITH_RUNS_ENDPOINTS: expected string, got ${typeof i.api_key}`);continue}t.push({apiUrl:i.api_url.replace(/\/$/,""),apiKey:i.api_key})}return t}else if(typeof e=="object"&&e!==null){pN(e);const t=[];for(const[i,r]of Object.entries(e)){const a=i.replace(/\/$/,"");if(typeof r=="string")t.push({apiUrl:a,apiKey:r});else{console.warn(`Invalid value type in LANGSMITH_RUNS_ENDPOINTS for URL ${i}: expected string, got ${typeof r}`);continue}}return t}else return console.warn(`Invalid LANGSMITH_RUNS_ENDPOINTS – must be valid JSON array of objects with api_url and api_key properties, or object mapping url->apiKey, got ${typeof e}`),[]}catch(e){if(JM(e))throw e;return console.warn("Invalid LANGSMITH_RUNS_ENDPOINTS – must be valid JSON array of objects with api_url and api_key properties, or object mapping url->apiKey"),[]}}function hN(n){return n?n.map(e=>Array.isArray(e)?{projectName:e[0],updates:e[1]}:e):dN()}function pN(n){if(Object.keys(n).length>0&&un("ENDPOINT"))throw new jM}var rp,B0;function mN(){return B0||(B0=1,rp=function(n,e){if(typeof n!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,n.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()}),rp}var gN=mN();const yN=aa(gN);var Nu={exports:{}},G0;function _N(){if(G0)return Nu.exports;G0=1;const n=/[\p{Lu}]/u,e=/[\p{Ll}]/u,t=/^[\p{Lu}](?![\p{Lu}])/gu,i=/([\p{Alpha}\p{N}_]|$)/u,r=/[_.\- ]+/,a=new RegExp("^"+r.source),l=new RegExp(r.source+i.source,"gu"),c=new RegExp("\\d+"+i.source,"gu"),f=(v,w,T)=>{let S=!1,C=!1,x=!1;for(let M=0;M<v.length;M++){const R=v[M];S&&n.test(R)?(v=v.slice(0,M)+"-"+v.slice(M),S=!1,x=C,C=!0,M++):C&&x&&e.test(R)?(v=v.slice(0,M-1)+"-"+v.slice(M-1),x=C,C=!1,S=!0):(S=w(R)===R&&T(R)!==R,x=C,C=T(R)===R&&w(R)!==R)}return v},d=(v,w)=>(t.lastIndex=0,v.replace(t,T=>w(T))),g=(v,w)=>(l.lastIndex=0,c.lastIndex=0,v.replace(l,(T,S)=>w(S)).replace(c,T=>w(T))),_=(v,w)=>{if(!(typeof v=="string"||Array.isArray(v)))throw new TypeError("Expected the input to be `string | string[]`");if(w={pascalCase:!1,preserveConsecutiveUppercase:!1,...w},Array.isArray(v)?v=v.map(x=>x.trim()).filter(x=>x.length).join("-"):v=v.trim(),v.length===0)return"";const T=w.locale===!1?x=>x.toLowerCase():x=>x.toLocaleLowerCase(w.locale),S=w.locale===!1?x=>x.toUpperCase():x=>x.toLocaleUpperCase(w.locale);return v.length===1?w.pascalCase?S(v):T(v):(v!==T(v)&&(v=f(v,T,S)),v=v.replace(a,""),w.preserveConsecutiveUppercase?v=d(v,T):v=T(v),w.pascalCase&&(v=S(v.charAt(0))+v.slice(1)),g(v,S))};return Nu.exports=_,Nu.exports.default=_,Nu.exports}_N();function vN(n,e){return e?.[n]||yN(n)}function bN(n,e,t){const i={};for(const r in n)Object.hasOwn(n,r)&&(i[e(r,t)]=n[r]);return i}function V0(n){return Array.isArray(n)?[...n]:{...n}}function wN(n,e){const t=V0(n);for(const[i,r]of Object.entries(e)){const[a,...l]=i.split(".").reverse();let c=t;for(const f of l.reverse()){if(c[f]===void 0)break;c[f]=V0(c[f]),c=c[f]}c[a]!==void 0&&(c[a]={lc:1,type:"secret",id:[r]})}return t}function WE(n){const e=Object.getPrototypeOf(n);return typeof n.lc_name=="function"&&(typeof e.lc_name!="function"||n.lc_name()!==e.lc_name())?n.lc_name():n.name}class ur{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,WE(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}constructor(e,...t){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_serializable_keys!==void 0?this.lc_kwargs=Object.fromEntries(Object.entries(e||{}).filter(([i])=>this.lc_serializable_keys?.includes(i))):this.lc_kwargs=e??{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof ur||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},t={},i=Object.keys(this.lc_kwargs).reduce((r,a)=>(r[a]=a in this?this[a]:this.lc_kwargs[a],r),{});for(let r=Object.getPrototypeOf(this);r;r=Object.getPrototypeOf(r))Object.assign(e,Reflect.get(r,"lc_aliases",this)),Object.assign(t,Reflect.get(r,"lc_secrets",this)),Object.assign(i,Reflect.get(r,"lc_attributes",this));return Object.keys(t).forEach(r=>{let a=this,l=i;const[c,...f]=r.split(".").reverse();for(const d of f.reverse()){if(!(d in a)||a[d]===void 0)return;(!(d in l)||l[d]===void 0)&&(typeof a[d]=="object"&&a[d]!=null?l[d]={}:Array.isArray(a[d])&&(l[d]=[])),a=a[d],l=l[d]}c in a&&a[c]!==void 0&&(l[c]=l[c]||a[c])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:bN(Object.keys(t).length?wN(i,t):i,vN,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}var TN={};const EN=()=>typeof window<"u"&&typeof window.document<"u",SN=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",CN=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&navigator.userAgent.includes("jsdom"),Mm=()=>typeof Deno<"u",AN=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!Mm(),RN=()=>{let n;return EN()?n="browser":AN()?n="node":SN()?n="webworker":CN()?n="jsdom":Mm()?n="deno":n="other",n};let sp;function xN(){return sp===void 0&&(sp={library:"langchain-js",runtime:RN()}),sp}function sr(n){try{return typeof process<"u"?TN?.[n]:Mm()?Deno?.env.get(n):void 0}catch{return}}class IN{}function MN(n){return"lc_prefer_streaming"in n&&n.lc_prefer_streaming}class Xo extends IN{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,WE(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:sr("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}copy(){return new this.constructor(this)}toJSON(){return ur.prototype.toJSON.call(this)}toJSONNotImplemented(){return ur.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class t extends Xo{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Ut()}),Object.assign(this,e)}}return new t}}const NN=n=>{const e=n;return e!==void 0&&typeof e.copy=="function"&&typeof e.name=="string"&&typeof e.awaitHandlers=="boolean"},ON=n=>{if(n)return n.events=n.events??[],n.child_runs=n.child_runs??[],n};function Vp(n,e){if(n)return new Yt({...n,start_time:n._serialized_start_time??n.start_time,parent_run:Vp(e),child_runs:n.child_runs.map(t=>Vp(t)).filter(t=>t!==void 0),extra:{...n.extra,runtime:xN()},tracingEnabled:!1})}function ap(n,e){return n&&!Array.isArray(n)&&typeof n=="object"?n:{[e]:n}}function bo(n){return typeof n._addRunToRunMap=="function"}class Wo extends Xo{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"runTreeMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"usesRunTreeMap",{enumerable:!0,configurable:!0,writable:!0,value:!1})}copy(){return this}getRunById(e){if(e!==void 0)return this.usesRunTreeMap?ON(this.runTreeMap.get(e)):this.runMap.get(e)}stringifyError(e){return e instanceof Error?e.message+(e?.stack?`

${e.stack}`:""):typeof e=="string"?e:`${e}`}_addChildRun(e,t){e.child_runs.push(t)}_addRunToRunMap(e){const{dottedOrder:t,microsecondPrecisionDatestring:i}=QE(new Date(e.start_time).getTime(),e.id,e.execution_order),r={...e},a=this.getRunById(r.parent_run_id);if(r.parent_run_id!==void 0?a&&(this._addChildRun(a,r),a.child_execution_order=Math.max(a.child_execution_order,r.child_execution_order),r.trace_id=a.trace_id,a.dotted_order!==void 0&&(r.dotted_order=[a.dotted_order,t].join("."),r._serialized_start_time=i)):(r.trace_id=r.id,r.dotted_order=t,r._serialized_start_time=i),this.usesRunTreeMap){const l=Vp(r,a);l!==void 0&&this.runTreeMap.set(r.id,l)}else this.runMap.set(r.id,r);return r}async _endTrace(e){const t=e.parent_run_id!==void 0&&this.getRunById(e.parent_run_id);t?t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order):await this.persistRun(e),await this.onRunUpdate?.(e),this.usesRunTreeMap?this.runTreeMap.delete(e.id):this.runMap.delete(e.id)}_getExecutionOrder(e){const t=e!==void 0&&this.getRunById(e);return t?t.child_execution_order+1:1}_createRunForLLMStart(e,t,i,r,a,l,c,f){const d=this._getExecutionOrder(r),g=Date.now(),_=c?{...a,metadata:c}:a,v={id:i,name:f??e.id[e.id.length-1],parent_run_id:r,start_time:g,serialized:e,events:[{name:"start",time:new Date(g).toISOString()}],inputs:{prompts:t},execution_order:d,child_runs:[],child_execution_order:d,run_type:"llm",extra:_??{},tags:l||[]};return this._addRunToRunMap(v)}async handleLLMStart(e,t,i,r,a,l,c,f){const d=this.getRunById(i)??this._createRunForLLMStart(e,t,i,r,a,l,c,f);return await this.onRunCreate?.(d),await this.onLLMStart?.(d),d}_createRunForChatModelStart(e,t,i,r,a,l,c,f){const d=this._getExecutionOrder(r),g=Date.now(),_=c?{...a,metadata:c}:a,v={id:i,name:f??e.id[e.id.length-1],parent_run_id:r,start_time:g,serialized:e,events:[{name:"start",time:new Date(g).toISOString()}],inputs:{messages:t},execution_order:d,child_runs:[],child_execution_order:d,run_type:"llm",extra:_??{},tags:l||[]};return this._addRunToRunMap(v)}async handleChatModelStart(e,t,i,r,a,l,c,f){const d=this.getRunById(i)??this._createRunForChatModelStart(e,t,i,r,a,l,c,f);return await this.onRunCreate?.(d),await this.onLLMStart?.(d),d}async handleLLMEnd(e,t,i,r,a){const l=this.getRunById(t);if(!l||l?.run_type!=="llm")throw new Error("No LLM run to end.");return l.end_time=Date.now(),l.outputs=e,l.events.push({name:"end",time:new Date(l.end_time).toISOString()}),l.extra={...l.extra,...a},await this.onLLMEnd?.(l),await this._endTrace(l),l}async handleLLMError(e,t,i,r,a){const l=this.getRunById(t);if(!l||l?.run_type!=="llm")throw new Error("No LLM run to end.");return l.end_time=Date.now(),l.error=this.stringifyError(e),l.events.push({name:"error",time:new Date(l.end_time).toISOString()}),l.extra={...l.extra,...a},await this.onLLMError?.(l),await this._endTrace(l),l}_createRunForChainStart(e,t,i,r,a,l,c,f){const d=this._getExecutionOrder(r),g=Date.now(),_={id:i,name:f??e.id[e.id.length-1],parent_run_id:r,start_time:g,serialized:e,events:[{name:"start",time:new Date(g).toISOString()}],inputs:t,execution_order:d,child_execution_order:d,run_type:c??"chain",child_runs:[],extra:l?{metadata:l}:{},tags:a||[]};return this._addRunToRunMap(_)}async handleChainStart(e,t,i,r,a,l,c,f){const d=this.getRunById(i)??this._createRunForChainStart(e,t,i,r,a,l,c,f);return await this.onRunCreate?.(d),await this.onChainStart?.(d),d}async handleChainEnd(e,t,i,r,a){const l=this.getRunById(t);if(!l)throw new Error("No chain run to end.");return l.end_time=Date.now(),l.outputs=ap(e,"output"),l.events.push({name:"end",time:new Date(l.end_time).toISOString()}),a?.inputs!==void 0&&(l.inputs=ap(a.inputs,"input")),await this.onChainEnd?.(l),await this._endTrace(l),l}async handleChainError(e,t,i,r,a){const l=this.getRunById(t);if(!l)throw new Error("No chain run to end.");return l.end_time=Date.now(),l.error=this.stringifyError(e),l.events.push({name:"error",time:new Date(l.end_time).toISOString()}),a?.inputs!==void 0&&(l.inputs=ap(a.inputs,"input")),await this.onChainError?.(l),await this._endTrace(l),l}_createRunForToolStart(e,t,i,r,a,l,c){const f=this._getExecutionOrder(r),d=Date.now(),g={id:i,name:c??e.id[e.id.length-1],parent_run_id:r,start_time:d,serialized:e,events:[{name:"start",time:new Date(d).toISOString()}],inputs:{input:t},execution_order:f,child_execution_order:f,run_type:"tool",child_runs:[],extra:l?{metadata:l}:{},tags:a||[]};return this._addRunToRunMap(g)}async handleToolStart(e,t,i,r,a,l,c){const f=this.getRunById(i)??this._createRunForToolStart(e,t,i,r,a,l,c);return await this.onRunCreate?.(f),await this.onToolStart?.(f),f}async handleToolEnd(e,t){const i=this.getRunById(t);if(!i||i?.run_type!=="tool")throw new Error("No tool run to end");return i.end_time=Date.now(),i.outputs={output:e},i.events.push({name:"end",time:new Date(i.end_time).toISOString()}),await this.onToolEnd?.(i),await this._endTrace(i),i}async handleToolError(e,t){const i=this.getRunById(t);if(!i||i?.run_type!=="tool")throw new Error("No tool run to end");return i.end_time=Date.now(),i.error=this.stringifyError(e),i.events.push({name:"error",time:new Date(i.end_time).toISOString()}),await this.onToolError?.(i),await this._endTrace(i),i}async handleAgentAction(e,t){const i=this.getRunById(t);if(!i||i?.run_type!=="chain")return;const r=i;r.actions=r.actions||[],r.actions.push(e),r.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await this.onAgentAction?.(i)}async handleAgentEnd(e,t){const i=this.getRunById(t);!i||i?.run_type!=="chain"||(i.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await this.onAgentEnd?.(i))}_createRunForRetrieverStart(e,t,i,r,a,l,c){const f=this._getExecutionOrder(r),d=Date.now(),g={id:i,name:c??e.id[e.id.length-1],parent_run_id:r,start_time:d,serialized:e,events:[{name:"start",time:new Date(d).toISOString()}],inputs:{query:t},execution_order:f,child_execution_order:f,run_type:"retriever",child_runs:[],extra:l?{metadata:l}:{},tags:a||[]};return this._addRunToRunMap(g)}async handleRetrieverStart(e,t,i,r,a,l,c){const f=this.getRunById(i)??this._createRunForRetrieverStart(e,t,i,r,a,l,c);return await this.onRunCreate?.(f),await this.onRetrieverStart?.(f),f}async handleRetrieverEnd(e,t){const i=this.getRunById(t);if(!i||i?.run_type!=="retriever")throw new Error("No retriever run to end");return i.end_time=Date.now(),i.outputs={documents:e},i.events.push({name:"end",time:new Date(i.end_time).toISOString()}),await this.onRetrieverEnd?.(i),await this._endTrace(i),i}async handleRetrieverError(e,t){const i=this.getRunById(t);if(!i||i?.run_type!=="retriever")throw new Error("No retriever run to end");return i.end_time=Date.now(),i.error=this.stringifyError(e),i.events.push({name:"error",time:new Date(i.end_time).toISOString()}),await this.onRetrieverError?.(i),await this._endTrace(i),i}async handleText(e,t){const i=this.getRunById(t);!i||i?.run_type!=="chain"||(i.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await this.onText?.(i))}async handleLLMNewToken(e,t,i,r,a,l){const c=this.getRunById(i);if(!c||c?.run_type!=="llm")throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return c.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:t,chunk:l?.chunk}}),await this.onLLMNewToken?.(c,e,{chunk:l?.chunk}),c}}var Gu={exports:{}};Gu.exports;var F0;function kN(){return F0||(F0=1,function(n){const t=(a=0)=>l=>`\x1B[${38+a};5;${l}m`,i=(a=0)=>(l,c,f)=>`\x1B[${38+a};2;${l};${c};${f}m`;function r(){const a=new Map,l={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};l.color.gray=l.color.blackBright,l.bgColor.bgGray=l.bgColor.bgBlackBright,l.color.grey=l.color.blackBright,l.bgColor.bgGrey=l.bgColor.bgBlackBright;for(const[c,f]of Object.entries(l)){for(const[d,g]of Object.entries(f))l[d]={open:`\x1B[${g[0]}m`,close:`\x1B[${g[1]}m`},f[d]=l[d],a.set(g[0],g[1]);Object.defineProperty(l,c,{value:f,enumerable:!1})}return Object.defineProperty(l,"codes",{value:a,enumerable:!1}),l.color.close="\x1B[39m",l.bgColor.close="\x1B[49m",l.color.ansi256=t(),l.color.ansi16m=i(),l.bgColor.ansi256=t(10),l.bgColor.ansi16m=i(10),Object.defineProperties(l,{rgbToAnsi256:{value:(c,f,d)=>c===f&&f===d?c<8?16:c>248?231:Math.round((c-8)/247*24)+232:16+36*Math.round(c/255*5)+6*Math.round(f/255*5)+Math.round(d/255*5),enumerable:!1},hexToRgb:{value:c=>{const f=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(c.toString(16));if(!f)return[0,0,0];let{colorString:d}=f.groups;d.length===3&&(d=d.split("").map(_=>_+_).join(""));const g=Number.parseInt(d,16);return[g>>16&255,g>>8&255,g&255]},enumerable:!1},hexToAnsi256:{value:c=>l.rgbToAnsi256(...l.hexToRgb(c)),enumerable:!1}}),l}Object.defineProperty(n,"exports",{enumerable:!0,get:r})}(Gu)),Gu.exports}var PN=kN();const eS=aa(PN);function Dt(n,e){return`${n.open}${e}${n.close}`}function Tn(n,e){try{return JSON.stringify(n,null,2)}catch{return e}}function H0(n){return typeof n=="string"?n.trim():n==null?n:Tn(n,n.toString())}function zi(n){if(!n.end_time)return"";const e=n.end_time-n.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:Jt}=eS;class z0 extends Wo{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const t=[];let i=e;for(;i.parent_run_id;){const r=this.runMap.get(i.parent_run_id);if(r)t.push(r),i=r;else break}return t}getBreadcrumbs(e){const i=[...this.getParents(e).reverse(),e].map((r,a,l)=>{const c=`${r.execution_order}:${r.run_type}:${r.name}`;return a===l.length-1?Dt(eS.bold,c):c}).join(" > ");return Dt(Jt.grey,i)}onChainStart(e){const t=this.getBreadcrumbs(e);console.log(`${Dt(Jt.green,"[chain/start]")} [${t}] Entering Chain run with input: ${Tn(e.inputs,"[inputs]")}`)}onChainEnd(e){const t=this.getBreadcrumbs(e);console.log(`${Dt(Jt.cyan,"[chain/end]")} [${t}] [${zi(e)}] Exiting Chain run with output: ${Tn(e.outputs,"[outputs]")}`)}onChainError(e){const t=this.getBreadcrumbs(e);console.log(`${Dt(Jt.red,"[chain/error]")} [${t}] [${zi(e)}] Chain run errored with error: ${Tn(e.error,"[error]")}`)}onLLMStart(e){const t=this.getBreadcrumbs(e),i="prompts"in e.inputs?{prompts:e.inputs.prompts.map(r=>r.trim())}:e.inputs;console.log(`${Dt(Jt.green,"[llm/start]")} [${t}] Entering LLM run with input: ${Tn(i,"[inputs]")}`)}onLLMEnd(e){const t=this.getBreadcrumbs(e);console.log(`${Dt(Jt.cyan,"[llm/end]")} [${t}] [${zi(e)}] Exiting LLM run with output: ${Tn(e.outputs,"[response]")}`)}onLLMError(e){const t=this.getBreadcrumbs(e);console.log(`${Dt(Jt.red,"[llm/error]")} [${t}] [${zi(e)}] LLM run errored with error: ${Tn(e.error,"[error]")}`)}onToolStart(e){const t=this.getBreadcrumbs(e);console.log(`${Dt(Jt.green,"[tool/start]")} [${t}] Entering Tool run with input: "${H0(e.inputs.input)}"`)}onToolEnd(e){const t=this.getBreadcrumbs(e);console.log(`${Dt(Jt.cyan,"[tool/end]")} [${t}] [${zi(e)}] Exiting Tool run with output: "${H0(e.outputs?.output)}"`)}onToolError(e){const t=this.getBreadcrumbs(e);console.log(`${Dt(Jt.red,"[tool/error]")} [${t}] [${zi(e)}] Tool run errored with error: ${Tn(e.error,"[error]")}`)}onRetrieverStart(e){const t=this.getBreadcrumbs(e);console.log(`${Dt(Jt.green,"[retriever/start]")} [${t}] Entering Retriever run with input: ${Tn(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const t=this.getBreadcrumbs(e);console.log(`${Dt(Jt.cyan,"[retriever/end]")} [${t}] [${zi(e)}] Exiting Retriever run with output: ${Tn(e.outputs,"[outputs]")}`)}onRetrieverError(e){const t=this.getBreadcrumbs(e);console.log(`${Dt(Jt.red,"[retriever/error]")} [${t}] [${zi(e)}] Retriever run errored with error: ${Tn(e.error,"[error]")}`)}onAgentAction(e){const t=e,i=this.getBreadcrumbs(e);console.log(`${Dt(Jt.blue,"[agent/action]")} [${i}] Agent selected action: ${Tn(t.actions[t.actions.length-1],"[action]")}`)}}function Nm(n,e){return n.lc_error_code=e,n.message=`${n.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,n}function tS(n){return!!(n&&typeof n=="object"&&"type"in n&&n.type==="tool_call")}class DN extends Error{constructor(e,t){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=t}}function j0(n,e=nS){n=n.trim();const t=n.indexOf("```");if(t===-1)return e(n);let i=n.substring(t+3);i.startsWith(`json
`)?i=i.substring(5):i.startsWith("json")?i=i.substring(4):i.startsWith(`
`)&&(i=i.substring(1));const r=i.indexOf("```");let a=i;return r!==-1&&(a=i.substring(0,r)),e(a.trim())}function nS(n){if(typeof n>"u")return null;try{return JSON.parse(n)}catch{}let e="";const t=[];let i=!1,r=!1;for(let a of n){if(i)a==='"'&&!r?i=!1:a===`
`&&!r?a="\\n":a==="\\"?r=!r:r=!1;else if(a==='"')i=!0,r=!1;else if(a==="{")t.push("}");else if(a==="[")t.push("]");else if(a==="}"||a==="]")if(t&&t[t.length-1]===a)t.pop();else return null;e+=a}i&&(e+='"');for(let a=t.length-1;a>=0;a-=1)e+=t[a];try{return JSON.parse(e)}catch{return null}}function ta(n){return typeof n=="object"&&n!==null&&"type"in n&&typeof n.type=="string"&&"source_type"in n&&(n.source_type==="url"||n.source_type==="base64"||n.source_type==="text"||n.source_type==="id")}function LN(n){return ta(n)&&n.source_type==="url"&&"url"in n&&typeof n.url=="string"}function UN(n){return ta(n)&&n.source_type==="base64"&&"data"in n&&typeof n.data=="string"}function $N(n){if(ta(n)){if(n.source_type==="url")return{type:"image_url",image_url:{url:n.url}};if(n.source_type==="base64"){if(!n.mime_type)throw new Error("mime_type key is required for base64 data.");return{type:"image_url",image_url:{url:`data:${n.mime_type};base64,${n.data}`}}}}throw new Error("Unsupported source type. Only 'url' and 'base64' are supported.")}function op({dataUrl:n,asTypedArray:e=!1}){const t=n.match(/^data:(\w+\/\w+);base64,([A-Za-z0-9+/]+=*)$/);let i;if(t){i=t[1].toLowerCase();const r=e?Uint8Array.from(atob(t[2]),a=>a.charCodeAt(0)):t[2];return{mime_type:i,data:r}}}function qN(n,e){if(n.type==="text"){if(!e.fromStandardTextBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardTextBlock\` method.`);return e.fromStandardTextBlock(n)}if(n.type==="image"){if(!e.fromStandardImageBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardImageBlock\` method.`);return e.fromStandardImageBlock(n)}if(n.type==="audio"){if(!e.fromStandardAudioBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardAudioBlock\` method.`);return e.fromStandardAudioBlock(n)}if(n.type==="file"){if(!e.fromStandardFileBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardFileBlock\` method.`);return e.fromStandardFileBlock(n)}throw new Error(`Unable to convert content block type '${n.type}' to provider-specific format: not recognized.`)}function el(n,e){return typeof n=="string"?n===""?e:typeof e=="string"?n+e:Array.isArray(e)&&e.some(t=>ta(t))?[{type:"text",source_type:"text",text:n},...e]:[{type:"text",text:n},...e]:Array.isArray(e)?Om(n,e)??[...n,...e]:e===""?n:Array.isArray(n)&&n.some(t=>ta(t))?[...n,{type:"file",source_type:"text",text:e}]:[...n,{type:"text",text:e}]}function BN(n,e){function t(i,r){if(typeof i!="object"||i===null||i===void 0)return i;if(r>=e)return Array.isArray(i)?"[Array]":"[Object]";if(Array.isArray(i))return i.map(l=>t(l,r+1));const a={};for(const l of Object.keys(i))a[l]=t(i[l],r+1);return a}return JSON.stringify(t(n,0),null,2)}class la extends ur{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return typeof this.content=="string"?this.content:Array.isArray(this.content)?this.content.map(e=>typeof e=="string"?e:e.type==="text"?e.text:"").join(""):""}getType(){return this._getType()}constructor(e,t){typeof e=="string"&&(e={content:e,additional_kwargs:t,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata,this.id=e.id}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}_updateId(e){this.id=e,this.lc_kwargs.id=e}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){if(e===null)return this;const t=BN(this._printableFields,Math.max(4,e));return`${this.constructor.lc_name()} ${t}`}}function Sn(n,e){const t={...n};for(const[i,r]of Object.entries(e))if(t[i]==null)t[i]=r;else{if(r==null)continue;if(typeof t[i]!=typeof r||Array.isArray(t[i])!==Array.isArray(r))throw new Error(`field[${i}] already exists in the message chunk, but with a different type.`);if(typeof t[i]=="string"){if(i==="type")continue;t[i]+=r}else if(typeof t[i]=="object"&&!Array.isArray(t[i]))t[i]=Sn(t[i],r);else if(Array.isArray(t[i]))t[i]=Om(t[i],r);else{if(t[i]===r)continue;console.warn(`field[${i}] already exists in this message chunk and value has unsupported type.`)}}return t}function Om(n,e){if(!(n===void 0&&e===void 0)){if(n===void 0||e===void 0)return n||e;{const t=[...n];for(const i of e)if(typeof i=="object"&&"index"in i&&typeof i.index=="number"){const r=t.findIndex(a=>a.index===i.index);r!==-1?t[r]=Sn(t[r],i):t.push(i)}else{if(typeof i=="object"&&"text"in i&&i.text==="")continue;t.push(i)}return t}}}class tl extends la{}function GN(n){return typeof n.role=="string"}function nl(n){return typeof n?._getType=="function"}function VN(n){return nl(n)&&typeof n.concat=="function"}class FN extends la{static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}constructor(e,t,i){typeof e=="string"&&(e={content:e,name:i,tool_call_id:t}),super(e),Object.defineProperty(this,"lc_direct_tool_output",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}_getType(){return"tool"}static isInstance(e){return e._getType()==="tool"}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}function HN(n){const e=[],t=[];for(const i of n)if(i.function){const r=i.function.name;try{const a=JSON.parse(i.function.arguments),l={name:r||"",args:a||{},id:i.id};e.push(l)}catch{t.push({name:r,args:i.function.arguments,id:i.id,error:"Malformed args."})}}else continue;return[e,t]}function zN(n){return n._getType()==="tool"}class Fp extends la{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(e,t){let i;if(typeof e=="string")i={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:t??{}};else{i=e;const r=i.additional_kwargs?.tool_calls,a=i.tool_calls;r!=null&&r.length>0&&(a===void 0||a.length===0)&&console.warn(["New LangChain packages are available that more efficiently handle",`tool calling.

Please upgrade your packages to versions that set`,"message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(r!=null&&a===void 0){const[l,c]=HN(r);i.tool_calls=l??[],i.invalid_tool_calls=c??[]}else i.tool_calls=i.tool_calls??[],i.invalid_tool_calls=i.invalid_tool_calls??[]}catch{i.tool_calls=[],i.invalid_tool_calls=[]}}super(i),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof i!="string"&&(this.tool_calls=i.tool_calls??this.tool_calls,this.invalid_tool_calls=i.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=i.usage_metadata}static lc_name(){return"AIMessage"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}}function km(n){return n._getType()==="ai"}function J0(n){return n._getType()==="ai"}class ua extends tl{constructor(e){let t;if(typeof e=="string")t={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(e.tool_call_chunks===void 0)t={...e,tool_calls:e.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[],usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0};else{const i=e.tool_call_chunks.reduce((l,c)=>(c.id&&(l[c.id]=l[c.id]??[],l[c.id].push(c)),l),{}),r=[],a=[];for(const[l,c]of Object.entries(i)){let f={};const d=c[0]?.name??"",g=c.map(v=>v.args||"").join(""),_=g.length?g:"{}";try{if(f=nS(_),f===null||typeof f!="object"||Array.isArray(f))throw new Error("Malformed tool call chunk args.");r.push({name:d,args:f,id:l,type:"tool_call"})}catch{a.push({name:d,args:_,id:l,error:"Malformed args.",type:"invalid_tool_call"})}}t={...e,tool_calls:r,invalid_tool_calls:a,usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0}}super(t),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_chunks=t.tool_call_chunks??this.tool_call_chunks,this.tool_calls=t.tool_calls??this.tool_calls,this.invalid_tool_calls=t.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=t.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(e){const t={content:el(this.content,e.content),additional_kwargs:Sn(this.additional_kwargs,e.additional_kwargs),response_metadata:Sn(this.response_metadata,e.response_metadata),tool_call_chunks:[],id:this.id??e.id};if(this.tool_call_chunks!==void 0||e.tool_call_chunks!==void 0){const i=Om(this.tool_call_chunks,e.tool_call_chunks);i!==void 0&&i.length>0&&(t.tool_call_chunks=i)}if(this.usage_metadata!==void 0||e.usage_metadata!==void 0){const i={...(this.usage_metadata?.input_token_details?.audio!==void 0||e.usage_metadata?.input_token_details?.audio!==void 0)&&{audio:(this.usage_metadata?.input_token_details?.audio??0)+(e.usage_metadata?.input_token_details?.audio??0)},...(this.usage_metadata?.input_token_details?.cache_read!==void 0||e.usage_metadata?.input_token_details?.cache_read!==void 0)&&{cache_read:(this.usage_metadata?.input_token_details?.cache_read??0)+(e.usage_metadata?.input_token_details?.cache_read??0)},...(this.usage_metadata?.input_token_details?.cache_creation!==void 0||e.usage_metadata?.input_token_details?.cache_creation!==void 0)&&{cache_creation:(this.usage_metadata?.input_token_details?.cache_creation??0)+(e.usage_metadata?.input_token_details?.cache_creation??0)}},r={...(this.usage_metadata?.output_token_details?.audio!==void 0||e.usage_metadata?.output_token_details?.audio!==void 0)&&{audio:(this.usage_metadata?.output_token_details?.audio??0)+(e.usage_metadata?.output_token_details?.audio??0)},...(this.usage_metadata?.output_token_details?.reasoning!==void 0||e.usage_metadata?.output_token_details?.reasoning!==void 0)&&{reasoning:(this.usage_metadata?.output_token_details?.reasoning??0)+(e.usage_metadata?.output_token_details?.reasoning??0)}},a=this.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},l=e.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},c={input_tokens:a.input_tokens+l.input_tokens,output_tokens:a.output_tokens+l.output_tokens,total_tokens:a.total_tokens+l.total_tokens,...Object.keys(i).length>0&&{input_token_details:i},...Object.keys(r).length>0&&{output_token_details:r}};t.usage_metadata=c}return new ua(t)}}class yc extends la{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return yc}constructor(e,t){typeof e=="string"&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return e._getType()==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}}class Pm extends tl{static lc_name(){return"ChatMessageChunk"}constructor(e,t){typeof e=="string"&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}concat(e){return new Pm({content:el(this.content,e.content),additional_kwargs:Sn(this.additional_kwargs,e.additional_kwargs),response_metadata:Sn(this.response_metadata,e.response_metadata),role:this.role,id:this.id??e.id})}get _printableFields(){return{...super._printableFields,role:this.role}}}class Dm extends tl{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(e){return new Dm({content:el(this.content,e.content),additional_kwargs:Sn(this.additional_kwargs,e.additional_kwargs),response_metadata:Sn(this.response_metadata,e.response_metadata),name:this.name??"",id:this.id??e.id})}}class _c extends la{static lc_name(){return"HumanMessage"}_getType(){return"human"}constructor(e,t){super(e,t)}}class Lm extends tl{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}constructor(e,t){super(e,t)}concat(e){return new Lm({content:el(this.content,e.content),additional_kwargs:Sn(this.additional_kwargs,e.additional_kwargs),response_metadata:Sn(this.response_metadata,e.response_metadata),id:this.id??e.id})}}class K0 extends la{static lc_name(){return"SystemMessage"}_getType(){return"system"}constructor(e,t){super(e,t)}}class Um extends tl{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}constructor(e,t){super(e,t)}concat(e){return new Um({content:el(this.content,e.content),additional_kwargs:Sn(this.additional_kwargs,e.additional_kwargs),response_metadata:Sn(this.response_metadata,e.response_metadata),id:this.id??e.id})}}function jN(n){return tS(n)?n:typeof n.id=="string"&&n.type==="function"&&typeof n.function=="object"&&n.function!==null&&"arguments"in n.function&&typeof n.function.arguments=="string"&&"name"in n.function&&typeof n.function.name=="string"?{id:n.id,args:JSON.parse(n.function.arguments),name:n.function.name,type:"tool_call"}:n}function JN(n){return typeof n=="object"&&n!=null&&n.lc===1&&Array.isArray(n.id)&&n.kwargs!=null&&typeof n.kwargs=="object"}function lp(n){let e,t;if(JN(n)){const i=n.id.at(-1);i==="HumanMessage"||i==="HumanMessageChunk"?e="user":i==="AIMessage"||i==="AIMessageChunk"?e="assistant":i==="SystemMessage"||i==="SystemMessageChunk"?e="system":i==="FunctionMessage"||i==="FunctionMessageChunk"?e="function":i==="ToolMessage"||i==="ToolMessageChunk"?e="tool":e="unknown",t=n.kwargs}else{const{type:i,...r}=n;e=i,t=r}if(e==="human"||e==="user")return new _c(t);if(e==="ai"||e==="assistant"){const{tool_calls:i,...r}=t;if(!Array.isArray(i))return new Fp(t);const a=i.map(jN);return new Fp({...r,tool_calls:a})}else{if(e==="system")return new K0(t);if(e==="developer")return new K0({...t,additional_kwargs:{...t.additional_kwargs,__openai_role__:"developer"}});if(e==="tool"&&"tool_call_id"in t)return new FN({...t,content:t.content,tool_call_id:t.tool_call_id,name:t.name});throw Nm(new Error(`Unable to coerce message from array: only human, AI, system, developer, or tool message coercion is currently supported.

Received: ${JSON.stringify(n,null,2)}`),"MESSAGE_COERCION_FAILURE")}}function Ao(n){if(typeof n=="string")return new _c(n);if(nl(n))return n;if(Array.isArray(n)){const[e,t]=n;return lp({type:e,content:t})}else if(GN(n)){const{role:e,...t}=n;return lp({...t,type:e})}else return lp(n)}function iS(n,e="Human",t="AI"){const i=[];for(const r of n){let a;if(r._getType()==="human")a=e;else if(r._getType()==="ai")a=t;else if(r._getType()==="system")a="System";else if(r._getType()==="function")a="Function";else if(r._getType()==="tool")a="Tool";else if(r._getType()==="generic")a=r.role;else throw new Error(`Got unsupported message type: ${r._getType()}`);const l=r.name?`${r.name}, `:"",c=typeof r.content=="string"?r.content:JSON.stringify(r.content,null,2);i.push(`${a}: ${l}${c}`)}return i.join(`
`)}function KN(n){const e=n._getType();if(e==="human")return new Lm({...n});if(e==="ai"){let t={...n};return"tool_calls"in t&&(t={...t,tool_call_chunks:t.tool_calls?.map(i=>({...i,type:"tool_call_chunk",index:void 0,args:JSON.stringify(i.args)}))}),new ua({...t})}else{if(e==="system")return new Um({...n});if(e==="function")return new Dm({...n});if(yc.isInstance(n))return new Pm({...n});throw new Error("Unknown message type.")}}let up;const YN=()=>{if(up===void 0){const n=sr("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"?{blockOnRootRunFinalization:!0}:{};up=new Vo(n)}return up};class Oo extends Wo{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"replicas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"usesRunTreeMap",{enumerable:!0,configurable:!0,writable:!0,value:!0});const{exampleId:t,projectName:i,client:r,replicas:a}=e;this.projectName=i??$E(),this.replicas=a,this.exampleId=t,this.client=r??YN();const l=Oo.getTraceableRunTree();l&&this.updateFromRunTree(l)}async persistRun(e){}async onRunCreate(e){await this.getRunTreeWithTracingConfig(e.id)?.postRun()}async onRunUpdate(e){await this.getRunTreeWithTracingConfig(e.id)?.patchRun()}getRun(e){return this.runTreeMap.get(e)}updateFromRunTree(e){let t=e;const i=new Set;for(;t.parent_run&&!(i.has(t.id)||(i.add(t.id),!t.parent_run));)t=t.parent_run;i.clear();const r=[t];for(;r.length>0;){const a=r.shift();!a||i.has(a.id)||(i.add(a.id),this.runTreeMap.set(a.id,a),a.child_runs&&r.push(...a.child_runs))}this.client=e.client??this.client,this.replicas=e.replicas??this.replicas,this.projectName=e.project_name??this.projectName,this.exampleId=e.reference_example_id??this.exampleId}getRunTreeWithTracingConfig(e){const t=this.runTreeMap.get(e);if(t)return new Yt({...t,client:this.client,project_name:this.projectName,replicas:this.replicas,reference_example_id:this.exampleId,tracingEnabled:!0})}static getTraceableRunTree(){try{return lI(!0)}catch{return}}}const rS=Symbol.for("ls:tracing_async_local_storage"),Vu=Symbol.for("lc:context_variables"),ZN=n=>{globalThis[rS]=n},Fo=()=>globalThis[rS];let ko;function QN(){const n="default"in mi?mi.default:mi;return new n({autoStart:!0,concurrency:1})}function XN(){return typeof ko>"u"&&(ko=QN()),ko}async function dt(n,e){if(e===!0){const t=Fo();t!==void 0?await t.run(void 0,async()=>n()):await n()}else ko=XN(),ko.add(async()=>{const t=Fo();t!==void 0?await t.run(void 0,async()=>n()):await n()})}const WN=n=>!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find(t=>sr(t)==="true");function sS(n){const e=Fo();return e===void 0?void 0:e.getStore()?.[Vu]?.[n]}const eO=Symbol("lc:configure_hooks"),tO=()=>sS(eO)||[];function nO(n){return n?Array.isArray(n)||"name"in n?{callbacks:n}:n:{}}class iO{setHandler(e){return this.setHandlers([e])}}class vc{constructor(e,t,i,r,a,l,c,f){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:l}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:c}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:f})}get parentRunId(){return this._parentRunId}async handleText(e){await Promise.all(this.handlers.map(t=>dt(async()=>{try{await t.handleText?.(e,this.runId,this._parentRunId,this.tags)}catch(i){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleText: ${i}`),t.raiseError)throw i}},t.awaitHandlers)))}async handleCustomEvent(e,t,i,r,a){await Promise.all(this.handlers.map(l=>dt(async()=>{try{await l.handleCustomEvent?.(e,t,this.runId,this.tags,this.metadata)}catch(c){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleCustomEvent: ${c}`),l.raiseError)throw c}},l.awaitHandlers)))}}class rO extends vc{getChild(e){const t=new $t(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(t=>dt(async()=>{if(!t.ignoreRetriever)try{await t.handleRetrieverEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(i){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetriever`),t.raiseError)throw i}},t.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(t=>dt(async()=>{if(!t.ignoreRetriever)try{await t.handleRetrieverError?.(e,this.runId,this._parentRunId,this.tags)}catch(i){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetrieverError: ${i}`),t.raiseError)throw e}},t.awaitHandlers)))}}class Y0 extends vc{async handleLLMNewToken(e,t,i,r,a,l){await Promise.all(this.handlers.map(c=>dt(async()=>{if(!c.ignoreLLM)try{await c.handleLLMNewToken?.(e,t??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,l)}catch(f){if((c.raiseError?console.error:console.warn)(`Error in handler ${c.constructor.name}, handleLLMNewToken: ${f}`),c.raiseError)throw f}},c.awaitHandlers)))}async handleLLMError(e,t,i,r,a){await Promise.all(this.handlers.map(l=>dt(async()=>{if(!l.ignoreLLM)try{await l.handleLLMError?.(e,this.runId,this._parentRunId,this.tags,a)}catch(c){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleLLMError: ${c}`),l.raiseError)throw c}},l.awaitHandlers)))}async handleLLMEnd(e,t,i,r,a){await Promise.all(this.handlers.map(l=>dt(async()=>{if(!l.ignoreLLM)try{await l.handleLLMEnd?.(e,this.runId,this._parentRunId,this.tags,a)}catch(c){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleLLMEnd: ${c}`),l.raiseError)throw c}},l.awaitHandlers)))}}class sO extends vc{getChild(e){const t=new $t(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleChainError(e,t,i,r,a){await Promise.all(this.handlers.map(l=>dt(async()=>{if(!l.ignoreChain)try{await l.handleChainError?.(e,this.runId,this._parentRunId,this.tags,a)}catch(c){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleChainError: ${c}`),l.raiseError)throw c}},l.awaitHandlers)))}async handleChainEnd(e,t,i,r,a){await Promise.all(this.handlers.map(l=>dt(async()=>{if(!l.ignoreChain)try{await l.handleChainEnd?.(e,this.runId,this._parentRunId,this.tags,a)}catch(c){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleChainEnd: ${c}`),l.raiseError)throw c}},l.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(t=>dt(async()=>{if(!t.ignoreAgent)try{await t.handleAgentAction?.(e,this.runId,this._parentRunId,this.tags)}catch(i){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentAction: ${i}`),t.raiseError)throw i}},t.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(t=>dt(async()=>{if(!t.ignoreAgent)try{await t.handleAgentEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(i){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentEnd: ${i}`),t.raiseError)throw i}},t.awaitHandlers)))}}class aO extends vc{getChild(e){const t=new $t(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleToolError(e){await Promise.all(this.handlers.map(t=>dt(async()=>{if(!t.ignoreAgent)try{await t.handleToolError?.(e,this.runId,this._parentRunId,this.tags)}catch(i){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolError: ${i}`),t.raiseError)throw i}},t.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(t=>dt(async()=>{if(!t.ignoreAgent)try{await t.handleToolEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(i){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolEnd: ${i}`),t.raiseError)throw i}},t.awaitHandlers)))}}class $t extends iO{constructor(e,t){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=t?.handlers??this.handlers,this.inheritableHandlers=t?.inheritableHandlers??this.inheritableHandlers,this.tags=t?.tags??this.tags,this.inheritableTags=t?.inheritableTags??this.inheritableTags,this.metadata=t?.metadata??this.metadata,this.inheritableMetadata=t?.inheritableMetadata??this.inheritableMetadata,this._parentRunId=e}getParentRunId(){return this._parentRunId}async handleLLMStart(e,t,i=void 0,r=void 0,a=void 0,l=void 0,c=void 0,f=void 0){return Promise.all(t.map(async(d,g)=>{const _=g===0&&i?i:Ut();return await Promise.all(this.handlers.map(v=>{if(!v.ignoreLLM)return bo(v)&&v._createRunForLLMStart(e,[d],_,this._parentRunId,a,this.tags,this.metadata,f),dt(async()=>{try{await v.handleLLMStart?.(e,[d],_,this._parentRunId,a,this.tags,this.metadata,f)}catch(w){if((v.raiseError?console.error:console.warn)(`Error in handler ${v.constructor.name}, handleLLMStart: ${w}`),v.raiseError)throw w}},v.awaitHandlers)})),new Y0(_,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,t,i=void 0,r=void 0,a=void 0,l=void 0,c=void 0,f=void 0){return Promise.all(t.map(async(d,g)=>{const _=g===0&&i?i:Ut();return await Promise.all(this.handlers.map(v=>{if(!v.ignoreLLM)return bo(v)&&v._createRunForChatModelStart(e,[d],_,this._parentRunId,a,this.tags,this.metadata,f),dt(async()=>{try{if(v.handleChatModelStart)await v.handleChatModelStart?.(e,[d],_,this._parentRunId,a,this.tags,this.metadata,f);else if(v.handleLLMStart){const w=iS(d);await v.handleLLMStart?.(e,[w],_,this._parentRunId,a,this.tags,this.metadata,f)}}catch(w){if((v.raiseError?console.error:console.warn)(`Error in handler ${v.constructor.name}, handleLLMStart: ${w}`),v.raiseError)throw w}},v.awaitHandlers)})),new Y0(_,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,t,i=Ut(),r=void 0,a=void 0,l=void 0,c=void 0){return await Promise.all(this.handlers.map(f=>{if(!f.ignoreChain)return bo(f)&&f._createRunForChainStart(e,t,i,this._parentRunId,this.tags,this.metadata,r,c),dt(async()=>{try{await f.handleChainStart?.(e,t,i,this._parentRunId,this.tags,this.metadata,r,c)}catch(d){if((f.raiseError?console.error:console.warn)(`Error in handler ${f.constructor.name}, handleChainStart: ${d}`),f.raiseError)throw d}},f.awaitHandlers)})),new sO(i,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,t,i=Ut(),r=void 0,a=void 0,l=void 0,c=void 0){return await Promise.all(this.handlers.map(f=>{if(!f.ignoreAgent)return bo(f)&&f._createRunForToolStart(e,t,i,this._parentRunId,this.tags,this.metadata,c),dt(async()=>{try{await f.handleToolStart?.(e,t,i,this._parentRunId,this.tags,this.metadata,c)}catch(d){if((f.raiseError?console.error:console.warn)(`Error in handler ${f.constructor.name}, handleToolStart: ${d}`),f.raiseError)throw d}},f.awaitHandlers)})),new aO(i,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,t,i=Ut(),r=void 0,a=void 0,l=void 0,c=void 0){return await Promise.all(this.handlers.map(f=>{if(!f.ignoreRetriever)return bo(f)&&f._createRunForRetrieverStart(e,t,i,this._parentRunId,this.tags,this.metadata,c),dt(async()=>{try{await f.handleRetrieverStart?.(e,t,i,this._parentRunId,this.tags,this.metadata,c)}catch(d){if((f.raiseError?console.error:console.warn)(`Error in handler ${f.constructor.name}, handleRetrieverStart: ${d}`),f.raiseError)throw d}},f.awaitHandlers)})),new rO(i,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(e,t,i,r,a){await Promise.all(this.handlers.map(l=>dt(async()=>{if(!l.ignoreCustomEvent)try{await l.handleCustomEvent?.(e,t,i,this.tags,this.metadata)}catch(c){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleCustomEvent: ${c}`),l.raiseError)throw c}},l.awaitHandlers)))}addHandler(e,t=!0){this.handlers.push(e),t&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t!==e),this.inheritableHandlers=this.inheritableHandlers.filter(t=>t!==e)}setHandlers(e,t=!0){this.handlers=[],this.inheritableHandlers=[];for(const i of e)this.addHandler(i,t)}addTags(e,t=!0){this.removeTags(e),this.tags.push(...e),t&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(t=>!e.includes(t)),this.inheritableTags=this.inheritableTags.filter(t=>!e.includes(t))}addMetadata(e,t=!0){this.metadata={...this.metadata,...e},t&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const t of Object.keys(e))delete this.metadata[t],delete this.inheritableMetadata[t]}copy(e=[],t=!0){const i=new $t(this._parentRunId);for(const r of this.handlers){const a=this.inheritableHandlers.includes(r);i.addHandler(r,a)}for(const r of this.tags){const a=this.inheritableTags.includes(r);i.addTags([r],a)}for(const r of Object.keys(this.metadata)){const a=Object.keys(this.inheritableMetadata).includes(r);i.addMetadata({[r]:this.metadata[r]},a)}for(const r of e)i.handlers.filter(a=>a.name==="console_callback_handler").some(a=>a.name===r.name)||i.addHandler(r,t);return i}static fromHandlers(e){class t extends Xo{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Ut()}),Object.assign(this,e)}}const i=new this;return i.addHandler(new t),i}static configure(e,t,i,r,a,l,c){return this._configureSync(e,t,i,r,a,l,c)}static _configureSync(e,t,i,r,a,l,c){let f;(e||t)&&(Array.isArray(e)||!e?(f=new $t,f.setHandlers(e?.map(nc)??[],!0)):f=e,f=f.copy(Array.isArray(t)?t.map(nc):t?.handlers,!1));const d=sr("LANGCHAIN_VERBOSE")==="true"||c?.verbose,g=Oo.getTraceableRunTree()?.tracingEnabled||WN(),_=g||(sr("LANGCHAIN_TRACING")??!1);if(d||_){if(f||(f=new $t),d&&!f.handlers.some(v=>v.name===z0.prototype.name)){const v=new z0;f.addHandler(v,!0)}if(_&&!f.handlers.some(v=>v.name==="langchain_tracer")&&g){const v=new Oo;f.addHandler(v,!0),f._parentRunId=Oo.getTraceableRunTree()?.id??f._parentRunId}}for(const{contextVar:v,inheritable:w=!0,handlerClass:T,envVar:S}of tO()){const C=S&&sr(S)==="true"&&T;let x;const M=v!==void 0?sS(v):void 0;M&&NN(M)?x=M:C&&(x=new T({})),x!==void 0&&(f||(f=new $t),f.handlers.some(R=>R.name===x.name)||f.addHandler(x,w))}return(i||r)&&f&&(f.addTags(i??[]),f.addTags(r??[],!1)),(a||l)&&f&&(f.addMetadata(a??{}),f.addMetadata(l??{},!1)),f}}function nc(n){return"name"in n?n:Xo.fromMethods(n)}class oO{getStore(){}run(e,t){return t()}enterWith(e){}}const lO=new oO,Z0=Symbol.for("lc:child_config");class uO{getInstance(){return Fo()??lO}getRunnableConfig(){return this.getInstance().getStore()?.extra?.[Z0]}runWithConfig(e,t,i){const r=$t._configureSync(e?.callbacks,void 0,e?.tags,void 0,e?.metadata),a=this.getInstance(),l=a.getStore(),c=r?.getParentRunId(),f=r?.handlers?.find(g=>g?.name==="langchain_tracer");let d;return f&&c?d=f.getRunTreeWithTracingConfig(c):i||(d=new Yt({name:"<runnable_lambda>",tracingEnabled:!1})),d&&(d.extra={...d.extra,[Z0]:e}),l!==void 0&&l[Vu]!==void 0&&(d===void 0&&(d={}),d[Vu]=l[Vu]),a.run(d,t)}initializeGlobalInstance(e){Fo()===void 0&&ZN(e)}}const cr=new uO,cp=25;async function Dn(n){return $t._configureSync(n?.callbacks,void 0,n?.tags,void 0,n?.metadata)}function Q0(...n){const e={};for(const t of n.filter(i=>!!i))for(const i of Object.keys(t))if(i==="metadata")e[i]={...e[i],...t[i]};else if(i==="tags"){const r=e[i]??[];e[i]=[...new Set(r.concat(t[i]??[]))]}else if(i==="configurable")e[i]={...e[i],...t[i]};else if(i==="timeout")e.timeout===void 0?e.timeout=t.timeout:t.timeout!==void 0&&(e.timeout=Math.min(e.timeout,t.timeout));else if(i==="signal")e.signal===void 0?e.signal=t.signal:t.signal!==void 0&&("any"in AbortSignal?e.signal=AbortSignal.any([e.signal,t.signal]):e.signal=t.signal);else if(i==="callbacks"){const r=e.callbacks,a=t.callbacks;if(Array.isArray(a))if(!r)e.callbacks=a;else if(Array.isArray(r))e.callbacks=r.concat(a);else{const l=r.copy();for(const c of a)l.addHandler(nc(c),!0);e.callbacks=l}else if(a)if(!r)e.callbacks=a;else if(Array.isArray(r)){const l=a.copy();for(const c of r)l.addHandler(nc(c),!0);e.callbacks=l}else e.callbacks=new $t(a._parentRunId,{handlers:r.handlers.concat(a.handlers),inheritableHandlers:r.inheritableHandlers.concat(a.inheritableHandlers),tags:Array.from(new Set(r.tags.concat(a.tags))),inheritableTags:Array.from(new Set(r.inheritableTags.concat(a.inheritableTags))),metadata:{...r.metadata,...a.metadata}})}else{const r=i;e[r]=t[r]??e[r]}return e}const cO=new Set(["string","number","boolean"]);function De(n){const e=cr.getRunnableConfig();let t={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(e){const{runId:i,runName:r,...a}=e;t=Object.entries(a).reduce((l,[c,f])=>(f!==void 0&&(l[c]=f),l),t)}if(n&&(t=Object.entries(n).reduce((i,[r,a])=>(a!==void 0&&(i[r]=a),i),t)),t?.configurable)for(const i of Object.keys(t.configurable))cO.has(typeof t.configurable[i])&&!t.metadata?.[i]&&(t.metadata||(t.metadata={}),t.metadata[i]=t.configurable[i]);if(t.timeout!==void 0){if(t.timeout<=0)throw new Error("Timeout must be a positive number");const i=AbortSignal.timeout(t.timeout);t.signal!==void 0?"any"in AbortSignal&&(t.signal=AbortSignal.any([t.signal,i])):t.signal=i,delete t.timeout}return t}function Nt(n={},{callbacks:e,maxConcurrency:t,recursionLimit:i,runName:r,configurable:a,runId:l}={}){const c=De(n);return e!==void 0&&(delete c.runName,c.callbacks=e),i!==void 0&&(c.recursionLimit=i),t!==void 0&&(c.maxConcurrency=t),r!==void 0&&(c.runName=r),a!==void 0&&(c.configurable={...c.configurable,...a}),l!==void 0&&delete c.runId,c}function na(n){return n?{configurable:n.configurable,recursionLimit:n.recursionLimit,callbacks:n.callbacks,tags:n.tags,metadata:n.metadata,maxConcurrency:n.maxConcurrency,timeout:n.timeout,signal:n.signal}:void 0}async function fr(n,e){if(e===void 0)return n;let t;return Promise.race([n.catch(i=>{if(!e?.aborted)throw i}),new Promise((i,r)=>{t=()=>{r(new Error("Aborted"))},e.addEventListener("abort",t),e.aborted&&r(new Error("Aborted"))})]).finally(()=>e.removeEventListener("abort",t))}class fn extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const e=await this.reader.read();return e.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){const e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){const t=this.reader.cancel();this.reader.releaseLock(),await t}throw e}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}static fromReadableStream(e){const t=e.getReader();return new fn({start(i){return r();function r(){return t.read().then(({done:a,value:l})=>{if(a){i.close();return}return i.enqueue(l),r()})}},cancel(){t.releaseLock()}})}static fromAsyncGenerator(e){return new fn({async pull(t){const{value:i,done:r}=await e.next();r&&t.close(),t.enqueue(i)},async cancel(t){await e.return(t)}})}}function aS(n,e=2){const t=Array.from({length:e},()=>[]);return t.map(async function*(r){for(;;)if(r.length===0){const a=await n.next();for(const l of t)l.push(a)}else{if(r[0].done)return;yield r.shift().value}})}function Ln(n,e){if(Array.isArray(n)&&Array.isArray(e))return n.concat(e);if(typeof n=="string"&&typeof e=="string")return n+e;if(typeof n=="number"&&typeof e=="number")return n+e;if("concat"in n&&typeof n.concat=="function")return n.concat(e);if(typeof n=="object"&&typeof e=="object"){const t={...n};for(const[i,r]of Object.entries(e))i in t&&!Array.isArray(t[i])?t[i]=Ln(t[i],r):t[i]=r;return t}else throw new Error(`Cannot concat ${typeof n} and ${typeof e}`)}class ca{constructor(e){Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=e.signal??this.config?.signal,this.setup=new Promise((t,i)=>{cr.runWithConfig(na(e.config),async()=>{this.firstResult=e.generator.next(),e.startSetup?this.firstResult.then(e.startSetup).then(t,i):this.firstResult.then(r=>t(void 0),i)},!0)})}async next(...e){return this.signal?.throwIfAborted(),this.firstResultUsed?cr.runWithConfig(na(this.config),this.signal?async()=>fr(this.generator.next(...e),this.signal):async()=>this.generator.next(...e),!0):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}}async function fO(n,e,t,i,...r){const a=new ca({generator:e,startSetup:t,signal:i}),l=await a.setup;return{output:n(a,l,...r),setup:l}}class Yi{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){const t=this.ops.concat(e.ops),i=Xu({},t);return new Ho({ops:t,state:i[i.length-1].newDocument})}}class Ho extends Yi{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){const t=this.ops.concat(e.ops),i=Xu(this.state,e.ops);return new Ho({ops:t,state:i[i.length-1].newDocument})}static fromRunLogPatch(e){const t=Xu({},e.ops);return new Ho({ops:e.ops,state:t[t.length-1].newDocument})}}const dO=n=>n.name==="log_stream_tracer";async function X0(n,e){if(e==="original")throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");const{inputs:t}=n;if(["retriever","llm","prompt"].includes(n.run_type))return t;if(!(Object.keys(t).length===1&&t?.input===""))return t.input}async function W0(n,e){const{outputs:t}=n;return e==="original"||["retriever","llm","prompt"].includes(n.run_type)?t:t!==void 0&&Object.keys(t).length===1&&t?.output!==void 0?t.output:t}function hO(n){return n!==void 0&&n.message!==void 0}class ew extends Wo{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=e?.autoClose??!0,this.includeNames=e?.includeNames,this.includeTypes=e?.includeTypes,this.includeTags=e?.includeTags,this.excludeNames=e?.excludeNames,this.excludeTypes=e?.excludeTypes,this.excludeTags=e?.excludeTags,this._schemaFormat=e?._schemaFormat??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=fn.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;const t=e.tags??[];let i=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(i=i||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(i=i||this.includeTypes.includes(e.run_type)),this.includeTags!==void 0&&(i=i||t.find(r=>this.includeTags?.includes(r))!==void 0),this.excludeNames!==void 0&&(i=i&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(i=i&&!this.excludeTypes.includes(e.run_type)),this.excludeTags!==void 0&&(i=i&&t.every(r=>!this.excludeTags?.includes(r))),i}async*tapOutputIterable(e,t){for await(const i of t){if(e!==this.rootId){const r=this.keyMapByRunId[e];r&&await this.writer.write(new Yi({ops:[{op:"add",path:`/logs/${r}/streamed_output/-`,value:i}]}))}yield i}}async onRunCreate(e){if(this.rootId===void 0&&(this.rootId=e.id,await this.writer.write(new Yi({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;this.counterMapByRunName[e.name]===void 0&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;const t=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=t===1?e.name:`${e.name}:${t}`;const i={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:e.extra?.metadata??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};this._schemaFormat==="streaming_events"&&(i.inputs=await X0(e,this._schemaFormat)),await this.writer.write(new Yi({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:i}]}))}async onRunUpdate(e){try{const t=this.keyMapByRunId[e.id];if(t===void 0)return;const i=[];this._schemaFormat==="streaming_events"&&i.push({op:"replace",path:`/logs/${t}/inputs`,value:await X0(e,this._schemaFormat)}),i.push({op:"add",path:`/logs/${t}/final_output`,value:await W0(e,this._schemaFormat)}),e.end_time!==void 0&&i.push({op:"add",path:`/logs/${t}/end_time`,value:new Date(e.end_time).toISOString()});const r=new Yi({ops:i});await this.writer.write(r)}finally{if(e.id===this.rootId){const t=new Yi({ops:[{op:"replace",path:"/final_output",value:await W0(e,this._schemaFormat)}]});await this.writer.write(t),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,t,i){const r=this.keyMapByRunId[e.id];if(r===void 0)return;const a=e.inputs.messages!==void 0;let l;a?hO(i?.chunk)?l=i?.chunk:l=new ua({id:`run-${e.id}`,content:t}):l=t;const c=new Yi({ops:[{op:"add",path:`/logs/${r}/streamed_output_str/-`,value:t},{op:"add",path:`/logs/${r}/streamed_output/-`,value:l}]});await this.writer.write(c)}}const tw="__run";class ia{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new ia({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}class zo extends ia{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new zo({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}function Ou({name:n,serialized:e}){return n!==void 0?n:e?.name!==void 0?e.name:e?.id!==void 0&&Array.isArray(e?.id)?e.id[e.id.length-1]:"Unnamed"}const pO=n=>n.name==="event_stream_tracer";class mO extends Wo{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=e?.autoClose??!0,this.includeNames=e?.includeNames,this.includeTypes=e?.includeTypes,this.includeTags=e?.includeTags,this.excludeNames=e?.excludeNames,this.excludeTypes=e?.excludeTypes,this.excludeTags=e?.excludeTags,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=fn.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){const t=e.tags??[];let i=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(i=i||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(i=i||this.includeTypes.includes(e.runType)),this.includeTags!==void 0&&(i=i||t.find(r=>this.includeTags?.includes(r))!==void 0),this.excludeNames!==void 0&&(i=i&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(i=i&&!this.excludeTypes.includes(e.runType)),this.excludeTags!==void 0&&(i=i&&t.every(r=>!this.excludeTags?.includes(r))),i}async*tapOutputIterable(e,t){const i=await t.next();if(i.done)return;const r=this.runInfoMap.get(e);if(r===void 0){yield i.value;return}function a(c,f){return c==="llm"&&typeof f=="string"?new ia({text:f}):f}let l=this.tappedPromises.get(e);if(l===void 0){let c;l=new Promise(f=>{c=f}),this.tappedPromises.set(e,l);try{const f={event:`on_${r.runType}_stream`,run_id:e,name:r.name,tags:r.tags,metadata:r.metadata,data:{}};await this.send({...f,data:{chunk:a(r.runType,i.value)}},r),yield i.value;for await(const d of t)r.runType!=="tool"&&r.runType!=="retriever"&&await this.send({...f,data:{chunk:a(r.runType,d)}},r),yield d}finally{c()}}else{yield i.value;for await(const c of t)yield c}}async send(e,t){this._includeRun(t)&&await this.writer.write(e)}async sendEndEvent(e,t){const i=this.tappedPromises.get(e.run_id);i!==void 0?i.then(()=>{this.send(e,t)}):await this.send(e,t)}async onLLMStart(e){const t=Ou(e),i=e.inputs.messages!==void 0?"chat_model":"llm",r={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:i,inputs:e.inputs};this.runInfoMap.set(e.id,r);const a=`on_${i}_start`;await this.send({event:a,data:{input:e.inputs},name:t,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},r)}async onLLMNewToken(e,t,i){const r=this.runInfoMap.get(e.id);let a,l;if(r===void 0)throw new Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(this.runInfoMap.size!==1){if(r.runType==="chat_model")l="on_chat_model_stream",i?.chunk===void 0?a=new ua({content:t,id:`run-${e.id}`}):a=i.chunk.message;else if(r.runType==="llm")l="on_llm_stream",i?.chunk===void 0?a=new ia({text:t}):a=i.chunk;else throw new Error(`Unexpected run type ${r.runType}`);await this.send({event:l,data:{chunk:a},run_id:e.id,name:r.name,tags:r.tags,metadata:r.metadata},r)}}async onLLMEnd(e){const t=this.runInfoMap.get(e.id);this.runInfoMap.delete(e.id);let i;if(t===void 0)throw new Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);const r=e.outputs?.generations;let a;if(t.runType==="chat_model"){for(const l of r??[]){if(a!==void 0)break;a=l[0]?.message}i="on_chat_model_end"}else if(t.runType==="llm")a={generations:r?.map(l=>l.map(c=>({text:c.text,generationInfo:c.generationInfo}))),llmOutput:e.outputs?.llmOutput??{}},i="on_llm_end";else throw new Error(`onLLMEnd: Unexpected run type: ${t.runType}`);await this.sendEndEvent({event:i,data:{output:a,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onChainStart(e){const t=Ou(e),i=e.run_type??"chain",r={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:e.run_type};let a={};e.inputs.input===""&&Object.keys(e.inputs).length===1?(a={},r.inputs={}):e.inputs.input!==void 0?(a.input=e.inputs.input,r.inputs=e.inputs.input):(a.input=e.inputs,r.inputs=e.inputs),this.runInfoMap.set(e.id,r),await this.send({event:`on_${i}_start`,data:a,name:t,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},r)}async onChainEnd(e){const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onChainEnd: Run ID ${e.id} not found in run map.`);const i=`on_${e.run_type}_end`,r=e.inputs??t.inputs??{},l={output:e.outputs?.output??e.outputs,input:r};r.input&&Object.keys(r).length===1&&(l.input=r.input,t.inputs=r.input),await this.sendEndEvent({event:i,data:l,run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata??{}},t)}async onToolStart(e){const t=Ou(e),i={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,i),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:t,run_id:e.id,tags:e.tags??[],metadata:e.extra?.metadata??{}},i)}async onToolEnd(e){const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(t.inputs===void 0)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);const i=e.outputs?.output===void 0?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:i,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onRetrieverStart(e){const t=Ou(e),r={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:"retriever",inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,r),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:t,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},r)}async onRetrieverEnd(e){const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:e.outputs?.documents??e.outputs,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async handleCustomEvent(e,t,i){const r=this.runInfoMap.get(i);if(r===void 0)throw new Error(`handleCustomEvent: Run ID ${i} not found in run map.`);await this.send({event:"on_custom_event",run_id:i,name:e,tags:r.tags,metadata:r.metadata,data:t},r)}async finish(){const e=[...this.tappedPromises.values()];Promise.all(e).finally(()=>{this.writer.close()})}}const gO=[400,401,402,403,404,405,406,407,409],yO=n=>{if(n.message.startsWith("Cancel")||n.message.startsWith("AbortError")||n.name==="AbortError"||n?.code==="ECONNABORTED")throw n;const e=n?.response?.status??n?.status;if(e&&gO.includes(+e))throw n;if(n?.error?.code==="insufficient_quota"){const t=new Error(n?.message);throw t.name="InsufficientQuotaError",t}};class bc{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??yO;const t="default"in mi?mi.default:mi;this.queue=new t({concurrency:this.maxConcurrency})}call(e,...t){return this.queue.add(()=>Qu(()=>e(...t).catch(i=>{throw i instanceof Error?i:new Error(i)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...i){return e.signal?Promise.race([this.call(t,...i),new Promise((r,a)=>{e.signal?.addEventListener("abort",()=>{a(new Error("AbortError"))})})]):this.call(t,...i)}fetch(...e){return this.call(()=>fetch(...e).then(t=>t.ok?t:Promise.reject(t)))}}class oS extends Wo{constructor({config:e,onStart:t,onEnd:i,onError:r}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.argOnStart=t,this.argOnEnd=i,this.argOnError=r}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&await this.argOnStart(e,this.config))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&await this.argOnError(e,this.config):this.argOnEnd&&await this.argOnEnd(e,this.config))}}function $m(n){return n?n.lc_runnable:!1}class _O{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,t){let i=this.includeNames===void 0&&this.includeTypes===void 0&&this.includeTags===void 0;const r=e.tags??[];return this.includeNames!==void 0&&(i=i||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(i=i||this.includeTypes.includes(t)),this.includeTags!==void 0&&(i=i||r.some(a=>this.includeTags?.includes(a))),this.excludeNames!==void 0&&(i=i&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(i=i&&!this.excludeTypes.includes(t)),this.excludeTags!==void 0&&(i=i&&r.every(a=>!this.excludeTags?.includes(a))),i}}function fp(n){return n.replace(/[^a-zA-Z-_0-9]/g,"_")}const vO=["*","_","`"];function bO(n){let e="";for(const[t,i]of Object.entries(n))e+=`	classDef ${t} ${i};
`;return e}function wO(n,e,t){const{firstNode:i,lastNode:r,nodeColors:a,withStyles:l=!0,curveStyle:c="linear",wrapLabelNWords:f=9}=t??{};let d=l?`%%{init: {'flowchart': {'curve': '${c}'}}}%%
graph TD;
`:`graph TD;
`;if(l){const w="default",T={[w]:"{0}({1})"};i!==void 0&&(T[i]="{0}([{1}]):::first"),r!==void 0&&(T[r]="{0}([{1}]):::last");for(const[S,C]of Object.entries(n)){const x=C.name.split(":").pop()??"";let R=vO.some(O=>x.startsWith(O)&&x.endsWith(O))?`<p>${x}</p>`:x;Object.keys(C.metadata??{}).length&&(R+=`<hr/><small><em>${Object.entries(C.metadata??{}).map(([O,V])=>`${O} = ${V}`).join(`
`)}</em></small>`);const P=(T[S]??T[w]).replace("{0}",fp(S)).replace("{1}",R);d+=`	${P}
`}}const g={};for(const w of e){const T=w.source.split(":"),S=w.target.split(":"),C=T.filter((x,M)=>x===S[M]).join(":");g[C]||(g[C]=[]),g[C].push(w)}const _=new Set;function v(w,T){const S=w.length===1&&w[0].source===w[0].target;if(T&&!S){const C=T.split(":").pop();if(_.has(C))throw new Error(`Found duplicate subgraph '${C}' -- this likely means that you're reusing a subgraph node with the same name. Please adjust your graph to have subgraph nodes with unique names.`);_.add(C),d+=`	subgraph ${C}
`}for(const C of w){const{source:x,target:M,data:R,conditional:P}=C;let O="";if(R!==void 0){let V=R;const J=V.split(" ");J.length>f&&(V=Array.from({length:Math.ceil(J.length/f)},(Z,re)=>J.slice(re*f,(re+1)*f).join(" ")).join("&nbsp;<br>&nbsp;")),O=P?` -. &nbsp;${V}&nbsp; .-> `:` -- &nbsp;${V}&nbsp; --> `}else O=P?" -.-> ":" --> ";d+=`	${fp(x)}${O}${fp(M)};
`}for(const C in g)C.startsWith(`${T}:`)&&C!==T&&v(g[C],C);T&&!S&&(d+=`	end
`)}v(g[""]??[],"");for(const w in g)!w.includes(":")&&w!==""&&v(g[w],w);return l&&(d+=bO(a??{})),d}async function TO(n,e){let{backgroundColor:t="white"}=e??{};const i=btoa(n);t!==void 0&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(t)||(t=`!${t}`));const r=`https://mermaid.ink/img/${i}?bgColor=${t}`,a=await fetch(r);if(!a.ok)throw new Error(["Failed to render the graph using the Mermaid.INK API.",`Status code: ${a.status}`,`Status text: ${a.statusText}`].join(`
`));return await a.blob()}function wc(n,e,t){function i(c,f){var d;Object.defineProperty(c,"_zod",{value:c._zod??{},enumerable:!1}),(d=c._zod).traits??(d.traits=new Set),c._zod.traits.add(n),e(c,f);for(const g in l.prototype)g in c||Object.defineProperty(c,g,{value:l.prototype[g].bind(c)});c._zod.constr=l,c._zod.def=f}const r=t?.Parent??Object;class a extends r{}Object.defineProperty(a,"name",{value:n});function l(c){var f;const d=t?.Parent?new a:this;i(d,c),(f=d._zod).deferred??(f.deferred=[]);for(const g of d._zod.deferred)g();return d}return Object.defineProperty(l,"init",{value:i}),Object.defineProperty(l,Symbol.hasInstance,{value:c=>t?.Parent&&c instanceof t.Parent?!0:c?._zod?.traits?.has(n)}),Object.defineProperty(l,"name",{value:n}),l}class ic extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const EO={};function Tc(n){return EO}function SO(n){const e=Object.values(n).filter(i=>typeof i=="number");return Object.entries(n).filter(([i,r])=>e.indexOf(+i)===-1).map(([i,r])=>r)}function CO(n,e){return typeof e=="bigint"?e.toString():e}const lS=Error.captureStackTrace?Error.captureStackTrace:(...n)=>{};function rc(n,e,t){const i=new n._zod.constr(e??n._zod.def);return(!e||t?.parent)&&(i._zod.parent=n),i}function AO(n){return{}}function dp(n,e=0){for(let t=e;t<n.issues.length;t++)if(n.issues[t]?.continue!==!0)return!0;return!1}function ku(n){return typeof n=="string"?n:n?.message}function Ec(n,e,t){const i={...n,path:n.path??[]};if(!n.message){const r=ku(n.inst?._zod.def?.error?.(n))??ku(e?.error?.(n))??ku(t.customError?.(n))??ku(t.localeError?.(n))??"Invalid input";i.message=r}return delete i.inst,delete i.continue,e?.reportInput||delete i.input,i}const uS=(n,e)=>{n.name="$ZodError",Object.defineProperty(n,"_zod",{value:n._zod,enumerable:!1}),Object.defineProperty(n,"issues",{value:e,enumerable:!1}),Object.defineProperty(n,"message",{get(){return JSON.stringify(e,CO,2)},enumerable:!0}),Object.defineProperty(n,"toString",{value:()=>n.message,enumerable:!1})},RO=wc("$ZodError",uS),Sc=wc("$ZodError",uS,{Parent:Error}),xO=n=>(e,t,i,r)=>{const a=i?Object.assign(i,{async:!1}):{async:!1},l=e._zod.run({value:t,issues:[]},a);if(l instanceof Promise)throw new ic;if(l.issues.length){const c=new(r?.Err??n)(l.issues.map(f=>Ec(f,a,Tc())));throw lS(c,r?.callee),c}return l.value},IO=xO(Sc),MO=n=>async(e,t,i,r)=>{const a=i?Object.assign(i,{async:!0}):{async:!0};let l=e._zod.run({value:t,issues:[]},a);if(l instanceof Promise&&(l=await l),l.issues.length){const c=new(r?.Err??n)(l.issues.map(f=>Ec(f,a,Tc())));throw lS(c,r?.callee),c}return l.value},NO=MO(Sc),OO=n=>(e,t,i)=>{const r=i?{...i,async:!1}:{async:!1},a=e._zod.run({value:t,issues:[]},r);if(a instanceof Promise)throw new ic;return a.issues.length?{success:!1,error:new(n??RO)(a.issues.map(l=>Ec(l,r,Tc())))}:{success:!0,data:a.value}},kO=OO(Sc),PO=n=>async(e,t,i)=>{const r=i?Object.assign(i,{async:!0}):{async:!0};let a=e._zod.run({value:t,issues:[]},r);return a instanceof Promise&&(a=await a),a.issues.length?{success:!1,error:new n(a.issues.map(l=>Ec(l,r,Tc())))}:{success:!0,data:a.value}},DO=PO(Sc),LO={major:4,minor:0,patch:0},UO=wc("$ZodType",(n,e)=>{var t;n??(n={}),n._zod.def=e,n._zod.bag=n._zod.bag||{},n._zod.version=LO;const i=[...n._zod.def.checks??[]];n._zod.traits.has("$ZodCheck")&&i.unshift(n);for(const r of i)for(const a of r._zod.onattach)a(n);if(i.length===0)(t=n._zod).deferred??(t.deferred=[]),n._zod.deferred?.push(()=>{n._zod.run=n._zod.parse});else{const r=(a,l,c)=>{let f=dp(a),d;for(const g of l){if(g._zod.def.when){if(!g._zod.def.when(a))continue}else if(f)continue;const _=a.issues.length,v=g._zod.check(a);if(v instanceof Promise&&c?.async===!1)throw new ic;if(d||v instanceof Promise)d=(d??Promise.resolve()).then(async()=>{await v,a.issues.length!==_&&(f||(f=dp(a,_)))});else{if(a.issues.length===_)continue;f||(f=dp(a,_))}}return d?d.then(()=>a):a};n._zod.run=(a,l)=>{const c=n._zod.parse(a,l);if(c instanceof Promise){if(l.async===!1)throw new ic;return c.then(f=>r(f,i,l))}return r(c,i,l)}}n["~standard"]={validate:r=>{try{const a=kO(n,r);return a.success?{value:a.data}:{issues:a.error?.issues}}catch{return DO(n,r).then(l=>l.success?{value:l.data}:{issues:l.error?.issues})}},vendor:"zod",version:1}}),$O=wc("$ZodNever",(n,e)=>{UO.init(n,e),n._zod.parse=(t,i)=>(t.issues.push({expected:"never",code:"invalid_type",input:t.value,inst:n}),t)});class cS{constructor(){this._map=new Map,this._idmap=new Map}add(e,...t){const i=t[0];if(this._map.set(e,i),i&&typeof i=="object"&&"id"in i){if(this._idmap.has(i.id))throw new Error(`ID ${i.id} already exists in the registry`);this._idmap.set(i.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){const t=this._map.get(e);return t&&typeof t=="object"&&"id"in t&&this._idmap.delete(t.id),this._map.delete(e),this}get(e){const t=e._zod.parent;if(t){const i={...this.get(t)??{}};return delete i.id,{...i,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}}function qO(){return new cS}const er=qO();function BO(n,e){return new n({type:"never",...AO()})}class nw{constructor(e){this.counter=0,this.metadataRegistry=e?.metadata??er,this.target=e?.target??"draft-2020-12",this.unrepresentable=e?.unrepresentable??"throw",this.override=e?.override??(()=>{}),this.io=e?.io??"output",this.seen=new Map}process(e,t={path:[],schemaPath:[]}){var i;const r=e._zod.def,a={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},l=this.seen.get(e);if(l)return l.count++,t.schemaPath.includes(e)&&(l.cycle=t.path),l.schema;const c={schema:{},count:1,cycle:void 0,path:t.path};this.seen.set(e,c);const f=e._zod.toJSONSchema?.();if(f)c.schema=f;else{const _={...t,schemaPath:[...t.schemaPath,e],path:t.path},v=e._zod.parent;if(v)c.ref=v,this.process(v,_),this.seen.get(v).isParent=!0;else{const w=c.schema;switch(r.type){case"string":{const T=w;T.type="string";const{minimum:S,maximum:C,format:x,patterns:M,contentEncoding:R}=e._zod.bag;if(typeof S=="number"&&(T.minLength=S),typeof C=="number"&&(T.maxLength=C),x&&(T.format=a[x]??x,T.format===""&&delete T.format),R&&(T.contentEncoding=R),M&&M.size>0){const P=[...M];P.length===1?T.pattern=P[0].source:P.length>1&&(c.schema.allOf=[...P.map(O=>({...this.target==="draft-7"?{type:"string"}:{},pattern:O.source}))])}break}case"number":{const T=w,{minimum:S,maximum:C,format:x,multipleOf:M,exclusiveMaximum:R,exclusiveMinimum:P}=e._zod.bag;typeof x=="string"&&x.includes("int")?T.type="integer":T.type="number",typeof P=="number"&&(T.exclusiveMinimum=P),typeof S=="number"&&(T.minimum=S,typeof P=="number"&&(P>=S?delete T.minimum:delete T.exclusiveMinimum)),typeof R=="number"&&(T.exclusiveMaximum=R),typeof C=="number"&&(T.maximum=C,typeof R=="number"&&(R<=C?delete T.maximum:delete T.exclusiveMaximum)),typeof M=="number"&&(T.multipleOf=M);break}case"boolean":{const T=w;T.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema");break}case"null":{w.type="null";break}case"any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema");break}case"never":{w.not={};break}case"date":{if(this.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema");break}case"array":{const T=w,{minimum:S,maximum:C}=e._zod.bag;typeof S=="number"&&(T.minItems=S),typeof C=="number"&&(T.maxItems=C),T.type="array",T.items=this.process(r.element,{..._,path:[..._.path,"items"]});break}case"object":{const T=w;T.type="object",T.properties={};const S=r.shape;for(const M in S)T.properties[M]=this.process(S[M],{..._,path:[..._.path,"properties",M]});const C=new Set(Object.keys(S)),x=new Set([...C].filter(M=>{const R=r.shape[M]._zod;return this.io==="input"?R.optin===void 0:R.optout===void 0}));x.size>0&&(T.required=Array.from(x)),r.catchall?._zod.def.type==="never"?T.additionalProperties=!1:r.catchall?r.catchall&&(T.additionalProperties=this.process(r.catchall,{..._,path:[..._.path,"additionalProperties"]})):this.io==="output"&&(T.additionalProperties=!1);break}case"union":{const T=w;T.anyOf=r.options.map((S,C)=>this.process(S,{..._,path:[..._.path,"anyOf",C]}));break}case"intersection":{const T=w,S=this.process(r.left,{..._,path:[..._.path,"allOf",0]}),C=this.process(r.right,{..._,path:[..._.path,"allOf",1]}),x=R=>"allOf"in R&&Object.keys(R).length===1,M=[...x(S)?S.allOf:[S],...x(C)?C.allOf:[C]];T.allOf=M;break}case"tuple":{const T=w;T.type="array";const S=r.items.map((M,R)=>this.process(M,{..._,path:[..._.path,"prefixItems",R]}));if(this.target==="draft-2020-12"?T.prefixItems=S:T.items=S,r.rest){const M=this.process(r.rest,{..._,path:[..._.path,"items"]});this.target==="draft-2020-12"?T.items=M:T.additionalItems=M}r.rest&&(T.items=this.process(r.rest,{..._,path:[..._.path,"items"]}));const{minimum:C,maximum:x}=e._zod.bag;typeof C=="number"&&(T.minItems=C),typeof x=="number"&&(T.maxItems=x);break}case"record":{const T=w;T.type="object",T.propertyNames=this.process(r.keyType,{..._,path:[..._.path,"propertyNames"]}),T.additionalProperties=this.process(r.valueType,{..._,path:[..._.path,"additionalProperties"]});break}case"map":{if(this.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema");break}case"enum":{const T=w,S=SO(r.entries);S.every(C=>typeof C=="number")&&(T.type="number"),S.every(C=>typeof C=="string")&&(T.type="string"),T.enum=S;break}case"literal":{const T=w,S=[];for(const C of r.values)if(C===void 0){if(this.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof C=="bigint"){if(this.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");S.push(Number(C))}else S.push(C);if(S.length!==0)if(S.length===1){const C=S[0];T.type=C===null?"null":typeof C,T.const=C}else S.every(C=>typeof C=="number")&&(T.type="number"),S.every(C=>typeof C=="string")&&(T.type="string"),S.every(C=>typeof C=="boolean")&&(T.type="string"),S.every(C=>C===null)&&(T.type="null"),T.enum=S;break}case"file":{const T=w,S={type:"string",format:"binary",contentEncoding:"binary"},{minimum:C,maximum:x,mime:M}=e._zod.bag;C!==void 0&&(S.minLength=C),x!==void 0&&(S.maxLength=x),M?M.length===1?(S.contentMediaType=M[0],Object.assign(T,S)):T.anyOf=M.map(R=>({...S,contentMediaType:R})):Object.assign(T,S);break}case"transform":{if(this.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{const T=this.process(r.innerType,_);w.anyOf=[T,{type:"null"}];break}case"nonoptional":{this.process(r.innerType,_),c.ref=r.innerType;break}case"success":{const T=w;T.type="boolean";break}case"default":{this.process(r.innerType,_),c.ref=r.innerType,w.default=JSON.parse(JSON.stringify(r.defaultValue));break}case"prefault":{this.process(r.innerType,_),c.ref=r.innerType,this.io==="input"&&(w._prefault=JSON.parse(JSON.stringify(r.defaultValue)));break}case"catch":{this.process(r.innerType,_),c.ref=r.innerType;let T;try{T=r.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}w.default=T;break}case"nan":{if(this.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{const T=w,S=e._zod.pattern;if(!S)throw new Error("Pattern not found in template literal");T.type="string",T.pattern=S.source;break}case"pipe":{const T=this.io==="input"?r.in._zod.def.type==="transform"?r.out:r.in:r.out;this.process(T,_),c.ref=T;break}case"readonly":{this.process(r.innerType,_),c.ref=r.innerType,w.readOnly=!0;break}case"promise":{this.process(r.innerType,_),c.ref=r.innerType;break}case"optional":{this.process(r.innerType,_),c.ref=r.innerType;break}case"lazy":{const T=e._zod.innerType;this.process(T,_),c.ref=T;break}case"custom":{if(this.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema");break}}}}const d=this.metadataRegistry.get(e);return d&&Object.assign(c.schema,d),this.io==="input"&&ft(e)&&(delete c.schema.examples,delete c.schema.default),this.io==="input"&&c.schema._prefault&&((i=c.schema).default??(i.default=c.schema._prefault)),delete c.schema._prefault,this.seen.get(e).schema}emit(e,t){const i={cycles:t?.cycles??"ref",reused:t?.reused??"inline",external:t?.external??void 0},r=this.seen.get(e);if(!r)throw new Error("Unprocessed schema. This is a bug in Zod.");const a=g=>{const _=this.target==="draft-2020-12"?"$defs":"definitions";if(i.external){const S=i.external.registry.get(g[0])?.id,C=i.external.uri??(M=>M);if(S)return{ref:C(S)};const x=g[1].defId??g[1].schema.id??`schema${this.counter++}`;return g[1].defId=x,{defId:x,ref:`${C("__shared")}#/${_}/${x}`}}if(g[1]===r)return{ref:"#"};const w=`#/${_}/`,T=g[1].schema.id??`__schema${this.counter++}`;return{defId:T,ref:w+T}},l=g=>{if(g[1].schema.$ref)return;const _=g[1],{ref:v,defId:w}=a(g);_.def={..._.schema},w&&(_.defId=w);const T=_.schema;for(const S in T)delete T[S];T.$ref=v};if(i.cycles==="throw")for(const g of this.seen.entries()){const _=g[1];if(_.cycle)throw new Error(`Cycle detected: #/${_.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(const g of this.seen.entries()){const _=g[1];if(e===g[0]){l(g);continue}if(i.external){const w=i.external.registry.get(g[0])?.id;if(e!==g[0]&&w){l(g);continue}}if(this.metadataRegistry.get(g[0])?.id){l(g);continue}if(_.cycle){l(g);continue}if(_.count>1&&i.reused==="ref"){l(g);continue}}const c=(g,_)=>{const v=this.seen.get(g),w=v.def??v.schema,T={...w};if(v.ref===null)return;const S=v.ref;if(v.ref=null,S){c(S,_);const C=this.seen.get(S).schema;C.$ref&&_.target==="draft-7"?(w.allOf=w.allOf??[],w.allOf.push(C)):(Object.assign(w,C),Object.assign(w,T))}v.isParent||this.override({zodSchema:g,jsonSchema:w,path:v.path??[]})};for(const g of[...this.seen.entries()].reverse())c(g[0],{target:this.target});const f={};if(this.target==="draft-2020-12"?f.$schema="https://json-schema.org/draft/2020-12/schema":this.target==="draft-7"?f.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),i.external?.uri){const g=i.external.registry.get(e)?.id;if(!g)throw new Error("Schema is missing an `id` property");f.$id=i.external.uri(g)}Object.assign(f,r.def);const d=i.external?.defs??{};for(const g of this.seen.entries()){const _=g[1];_.def&&_.defId&&(d[_.defId]=_.def)}i.external||Object.keys(d).length>0&&(this.target==="draft-2020-12"?f.$defs=d:f.definitions=d);try{return JSON.parse(JSON.stringify(f))}catch{throw new Error("Error converting schema to JSON.")}}}function iw(n,e){if(n instanceof cS){const i=new nw(e),r={};for(const c of n._idmap.entries()){const[f,d]=c;i.process(d)}const a={},l={registry:n,uri:e?.uri,defs:r};for(const c of n._idmap.entries()){const[f,d]=c;a[f]=i.emit(d,{...e,external:l})}if(Object.keys(r).length>0){const c=i.target==="draft-2020-12"?"$defs":"definitions";a.__shared={[c]:r}}return{schemas:a}}const t=new nw(e);return t.process(n),t.emit(n,e)}function ft(n,e){const t=e??{seen:new Set};if(t.seen.has(n))return!1;t.seen.add(n);const r=n._zod.def;switch(r.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return ft(r.element,t);case"object":{for(const a in r.shape)if(ft(r.shape[a],t))return!0;return!1}case"union":{for(const a of r.options)if(ft(a,t))return!0;return!1}case"intersection":return ft(r.left,t)||ft(r.right,t);case"tuple":{for(const a of r.items)if(ft(a,t))return!0;return!!(r.rest&&ft(r.rest,t))}case"record":return ft(r.keyType,t)||ft(r.valueType,t);case"map":return ft(r.keyType,t)||ft(r.valueType,t);case"set":return ft(r.valueType,t);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return ft(r.innerType,t);case"lazy":return ft(r.getter(),t);case"default":return ft(r.innerType,t);case"prefault":return ft(r.innerType,t);case"custom":return!1;case"transform":return!0;case"pipe":return ft(r.in,t)||ft(r.out,t);case"success":return!1;case"catch":return!1}throw new Error(`Unknown schema type: ${r.type}`)}const GO=Symbol("Let zodToJsonSchema decide on which parser to use"),VO={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},FO=n=>({...VO,...n}),HO=n=>{const e=FO(n),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,flags:{hasReferencedOpenAiAnyType:!1},currentPath:t,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([i,r])=>[r._def,{def:r._def,path:[...e.basePath,e.definitionPath,i],jsonSchema:void 0}]))}};function fS(n,e,t,i){i?.errorMessages&&t&&(n.errorMessage={...n.errorMessage,[e]:t})}function Ve(n,e,t,i,r){n[e]=t,fS(n,e,i,r)}const dS=(n,e)=>{let t=0;for(;t<n.length&&t<e.length&&n[t]===e[t];t++);return[(n.length-t).toString(),...e.slice(t)].join("/")};function dn(n){if(n.target!=="openAi")return{};const e=[...n.basePath,n.definitionPath,n.openAiAnyTypeName];return n.flags.hasReferencedOpenAiAnyType=!0,{$ref:n.$refStrategy==="relative"?dS(e,n.currentPath):e.join("/")}}function zO(n,e){const t={type:"array"};return n.type?._def&&n.type?._def?.typeName!==ee.ZodAny&&(t.items=qe(n.type._def,{...e,currentPath:[...e.currentPath,"items"]})),n.minLength&&Ve(t,"minItems",n.minLength.value,n.minLength.message,e),n.maxLength&&Ve(t,"maxItems",n.maxLength.value,n.maxLength.message,e),n.exactLength&&(Ve(t,"minItems",n.exactLength.value,n.exactLength.message,e),Ve(t,"maxItems",n.exactLength.value,n.exactLength.message,e)),t}function jO(n,e){const t={type:"integer",format:"int64"};if(!n.checks)return t;for(const i of n.checks)switch(i.kind){case"min":e.target==="jsonSchema7"?i.inclusive?Ve(t,"minimum",i.value,i.message,e):Ve(t,"exclusiveMinimum",i.value,i.message,e):(i.inclusive||(t.exclusiveMinimum=!0),Ve(t,"minimum",i.value,i.message,e));break;case"max":e.target==="jsonSchema7"?i.inclusive?Ve(t,"maximum",i.value,i.message,e):Ve(t,"exclusiveMaximum",i.value,i.message,e):(i.inclusive||(t.exclusiveMaximum=!0),Ve(t,"maximum",i.value,i.message,e));break;case"multipleOf":Ve(t,"multipleOf",i.value,i.message,e);break}return t}function JO(){return{type:"boolean"}}function hS(n,e){return qe(n.type._def,e)}const KO=(n,e)=>qe(n.innerType._def,e);function pS(n,e,t){const i=t??e.dateStrategy;if(Array.isArray(i))return{anyOf:i.map((r,a)=>pS(n,e,r))};switch(i){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return YO(n,e)}}const YO=(n,e)=>{const t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(const i of n.checks)switch(i.kind){case"min":Ve(t,"minimum",i.value,i.message,e);break;case"max":Ve(t,"maximum",i.value,i.message,e);break}return t};function ZO(n,e){return{...qe(n.innerType._def,e),default:n.defaultValue()}}function QO(n,e){return e.effectStrategy==="input"?qe(n.schema._def,e):dn(e)}function XO(n){return{type:"string",enum:Array.from(n.values)}}const WO=n=>"type"in n&&n.type==="string"?!1:"allOf"in n;function ek(n,e){const t=[qe(n.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),qe(n.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a);let i=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const r=[];return t.forEach(a=>{if(WO(a))r.push(...a.allOf),a.unevaluatedProperties===void 0&&(i=void 0);else{let l=a;if("additionalProperties"in a&&a.additionalProperties===!1){const{additionalProperties:c,...f}=a;l=f}else i=void 0;r.push(l)}}),r.length?{allOf:r,...i}:void 0}function tk(n,e){const t=typeof n.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(n.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[n.value]}:{type:t==="bigint"?"integer":t,const:n.value}}let hp;const In={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(hp===void 0&&(hp=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),hp),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function mS(n,e){const t={type:"string"};if(n.checks)for(const i of n.checks)switch(i.kind){case"min":Ve(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,i.value):i.value,i.message,e);break;case"max":Ve(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,i.value):i.value,i.message,e);break;case"email":switch(e.emailStrategy){case"format:email":Mn(t,"email",i.message,e);break;case"format:idn-email":Mn(t,"idn-email",i.message,e);break;case"pattern:zod":Lt(t,In.email,i.message,e);break}break;case"url":Mn(t,"uri",i.message,e);break;case"uuid":Mn(t,"uuid",i.message,e);break;case"regex":Lt(t,i.regex,i.message,e);break;case"cuid":Lt(t,In.cuid,i.message,e);break;case"cuid2":Lt(t,In.cuid2,i.message,e);break;case"startsWith":Lt(t,RegExp(`^${pp(i.value,e)}`),i.message,e);break;case"endsWith":Lt(t,RegExp(`${pp(i.value,e)}$`),i.message,e);break;case"datetime":Mn(t,"date-time",i.message,e);break;case"date":Mn(t,"date",i.message,e);break;case"time":Mn(t,"time",i.message,e);break;case"duration":Mn(t,"duration",i.message,e);break;case"length":Ve(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,i.value):i.value,i.message,e),Ve(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,i.value):i.value,i.message,e);break;case"includes":{Lt(t,RegExp(pp(i.value,e)),i.message,e);break}case"ip":{i.version!=="v6"&&Mn(t,"ipv4",i.message,e),i.version!=="v4"&&Mn(t,"ipv6",i.message,e);break}case"base64url":Lt(t,In.base64url,i.message,e);break;case"jwt":Lt(t,In.jwt,i.message,e);break;case"cidr":{i.version!=="v6"&&Lt(t,In.ipv4Cidr,i.message,e),i.version!=="v4"&&Lt(t,In.ipv6Cidr,i.message,e);break}case"emoji":Lt(t,In.emoji(),i.message,e);break;case"ulid":{Lt(t,In.ulid,i.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{Mn(t,"binary",i.message,e);break}case"contentEncoding:base64":{Ve(t,"contentEncoding","base64",i.message,e);break}case"pattern:zod":{Lt(t,In.base64,i.message,e);break}}break}case"nanoid":Lt(t,In.nanoid,i.message,e)}return t}function pp(n,e){return e.patternStrategy==="escape"?ik(n):n}const nk=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function ik(n){let e="";for(let t=0;t<n.length;t++)nk.has(n[t])||(e+="\\"),e+=n[t];return e}function Mn(n,e,t,i){n.format||n.anyOf?.some(r=>r.format)?(n.anyOf||(n.anyOf=[]),n.format&&(n.anyOf.push({format:n.format,...n.errorMessage&&i.errorMessages&&{errorMessage:{format:n.errorMessage.format}}}),delete n.format,n.errorMessage&&(delete n.errorMessage.format,Object.keys(n.errorMessage).length===0&&delete n.errorMessage)),n.anyOf.push({format:e,...t&&i.errorMessages&&{errorMessage:{format:t}}})):Ve(n,"format",e,t,i)}function Lt(n,e,t,i){n.pattern||n.allOf?.some(r=>r.pattern)?(n.allOf||(n.allOf=[]),n.pattern&&(n.allOf.push({pattern:n.pattern,...n.errorMessage&&i.errorMessages&&{errorMessage:{pattern:n.errorMessage.pattern}}}),delete n.pattern,n.errorMessage&&(delete n.errorMessage.pattern,Object.keys(n.errorMessage).length===0&&delete n.errorMessage)),n.allOf.push({pattern:rw(e,i),...t&&i.errorMessages&&{errorMessage:{pattern:t}}})):Ve(n,"pattern",rw(e,i),t,i)}function rw(n,e){if(!e.applyRegexFlags||!n.flags)return n.source;const t={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},i=t.i?n.source.toLowerCase():n.source;let r="",a=!1,l=!1,c=!1;for(let f=0;f<i.length;f++){if(a){r+=i[f],a=!1;continue}if(t.i){if(l){if(i[f].match(/[a-z]/)){c?(r+=i[f],r+=`${i[f-2]}-${i[f]}`.toUpperCase(),c=!1):i[f+1]==="-"&&i[f+2]?.match(/[a-z]/)?(r+=i[f],c=!0):r+=`${i[f]}${i[f].toUpperCase()}`;continue}}else if(i[f].match(/[a-z]/)){r+=`[${i[f]}${i[f].toUpperCase()}]`;continue}}if(t.m){if(i[f]==="^"){r+=`(^|(?<=[\r
]))`;continue}else if(i[f]==="$"){r+=`($|(?=[\r
]))`;continue}}if(t.s&&i[f]==="."){r+=l?`${i[f]}\r
`:`[${i[f]}\r
]`;continue}r+=i[f],i[f]==="\\"?a=!0:l&&i[f]==="]"?l=!1:!l&&i[f]==="["&&(l=!0)}try{new RegExp(r)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return r}function gS(n,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&n.keyType?._def.typeName===ee.ZodEnum)return{type:"object",required:n.keyType._def.values,properties:n.keyType._def.values.reduce((i,r)=>({...i,[r]:qe(n.valueType._def,{...e,currentPath:[...e.currentPath,"properties",r]})??dn(e)}),{}),additionalProperties:e.rejectedAdditionalProperties};const t={type:"object",additionalProperties:qe(n.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return t;if(n.keyType?._def.typeName===ee.ZodString&&n.keyType._def.checks?.length){const{type:i,...r}=mS(n.keyType._def,e);return{...t,propertyNames:r}}else{if(n.keyType?._def.typeName===ee.ZodEnum)return{...t,propertyNames:{enum:n.keyType._def.values}};if(n.keyType?._def.typeName===ee.ZodBranded&&n.keyType._def.type._def.typeName===ee.ZodString&&n.keyType._def.type._def.checks?.length){const{type:i,...r}=hS(n.keyType._def,e);return{...t,propertyNames:r}}}return t}function rk(n,e){if(e.mapStrategy==="record")return gS(n,e);const t=qe(n.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||dn(e),i=qe(n.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||dn(e);return{type:"array",maxItems:125,items:{type:"array",items:[t,i],minItems:2,maxItems:2}}}function sk(n){const e=n.values,i=Object.keys(n.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),r=Array.from(new Set(i.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:i}}function ak(n){return n.target==="openAi"?void 0:{not:dn({...n,currentPath:[...n.currentPath,"not"]})}}function ok(n){return n.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const sc={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function lk(n,e){if(e.target==="openApi3")return sw(n,e);const t=n.options instanceof Map?Array.from(n.options.values()):n.options;if(t.every(i=>i._def.typeName in sc&&(!i._def.checks||!i._def.checks.length))){const i=t.reduce((r,a)=>{const l=sc[a._def.typeName];return l&&!r.includes(l)?[...r,l]:r},[]);return{type:i.length>1?i:i[0]}}else if(t.every(i=>i._def.typeName==="ZodLiteral"&&!i.description)){const i=t.reduce((r,a)=>{const l=typeof a._def.value;switch(l){case"string":case"number":case"boolean":return[...r,l];case"bigint":return[...r,"integer"];case"object":if(a._def.value===null)return[...r,"null"];case"symbol":case"undefined":case"function":default:return r}},[]);if(i.length===t.length){const r=i.filter((a,l,c)=>c.indexOf(a)===l);return{type:r.length>1?r:r[0],enum:t.reduce((a,l)=>a.includes(l._def.value)?a:[...a,l._def.value],[])}}}else if(t.every(i=>i._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((i,r)=>[...i,...r._def.values.filter(a=>!i.includes(a))],[])};return sw(n,e)}const sw=(n,e)=>{const t=(n.options instanceof Map?Array.from(n.options.values()):n.options).map((i,r)=>qe(i._def,{...e,currentPath:[...e.currentPath,"anyOf",`${r}`]})).filter(i=>!!i&&(!e.strictUnions||typeof i=="object"&&Object.keys(i).length>0));return t.length?{anyOf:t}:void 0};function uk(n,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(n.innerType._def.typeName)&&(!n.innerType._def.checks||!n.innerType._def.checks.length))return e.target==="openApi3"?{type:sc[n.innerType._def.typeName],nullable:!0}:{type:[sc[n.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const i=qe(n.innerType._def,{...e,currentPath:[...e.currentPath]});return i&&"$ref"in i?{allOf:[i],nullable:!0}:i&&{...i,nullable:!0}}const t=qe(n.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function ck(n,e){const t={type:"number"};if(!n.checks)return t;for(const i of n.checks)switch(i.kind){case"int":t.type="integer",fS(t,"type",i.message,e);break;case"min":e.target==="jsonSchema7"?i.inclusive?Ve(t,"minimum",i.value,i.message,e):Ve(t,"exclusiveMinimum",i.value,i.message,e):(i.inclusive||(t.exclusiveMinimum=!0),Ve(t,"minimum",i.value,i.message,e));break;case"max":e.target==="jsonSchema7"?i.inclusive?Ve(t,"maximum",i.value,i.message,e):Ve(t,"exclusiveMaximum",i.value,i.message,e):(i.inclusive||(t.exclusiveMaximum=!0),Ve(t,"maximum",i.value,i.message,e));break;case"multipleOf":Ve(t,"multipleOf",i.value,i.message,e);break}return t}function fk(n,e){const t=e.target==="openAi",i={type:"object",properties:{}},r=[],a=n.shape();for(const c in a){let f=a[c];if(f===void 0||f._def===void 0)continue;let d=hk(f);d&&t&&(f._def.typeName==="ZodOptional"&&(f=f._def.innerType),f.isNullable()||(f=f.nullable()),d=!1);const g=qe(f._def,{...e,currentPath:[...e.currentPath,"properties",c],propertyPath:[...e.currentPath,"properties",c]});g!==void 0&&(i.properties[c]=g,d||r.push(c))}r.length&&(i.required=r);const l=dk(n,e);return l!==void 0&&(i.additionalProperties=l),i}function dk(n,e){if(n.catchall._def.typeName!=="ZodNever")return qe(n.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(n.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function hk(n){try{return n.isOptional()}catch{return!0}}const pk=(n,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return qe(n.innerType._def,e);const t=qe(n.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:dn(e)},t]}:dn(e)},mk=(n,e)=>{if(e.pipeStrategy==="input")return qe(n.in._def,e);if(e.pipeStrategy==="output")return qe(n.out._def,e);const t=qe(n.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),i=qe(n.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,i].filter(r=>r!==void 0)}};function gk(n,e){return qe(n.type._def,e)}function yk(n,e){const i={type:"array",uniqueItems:!0,items:qe(n.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return n.minSize&&Ve(i,"minItems",n.minSize.value,n.minSize.message,e),n.maxSize&&Ve(i,"maxItems",n.maxSize.value,n.maxSize.message,e),i}function _k(n,e){return n.rest?{type:"array",minItems:n.items.length,items:n.items.map((t,i)=>qe(t._def,{...e,currentPath:[...e.currentPath,"items",`${i}`]})).reduce((t,i)=>i===void 0?t:[...t,i],[]),additionalItems:qe(n.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:n.items.length,maxItems:n.items.length,items:n.items.map((t,i)=>qe(t._def,{...e,currentPath:[...e.currentPath,"items",`${i}`]})).reduce((t,i)=>i===void 0?t:[...t,i],[])}}function vk(n){return{not:dn(n)}}function bk(n){return dn(n)}const wk=(n,e)=>qe(n.innerType._def,e),Tk=(n,e,t)=>{switch(e){case ee.ZodString:return mS(n,t);case ee.ZodNumber:return ck(n,t);case ee.ZodObject:return fk(n,t);case ee.ZodBigInt:return jO(n,t);case ee.ZodBoolean:return JO();case ee.ZodDate:return pS(n,t);case ee.ZodUndefined:return vk(t);case ee.ZodNull:return ok(t);case ee.ZodArray:return zO(n,t);case ee.ZodUnion:case ee.ZodDiscriminatedUnion:return lk(n,t);case ee.ZodIntersection:return ek(n,t);case ee.ZodTuple:return _k(n,t);case ee.ZodRecord:return gS(n,t);case ee.ZodLiteral:return tk(n,t);case ee.ZodEnum:return XO(n);case ee.ZodNativeEnum:return sk(n);case ee.ZodNullable:return uk(n,t);case ee.ZodOptional:return pk(n,t);case ee.ZodMap:return rk(n,t);case ee.ZodSet:return yk(n,t);case ee.ZodLazy:return()=>n.getter()._def;case ee.ZodPromise:return gk(n,t);case ee.ZodNaN:case ee.ZodNever:return ak(t);case ee.ZodEffects:return QO(n,t);case ee.ZodAny:return dn(t);case ee.ZodUnknown:return bk(t);case ee.ZodDefault:return ZO(n,t);case ee.ZodBranded:return hS(n,t);case ee.ZodReadonly:return wk(n,t);case ee.ZodCatch:return KO(n,t);case ee.ZodPipeline:return mk(n,t);case ee.ZodFunction:case ee.ZodVoid:case ee.ZodSymbol:return;default:return(i=>{})()}};function qe(n,e,t=!1){const i=e.seen.get(n);if(e.override){const c=e.override?.(n,e,i,t);if(c!==GO)return c}if(i&&!t){const c=Ek(i,e);if(c!==void 0)return c}const r={def:n,path:e.currentPath,jsonSchema:void 0};e.seen.set(n,r);const a=Tk(n,n.typeName,e),l=typeof a=="function"?qe(a(),e):a;if(l&&Sk(n,e,l),e.postProcess){const c=e.postProcess(l,n,e);return r.jsonSchema=l,c}return r.jsonSchema=l,l}const Ek=(n,e)=>{switch(e.$refStrategy){case"root":return{$ref:n.path.join("/")};case"relative":return{$ref:dS(e.currentPath,n.path)};case"none":case"seen":return n.path.length<e.currentPath.length&&n.path.every((t,i)=>e.currentPath[i]===t)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),dn(e)):e.$refStrategy==="seen"?dn(e):void 0}},Sk=(n,e,t)=>(n.description&&(t.description=n.description,e.markdownDescription&&(t.markdownDescription=n.description)),t),Ck=(n,e)=>{const t=HO(e);let i;const r=e?.name,a=qe(n._def,t,!1)??dn(t);t.flags.hasReferencedOpenAiAnyType&&(i||(i={}),i[t.openAiAnyTypeName]||(i[t.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:t.$refStrategy==="relative"?"1":[...t.basePath,t.definitionPath,t.openAiAnyTypeName].join("/")}}));const l=r===void 0?i?{...a,[t.definitionPath]:i}:a:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,r].join("/"),[t.definitionPath]:{...i,[r]:a}};return t.target==="jsonSchema7"?l.$schema="http://json-schema.org/draft-07/schema#":(t.target==="jsonSchema2019-09"||t.target==="openAi")&&(l.$schema="https://json-schema.org/draft/2019-09/schema#"),t.target==="openAi"&&("anyOf"in l||"oneOf"in l||"allOf"in l||"type"in l&&Array.isArray(l.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),l};function Hp(n,e){const t=typeof n;if(t!==typeof e)return!1;if(Array.isArray(n)){if(!Array.isArray(e))return!1;const i=n.length;if(i!==e.length)return!1;for(let r=0;r<i;r++)if(!Hp(n[r],e[r]))return!1;return!0}if(t==="object"){if(!n||!e)return n===e;const i=Object.keys(n),r=Object.keys(e);if(i.length!==r.length)return!1;for(const l of i)if(!Hp(n[l],e[l]))return!1;return!0}return n===e}function Yn(n){if(typeof n!="object"||n===null)return!1;const e=n;if(!("_zod"in e))return!1;const t=e._zod;return typeof t=="object"&&t!==null&&"def"in t}function yi(n){if(typeof n!="object"||n===null)return!1;const e=n;if(!("_def"in e)||"_zod"in e)return!1;const t=e._def;return typeof t=="object"&&t!=null&&"typeName"in t}function il(n){return!n||typeof n!="object"||Array.isArray(n)?!1:!!(Yn(n)||yi(n))}async function Ak(n,e){if(Yn(n))try{return{success:!0,data:await NO(n,e)}}catch(t){return{success:!1,error:t}}if(yi(n))return n.safeParse(e);throw new Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}async function Rk(n,e){if(Yn(n))return IO(n,e);if(yi(n))return n.parse(e);throw new Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}function yS(n){if(Yn(n))return er.get(n)?.description;if(yi(n)||"description"in n&&typeof n.description=="string")return n.description}function xk(n){return il(n)?yi(n)?n._def.typeName==="ZodString":Yn(n)?n._zod.def.type==="string":!1:!1}function Po(n){return Yn(n)?typeof n=="object"&&n!==null&&"_zod"in n&&typeof n._zod=="object"&&n._zod!==null&&"def"in n._zod&&typeof n._zod.def=="object"&&n._zod.def!==null&&"type"in n._zod.def&&n._zod.def.type==="object":!1}function _S(n){return Yn(n)?typeof n=="object"&&n!==null&&"_zod"in n&&typeof n._zod=="object"&&n._zod!==null&&"def"in n._zod&&typeof n._zod.def=="object"&&n._zod.def!==null&&"type"in n._zod.def&&n._zod.def.type==="array":!1}function zp(n,e=!1){if(yi(n))return n.strict();if(Po(n)){const t=n._zod.def.shape;if(e)for(const[a,l]of Object.entries(n._zod.def.shape)){if(Po(l)){const f=zp(l,e);t[a]=f}else if(_S(l)){let f=l._zod.def.element;Po(f)&&(f=zp(f,e)),t[a]=rc(l,{...l._zod.def,element:f})}else t[a]=l;const c=er.get(l);c&&er.add(t[a],c)}const i=rc(n,{...n._zod.def,shape:t,catchall:BO($O)}),r=er.get(n);return r&&er.add(i,r),i}throw new Error("Schema must be an instance of z3.ZodObject or z4.$ZodObject")}function Ik(n){return yi(n)&&"typeName"in n._def&&n._def.typeName==="ZodEffects"}function Mk(n){return Yn(n)&&n._zod.def.type==="pipe"}function Ro(n,e=!1){if(yi(n))return Ik(n)?Ro(n._def.schema,e):n;if(Yn(n)){let t=n;if(Mk(n)&&(t=Ro(n._zod.def.in,e)),e){if(Po(t)){const r=t._zod.def.shape;for(const[a,l]of Object.entries(t._zod.def.shape))r[a]=Ro(l,e);t=rc(t,{...t._zod.def,shape:r})}else if(_S(t)){const r=Ro(t._zod.def.element,e);t=rc(t,{...t._zod.def,element:r})}}const i=er.get(n);return i&&er.add(t,i),t}throw new Error("Schema must be an instance of z3.ZodType or z4.$ZodType")}function qm(n){if(Yn(n)){const e=Ro(n,!0);if(Po(e)){const t=zp(e,!0);return iw(t)}else return iw(n)}return yi(n)?Ck(n):n}function Nk(n,e){if(n!==void 0&&!Mo(n))return n;if($m(e))try{let t=e.getName();return t=t.startsWith("Runnable")?t.slice(8):t,t}catch{return e.getName()}else return e.name??"UnknownSchema"}function Ok(n){return $m(n.data)?{type:"runnable",data:{id:n.data.lc_id,name:n.data.getName()}}:{type:"schema",data:{...qm(n.data.schema),title:n.data.name}}}class Cc{constructor(e){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.nodes=e?.nodes??this.nodes,this.edges=e?.edges??this.edges}toJSON(){const e={};return Object.values(this.nodes).forEach((t,i)=>{e[t.id]=Mo(t.id)?i:t.id}),{nodes:Object.values(this.nodes).map(t=>({id:e[t.id],...Ok(t)})),edges:this.edges.map(t=>{const i={source:e[t.source],target:e[t.target]};return typeof t.data<"u"&&(i.data=t.data),typeof t.conditional<"u"&&(i.conditional=t.conditional),i})}}addNode(e,t,i){if(t!==void 0&&this.nodes[t]!==void 0)throw new Error(`Node with id ${t} already exists`);const r=t??Ut(),a={id:r,data:e,name:Nk(t,e),metadata:i};return this.nodes[r]=a,a}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(t=>t.source!==e.id&&t.target!==e.id)}addEdge(e,t,i,r){if(this.nodes[e.id]===void 0)throw new Error(`Source node ${e.id} not in graph`);if(this.nodes[t.id]===void 0)throw new Error(`Target node ${t.id} not in graph`);const a={source:e.id,target:t.id,data:i,conditional:r};return this.edges.push(a),a}firstNode(){return aw(this)}lastNode(){return ow(this)}extend(e,t=""){let i=t;Object.values(e.nodes).map(d=>d.id).every(Mo)&&(i="");const a=d=>i?`${i}:${d}`:d;Object.entries(e.nodes).forEach(([d,g])=>{this.nodes[a(d)]={...g,id:a(d)}});const l=e.edges.map(d=>({...d,source:a(d.source),target:a(d.target)}));this.edges=[...this.edges,...l];const c=e.firstNode(),f=e.lastNode();return[c?{id:a(c.id),data:c.data}:void 0,f?{id:a(f.id),data:f.data}:void 0]}trimFirstNode(){const e=this.firstNode();e&&aw(this,[e.id])&&this.removeNode(e)}trimLastNode(){const e=this.lastNode();e&&ow(this,[e.id])&&this.removeNode(e)}reid(){const e=Object.fromEntries(Object.values(this.nodes).map(r=>[r.id,r.name])),t=new Map;Object.values(e).forEach(r=>{t.set(r,(t.get(r)||0)+1)});const i=r=>{const a=e[r];return Mo(r)&&t.get(a)===1?a:r};return new Cc({nodes:Object.fromEntries(Object.entries(this.nodes).map(([r,a])=>[i(r),{...a,id:i(r)}])),edges:this.edges.map(r=>({...r,source:i(r.source),target:i(r.target)}))})}drawMermaid(e){const{withStyles:t,curveStyle:i,nodeColors:r={default:"fill:#f2f0ff,line-height:1.2",first:"fill-opacity:0",last:"fill:#bfb6fc"},wrapLabelNWords:a}=e??{},l=this.reid(),c=l.firstNode(),f=l.lastNode();return wO(l.nodes,l.edges,{firstNode:c?.id,lastNode:f?.id,withStyles:t,curveStyle:i,nodeColors:r,wrapLabelNWords:a})}async drawMermaidPng(e){const t=this.drawMermaid(e);return TO(t,{backgroundColor:e?.backgroundColor})}}function aw(n,e=[]){const t=new Set(n.edges.filter(r=>!e.includes(r.source)).map(r=>r.target)),i=[];for(const r of Object.values(n.nodes))!e.includes(r.id)&&!t.has(r.id)&&i.push(r);return i.length===1?i[0]:void 0}function ow(n,e=[]){const t=new Set(n.edges.filter(r=>!e.includes(r.target)).map(r=>r.source)),i=[];for(const r of Object.values(n.nodes))!e.includes(r.id)&&!t.has(r.id)&&i.push(r);return i.length===1?i[0]:void 0}function kk(n){const e=new TextEncoder,t=new ReadableStream({async start(i){for await(const r of n)i.enqueue(e.encode(`event: data
data: ${JSON.stringify(r)}

`));i.enqueue(e.encode(`event: end

`)),i.close()}});return fn.fromReadableStream(t)}function lw(n){return typeof n=="object"&&n!==null&&typeof n[Symbol.iterator]=="function"&&typeof n.next=="function"}const Pk=n=>n!=null&&typeof n=="object"&&"next"in n&&typeof n.next=="function";function jp(n){return typeof n=="object"&&n!==null&&typeof n[Symbol.asyncIterator]=="function"}function*uw(n,e){for(;;){const{value:t,done:i}=cr.runWithConfig(na(n),e.next.bind(e),!0);if(i)break;yield t}}async function*Jp(n,e){const t=e[Symbol.asyncIterator]();for(;;){const{value:i,done:r}=await cr.runWithConfig(na(n),t.next.bind(e),!0);if(r)break;yield i}}function bt(n,e){return n&&!Array.isArray(n)&&!(n instanceof Date)&&typeof n=="object"?n:{[e]:n}}class lt extends ur{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(e){const t=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${t}${e}`:t}bind(e){return new Lr({bound:this,kwargs:e,config:{}})}map(){return new ac({bound:this})}withRetry(e){return new vS({bound:this,kwargs:{},config:{},maxAttemptNumber:e?.stopAfterAttempt,...e})}withConfig(e){return new Lr({bound:this,config:e,kwargs:{}})}withFallbacks(e){const t=Array.isArray(e)?e:e.fallbacks;return new Lk({runnable:this,fallbacks:t})}_getOptionsList(e,t=0){if(Array.isArray(e)&&e.length!==t)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${t} inputs`);if(Array.isArray(e))return e.map(De);if(t>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");const i=Object.fromEntries(Object.entries(e).filter(([r])=>r!=="runId"));return Array.from({length:t},(r,a)=>De(a===0?e:i))}return Array.from({length:t},()=>De(e))}async batch(e,t,i){const r=this._getOptionsList(t??{},e.length),a=r[0]?.maxConcurrency??i?.maxConcurrency,l=new bc({maxConcurrency:a,onFailedAttempt:f=>{throw f}}),c=e.map((f,d)=>l.call(async()=>{try{return await this.invoke(f,r[d])}catch(g){if(i?.returnExceptions)return g;throw g}}));return Promise.all(c)}async*_streamIterator(e,t){yield this.invoke(e,t)}async stream(e,t){const i=De(t),r=new ca({generator:this._streamIterator(e,i),config:i});return await r.setup,fn.fromAsyncGenerator(r)}_separateRunnableConfigFromCallOptions(e){let t;e===void 0?t=De(e):t=De({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});const i={...e};return delete i.callbacks,delete i.tags,delete i.metadata,delete i.runName,delete i.configurable,delete i.recursionLimit,delete i.maxConcurrency,delete i.runId,delete i.timeout,delete i.signal,[t,i]}async _callWithConfig(e,t,i){const r=De(i),l=await(await Dn(r))?.handleChainStart(this.toJSON(),bt(t,"input"),r.runId,r?.runType,void 0,void 0,r?.runName??this.getName());delete r.runId;let c;try{const f=e.call(this,t,r,l);c=await fr(f,i?.signal)}catch(f){throw await l?.handleChainError(f),f}return await l?.handleChainEnd(bt(c,"output")),c}async _batchWithConfig(e,t,i,r){const a=this._getOptionsList(i??{},t.length),l=await Promise.all(a.map(Dn)),c=await Promise.all(l.map(async(d,g)=>{const _=await d?.handleChainStart(this.toJSON(),bt(t[g],"input"),a[g].runId,a[g].runType,void 0,void 0,a[g].runName??this.getName());return delete a[g].runId,_}));let f;try{const d=e.call(this,t,a,c,r);f=await fr(d,a?.[0]?.signal)}catch(d){throw await Promise.all(c.map(g=>g?.handleChainError(d))),d}return await Promise.all(c.map(d=>d?.handleChainEnd(bt(f,"output")))),f}async*_transformStreamWithConfig(e,t,i){let r,a=!0,l,c=!0;const f=De(i),d=await Dn(f);async function*g(){for await(const v of e){if(a)if(r===void 0)r=v;else try{r=Ln(r,v)}catch{r=void 0,a=!1}yield v}}let _;try{const v=await fO(t.bind(this),g(),async()=>d?.handleChainStart(this.toJSON(),{input:""},f.runId,f.runType,void 0,void 0,f.runName??this.getName()),i?.signal,f);delete f.runId,_=v.setup;const w=_?.handlers.find(pO);let T=v.output;w!==void 0&&_!==void 0&&(T=w.tapOutputIterable(_.runId,T));const S=_?.handlers.find(dO);S!==void 0&&_!==void 0&&(T=S.tapOutputIterable(_.runId,T));for await(const C of T)if(yield C,c)if(l===void 0)l=C;else try{l=Ln(l,C)}catch{l=void 0,c=!1}}catch(v){throw await _?.handleChainError(v,void 0,void 0,void 0,{inputs:bt(r,"input")}),v}await _?.handleChainEnd(l??{},void 0,void 0,void 0,{inputs:bt(r,"input")})}getGraph(e){const t=new Cc,i=t.addNode({name:`${this.getName()}Input`,schema:vb()}),r=t.addNode(this),a=t.addNode({name:`${this.getName()}Output`,schema:vb()});return t.addEdge(i,r),t.addEdge(r,a),t}pipe(e){return new Pn({first:this,last:Dr(e)})}pick(e){return this.pipe(new Uk(e))}assign(e){return this.pipe(new bS(new fa({steps:e})))}async*transform(e,t){let i;for await(const r of e)i===void 0?i=r:i=Ln(i,r);yield*this._streamIterator(i,De(t))}async*streamLog(e,t,i){const r=new ew({...i,autoClose:!1,_schemaFormat:"original"}),a=De(t);yield*this._streamLog(e,r,a)}async*_streamLog(e,t,i){const{callbacks:r}=i;if(r===void 0)i.callbacks=[t];else if(Array.isArray(r))i.callbacks=r.concat([t]);else{const f=r.copy();f.addHandler(t,!0),i.callbacks=f}const a=this.stream(e,i);async function l(){try{const f=await a;for await(const d of f){const g=new Yi({ops:[{op:"add",path:"/streamed_output/-",value:d}]});await t.writer.write(g)}}finally{await t.writer.close()}}const c=l();try{for await(const f of t)yield f}finally{await c}}streamEvents(e,t,i){let r;if(t.version==="v1")r=this._streamEventsV1(e,t,i);else if(t.version==="v2")r=this._streamEventsV2(e,t,i);else throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');return t.encoding==="text/event-stream"?kk(r):fn.fromAsyncGenerator(r)}async*_streamEventsV2(e,t,i){const r=new mO({...i,autoClose:!1}),a=De(t),l=a.runId??Ut();a.runId=l;const c=a.callbacks;if(c===void 0)a.callbacks=[r];else if(Array.isArray(c))a.callbacks=c.concat(r);else{const T=c.copy();T.addHandler(r,!0),a.callbacks=T}const f=new AbortController,d=this;async function g(){let T,S=null;try{t?.signal?"any"in AbortSignal?T=AbortSignal.any([f.signal,t.signal]):(T=t.signal,S=()=>{f.abort()},t.signal.addEventListener("abort",S,{once:!0})):T=f.signal;const C=await d.stream(e,{...a,signal:T}),x=r.tapOutputIterable(l,C);for await(const M of x)if(f.signal.aborted)break}finally{await r.finish(),T&&S&&T.removeEventListener("abort",S)}}const _=g();let v=!1,w;try{for await(const T of r){if(!v){T.data.input=e,v=!0,w=T.run_id,yield T;continue}T.run_id===w&&T.event.endsWith("_end")&&T.data?.input&&delete T.data.input,yield T}}finally{f.abort(),await _}}async*_streamEventsV1(e,t,i){let r,a=!1;const l=De(t),c=l.tags??[],f=l.metadata??{},d=l.runName??this.getName(),g=new ew({...i,autoClose:!1,_schemaFormat:"streaming_events"}),_=new _O({...i}),v=this._streamLog(e,g,l);for await(const T of v){if(r?r=r.concat(T):r=Ho.fromRunLogPatch(T),r.state===void 0)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!a){a=!0;const M={...r.state},R={run_id:M.id,event:`on_${M.type}_start`,name:d,tags:c,metadata:f,data:{input:e}};_.includeEvent(R,M.type)&&(yield R)}const S=T.ops.filter(M=>M.path.startsWith("/logs/")).map(M=>M.path.split("/")[2]),C=[...new Set(S)];for(const M of C){let R,P={};const O=r.state.logs[M];if(O.end_time===void 0?O.streamed_output.length>0?R="stream":R="start":R="end",R==="start")O.inputs!==void 0&&(P.input=O.inputs);else if(R==="end")O.inputs!==void 0&&(P.input=O.inputs),P.output=O.final_output;else if(R==="stream"){const V=O.streamed_output.length;if(V!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${V} instead. Encountered in: "${O.name}"`);P={chunk:O.streamed_output[0]},O.streamed_output=[]}yield{event:`on_${O.type}_${R}`,name:O.name,run_id:O.id,tags:O.tags,metadata:O.metadata,data:P}}const{state:x}=r;if(x.streamed_output.length>0){const M=x.streamed_output.length;if(M!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${M} instead. Encountered in: "${x.name}"`);const R={chunk:x.streamed_output[0]};x.streamed_output=[];const P={event:`on_${x.type}_stream`,run_id:x.id,tags:c,metadata:f,name:d,data:R};_.includeEvent(P,x.type)&&(yield P)}}const w=r?.state;if(w!==void 0){const T={event:`on_${w.type}_end`,name:d,run_id:w.id,tags:c,metadata:f,data:{output:w.final_output}};_.includeEvent(T,w.type)&&(yield T)}}static isRunnable(e){return $m(e)}withListeners({onStart:e,onEnd:t,onError:i}){return new Lr({bound:this,config:{},configFactories:[r=>({callbacks:[new oS({config:r,onStart:e,onEnd:t,onError:i})]})]})}asTool(e){return $k(this,e)}}class Lr extends lt{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(...e){const t=Q0(this.config,...e);return Q0(t,...this.configFactories?await Promise.all(this.configFactories.map(async i=>await i(t))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new vS({bound:this.bound,kwargs:this.kwargs,config:this.config,maxAttemptNumber:e?.stopAfterAttempt,...e})}async invoke(e,t){return this.bound.invoke(e,await this._mergeConfig(De(t),this.kwargs))}async batch(e,t,i){const r=Array.isArray(t)?await Promise.all(t.map(async a=>this._mergeConfig(De(a),this.kwargs))):await this._mergeConfig(De(t),this.kwargs);return this.bound.batch(e,r,i)}async*_streamIterator(e,t){yield*this.bound._streamIterator(e,await this._mergeConfig(De(t),this.kwargs))}async stream(e,t){return this.bound.stream(e,await this._mergeConfig(De(t),this.kwargs))}async*transform(e,t){yield*this.bound.transform(e,await this._mergeConfig(De(t),this.kwargs))}streamEvents(e,t,i){const r=this,a=async function*(){yield*r.bound.streamEvents(e,{...await r._mergeConfig(De(t),r.kwargs),version:t.version},i)};return fn.fromAsyncGenerator(a())}static isRunnableBinding(e){return e.bound&&lt.isRunnable(e.bound)}withListeners({onStart:e,onEnd:t,onError:i}){return new Lr({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[r=>({callbacks:[new oS({config:r,onStart:e,onEnd:t,onError:i})]})]})}}class ac extends lt{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new ac({bound:this.bound.bind(e)})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _invoke(e,t,i){return this.bound.batch(e,Nt(t,{callbacks:i?.getChild()}))}withListeners({onStart:e,onEnd:t,onError:i}){return new ac({bound:this.bound.withListeners({onStart:e,onEnd:t,onError:i})})}}class vS extends Lr{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,t,i){const r=e>1?`retry:attempt:${e}`:void 0;return Nt(t,{callbacks:i?.getChild(r)})}async _invoke(e,t,i){return Qu(r=>super.invoke(e,this._patchConfigForRetry(r,t,i)),{onFailedAttempt:r=>this.onFailedAttempt(r,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _batch(e,t,i,r){const a={};try{await Qu(async l=>{const c=e.map((v,w)=>w).filter(v=>a[v.toString()]===void 0||a[v.toString()]instanceof Error),f=c.map(v=>e[v]),d=c.map(v=>this._patchConfigForRetry(l,t?.[v],i?.[v])),g=await super.batch(f,d,{...r,returnExceptions:!0});let _;for(let v=0;v<g.length;v+=1){const w=g[v],T=c[v];w instanceof Error&&_===void 0&&(_=w,_.input=f[v]),a[T.toString()]=w}if(_)throw _;return g},{onFailedAttempt:l=>this.onFailedAttempt(l,l.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(l){if(r?.returnExceptions!==!0)throw l}return Object.keys(a).sort((l,c)=>parseInt(l,10)-parseInt(c,10)).map(l=>a[parseInt(l,10)])}async batch(e,t,i){return this._batchWithConfig(this._batch.bind(this),e,t,i)}}class Pn extends lt{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"omitSequenceTags",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last,this.name=e.name,this.omitSequenceTags=e.omitSequenceTags??this.omitSequenceTags}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,t){const i=De(t),a=await(await Dn(i))?.handleChainStart(this.toJSON(),bt(e,"input"),i.runId,void 0,void 0,void 0,i?.runName);delete i.runId;let l=e,c;try{const f=[this.first,...this.middle];for(let d=0;d<f.length;d+=1){const _=f[d].invoke(l,Nt(i,{callbacks:a?.getChild(this.omitSequenceTags?void 0:`seq:step:${d+1}`)}));l=await fr(_,t?.signal)}if(t?.signal?.aborted)throw new Error("Aborted");c=await this.last.invoke(l,Nt(i,{callbacks:a?.getChild(this.omitSequenceTags?void 0:`seq:step:${this.steps.length}`)}))}catch(f){throw await a?.handleChainError(f),f}return await a?.handleChainEnd(bt(c,"output")),c}async batch(e,t,i){const r=this._getOptionsList(t??{},e.length),a=await Promise.all(r.map(Dn)),l=await Promise.all(a.map(async(f,d)=>{const g=await f?.handleChainStart(this.toJSON(),bt(e[d],"input"),r[d].runId,void 0,void 0,void 0,r[d].runName);return delete r[d].runId,g}));let c=e;try{for(let f=0;f<this.steps.length;f+=1){const g=this.steps[f].batch(c,l.map((_,v)=>{const w=_?.getChild(this.omitSequenceTags?void 0:`seq:step:${f+1}`);return Nt(r[v],{callbacks:w})}),i);c=await fr(g,r[0]?.signal)}}catch(f){throw await Promise.all(l.map(d=>d?.handleChainError(f))),f}return await Promise.all(l.map(f=>f?.handleChainEnd(bt(c,"output")))),c}async*_streamIterator(e,t){const i=await Dn(t),{runId:r,...a}=t??{},l=await i?.handleChainStart(this.toJSON(),bt(e,"input"),r,void 0,void 0,void 0,a?.runName),c=[this.first,...this.middle,this.last];let f=!0,d;async function*g(){yield e}try{let _=c[0].transform(g(),Nt(a,{callbacks:l?.getChild(this.omitSequenceTags?void 0:"seq:step:1")}));for(let v=1;v<c.length;v+=1)_=await c[v].transform(_,Nt(a,{callbacks:l?.getChild(this.omitSequenceTags?void 0:`seq:step:${v+1}`)}));for await(const v of _)if(t?.signal?.throwIfAborted(),yield v,f)if(d===void 0)d=v;else try{d=Ln(d,v)}catch{d=void 0,f=!1}}catch(_){throw await l?.handleChainError(_),_}await l?.handleChainEnd(bt(d,"output"))}getGraph(e){const t=new Cc;let i=null;return this.steps.forEach((r,a)=>{const l=r.getGraph(e);a!==0&&l.trimFirstNode(),a!==this.steps.length-1&&l.trimLastNode(),t.extend(l);const c=l.firstNode();if(!c)throw new Error(`Runnable ${r} has no first node`);i&&t.addEdge(i,c),i=l.lastNode()}),t}pipe(e){return Pn.isRunnableSequence(e)?new Pn({first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last,name:this.name??e.name}):new Pn({first:this.first,middle:[...this.middle,this.last],last:Dr(e),name:this.name})}static isRunnableSequence(e){return Array.isArray(e.middle)&&lt.isRunnable(e)}static from([e,...t],i){let r={};return typeof i=="string"?r.name=i:i!==void 0&&(r=i),new Pn({...r,first:Dr(e),middle:t.slice(0,-1).map(Dr),last:Dr(t[t.length-1])})}}class fa extends lt{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(const[t,i]of Object.entries(e.steps))this.steps[t]=Dr(i)}static from(e){return new fa({steps:e})}async invoke(e,t){const i=De(t),a=await(await Dn(i))?.handleChainStart(this.toJSON(),{input:e},i.runId,void 0,void 0,void 0,i?.runName);delete i.runId;const l={};try{const c=Object.entries(this.steps).map(async([f,d])=>{l[f]=await d.invoke(e,Nt(i,{callbacks:a?.getChild(`map:key:${f}`)}))});await fr(Promise.all(c),t?.signal)}catch(c){throw await a?.handleChainError(c),c}return await a?.handleChainEnd(l),l}async*_transform(e,t,i){const r={...this.steps},a=aS(e,Object.keys(r).length),l=new Map(Object.entries(r).map(([c,f],d)=>{const g=f.transform(a[d],Nt(i,{callbacks:t?.getChild(`map:key:${c}`)}));return[c,g.next().then(_=>({key:c,gen:g,result:_}))]}));for(;l.size;){const c=Promise.race(l.values()),{key:f,result:d,gen:g}=await fr(c,i?.signal);l.delete(f),d.done||(yield{[f]:d.value},l.set(f,g.next().then(_=>({key:f,gen:g,result:_}))))}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*i(){yield e}const r=De(t),a=new ca({generator:this.transform(i(),r),config:r});return await a.setup,fn.fromAsyncGenerator(a)}}class Bm extends lt{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!Tm(e.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=e.func}async invoke(e,t){const[i]=this._getOptionsList(t??{},1),r=await Dn(i),a=this.func(Nt(i,{callbacks:r}),e);return fr(a,i?.signal)}async*_streamIterator(e,t){const[i]=this._getOptionsList(t??{},1),r=await this.invoke(e,t);if(jp(r)){for await(const a of r)i?.signal?.throwIfAborted(),yield a;return}if(Pk(r)){for(;;){i?.signal?.throwIfAborted();const a=r.next();if(a.done)break;yield a.value}return}yield r}static from(e){return new Bm({func:e})}}function Dk(n){if(Tm(n))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}class rl extends lt{static lc_name(){return"RunnableLambda"}constructor(e){if(Tm(e.func))return Bm.from(e.func);super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Dk(e.func),this.func=e.func}static from(e){return new rl({func:e})}async _invoke(e,t,i){return new Promise((r,a)=>{const l=Nt(t,{callbacks:i?.getChild(),recursionLimit:(t?.recursionLimit??cp)-1});cr.runWithConfig(na(l),async()=>{try{let c=await this.func(e,{...l});if(c&&lt.isRunnable(c)){if(t?.recursionLimit===0)throw new Error("Recursion limit reached.");c=await c.invoke(e,{...l,recursionLimit:(l.recursionLimit??cp)-1})}else if(jp(c)){let f;for await(const d of Jp(l,c))if(t?.signal?.throwIfAborted(),f===void 0)f=d;else try{f=Ln(f,d)}catch{f=d}c=f}else if(lw(c)){let f;for(const d of uw(l,c))if(t?.signal?.throwIfAborted(),f===void 0)f=d;else try{f=Ln(f,d)}catch{f=d}c=f}r(c)}catch(c){a(c)}})})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async*_transform(e,t,i){let r;for await(const c of e)if(r===void 0)r=c;else try{r=Ln(r,c)}catch{r=c}const a=Nt(i,{callbacks:t?.getChild(),recursionLimit:(i?.recursionLimit??cp)-1}),l=await new Promise((c,f)=>{cr.runWithConfig(na(a),async()=>{try{const d=await this.func(r,{...a,config:a});c(d)}catch(d){f(d)}})});if(l&&lt.isRunnable(l)){if(i?.recursionLimit===0)throw new Error("Recursion limit reached.");const c=await l.stream(r,a);for await(const f of c)yield f}else if(jp(l))for await(const c of Jp(a,l))i?.signal?.throwIfAborted(),yield c;else if(lw(l))for(const c of uw(a,l))i?.signal?.throwIfAborted(),yield c;else yield l}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*i(){yield e}const r=De(t),a=new ca({generator:this.transform(i(),r),config:r});return await a.setup,fn.fromAsyncGenerator(a)}}class Lk extends lt{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,t){const i=De(t),r=await Dn(i),{runId:a,...l}=i,c=await r?.handleChainStart(this.toJSON(),bt(e,"input"),a,void 0,void 0,void 0,l?.runName),f=Nt(l,{callbacks:c?.getChild()});return await cr.runWithConfig(f,async()=>{let g;for(const _ of this.runnables()){i?.signal?.throwIfAborted();try{const v=await _.invoke(e,f);return await c?.handleChainEnd(bt(v,"output")),v}catch(v){g===void 0&&(g=v)}}throw g===void 0?new Error("No error stored at end of fallback."):(await c?.handleChainError(g),g)})}async*_streamIterator(e,t){const i=De(t),r=await Dn(i),{runId:a,...l}=i,c=await r?.handleChainStart(this.toJSON(),bt(e,"input"),a,void 0,void 0,void 0,l?.runName);let f,d;for(const _ of this.runnables()){i?.signal?.throwIfAborted();const v=Nt(l,{callbacks:c?.getChild()});try{const w=await _.stream(e,v);d=Jp(v,w);break}catch(w){f===void 0&&(f=w)}}if(d===void 0){const _=f??new Error("No error stored at end of fallback.");throw await c?.handleChainError(_),_}let g;try{for await(const _ of d){yield _;try{g=g===void 0?g:Ln(g,_)}catch{g=void 0}}}catch(_){throw await c?.handleChainError(_),_}await c?.handleChainEnd(bt(g,"output"))}async batch(e,t,i){if(i?.returnExceptions)throw new Error("Not implemented.");const r=this._getOptionsList(t??{},e.length),a=await Promise.all(r.map(f=>Dn(f))),l=await Promise.all(a.map(async(f,d)=>{const g=await f?.handleChainStart(this.toJSON(),bt(e[d],"input"),r[d].runId,void 0,void 0,void 0,r[d].runName);return delete r[d].runId,g}));let c;for(const f of this.runnables()){r[0].signal?.throwIfAborted();try{const d=await f.batch(e,l.map((g,_)=>Nt(r[_],{callbacks:g?.getChild()})),i);return await Promise.all(l.map((g,_)=>g?.handleChainEnd(bt(d[_],"output")))),d}catch(d){c===void 0&&(c=d)}}throw c?(await Promise.all(l.map(f=>f?.handleChainError(c))),c):new Error("No error stored at end of fallbacks.")}}function Dr(n){if(typeof n=="function")return new rl({func:n});if(lt.isRunnable(n))return n;if(!Array.isArray(n)&&typeof n=="object"){const e={};for(const[t,i]of Object.entries(n))e[t]=Dr(i);return new fa({steps:e})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}class bS extends lt{static lc_name(){return"RunnableAssign"}constructor(e){e instanceof fa&&(e={mapper:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e.mapper}async invoke(e,t){const i=await this.mapper.invoke(e,t);return{...e,...i}}async*_transform(e,t,i){const r=this.mapper.getStepsKeys(),[a,l]=aS(e),c=this.mapper.transform(l,Nt(i,{callbacks:t?.getChild()})),f=c.next();for await(const d of a){if(typeof d!="object"||Array.isArray(d))throw new Error(`RunnableAssign can only be used with objects as input, got ${typeof d}`);const g=Object.fromEntries(Object.entries(d).filter(([_])=>!r.includes(_)));Object.keys(g).length>0&&(yield g)}yield(await f).value;for await(const d of c)yield d}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*i(){yield e}const r=De(t),a=new ca({generator:this.transform(i(),r),config:r});return await a.setup,fn.fromAsyncGenerator(a)}}class Uk extends lt{static lc_name(){return"RunnablePick"}constructor(e){(typeof e=="string"||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if(typeof this.keys=="string")return e[this.keys];{const t=this.keys.map(i=>[i,e[i]]).filter(i=>i[1]!==void 0);return t.length===0?void 0:Object.fromEntries(t)}}async invoke(e,t){return this._callWithConfig(this._pick.bind(this),e,t)}async*_transform(e){for await(const t of e){const i=await this._pick(t);i!==void 0&&(yield i)}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*i(){yield e}const r=De(t),a=new ca({generator:this.transform(i(),r),config:r});return await a.setup,fn.fromAsyncGenerator(a)}}class cw extends Lr{constructor(e){const t=Pn.from([rl.from(async i=>{let r;if(tS(i))try{r=await Rk(this.schema,i.args)}catch{throw new DN("Received tool input did not match expected schema",JSON.stringify(i.args))}else r=i;return r}).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name});super({bound:t,config:e.config??{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}}function $k(n,e){const t=e.name??n.getName(),i=e.description??yS(e.schema);return xk(e.schema)?new cw({name:t,description:i,schema:Gx({input:Bx()}).transform(r=>r.input),bound:n}):new cw({name:t,description:i,schema:e.schema,bound:n})}class qk extends lt{get lc_attributes(){return{partialVariables:void 0}}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{inputVariables:t}=e;if(t.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,e)}async mergePartialAndUserVariables(e){const t=this.partialVariables??{},i={};for(const[a,l]of Object.entries(t))typeof l=="string"?i[a]=l:i[a]=await l();return{...i,...e}}async invoke(e,t){const i={...this.metadata,...t?.metadata},r=[...this.tags??[],...t?.tags??[]];return this._callWithConfig(a=>this.formatPromptValue(a),e,{...t,tags:r,metadata:i,runType:"prompt"})}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(e){switch(e._type){case"prompt":{const{PromptTemplate:t}=await ir(async()=>{const{PromptTemplate:i}=await Promise.resolve().then(()=>hw);return{PromptTemplate:i}},void 0);return t.deserialize(e)}case void 0:{const{PromptTemplate:t}=await ir(async()=>{const{PromptTemplate:i}=await Promise.resolve().then(()=>hw);return{PromptTemplate:i}},void 0);return t.deserialize({...e,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:t}=await ir(async()=>{const{FewShotPromptTemplate:i}=await import("./few_shot-Byyj-r82.js");return{FewShotPromptTemplate:i}},[]);return t.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}class wS extends ur{}class TS extends wS{static lc_name(){return"StringPromptValue"}constructor(e){super({value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new _c(this.value)]}}class Bk extends wS{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return iS(this.messages)}toChatMessages(){return this.messages}}class Gk extends qk{async formatPromptValue(e){const t=await this.format(e);return new TS(t)}}/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var Vk=Object.prototype.toString,da=Array.isArray||function(e){return Vk.call(e)==="[object Array]"};function Gm(n){return typeof n=="function"}function Fk(n){return da(n)?"array":typeof n}function mp(n){return n.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function fw(n,e){return n!=null&&typeof n=="object"&&e in n}function Hk(n,e){return n!=null&&typeof n!="object"&&n.hasOwnProperty&&n.hasOwnProperty(e)}var zk=RegExp.prototype.test;function jk(n,e){return zk.call(n,e)}var Jk=/\S/;function Kk(n){return!jk(Jk,n)}var Yk={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function Zk(n){return String(n).replace(/[&<>"'`=\/]/g,function(t){return Yk[t]})}var Qk=/\s*/,Xk=/\s+/,dw=/\s*=/,Wk=/\s*\}/,e1=/#|\^|\/|>|\{|&|=|!/;function t1(n,e){if(!n)return[];var t=!1,i=[],r=[],a=[],l=!1,c=!1,f="",d=0;function g(){if(l&&!c)for(;a.length;)delete r[a.pop()];else a=[];l=!1,c=!1}var _,v,w;function T(Z){if(typeof Z=="string"&&(Z=Z.split(Xk,2)),!da(Z)||Z.length!==2)throw new Error("Invalid tags: "+Z);_=new RegExp(mp(Z[0])+"\\s*"),v=new RegExp("\\s*"+mp(Z[1])),w=new RegExp("\\s*"+mp("}"+Z[1]))}T(e||Zt.tags);for(var S=new sl(n),C,x,M,R,P,O;!S.eos();){if(C=S.pos,M=S.scanUntil(_),M)for(var V=0,J=M.length;V<J;++V)R=M.charAt(V),Kk(R)?(a.push(r.length),f+=R):(c=!0,t=!0,f+=" "),r.push(["text",R,C,C+1]),C+=1,R===`
`&&(g(),f="",d=0,t=!1);if(!S.scan(_))break;if(l=!0,x=S.scan(e1)||"name",S.scan(Qk),x==="="?(M=S.scanUntil(dw),S.scan(dw),S.scanUntil(v)):x==="{"?(M=S.scanUntil(w),S.scan(Wk),S.scanUntil(v),x="&"):M=S.scanUntil(v),!S.scan(v))throw new Error("Unclosed tag at "+S.pos);if(x==">"?P=[x,M,C,S.pos,f,d,t]:P=[x,M,C,S.pos],d++,r.push(P),x==="#"||x==="^")i.push(P);else if(x==="/"){if(O=i.pop(),!O)throw new Error('Unopened section "'+M+'" at '+C);if(O[1]!==M)throw new Error('Unclosed section "'+O[1]+'" at '+C)}else x==="name"||x==="{"||x==="&"?c=!0:x==="="&&T(M)}if(g(),O=i.pop(),O)throw new Error('Unclosed section "'+O[1]+'" at '+S.pos);return i1(n1(r))}function n1(n){for(var e=[],t,i,r=0,a=n.length;r<a;++r)t=n[r],t&&(t[0]==="text"&&i&&i[0]==="text"?(i[1]+=t[1],i[3]=t[3]):(e.push(t),i=t));return e}function i1(n){for(var e=[],t=e,i=[],r,a,l=0,c=n.length;l<c;++l)switch(r=n[l],r[0]){case"#":case"^":t.push(r),i.push(r),t=r[4]=[];break;case"/":a=i.pop(),a[5]=r[2],t=i.length>0?i[i.length-1][4]:e;break;default:t.push(r)}return e}function sl(n){this.string=n,this.tail=n,this.pos=0}sl.prototype.eos=function(){return this.tail===""};sl.prototype.scan=function(e){var t=this.tail.match(e);if(!t||t.index!==0)return"";var i=t[0];return this.tail=this.tail.substring(i.length),this.pos+=i.length,i};sl.prototype.scanUntil=function(e){var t=this.tail.search(e),i;switch(t){case-1:i=this.tail,this.tail="";break;case 0:i="";break;default:i=this.tail.substring(0,t),this.tail=this.tail.substring(t)}return this.pos+=i.length,i};function ra(n,e){this.view=n,this.cache={".":this.view},this.parent=e}ra.prototype.push=function(e){return new ra(e,this)};ra.prototype.lookup=function(e){var t=this.cache,i;if(t.hasOwnProperty(e))i=t[e];else{for(var r=this,a,l,c,f=!1;r;){if(e.indexOf(".")>0)for(a=r.view,l=e.split("."),c=0;a!=null&&c<l.length;)c===l.length-1&&(f=fw(a,l[c])||Hk(a,l[c])),a=a[l[c++]];else a=r.view[e],f=fw(r.view,e);if(f){i=a;break}r=r.parent}t[e]=i}return Gm(i)&&(i=i.call(this.view)),i};function Bt(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}Bt.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};Bt.prototype.parse=function(e,t){var i=this.templateCache,r=e+":"+(t||Zt.tags).join(":"),a=typeof i<"u",l=a?i.get(r):void 0;return l==null&&(l=t1(e,t),a&&i.set(r,l)),l};Bt.prototype.render=function(e,t,i,r){var a=this.getConfigTags(r),l=this.parse(e,a),c=t instanceof ra?t:new ra(t,void 0);return this.renderTokens(l,c,i,e,r)};Bt.prototype.renderTokens=function(e,t,i,r,a){for(var l="",c,f,d,g=0,_=e.length;g<_;++g)d=void 0,c=e[g],f=c[0],f==="#"?d=this.renderSection(c,t,i,r,a):f==="^"?d=this.renderInverted(c,t,i,r,a):f===">"?d=this.renderPartial(c,t,i,a):f==="&"?d=this.unescapedValue(c,t):f==="name"?d=this.escapedValue(c,t,a):f==="text"&&(d=this.rawValue(c)),d!==void 0&&(l+=d);return l};Bt.prototype.renderSection=function(e,t,i,r,a){var l=this,c="",f=t.lookup(e[1]);function d(v){return l.render(v,t,i,a)}if(f){if(da(f))for(var g=0,_=f.length;g<_;++g)c+=this.renderTokens(e[4],t.push(f[g]),i,r,a);else if(typeof f=="object"||typeof f=="string"||typeof f=="number")c+=this.renderTokens(e[4],t.push(f),i,r,a);else if(Gm(f)){if(typeof r!="string")throw new Error("Cannot use higher-order sections without the original template");f=f.call(t.view,r.slice(e[3],e[5]),d),f!=null&&(c+=f)}else c+=this.renderTokens(e[4],t,i,r,a);return c}};Bt.prototype.renderInverted=function(e,t,i,r,a){var l=t.lookup(e[1]);if(!l||da(l)&&l.length===0)return this.renderTokens(e[4],t,i,r,a)};Bt.prototype.indentPartial=function(e,t,i){for(var r=t.replace(/[^ \t]/g,""),a=e.split(`
`),l=0;l<a.length;l++)a[l].length&&(l>0||!i)&&(a[l]=r+a[l]);return a.join(`
`)};Bt.prototype.renderPartial=function(e,t,i,r){if(i){var a=this.getConfigTags(r),l=Gm(i)?i(e[1]):i[e[1]];if(l!=null){var c=e[6],f=e[5],d=e[4],g=l;f==0&&d&&(g=this.indentPartial(l,d,c));var _=this.parse(g,a);return this.renderTokens(_,t,i,g,r)}}};Bt.prototype.unescapedValue=function(e,t){var i=t.lookup(e[1]);if(i!=null)return i};Bt.prototype.escapedValue=function(e,t,i){var r=this.getConfigEscape(i)||Zt.escape,a=t.lookup(e[1]);if(a!=null)return typeof a=="number"&&r===Zt.escape?String(a):r(a)};Bt.prototype.rawValue=function(e){return e[1]};Bt.prototype.getConfigTags=function(e){return da(e)?e:e&&typeof e=="object"?e.tags:void 0};Bt.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!da(e))return e.escape};var Zt={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(n){jo.templateCache=n},get templateCache(){return jo.templateCache}},jo=new Bt;Zt.clearCache=function(){return jo.clearCache()};Zt.parse=function(e,t){return jo.parse(e,t)};Zt.render=function(e,t,i,r){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+Fk(e)+'" was given as the first argument for mustache#render(template, view, partials)');return jo.render(e,t,i,r)};Zt.escape=Zk;Zt.Scanner=sl;Zt.Context=ra;Zt.Writer=Bt;function ES(){Zt.escape=n=>n}const SS=n=>{const e=n.split(""),t=[],i=(a,l)=>{for(let c=l;c<e.length;c+=1)if(a.includes(e[c]))return c;return-1};let r=0;for(;r<e.length;)if(e[r]==="{"&&r+1<e.length&&e[r+1]==="{")t.push({type:"literal",text:"{"}),r+=2;else if(e[r]==="}"&&r+1<e.length&&e[r+1]==="}")t.push({type:"literal",text:"}"}),r+=2;else if(e[r]==="{"){const a=i("}",r);if(a<0)throw new Error("Unclosed '{' in template.");t.push({type:"variable",name:e.slice(r+1,a).join("")}),r=a+1}else{if(e[r]==="}")throw new Error("Single '}' in template.");{const a=i("{}",r),l=(a<0?e.slice(r):e.slice(r,a)).join("");t.push({type:"literal",text:l}),r=a<0?e.length:a}}return t},r1=n=>n.map(e=>e[0]==="name"?{type:"variable",name:e[1].includes(".")?e[1].split(".")[0]:e[1]}:["#","&","^",">"].includes(e[0])?{type:"variable",name:e[1]}:{type:"literal",text:e[1]}),s1=n=>{ES();const e=Zt.parse(n);return r1(e)},a1=(n,e)=>SS(n).reduce((t,i)=>{if(i.type==="variable"){if(i.name in e){const r=typeof e[i.name]=="string"?e[i.name]:JSON.stringify(e[i.name]);return t+r}throw new Error(`(f-string) Missing value for input ${i.name}`)}return t+i.text},""),o1=(n,e)=>(ES(),Zt.render(n,e)),Kp={"f-string":a1,mustache:o1},l1={"f-string":SS,mustache:s1},xo=(n,e,t)=>{try{return Kp[e](n,t)}catch(i){throw Nm(i,"INVALID_PROMPT_INPUT")}},u1=(n,e)=>l1[e](n),c1=(n,e,t)=>{if(!(e in Kp)){const i=Object.keys(Kp);throw new Error(`Invalid template format. Got \`${e}\`;
                         should be one of ${i}`)}try{const i=t.reduce((r,a)=>(r[a]="foo",r),{});Array.isArray(n)?n.forEach(r=>{if(r.type==="text")xo(r.text,e,i);else if(r.type==="image_url")if(typeof r.image_url=="string")xo(r.image_url,e,i);else{const a=r.image_url.url;xo(a,e,i)}else throw new Error(`Invalid message template received. ${JSON.stringify(r,null,2)}`)}):xo(n,e,i)}catch(i){throw new Error(`Invalid prompt schema: ${i.message}`)}};class tr extends Gk{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.templateFormat==="mustache"&&e.validateTemplate===void 0&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){if(this.templateFormat==="mustache")throw new Error("Mustache templates cannot be validated.");let t=this.inputVariables;this.partialVariables&&(t=t.concat(Object.keys(this.partialVariables))),c1(this.template,this.templateFormat,t)}}_getPromptType(){return"prompt"}async format(e){const t=await this.mergePartialAndUserVariables(e);return xo(this.template,this.templateFormat,t)}static fromExamples(e,t,i,r=`

`,a=""){const l=[a,...e,t].join(r);return new tr({inputVariables:i,template:l})}static fromTemplate(e,t){const{templateFormat:i="f-string",...r}=t??{},a=new Set;return u1(e,i).forEach(l=>{l.type==="variable"&&a.add(l.name)}),new tr({inputVariables:[...a],templateFormat:i,template:e,...r})}async partial(e){const t=this.inputVariables.filter(a=>!(a in e)),i={...this.partialVariables??{},...e},r={...this,inputVariables:t,partialVariables:i};return new tr(r)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new tr({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}}const hw=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate:tr},Symbol.toStringTag,{value:"Module"}));var pw;(function(n){n.STRING="string",n.NUMBER="number",n.INTEGER="integer",n.BOOLEAN="boolean",n.ARRAY="array",n.OBJECT="object"})(pw||(pw={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mw;(function(n){n.LANGUAGE_UNSPECIFIED="language_unspecified",n.PYTHON="python"})(mw||(mw={}));var gw;(function(n){n.OUTCOME_UNSPECIFIED="outcome_unspecified",n.OUTCOME_OK="outcome_ok",n.OUTCOME_FAILED="outcome_failed",n.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(gw||(gw={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yw=["user","model","function","system"];var _w;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(_w||(_w={}));var vw;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(vw||(vw={}));var bw;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(bw||(bw={}));var ww;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER"})(ww||(ww={}));var Do;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.OTHER="OTHER"})(Do||(Do={}));var Tw;(function(n){n.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",n.RETRIEVAL_QUERY="RETRIEVAL_QUERY",n.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",n.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",n.CLASSIFICATION="CLASSIFICATION",n.CLUSTERING="CLUSTERING"})(Tw||(Tw={}));var js;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(js||(js={}));var Ew;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Ew||(Ew={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class Ms extends Ot{constructor(e,t){super(e),this.response=t}}class CS extends Ot{constructor(e,t,i,r){super(e),this.status=t,this.statusText=i,this.errorDetails=r}}class ar extends Ot{}class AS extends Ot{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f1="https://generativelanguage.googleapis.com",d1="v1beta",h1="0.24.1",p1="genai-js";var $r;(function(n){n.GENERATE_CONTENT="generateContent",n.STREAM_GENERATE_CONTENT="streamGenerateContent",n.COUNT_TOKENS="countTokens",n.EMBED_CONTENT="embedContent",n.BATCH_EMBED_CONTENTS="batchEmbedContents"})($r||($r={}));class m1{constructor(e,t,i,r,a){this.model=e,this.task=t,this.apiKey=i,this.stream=r,this.requestOptions=a}toString(){var e,t;const i=((e=this.requestOptions)===null||e===void 0?void 0:e.apiVersion)||d1;let a=`${((t=this.requestOptions)===null||t===void 0?void 0:t.baseUrl)||f1}/${i}/${this.model}:${this.task}`;return this.stream&&(a+="?alt=sse"),a}}function g1(n){const e=[];return n?.apiClient&&e.push(n.apiClient),e.push(`${p1}/${h1}`),e.join(" ")}async function y1(n){var e;const t=new Headers;t.append("Content-Type","application/json"),t.append("x-goog-api-client",g1(n.requestOptions)),t.append("x-goog-api-key",n.apiKey);let i=(e=n.requestOptions)===null||e===void 0?void 0:e.customHeaders;if(i){if(!(i instanceof Headers))try{i=new Headers(i)}catch(r){throw new ar(`unable to convert customHeaders value ${JSON.stringify(i)} to Headers: ${r.message}`)}for(const[r,a]of i.entries()){if(r==="x-goog-api-key")throw new ar(`Cannot set reserved header name ${r}`);if(r==="x-goog-api-client")throw new ar(`Header name ${r} can only be set using the apiClient field`);t.append(r,a)}}return t}async function _1(n,e,t,i,r,a){const l=new m1(n,e,t,i,a);return{url:l.toString(),fetchOptions:Object.assign(Object.assign({},T1(a)),{method:"POST",headers:await y1(l),body:r})}}async function al(n,e,t,i,r,a={},l=fetch){const{url:c,fetchOptions:f}=await _1(n,e,t,i,r,a);return v1(c,f,l)}async function v1(n,e,t=fetch){let i;try{i=await t(n,e)}catch(r){b1(r,n)}return i.ok||await w1(i,n),i}function b1(n,e){let t=n;throw t.name==="AbortError"?(t=new AS(`Request aborted when fetching ${e.toString()}: ${n.message}`),t.stack=n.stack):n instanceof CS||n instanceof ar||(t=new Ot(`Error fetching from ${e.toString()}: ${n.message}`),t.stack=n.stack),t}async function w1(n,e){let t="",i;try{const r=await n.json();t=r.error.message,r.error.details&&(t+=` ${JSON.stringify(r.error.details)}`,i=r.error.details)}catch{}throw new CS(`Error fetching from ${e.toString()}: [${n.status} ${n.statusText}] ${t}`,n.status,n.statusText,i)}function T1(n){const e={};if(n?.signal!==void 0||n?.timeout>=0){const t=new AbortController;n?.timeout>=0&&setTimeout(()=>t.abort(),n.timeout),n?.signal&&n.signal.addEventListener("abort",()=>{t.abort()}),e.signal=t.signal}return e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vm(n){return n.text=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),Fu(n.candidates[0]))throw new Ms(`${Zi(n)}`,n);return E1(n)}else if(n.promptFeedback)throw new Ms(`Text not available. ${Zi(n)}`,n);return""},n.functionCall=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Fu(n.candidates[0]))throw new Ms(`${Zi(n)}`,n);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),Sw(n)[0]}else if(n.promptFeedback)throw new Ms(`Function call not available. ${Zi(n)}`,n)},n.functionCalls=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Fu(n.candidates[0]))throw new Ms(`${Zi(n)}`,n);return Sw(n)}else if(n.promptFeedback)throw new Ms(`Function call not available. ${Zi(n)}`,n)},n}function E1(n){var e,t,i,r;const a=[];if(!((t=(e=n.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const l of(r=(i=n.candidates)===null||i===void 0?void 0:i[0].content)===null||r===void 0?void 0:r.parts)l.text&&a.push(l.text),l.executableCode&&a.push("\n```"+l.executableCode.language+`
`+l.executableCode.code+"\n```\n"),l.codeExecutionResult&&a.push("\n```\n"+l.codeExecutionResult.output+"\n```\n");return a.length>0?a.join(""):""}function Sw(n){var e,t,i,r;const a=[];if(!((t=(e=n.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const l of(r=(i=n.candidates)===null||i===void 0?void 0:i[0].content)===null||r===void 0?void 0:r.parts)l.functionCall&&a.push(l.functionCall);if(a.length>0)return a}const S1=[Do.RECITATION,Do.SAFETY,Do.LANGUAGE];function Fu(n){return!!n.finishReason&&S1.includes(n.finishReason)}function Zi(n){var e,t,i;let r="";if((!n.candidates||n.candidates.length===0)&&n.promptFeedback)r+="Response was blocked",!((e=n.promptFeedback)===null||e===void 0)&&e.blockReason&&(r+=` due to ${n.promptFeedback.blockReason}`),!((t=n.promptFeedback)===null||t===void 0)&&t.blockReasonMessage&&(r+=`: ${n.promptFeedback.blockReasonMessage}`);else if(!((i=n.candidates)===null||i===void 0)&&i[0]){const a=n.candidates[0];Fu(a)&&(r+=`Candidate was blocked due to ${a.finishReason}`,a.finishMessage&&(r+=`: ${a.finishMessage}`))}return r}function Jo(n){return this instanceof Jo?(this.v=n,this):new Jo(n)}function C1(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,a=[];return r={},l("next"),l("throw"),l("return"),r[Symbol.asyncIterator]=function(){return this},r;function l(v){i[v]&&(r[v]=function(w){return new Promise(function(T,S){a.push([v,w,T,S])>1||c(v,w)})})}function c(v,w){try{f(i[v](w))}catch(T){_(a[0][3],T)}}function f(v){v.value instanceof Jo?Promise.resolve(v.value.v).then(d,g):_(a[0][2],v)}function d(v){c("next",v)}function g(v){c("throw",v)}function _(v,w){v(w),a.shift(),a.length&&c(a[0][0],a[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cw=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function A1(n){const e=n.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),t=I1(e),[i,r]=t.tee();return{stream:x1(i),response:R1(r)}}async function R1(n){const e=[],t=n.getReader();for(;;){const{done:i,value:r}=await t.read();if(i)return Vm(M1(e));e.push(r)}}function x1(n){return C1(this,arguments,function*(){const t=n.getReader();for(;;){const{value:i,done:r}=yield Jo(t.read());if(r)break;yield yield Jo(Vm(i))}})}function I1(n){const e=n.getReader();return new ReadableStream({start(i){let r="";return a();function a(){return e.read().then(({value:l,done:c})=>{if(c){if(r.trim()){i.error(new Ot("Failed to parse stream"));return}i.close();return}r+=l;let f=r.match(Cw),d;for(;f;){try{d=JSON.parse(f[1])}catch{i.error(new Ot(`Error parsing JSON response: "${f[1]}"`));return}i.enqueue(d),r=r.substring(f[0].length),f=r.match(Cw)}return a()}).catch(l=>{let c=l;throw c.stack=l.stack,c.name==="AbortError"?c=new AS("Request aborted when reading from the stream"):c=new Ot("Error reading from the stream"),c})}}})}function M1(n){const e=n[n.length-1],t={promptFeedback:e?.promptFeedback};for(const i of n){if(i.candidates){let r=0;for(const a of i.candidates)if(t.candidates||(t.candidates=[]),t.candidates[r]||(t.candidates[r]={index:r}),t.candidates[r].citationMetadata=a.citationMetadata,t.candidates[r].groundingMetadata=a.groundingMetadata,t.candidates[r].finishReason=a.finishReason,t.candidates[r].finishMessage=a.finishMessage,t.candidates[r].safetyRatings=a.safetyRatings,a.content&&a.content.parts){t.candidates[r].content||(t.candidates[r].content={role:a.content.role||"user",parts:[]});const l={};for(const c of a.content.parts)c.text&&(l.text=c.text),c.functionCall&&(l.functionCall=c.functionCall),c.executableCode&&(l.executableCode=c.executableCode),c.codeExecutionResult&&(l.codeExecutionResult=c.codeExecutionResult),Object.keys(l).length===0&&(l.text=""),t.candidates[r].content.parts.push(l)}r++}i.usageMetadata&&(t.usageMetadata=i.usageMetadata)}return t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RS(n,e,t,i){const r=await al(e,$r.STREAM_GENERATE_CONTENT,n,!0,JSON.stringify(t),i);return A1(r)}async function xS(n,e,t,i){const a=await(await al(e,$r.GENERATE_CONTENT,n,!1,JSON.stringify(t),i)).json();return{response:Vm(a)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IS(n){if(n!=null){if(typeof n=="string")return{role:"system",parts:[{text:n}]};if(n.text)return{role:"system",parts:[n]};if(n.parts)return n.role?n:{role:"system",parts:n.parts}}}function Ko(n){let e=[];if(typeof n=="string")e=[{text:n}];else for(const t of n)typeof t=="string"?e.push({text:t}):e.push(t);return N1(e)}function N1(n){const e={role:"user",parts:[]},t={role:"function",parts:[]};let i=!1,r=!1;for(const a of n)"functionResponse"in a?(t.parts.push(a),r=!0):(e.parts.push(a),i=!0);if(i&&r)throw new Ot("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!i&&!r)throw new Ot("No content is provided for sending chat message.");return i?e:t}function O1(n,e){var t;let i={model:e?.model,generationConfig:e?.generationConfig,safetySettings:e?.safetySettings,tools:e?.tools,toolConfig:e?.toolConfig,systemInstruction:e?.systemInstruction,cachedContent:(t=e?.cachedContent)===null||t===void 0?void 0:t.name,contents:[]};const r=n.generateContentRequest!=null;if(n.contents){if(r)throw new ar("CountTokensRequest must have one of contents or generateContentRequest, not both.");i.contents=n.contents}else if(r)i=Object.assign(Object.assign({},i),n.generateContentRequest);else{const a=Ko(n);i.contents=[a]}return{generateContentRequest:i}}function Aw(n){let e;return n.contents?e=n:e={contents:[Ko(n)]},n.systemInstruction&&(e.systemInstruction=IS(n.systemInstruction)),e}function k1(n){return typeof n=="string"||Array.isArray(n)?{content:Ko(n)}:n}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rw=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],P1={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function D1(n){let e=!1;for(const t of n){const{role:i,parts:r}=t;if(!e&&i!=="user")throw new Ot(`First content should be with role 'user', got ${i}`);if(!yw.includes(i))throw new Ot(`Each item should include role field. Got ${i} but valid roles are: ${JSON.stringify(yw)}`);if(!Array.isArray(r))throw new Ot("Content should have 'parts' property with an array of Parts");if(r.length===0)throw new Ot("Each Content should have at least one part");const a={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const c of r)for(const f of Rw)f in c&&(a[f]+=1);const l=P1[i];for(const c of Rw)if(!l.includes(c)&&a[c]>0)throw new Ot(`Content with role '${i}' can't contain '${c}' part`);e=!0}}function xw(n){var e;if(n.candidates===void 0||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;if(t===void 0||t.parts===void 0||t.parts.length===0)return!1;for(const i of t.parts)if(i===void 0||Object.keys(i).length===0||i.text!==void 0&&i.text==="")return!1;return!0}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iw="SILENT_ERROR";class L1{constructor(e,t,i,r={}){this.model=t,this.params=i,this._requestOptions=r,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,i?.history&&(D1(i.history),this._history=i.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,t={}){var i,r,a,l,c,f;await this._sendPromise;const d=Ko(e),g={safetySettings:(i=this.params)===null||i===void 0?void 0:i.safetySettings,generationConfig:(r=this.params)===null||r===void 0?void 0:r.generationConfig,tools:(a=this.params)===null||a===void 0?void 0:a.tools,toolConfig:(l=this.params)===null||l===void 0?void 0:l.toolConfig,systemInstruction:(c=this.params)===null||c===void 0?void 0:c.systemInstruction,cachedContent:(f=this.params)===null||f===void 0?void 0:f.cachedContent,contents:[...this._history,d]},_=Object.assign(Object.assign({},this._requestOptions),t);let v;return this._sendPromise=this._sendPromise.then(()=>xS(this._apiKey,this.model,g,_)).then(w=>{var T;if(xw(w.response)){this._history.push(d);const S=Object.assign({parts:[],role:"model"},(T=w.response.candidates)===null||T===void 0?void 0:T[0].content);this._history.push(S)}else{const S=Zi(w.response);S&&console.warn(`sendMessage() was unsuccessful. ${S}. Inspect response object for details.`)}v=w}).catch(w=>{throw this._sendPromise=Promise.resolve(),w}),await this._sendPromise,v}async sendMessageStream(e,t={}){var i,r,a,l,c,f;await this._sendPromise;const d=Ko(e),g={safetySettings:(i=this.params)===null||i===void 0?void 0:i.safetySettings,generationConfig:(r=this.params)===null||r===void 0?void 0:r.generationConfig,tools:(a=this.params)===null||a===void 0?void 0:a.tools,toolConfig:(l=this.params)===null||l===void 0?void 0:l.toolConfig,systemInstruction:(c=this.params)===null||c===void 0?void 0:c.systemInstruction,cachedContent:(f=this.params)===null||f===void 0?void 0:f.cachedContent,contents:[...this._history,d]},_=Object.assign(Object.assign({},this._requestOptions),t),v=RS(this._apiKey,this.model,g,_);return this._sendPromise=this._sendPromise.then(()=>v).catch(w=>{throw new Error(Iw)}).then(w=>w.response).then(w=>{if(xw(w)){this._history.push(d);const T=Object.assign({},w.candidates[0].content);T.role||(T.role="model"),this._history.push(T)}else{const T=Zi(w);T&&console.warn(`sendMessageStream() was unsuccessful. ${T}. Inspect response object for details.`)}}).catch(w=>{w.message!==Iw&&console.error(w)}),v}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U1(n,e,t,i){return(await al(e,$r.COUNT_TOKENS,n,!1,JSON.stringify(t),i)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $1(n,e,t,i){return(await al(e,$r.EMBED_CONTENT,n,!1,JSON.stringify(t),i)).json()}async function q1(n,e,t,i){const r=t.requests.map(l=>Object.assign(Object.assign({},l),{model:e}));return(await al(e,$r.BATCH_EMBED_CONTENTS,n,!1,JSON.stringify({requests:r}),i)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{constructor(e,t,i={}){this.apiKey=e,this._requestOptions=i,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=IS(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(e,t={}){var i;const r=Aw(e),a=Object.assign(Object.assign({},this._requestOptions),t);return xS(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(i=this.cachedContent)===null||i===void 0?void 0:i.name},r),a)}async generateContentStream(e,t={}){var i;const r=Aw(e),a=Object.assign(Object.assign({},this._requestOptions),t);return RS(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(i=this.cachedContent)===null||i===void 0?void 0:i.name},r),a)}startChat(e){var t;return new L1(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(t=this.cachedContent)===null||t===void 0?void 0:t.name},e),this._requestOptions)}async countTokens(e,t={}){const i=O1(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),r=Object.assign(Object.assign({},this._requestOptions),t);return U1(this.apiKey,this.model,i,r)}async embedContent(e,t={}){const i=k1(e),r=Object.assign(Object.assign({},this._requestOptions),t);return $1(this.apiKey,this.model,i,r)}async batchEmbedContents(e,t={}){const i=Object.assign(Object.assign({},this._requestOptions),t);return q1(this.apiKey,this.model,e,i)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new Ot("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new Mw(this.apiKey,e,t)}getGenerativeModelFromCachedContent(e,t,i){if(!e.name)throw new ar("Cached content must contain a `name` field.");if(!e.model)throw new ar("Cached content must contain a `model` field.");const r=["model","systemInstruction"];for(const l of r)if(t?.[l]&&e[l]&&t?.[l]!==e[l]){if(l==="model"){const c=t.model.startsWith("models/")?t.model.replace("models/",""):t.model,f=e.model.startsWith("models/")?e.model.replace("models/",""):e.model;if(c===f)continue}throw new ar(`Different value for "${l}" specified in modelParams (${t[l]}) and cachedContent (${e[l]})`)}const a=Object.assign(Object.assign({},t),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new Mw(this.apiKey,a,i)}}/*
 * [js-sha1]{@link https://github.com/emn178/js-sha1}
 *
 * @version 0.6.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */var B1=typeof window=="object"?window:{},Ee="0123456789abcdef".split(""),G1=[-2147483648,8388608,32768,128],Nn=[24,16,8,0],yt=[];function Un(n){n?(yt[0]=yt[16]=yt[1]=yt[2]=yt[3]=yt[4]=yt[5]=yt[6]=yt[7]=yt[8]=yt[9]=yt[10]=yt[11]=yt[12]=yt[13]=yt[14]=yt[15]=0,this.blocks=yt):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Un.prototype.update=function(n){if(!this.finalized){var e=typeof n!="string";e&&n.constructor===B1.ArrayBuffer&&(n=new Uint8Array(n));for(var t,i=0,r,a=n.length||0,l=this.blocks;i<a;){if(this.hashed&&(this.hashed=!1,l[0]=this.block,l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0),e)for(r=this.start;i<a&&r<64;++i)l[r>>2]|=n[i]<<Nn[r++&3];else for(r=this.start;i<a&&r<64;++i)t=n.charCodeAt(i),t<128?l[r>>2]|=t<<Nn[r++&3]:t<2048?(l[r>>2]|=(192|t>>6)<<Nn[r++&3],l[r>>2]|=(128|t&63)<<Nn[r++&3]):t<55296||t>=57344?(l[r>>2]|=(224|t>>12)<<Nn[r++&3],l[r>>2]|=(128|t>>6&63)<<Nn[r++&3],l[r>>2]|=(128|t&63)<<Nn[r++&3]):(t=65536+((t&1023)<<10|n.charCodeAt(++i)&1023),l[r>>2]|=(240|t>>18)<<Nn[r++&3],l[r>>2]|=(128|t>>12&63)<<Nn[r++&3],l[r>>2]|=(128|t>>6&63)<<Nn[r++&3],l[r>>2]|=(128|t&63)<<Nn[r++&3]);this.lastByteIndex=r,this.bytes+=r-this.start,r>=64?(this.block=l[16],this.start=r-64,this.hash(),this.hashed=!0):this.start=r}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}};Un.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var n=this.blocks,e=this.lastByteIndex;n[16]=this.block,n[e>>2]|=G1[e&3],this.block=n[16],e>=56&&(this.hashed||this.hash(),n[0]=this.block,n[16]=n[1]=n[2]=n[3]=n[4]=n[5]=n[6]=n[7]=n[8]=n[9]=n[10]=n[11]=n[12]=n[13]=n[14]=n[15]=0),n[14]=this.hBytes<<3|this.bytes>>>29,n[15]=this.bytes<<3,this.hash()}};Un.prototype.hash=function(){var n=this.h0,e=this.h1,t=this.h2,i=this.h3,r=this.h4,a,l,c,f=this.blocks;for(l=16;l<80;++l)c=f[l-3]^f[l-8]^f[l-14]^f[l-16],f[l]=c<<1|c>>>31;for(l=0;l<20;l+=5)a=e&t|~e&i,c=n<<5|n>>>27,r=c+a+r+1518500249+f[l]<<0,e=e<<30|e>>>2,a=n&e|~n&t,c=r<<5|r>>>27,i=c+a+i+1518500249+f[l+1]<<0,n=n<<30|n>>>2,a=r&n|~r&e,c=i<<5|i>>>27,t=c+a+t+1518500249+f[l+2]<<0,r=r<<30|r>>>2,a=i&r|~i&n,c=t<<5|t>>>27,e=c+a+e+1518500249+f[l+3]<<0,i=i<<30|i>>>2,a=t&i|~t&r,c=e<<5|e>>>27,n=c+a+n+1518500249+f[l+4]<<0,t=t<<30|t>>>2;for(;l<40;l+=5)a=e^t^i,c=n<<5|n>>>27,r=c+a+r+1859775393+f[l]<<0,e=e<<30|e>>>2,a=n^e^t,c=r<<5|r>>>27,i=c+a+i+1859775393+f[l+1]<<0,n=n<<30|n>>>2,a=r^n^e,c=i<<5|i>>>27,t=c+a+t+1859775393+f[l+2]<<0,r=r<<30|r>>>2,a=i^r^n,c=t<<5|t>>>27,e=c+a+e+1859775393+f[l+3]<<0,i=i<<30|i>>>2,a=t^i^r,c=e<<5|e>>>27,n=c+a+n+1859775393+f[l+4]<<0,t=t<<30|t>>>2;for(;l<60;l+=5)a=e&t|e&i|t&i,c=n<<5|n>>>27,r=c+a+r-1894007588+f[l]<<0,e=e<<30|e>>>2,a=n&e|n&t|e&t,c=r<<5|r>>>27,i=c+a+i-1894007588+f[l+1]<<0,n=n<<30|n>>>2,a=r&n|r&e|n&e,c=i<<5|i>>>27,t=c+a+t-1894007588+f[l+2]<<0,r=r<<30|r>>>2,a=i&r|i&n|r&n,c=t<<5|t>>>27,e=c+a+e-1894007588+f[l+3]<<0,i=i<<30|i>>>2,a=t&i|t&r|i&r,c=e<<5|e>>>27,n=c+a+n-1894007588+f[l+4]<<0,t=t<<30|t>>>2;for(;l<80;l+=5)a=e^t^i,c=n<<5|n>>>27,r=c+a+r-899497514+f[l]<<0,e=e<<30|e>>>2,a=n^e^t,c=r<<5|r>>>27,i=c+a+i-899497514+f[l+1]<<0,n=n<<30|n>>>2,a=r^n^e,c=i<<5|i>>>27,t=c+a+t-899497514+f[l+2]<<0,r=r<<30|r>>>2,a=i^r^n,c=t<<5|t>>>27,e=c+a+e-899497514+f[l+3]<<0,i=i<<30|i>>>2,a=t^i^r,c=e<<5|e>>>27,n=c+a+n-899497514+f[l+4]<<0,t=t<<30|t>>>2;this.h0=this.h0+n<<0,this.h1=this.h1+e<<0,this.h2=this.h2+t<<0,this.h3=this.h3+i<<0,this.h4=this.h4+r<<0};Un.prototype.hex=function(){this.finalize();var n=this.h0,e=this.h1,t=this.h2,i=this.h3,r=this.h4;return Ee[n>>28&15]+Ee[n>>24&15]+Ee[n>>20&15]+Ee[n>>16&15]+Ee[n>>12&15]+Ee[n>>8&15]+Ee[n>>4&15]+Ee[n&15]+Ee[e>>28&15]+Ee[e>>24&15]+Ee[e>>20&15]+Ee[e>>16&15]+Ee[e>>12&15]+Ee[e>>8&15]+Ee[e>>4&15]+Ee[e&15]+Ee[t>>28&15]+Ee[t>>24&15]+Ee[t>>20&15]+Ee[t>>16&15]+Ee[t>>12&15]+Ee[t>>8&15]+Ee[t>>4&15]+Ee[t&15]+Ee[i>>28&15]+Ee[i>>24&15]+Ee[i>>20&15]+Ee[i>>16&15]+Ee[i>>12&15]+Ee[i>>8&15]+Ee[i>>4&15]+Ee[i&15]+Ee[r>>28&15]+Ee[r>>24&15]+Ee[r>>20&15]+Ee[r>>16&15]+Ee[r>>12&15]+Ee[r>>8&15]+Ee[r>>4&15]+Ee[r&15]};Un.prototype.toString=Un.prototype.hex;Un.prototype.digest=function(){this.finalize();var n=this.h0,e=this.h1,t=this.h2,i=this.h3,r=this.h4;return[n>>24&255,n>>16&255,n>>8&255,n&255,e>>24&255,e>>16&255,e>>8&255,e&255,t>>24&255,t>>16&255,t>>8&255,t&255,i>>24&255,i>>16&255,i>>8&255,i&255,r>>24&255,r>>16&255,r>>8&255,r&255]};Un.prototype.array=Un.prototype.digest;Un.prototype.arrayBuffer=function(){this.finalize();var n=new ArrayBuffer(20),e=new DataView(n);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),n};let Nw=!1;const V1=n=>(Nw||(console.warn(["The default method for hashing keys is insecure and will be replaced in a future version,","but hasn't been replaced yet as to not break existing caches. It's recommended that you use","a more secure hashing algorithm to avoid cache poisoning.","","See this page for more information:","|","└> https://js.langchain.com/docs/troubleshooting/warnings/insecure-cache-algorithm"].join(`
`)),Nw=!0),new Un(!0).update(n).hex()),F1=(...n)=>V1(n.join("_"));class H1{constructor(){Object.defineProperty(this,"keyEncoder",{enumerable:!0,configurable:!0,writable:!0,value:F1})}makeDefaultKeyEncoder(e){this.keyEncoder=e}}const z1=new Map;class Fm extends H1{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,t){return Promise.resolve(this.cache.get(this.keyEncoder(e,t))??null)}async update(e,t,i){this.cache.set(this.keyEncoder(e,t),i)}static global(){return new Fm(z1)}}var wo={},Ow;function j1(){if(Ow)return wo;Ow=1,wo.byteLength=c,wo.toByteArray=d,wo.fromByteArray=v;for(var n=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,a=i.length;r<a;++r)n[r]=i[r],e[i.charCodeAt(r)]=r;e[45]=62,e[95]=63;function l(w){var T=w.length;if(T%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var S=w.indexOf("=");S===-1&&(S=T);var C=S===T?0:4-S%4;return[S,C]}function c(w){var T=l(w),S=T[0],C=T[1];return(S+C)*3/4-C}function f(w,T,S){return(T+S)*3/4-S}function d(w){var T,S=l(w),C=S[0],x=S[1],M=new t(f(w,C,x)),R=0,P=x>0?C-4:C,O;for(O=0;O<P;O+=4)T=e[w.charCodeAt(O)]<<18|e[w.charCodeAt(O+1)]<<12|e[w.charCodeAt(O+2)]<<6|e[w.charCodeAt(O+3)],M[R++]=T>>16&255,M[R++]=T>>8&255,M[R++]=T&255;return x===2&&(T=e[w.charCodeAt(O)]<<2|e[w.charCodeAt(O+1)]>>4,M[R++]=T&255),x===1&&(T=e[w.charCodeAt(O)]<<10|e[w.charCodeAt(O+1)]<<4|e[w.charCodeAt(O+2)]>>2,M[R++]=T>>8&255,M[R++]=T&255),M}function g(w){return n[w>>18&63]+n[w>>12&63]+n[w>>6&63]+n[w&63]}function _(w,T,S){for(var C,x=[],M=T;M<S;M+=3)C=(w[M]<<16&16711680)+(w[M+1]<<8&65280)+(w[M+2]&255),x.push(g(C));return x.join("")}function v(w){for(var T,S=w.length,C=S%3,x=[],M=16383,R=0,P=S-C;R<P;R+=M)x.push(_(w,R,R+M>P?P:R+M));return C===1?(T=w[S-1],x.push(n[T>>2]+n[T<<4&63]+"==")):C===2&&(T=(w[S-2]<<8)+w[S-1],x.push(n[T>>10]+n[T>>4&63]+n[T<<2&63]+"=")),x.join("")}return wo}var J1=j1();const K1=aa(J1);var Y1=Object.defineProperty,Z1=(n,e,t)=>e in n?Y1(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Q1=(n,e,t)=>(Z1(n,e+"",t),t);function X1(n,e){let t=Array.from({length:n.length},(i,r)=>({start:r,end:r+1}));for(;t.length>1;){let i=null;for(let r=0;r<t.length-1;r++){const a=n.slice(t[r].start,t[r+1].end),l=e.get(a.join(","));l!=null&&(i==null||l<i[0])&&(i=[l,r])}if(i!=null){const r=i[1];t[r]={start:t[r].start,end:t[r+1].end},t.splice(r+1,1)}else break}return t}function W1(n,e){return n.length===1?[e.get(n.join(","))]:X1(n,e).map(t=>e.get(n.slice(t.start,t.end).join(","))).filter(t=>t!=null)}function eP(n){return n.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var Zp=class{specialTokens;inverseSpecialTokens;patStr;textEncoder=new TextEncoder;textDecoder=new TextDecoder("utf-8");rankMap=new Map;textMap=new Map;constructor(n,e){this.patStr=n.pat_str;const t=n.bpe_ranks.split(`
`).filter(Boolean).reduce((i,r)=>{const[a,l,...c]=r.split(" "),f=Number.parseInt(l,10);return c.forEach((d,g)=>i[d]=f+g),i},{});for(const[i,r]of Object.entries(t)){const a=K1.toByteArray(i);this.rankMap.set(a.join(","),r),this.textMap.set(r,a)}this.specialTokens={...n.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((i,[r,a])=>(i[a]=this.textEncoder.encode(r),i),{})}encode(n,e=[],t="all"){const i=new RegExp(this.patStr,"ug"),r=Zp.specialTokenRegex(Object.keys(this.specialTokens)),a=[],l=new Set(e==="all"?Object.keys(this.specialTokens):e),c=new Set(t==="all"?Object.keys(this.specialTokens).filter(d=>!l.has(d)):t);if(c.size>0){const d=Zp.specialTokenRegex([...c]),g=n.match(d);if(g!=null)throw new Error(`The text contains a special token that is not allowed: ${g[0]}`)}let f=0;for(;;){let d=null,g=f;for(;r.lastIndex=g,d=r.exec(n),!(d==null||l.has(d[0]));)g=d.index+1;const _=d?.index??n.length;for(const w of n.substring(f,_).matchAll(i)){const T=this.textEncoder.encode(w[0]),S=this.rankMap.get(T.join(","));if(S!=null){a.push(S);continue}a.push(...W1(T,this.rankMap))}if(d==null)break;let v=this.specialTokens[d[0]];a.push(v),f=d.index+d[0].length}return a}decode(n){const e=[];let t=0;for(let a=0;a<n.length;++a){const l=n[a],c=this.textMap.get(l)??this.inverseSpecialTokens[l];c!=null&&(e.push(c),t+=c.length)}const i=new Uint8Array(t);let r=0;for(const a of e)i.set(a,r),r+=a.length;return this.textDecoder.decode(i)}},MS=Zp;Q1(MS,"specialTokenRegex",n=>new RegExp(n.map(e=>eP(e)).join("|"),"g"));function tP(n){switch(n){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-2024-11-20":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"gpt-4o-search-preview":case"gpt-4o-search-preview-2025-03-11":case"gpt-4o-mini-search-preview":case"gpt-4o-mini-search-preview-2025-03-11":case"gpt-4o-audio-preview":case"gpt-4o-audio-preview-2024-12-17":case"gpt-4o-audio-preview-2024-10-01":case"gpt-4o-mini-audio-preview":case"gpt-4o-mini-audio-preview-2024-12-17":case"o1":case"o1-2024-12-17":case"o1-mini":case"o1-mini-2024-09-12":case"o1-preview":case"o1-preview-2024-09-12":case"o1-pro":case"o1-pro-2025-03-19":case"o3":case"o3-2025-04-16":case"o3-mini":case"o3-mini-2025-01-31":case"o4-mini":case"o4-mini-2025-04-16":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":case"gpt-4o-realtime-preview-2024-12-17":case"gpt-4o-mini-realtime-preview":case"gpt-4o-mini-realtime-preview-2024-12-17":case"gpt-4.1":case"gpt-4.1-2025-04-14":case"gpt-4.1-mini":case"gpt-4.1-mini-2025-04-14":case"gpt-4.1-nano":case"gpt-4.1-nano-2025-04-14":case"gpt-4.5-preview":case"gpt-4.5-preview-2025-02-27":return"o200k_base";default:throw new Error("Unknown model")}}const Pu={},nP=new bc({});async function iP(n){return n in Pu||(Pu[n]=nP.fetch(`https://tiktoken.pages.dev/js/${n}.json`).then(e=>e.json()).then(e=>new MS(e)).catch(e=>{throw delete Pu[n],e})),await Pu[n]}async function rP(n){return iP(tP(n))}const sP=n=>n.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":n.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":n.startsWith("gpt-4-32k")?"gpt-4-32k":n.startsWith("gpt-4-")?"gpt-4":n.startsWith("gpt-4o")?"gpt-4o":n;function NS(n){return typeof n!="object"||!n?!1:!!("type"in n&&n.type==="function"&&"function"in n&&typeof n.function=="object"&&n.function&&"name"in n.function&&"parameters"in n.function)}const aP=()=>!1;class oP extends lt{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??aP(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class lP extends oP{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:t,...i}){const{cache:r,...a}=i;super({callbacks:e??t,...a}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof r=="object"?this.cache=r:r?this.cache=Fm.global():this.cache=void 0,this.caller=new bc(i??{})}async getNumTokens(e){let t;typeof e=="string"?t=e:t=e.map(r=>typeof r=="string"?r:r.type==="text"&&"text"in r?r.text:"").join("");let i=Math.ceil(t.length/4);if(!this._encoding)try{this._encoding=await rP("modelName"in this?sP(this.modelName):"gpt2")}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}if(this._encoding)try{i=this._encoding.encode(t).length}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return i}static _convertInputToPromptValue(e){return typeof e=="string"?new TS(e):Array.isArray(e)?new Bk(e.map(Ao)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:e,...t}){const i={...this._identifyingParams(),...t,_type:this._llmType(),_model:this._modelType()};return Object.entries(i).filter(([l,c])=>c!==void 0).map(([l,c])=>`${l}:${JSON.stringify(c)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw new Error("Use .toJSON() instead")}}class Yo extends lt{static lc_name(){return"RunnablePassthrough"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e&&(this.func=e.func)}async invoke(e,t){const i=De(t);return this.func&&await this.func(e,i),this._callWithConfig(r=>Promise.resolve(r),e,i)}async*transform(e,t){const i=De(t);let r,a=!0;for await(const l of this._transformStreamWithConfig(e,c=>c,i))if(yield l,a)if(r===void 0)r=l;else try{r=Ln(r,l)}catch{r=void 0,a=!1}this.func&&r!==void 0&&await this.func(r,i)}static assign(e){return new bS(new fa({steps:e}))}}function gp(n){const e=[];for(const t of n){let i=t;if(Array.isArray(t.content))for(let r=0;r<t.content.length;r++){const a=t.content[r];(LN(a)||UN(a))&&i===t&&(i=new t.constructor({...i,content:[...t.content.slice(0,r),$N(a),...t.content.slice(r+1)]}))}e.push(i)}return e}class Qi extends lP{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]}),Object.defineProperty(this,"disableStreaming",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_separateRunnableConfigFromCallOptionsCompat(e){const[t,i]=super._separateRunnableConfigFromCallOptions(e);return i.signal=t.signal,[t,i]}async invoke(e,t){const i=Qi._convertInputToPromptValue(e);return(await this.generatePrompt([i],t,t?.callbacks)).generations[0][0].message}async*_streamResponseChunks(e,t,i){throw new Error("Not implemented.")}async*_streamIterator(e,t){if(this._streamResponseChunks===Qi.prototype._streamResponseChunks||this.disableStreaming)yield this.invoke(e,t);else{const r=Qi._convertInputToPromptValue(e).toChatMessages(),[a,l]=this._separateRunnableConfigFromCallOptionsCompat(t),c={...a.metadata,...this.getLsParams(l)},f=await $t.configure(a.callbacks,this.callbacks,a.tags,this.tags,c,this.metadata,{verbose:this.verbose}),d={options:l,invocation_params:this?.invocationParams(l),batch_size:1},g=await f?.handleChatModelStart(this.toJSON(),[gp(r)],a.runId,void 0,d,void 0,void 0,a.runName);let _,v;try{for await(const w of this._streamResponseChunks(r,l,g?.[0])){if(w.message.id==null){const T=g?.at(0)?.runId;T!=null&&w.message._updateId(`run-${T}`)}w.message.response_metadata={...w.generationInfo,...w.message.response_metadata},yield w.message,_?_=_.concat(w):_=w,J0(w.message)&&w.message.usage_metadata!==void 0&&(v={tokenUsage:{promptTokens:w.message.usage_metadata.input_tokens,completionTokens:w.message.usage_metadata.output_tokens,totalTokens:w.message.usage_metadata.total_tokens}})}}catch(w){throw await Promise.all((g??[]).map(T=>T?.handleLLMError(w))),w}await Promise.all((g??[]).map(w=>w?.handleLLMEnd({generations:[[_]],llmOutput:v})))}}getLsParams(e){const t=this.getName().startsWith("Chat")?this.getName().replace("Chat",""):this.getName();return{ls_model_type:"chat",ls_stop:e.stop,ls_provider:t}}async _generateUncached(e,t,i,r){const a=e.map(_=>_.map(Ao));let l;if(r!==void 0&&r.length===a.length)l=r;else{const _={...i.metadata,...this.getLsParams(t)},v=await $t.configure(i.callbacks,this.callbacks,i.tags,this.tags,_,this.metadata,{verbose:this.verbose}),w={options:t,invocation_params:this?.invocationParams(t),batch_size:1};l=await v?.handleChatModelStart(this.toJSON(),a.map(gp),i.runId,void 0,w,void 0,void 0,i.runName)}const c=[],f=[];if(!!l?.[0].handlers.find(MN)&&!this.disableStreaming&&a.length===1&&this._streamResponseChunks!==Qi.prototype._streamResponseChunks)try{const _=await this._streamResponseChunks(a[0],t,l?.[0]);let v,w;for await(const T of _){if(T.message.id==null){const S=l?.at(0)?.runId;S!=null&&T.message._updateId(`run-${S}`)}v===void 0?v=T:v=Ln(v,T),J0(T.message)&&T.message.usage_metadata!==void 0&&(w={tokenUsage:{promptTokens:T.message.usage_metadata.input_tokens,completionTokens:T.message.usage_metadata.output_tokens,totalTokens:T.message.usage_metadata.total_tokens}})}if(v===void 0)throw new Error("Received empty response from chat model call.");c.push([v]),await l?.[0].handleLLMEnd({generations:c,llmOutput:w})}catch(_){throw await l?.[0].handleLLMError(_),_}else{const _=await Promise.allSettled(a.map((v,w)=>this._generate(v,{...t,promptIndex:w},l?.[w])));await Promise.all(_.map(async(v,w)=>{if(v.status==="fulfilled"){const T=v.value;for(const S of T.generations){if(S.message.id==null){const C=l?.at(0)?.runId;C!=null&&S.message._updateId(`run-${C}`)}S.message.response_metadata={...S.generationInfo,...S.message.response_metadata}}return T.generations.length===1&&(T.generations[0].message.response_metadata={...T.llmOutput,...T.generations[0].message.response_metadata}),c[w]=T.generations,f[w]=T.llmOutput,l?.[w]?.handleLLMEnd({generations:[T.generations],llmOutput:T.llmOutput})}else return await l?.[w]?.handleLLMError(v.reason),Promise.reject(v.reason)}))}const g={generations:c,llmOutput:f.length?this._combineLLMOutput?.(...f):void 0};return Object.defineProperty(g,tw,{value:l?{runIds:l?.map(_=>_.runId)}:void 0,configurable:!0}),g}async _generateCached({messages:e,cache:t,llmStringKey:i,parsedOptions:r,handledOptions:a}){const l=e.map(C=>C.map(Ao)),c={...a.metadata,...this.getLsParams(r)},f=await $t.configure(a.callbacks,this.callbacks,a.tags,this.tags,c,this.metadata,{verbose:this.verbose}),d={options:r,invocation_params:this?.invocationParams(r),batch_size:1},g=await f?.handleChatModelStart(this.toJSON(),l.map(gp),a.runId,void 0,d,void 0,void 0,a.runName),_=[],w=(await Promise.allSettled(l.map(async(C,x)=>{const M=Qi._convertInputToPromptValue(C).toString(),R=await t.lookup(M,i);return R==null&&_.push(x),R}))).map((C,x)=>({result:C,runManager:g?.[x]})).filter(({result:C})=>C.status==="fulfilled"&&C.value!=null||C.status==="rejected"),T=[];await Promise.all(w.map(async({result:C,runManager:x},M)=>{if(C.status==="fulfilled"){const R=C.value;return T[M]=R.map(P=>("message"in P&&nl(P.message)&&km(P.message)&&(P.message.usage_metadata={input_tokens:0,output_tokens:0,total_tokens:0}),P.generationInfo={...P.generationInfo,tokenUsage:{}},P)),R.length&&await x?.handleLLMNewToken(R[0].text),x?.handleLLMEnd({generations:[R]},void 0,void 0,void 0,{cached:!0})}else return await x?.handleLLMError(C.reason,void 0,void 0,void 0,{cached:!0}),Promise.reject(C.reason)}));const S={generations:T,missingPromptIndices:_,startedRunManagers:g};return Object.defineProperty(S,tw,{value:g?{runIds:g?.map(C=>C.runId)}:void 0,configurable:!0}),S}async generate(e,t,i){let r;Array.isArray(t)?r={stop:t}:r=t;const a=e.map(T=>T.map(Ao)),[l,c]=this._separateRunnableConfigFromCallOptionsCompat(r);if(l.callbacks=l.callbacks??i,!this.cache)return this._generateUncached(a,c,l);const{cache:f}=this,d=this._getSerializedCacheKeyParametersForCall(c),{generations:g,missingPromptIndices:_,startedRunManagers:v}=await this._generateCached({messages:a,cache:f,llmStringKey:d,parsedOptions:c,handledOptions:l});let w={};if(_.length>0){const T=await this._generateUncached(_.map(S=>a[S]),c,l,v!==void 0?_.map(S=>v?.[S]):void 0);await Promise.all(T.generations.map(async(S,C)=>{const x=_[C];g[x]=S;const M=Qi._convertInputToPromptValue(a[x]).toString();return f.update(M,d,S)})),w=T.llmOutput??{}}return{generations:g,llmOutput:w}}invocationParams(e){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(e,t,i){const r=e.map(a=>a.toChatMessages());return this.generate(r,t,i)}async call(e,t,i){return(await this.generate([e.map(Ao)],t,i)).generations[0][0].message}async callPrompt(e,t,i){const r=e.toChatMessages();return this.call(r,t,i)}async predictMessages(e,t,i){return this.call(e,t,i)}async predict(e,t,i){const r=new _c(e),a=await this.call([r],t,i);if(typeof a.content!="string")throw new Error("Cannot use predict when output is not a string.");return a.content}withStructuredOutput(e,t){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');if(t?.strict)throw new Error('"strict" mode is not supported for this model by default.');const i=e,r=t?.name,a=yS(i)??"A function available to call.",l=t?.method,c=t?.includeRaw;if(l==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let f=r??"extract",d;il(i)?d=[{type:"function",function:{name:f,description:a,parameters:qm(i)}}]:("name"in i&&(f=i.name),d=[{type:"function",function:{name:f,description:a,parameters:i}}]);const g=this.bindTools(d),_=rl.from(S=>{if(!S.tool_calls||S.tool_calls.length===0)throw new Error("No tool calls found in the response.");const C=S.tool_calls.find(x=>x.name===f);if(!C)throw new Error(`No tool call found with name ${f}.`);return C.args});if(!c)return g.pipe(_).withConfig({runName:"StructuredOutput"});const v=Yo.assign({parsed:(S,C)=>_.invoke(S.raw,C)}),w=Yo.assign({parsed:()=>null}),T=v.withFallbacks({fallbacks:[w]});return Pn.from([{raw:g},T]).withConfig({runName:"StructuredOutputRunnable"})}}class OS extends lt{parseResultWithPrompt(e,t,i){return this.parseResult(e,i)}_baseMessageToString(e){return typeof e.content=="string"?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}async invoke(e,t){return typeof e=="string"?this._callWithConfig(async(i,r)=>this.parseResult([{text:i}],r?.callbacks),e,{...t,runType:"parser"}):this._callWithConfig(async(i,r)=>this.parseResult([{message:i,text:this._baseMessageToString(i)}],r?.callbacks),e,{...t,runType:"parser"})}}class uP extends OS{parseResult(e,t){return this.parse(e[0].text,t)}async parseWithPrompt(e,t,i){return this.parse(e,i)}_type(){throw new Error("_type not implemented")}}class cP extends Error{constructor(e,t,i,r=!1){if(super(e),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=t,this.observation=i,this.sendToLLM=r,r&&(i===void 0||t===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true");Nm(this,"OUTPUT_PARSING_FAILURE")}}class kS extends uP{async*_transform(e){for await(const t of e)typeof t=="string"?yield this.parseResult([{text:t}]):yield this.parseResult([{message:t,text:this._baseMessageToString(t)}])}async*transform(e,t){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...t,runType:"parser"})}}class fP extends kS{constructor(e){super(e),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=e?.diff??this.diff}async*_transform(e){let t,i;for await(const r of e){if(typeof r!="string"&&typeof r.content!="string")throw new Error("Cannot handle non-string output.");let a;if(VN(r)){if(typeof r.content!="string")throw new Error("Cannot handle non-string message output.");a=new zo({message:r,text:r.content})}else if(nl(r)){if(typeof r.content!="string")throw new Error("Cannot handle non-string message output.");a=new zo({message:KN(r),text:r.content})}else a=new ia({text:r});i===void 0?i=a:i=i.concat(a);const l=await this.parsePartialResult([i]);l!=null&&!Hp(l,t)&&(this.diff?yield this._diff(t,l):yield l,t=l)}}getFormatInstructions(){return""}}class kw extends kS{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers","string"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"StrOutputParser"}parse(e){return Promise.resolve(e)}getFormatInstructions(){return""}_textContentToString(e){return e.text}_imageUrlContentToString(e){throw new Error('Cannot coerce a multimodal "image_url" message part into a string.')}_messageContentComplexToString(e){switch(e.type){case"text":case"text_delta":if("text"in e)return this._textContentToString(e);break;case"image_url":if("image_url"in e)return this._imageUrlContentToString(e);break;default:throw new Error(`Cannot coerce "${e.type}" message part into a string.`)}throw new Error(`Invalid content type: ${e.type}`)}_baseMessageContentToString(e){return e.reduce((t,i)=>t+this._messageContentComplexToString(i),"")}}class dP extends fP{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(e,t){if(t)return e?pI(e,t):[{op:"replace",path:"",value:t}]}async parsePartialResult(e){return j0(e[0].text)}async parse(e){return j0(e,JSON.parse)}getFormatInstructions(){return""}}function qr(n){if(typeof n=="object"&&n!==null){const e={...n};"additionalProperties"in e&&delete e.additionalProperties,"$schema"in e&&delete e.$schema,"strict"in e&&delete e.strict;for(const t in e)t in e&&(Array.isArray(e[t])?e[t]=e[t].map(qr):typeof e[t]=="object"&&e[t]!==null&&(e[t]=qr(e[t])));return e}return n}function Qp(n){const e=qr(il(n)?qm(n):n),{$schema:t,...i}=e;return i}function hP(n){const e=qr(n),{$schema:t,...i}=e;return i}function pP(n){return n!==void 0&&Array.isArray(n.lc_namespace)}function mP(n){return n!==void 0&&lt.isRunnable(n)&&"lc_name"in n.constructor&&typeof n.constructor.lc_name=="function"&&n.constructor.lc_name()==="RunnableToolLike"}function gP(n){return!!n&&typeof n=="object"&&"name"in n&&"schema"in n&&(il(n.schema)||n.schema!=null&&typeof n.schema=="object"&&"type"in n.schema&&typeof n.schema.type=="string"&&["null","boolean","object","array","number","string"].includes(n.schema.type))}function PS(n){return gP(n)||mP(n)||pP(n)}const Ct=[];for(let n=0;n<256;++n)Ct.push((n+256).toString(16).slice(1));function yP(n,e=0){return(Ct[n[e+0]]+Ct[n[e+1]]+Ct[n[e+2]]+Ct[n[e+3]]+"-"+Ct[n[e+4]]+Ct[n[e+5]]+"-"+Ct[n[e+6]]+Ct[n[e+7]]+"-"+Ct[n[e+8]]+Ct[n[e+9]]+"-"+Ct[n[e+10]]+Ct[n[e+11]]+Ct[n[e+12]]+Ct[n[e+13]]+Ct[n[e+14]]+Ct[n[e+15]]).toLowerCase()}let yp;const _P=new Uint8Array(16);function vP(){if(!yp){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");yp=crypto.getRandomValues.bind(crypto)}return yp(_P)}const bP=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Pw={randomUUID:bP};function DS(n,e,t){if(Pw.randomUUID&&!n)return Pw.randomUUID();n=n||{};const i=n.random??n.rng?.()??vP();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,yP(i)}function wP(n){const e=n._getType();return yc.isInstance(n)?n.role:e==="tool"?e:n.name??e}function TP(n){switch(n){case"supervisor":case"ai":case"model":return"model";case"system":return"system";case"human":return"user";case"tool":case"function":return"function";default:throw new Error(`Unknown / unsupported author: ${n}`)}}function EP(n){if("mimeType"in n&&"data"in n)return{inlineData:{mimeType:n.mimeType,data:n.data}};if("mimeType"in n&&"fileUri"in n)return{fileData:{mimeType:n.mimeType,fileUri:n.fileUri}};throw new Error("Invalid media content")}function SP(n,e){return e.map(t=>km(t)?t.tool_calls??[]:[]).flat().find(t=>t.id===n.tool_call_id)?.name}function CP(n){return{providerName:"Google Gemini",fromStandardTextBlock(t){return{text:t.text}},fromStandardImageBlock(t){if(!n)throw new Error("This model does not support images");if(t.source_type==="url"){const i=op({dataUrl:t.url});return i?{inlineData:{mimeType:i.mime_type,data:i.data}}:{fileData:{mimeType:t.mime_type??"",fileUri:t.url}}}if(t.source_type==="base64")return{inlineData:{mimeType:t.mime_type??"",data:t.data}};throw new Error(`Unsupported source type: ${t.source_type}`)},fromStandardAudioBlock(t){if(!n)throw new Error("This model does not support audio");if(t.source_type==="url"){const i=op({dataUrl:t.url});return i?{inlineData:{mimeType:i.mime_type,data:i.data}}:{fileData:{mimeType:t.mime_type??"",fileUri:t.url}}}if(t.source_type==="base64")return{inlineData:{mimeType:t.mime_type??"",data:t.data}};throw new Error(`Unsupported source type: ${t.source_type}`)},fromStandardFileBlock(t){if(!n)throw new Error("This model does not support files");if(t.source_type==="text")return{text:t.text};if(t.source_type==="url"){const i=op({dataUrl:t.url});return i?{inlineData:{mimeType:i.mime_type,data:i.data}}:{fileData:{mimeType:t.mime_type??"",fileUri:t.url}}}if(t.source_type==="base64")return{inlineData:{mimeType:t.mime_type??"",data:t.data}};throw new Error(`Unsupported source type: ${t.source_type}`)}}}function Dw(n,e){if(ta(n))return qN(n,CP(e));if(n.type==="text")return{text:n.text};if(n.type==="executableCode")return{executableCode:n.executableCode};if(n.type==="codeExecutionResult")return{codeExecutionResult:n.codeExecutionResult};if(n.type==="image_url"){if(!e)throw new Error("This model does not support images");let t;if(typeof n.image_url=="string")t=n.image_url;else if(typeof n.image_url=="object"&&"url"in n.image_url)t=n.image_url.url;else throw new Error("Please provide image as base64 encoded data URL");const[i,r]=t.split(",");if(!i.startsWith("data:"))throw new Error("Please provide image as base64 encoded data URL");const[a,l]=i.replace(/^data:/,"").split(";");if(l!=="base64")throw new Error("Please provide image as base64 encoded data URL");return{inlineData:{data:r,mimeType:a}}}else{if(n.type==="media")return EP(n);if(n.type==="tool_use")return{functionCall:{name:n.name,args:n.input}};if(n.type?.includes("/")&&n.type.split("/").length===2&&"data"in n&&typeof n.data=="string")return{inlineData:{mimeType:n.type,data:n.data}};if("functionCall"in n)return;throw"type"in n?new Error(`Unknown content type ${n.type}`):new Error(`Unknown content ${JSON.stringify(n)}`)}}function AP(n,e,t){if(zN(n)){const a=n.name??SP(n,t);if(a===void 0)throw new Error(`Google requires a tool name for each tool call response, and we could not infer a called tool name for ToolMessage "${n.id}" from your passed messages. Please populate a "name" field on that ToolMessage explicitly.`);const l=Array.isArray(n.content)?n.content.map(c=>Dw(c,e)).filter(c=>c!==void 0):n.content;return n.status==="error"?[{functionResponse:{name:a,response:{error:{details:l}}}}]:[{functionResponse:{name:a,response:{result:l}}}]}let i=[];const r=[];return typeof n.content=="string"&&n.content&&r.push({text:n.content}),Array.isArray(n.content)&&r.push(...n.content.map(a=>Dw(a,e)).filter(a=>a!==void 0)),km(n)&&n.tool_calls?.length&&(i=n.tool_calls.map(a=>({functionCall:{name:a.name,args:a.args}}))),[...r,...i]}function Lw(n,e,t=!1){return n.reduce((i,r,a)=>{if(!nl(r))throw new Error("Unsupported message input");const l=wP(r);if(l==="system"&&a!==0)throw new Error("System message should be the first one");const c=TP(l),f=i.content[i.content.length];if(!i.mergeWithPreviousContent&&f&&f.role===c)throw new Error("Google Generative AI requires alternate messages between authors");const d=AP(r,e,n.slice(0,a));if(i.mergeWithPreviousContent){const v=i.content[i.content.length-1];if(!v)throw new Error("There was a problem parsing your system message. Please try a prompt without one.");return v.parts.push(...d),{mergeWithPreviousContent:!1,content:i.content}}let g=c;(g==="function"||g==="system"&&!t)&&(g="user");const _={role:g,parts:d};return{mergeWithPreviousContent:l==="system"&&!t,content:[...i.content,_]}},{content:[],mergeWithPreviousContent:!1}).content}function RP(n,e){if(!n.candidates||n.candidates.length===0||!n.candidates[0])return{generations:[],llmOutput:{filters:n.promptFeedback}};const t=n.functionCalls(),[i]=n.candidates,{content:r,...a}=i;let l;Array.isArray(r?.parts)&&r.parts.length===1&&r.parts[0].text?l=r.parts[0].text:Array.isArray(r?.parts)&&r.parts.length>0?l=r.parts.map(d=>"text"in d?{type:"text",text:d.text}:"executableCode"in d?{type:"executableCode",executableCode:d.executableCode}:"codeExecutionResult"in d?{type:"codeExecutionResult",codeExecutionResult:d.codeExecutionResult}:d):l=[];let c="";return typeof l=="string"?c=l:Array.isArray(l)&&l.length>0&&(c=l.find(g=>"text"in g)?.text??c),{generations:[{text:c,message:new Fp({content:l??"",tool_calls:t?.map(d=>({...d,type:"tool_call",id:"id"in d&&typeof d.id=="string"?d.id:DS()})),additional_kwargs:{...a},usage_metadata:e?.usageMetadata}),generationInfo:a}],llmOutput:{tokenUsage:{promptTokens:e?.usageMetadata?.input_tokens,completionTokens:e?.usageMetadata?.output_tokens,totalTokens:e?.usageMetadata?.total_tokens}}}}function xP(n,e){if(!n.candidates||n.candidates.length===0)return null;const t=n.functionCalls(),[i]=n.candidates,{content:r,...a}=i;let l;Array.isArray(r?.parts)&&r.parts.every(d=>"text"in d)?l=r.parts.map(d=>d.text).join(""):Array.isArray(r?.parts)?l=r.parts.map(d=>"text"in d?{type:"text",text:d.text}:"executableCode"in d?{type:"executableCode",executableCode:d.executableCode}:"codeExecutionResult"in d?{type:"codeExecutionResult",codeExecutionResult:d.codeExecutionResult}:d):l=[];let c="";l&&typeof l=="string"?c=l:Array.isArray(l)&&(c=l.find(g=>"text"in g)?.text??"");const f=[];return t&&f.push(...t.map(d=>({...d,args:JSON.stringify(d.args),index:e.index,type:"tool_call_chunk",id:"id"in d&&typeof d.id=="string"?d.id:DS()}))),new zo({text:c,message:new ua({content:l||"",name:r?r.role:void 0,tool_call_chunks:f,additional_kwargs:{},usage_metadata:e.usageMetadata}),generationInfo:a})}function IP(n){return n.every(e=>"functionDeclarations"in e&&Array.isArray(e.functionDeclarations))?n:[{functionDeclarations:n.map(e=>{if(PS(e)){const t=Qp(e.schema);return t.type==="object"&&"properties"in t&&Object.keys(t.properties).length===0?{name:e.name,description:e.description}:{name:e.name,description:e.description,parameters:t}}return NS(e)?{name:e.function.name,description:e.function.description??"A function available to call.",parameters:hP(e.function.parameters)}:e})}]}class Uw extends OS{static lc_name(){return"GoogleGenerativeAIToolsOutputParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","google_genai","output_parsers"]}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){if(this.zodSchema===void 0)return e;const t=await Ak(this.zodSchema,e);if(t.success)return t.data;throw new cP(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(t.error.issues)}`,JSON.stringify(e,null,2))}async parseResult(e){const t=e.flatMap(a=>{const{message:l}=a;return!("tool_calls"in l)||!Array.isArray(l.tool_calls)?[]:l.tool_calls});if(t[0]===void 0)throw new Error("No parseable tool calls provided to GoogleGenerativeAIToolsOutputParser.");const[i]=t;return await this._validateResult(i.args)}}function $w(n,e){const t=MP(n),i=OP(t,e);return{tools:t,toolConfig:i}}function MP(n){let e=[];const t=[];return n.forEach(r=>{if(PS(r)){const[a]=IP([r]);a.functionDeclarations&&e.push(...a.functionDeclarations)}else if(NS(r)){const{functionDeclarations:a}=NP(r);if(a)e.push(...a);else throw new Error("Failed to convert OpenAI structured tool to GenerativeAI tool")}else t.push(r)}),t.find(r=>"functionDeclarations"in r)?t.map(r=>{if(e?.length>0&&"functionDeclarations"in r){const a={functionDeclarations:[...r.functionDeclarations||[],...e]};return e=[],a}return r}):[...t,...e.length>0?[{functionDeclarations:e}]:[]]}function NP(n){return{functionDeclarations:[{name:n.function.name,description:n.function.description,parameters:qr(n.function.parameters)}]}}function OP(n,e){if(!n.length||!e)return;const{toolChoice:t,allowedFunctionNames:i}=e,r={any:js.ANY,auto:js.AUTO,none:js.NONE};if(t&&["any","auto","none"].includes(t))return{functionCallingConfig:{mode:r[t]??"MODE_UNSPECIFIED",allowedFunctionNames:i}};if(typeof t=="string"||i)return{functionCallingConfig:{mode:js.ANY,allowedFunctionNames:[...i??[],...t&&typeof t=="string"?[t]:[]]}}}class kP extends Qi{static lc_name(){return"ChatGoogleGenerativeAI"}get lc_secrets(){return{apiKey:"GOOGLE_API_KEY"}}get lc_aliases(){return{apiKey:"google_api_key"}}get _isMultimodalModel(){return this.model.includes("vision")||this.model.startsWith("gemini-1.5")||this.model.startsWith("gemini-2")}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models","google_genai"]}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxOutputTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"safetySettings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"json",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"convertSystemMessageToHumanContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.model=e.model.replace(/^models\//,""),this.maxOutputTokens=e.maxOutputTokens??this.maxOutputTokens,this.maxOutputTokens&&this.maxOutputTokens<0)throw new Error("`maxOutputTokens` must be a positive integer");if(this.temperature=e.temperature??this.temperature,this.temperature&&(this.temperature<0||this.temperature>2))throw new Error("`temperature` must be in the range of [0.0,2.0]");if(this.topP=e.topP??this.topP,this.topP&&this.topP<0)throw new Error("`topP` must be a positive integer");if(this.topP&&this.topP>1)throw new Error("`topP` must be below 1.");if(this.topK=e.topK??this.topK,this.topK&&this.topK<0)throw new Error("`topK` must be a positive integer");if(this.stopSequences=e.stopSequences??this.stopSequences,this.apiKey=e.apiKey??sr("GOOGLE_API_KEY"),!this.apiKey)throw new Error("Please set an API key for Google GenerativeAI in the environment variable GOOGLE_API_KEY or in the `apiKey` field of the ChatGoogleGenerativeAI constructor");if(this.safetySettings=e.safetySettings??this.safetySettings,this.safetySettings&&this.safetySettings.length>0&&new Set(this.safetySettings.map(i=>i.category)).size!==this.safetySettings.length)throw new Error("The categories in `safetySettings` array must be unique");this.streaming=e.streaming??this.streaming,this.json=e.json,this.client=new Yp(this.apiKey).getGenerativeModel({model:this.model,safetySettings:this.safetySettings,generationConfig:{stopSequences:this.stopSequences,maxOutputTokens:this.maxOutputTokens,temperature:this.temperature,topP:this.topP,topK:this.topK,...this.json?{responseMimeType:"application/json"}:{}}},{apiVersion:e.apiVersion,baseUrl:e.baseUrl}),this.streamUsage=e.streamUsage??this.streamUsage}useCachedContent(e,t,i){this.apiKey&&(this.client=new Yp(this.apiKey).getGenerativeModelFromCachedContent(e,t,i))}get useSystemInstruction(){return typeof this.convertSystemMessageToHumanContent=="boolean"?!this.convertSystemMessageToHumanContent:this.computeUseSystemInstruction}get computeUseSystemInstruction(){return this.model==="gemini-1.0-pro-001"||this.model.startsWith("gemini-pro-vision")||this.model.startsWith("gemini-1.0-pro-vision")?!1:this.model!=="gemini-pro"}getLsParams(e){return{ls_provider:"google_genai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:this.client.generationConfig.temperature,ls_max_tokens:this.client.generationConfig.maxOutputTokens,ls_stop:e.stop}}_combineLLMOutput(){return[]}_llmType(){return"googlegenerativeai"}bindTools(e,t){return this.withConfig({tools:$w(e)?.tools,...t})}invocationParams(e){const t=e?.tools?.length?$w(e.tools,{toolChoice:e.tool_choice,allowedFunctionNames:e.allowedFunctionNames}):void 0;return e?.responseSchema?(this.client.generationConfig.responseSchema=e.responseSchema,this.client.generationConfig.responseMimeType="application/json"):(this.client.generationConfig.responseSchema=void 0,this.client.generationConfig.responseMimeType=this.json?"application/json":void 0),{...t?.tools?{tools:t.tools}:{},...t?.toolConfig?{toolConfig:t.toolConfig}:{}}}async _generate(e,t,i){const r=Lw(e,this._isMultimodalModel,this.useSystemInstruction);let a=r;if(r[0].role==="system"){const[g]=r;this.client.systemInstruction=g,a=r.slice(1)}const l=this.invocationParams(t);if(this.streaming){const g={},_=this._streamResponseChunks(e,t,i),v={};for await(const T of _){const S=T.generationInfo?.completion??0;v[S]===void 0?v[S]=T:v[S]=v[S].concat(T)}return{generations:Object.entries(v).sort(([T],[S])=>parseInt(T,10)-parseInt(S,10)).map(([T,S])=>S),llmOutput:{estimatedTokenUsage:g}}}const c=await this.completionWithRetry({...l,contents:a});let f;if("usageMetadata"in c.response){const g=c.response.usageMetadata;f={input_tokens:g.promptTokenCount??0,output_tokens:g.candidatesTokenCount??0,total_tokens:g.totalTokenCount??0}}const d=RP(c.response,{usageMetadata:f});return d.generations?.length>0&&await i?.handleLLMNewToken(d.generations[0]?.text??""),d}async*_streamResponseChunks(e,t,i){const r=Lw(e,this._isMultimodalModel,this.useSystemInstruction);let a=r;if(r[0].role==="system"){const[_]=r;this.client.systemInstruction=_,a=r.slice(1)}const c={...this.invocationParams(t),contents:a},f=await this.caller.callWithOptions({signal:t?.signal},async()=>{const{stream:_}=await this.client.generateContentStream(c);return _});let d,g=0;for await(const _ of f){if("usageMetadata"in _&&this.streamUsage!==!1&&t.streamUsage!==!1){const w=_.usageMetadata;if(!d)d={input_tokens:w.promptTokenCount??0,output_tokens:w.candidatesTokenCount??0,total_tokens:w.totalTokenCount??0};else{const T=(w.candidatesTokenCount??0)-d.output_tokens;d={input_tokens:0,output_tokens:T,total_tokens:T}}}const v=xP(_,{usageMetadata:d,index:g});g+=1,v&&(yield v,await i?.handleLLMNewToken(v.text??""))}}async completionWithRetry(e,t){return this.caller.callWithOptions({signal:t?.signal},async()=>{try{return await this.client.generateContent(e)}catch(i){throw i.message?.includes("400 Bad Request")&&(i.status=400),i}})}withStructuredOutput(e,t){const i=e,r=t?.name,a=t?.method,l=t?.includeRaw;if(a==="jsonMode")throw new Error('ChatGoogleGenerativeAI only supports "jsonSchema" or "functionCalling" as a method.');let c,f;if(a==="functionCalling"){let v=r??"extract",w;if(il(i)){const T=Qp(i);w=[{functionDeclarations:[{name:v,description:T.description??"A function available to call.",parameters:T}]}],f=new Uw({returnSingle:!0,keyName:v,zodSchema:i})}else{let T;typeof i.name=="string"&&typeof i.parameters=="object"&&i.parameters!=null?(T=i,T.parameters=qr(i.parameters),v=i.name):T={name:v,description:i.description??"",parameters:qr(i)},w=[{functionDeclarations:[T]}],f=new Uw({returnSingle:!0,keyName:v})}c=this.bindTools(w).withConfig({allowedFunctionNames:[v]})}else{const v=Qp(i);c=this.withConfig({responseSchema:v}),f=new dP}if(!l)return c.pipe(f).withConfig({runName:"ChatGoogleGenerativeAIStructuredOutput"});const d=Yo.assign({parsed:(v,w)=>f.invoke(v.raw,w)}),g=Yo.assign({parsed:()=>null}),_=d.withFallbacks({fallbacks:[g]});return Pn.from([{raw:c},_]).withConfig({runName:"StructuredOutputRunnable"})}}class PP{constructor(e){Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.caller=new bc(e??{})}}const DP=(n,e)=>n.reduce((t,i,r)=>{const a=Math.floor(r/e),l=t[a]||[];return t[a]=l.concat([i]),t},[]);class LP extends PP{constructor(e){if(super(e??{}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"embedding-001"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"embedding-001"}),Object.defineProperty(this,"taskType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"title",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stripNewLines",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxBatchSize",{enumerable:!0,configurable:!0,writable:!0,value:100}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.modelName=e?.model?.replace(/^models\//,"")??e?.modelName?.replace(/^models\//,"")??this.modelName,this.model=this.modelName,this.taskType=e?.taskType??this.taskType,this.title=e?.title??this.title,this.title&&this.taskType!=="RETRIEVAL_DOCUMENT")throw new Error("title can only be sepcified with TaskType.RETRIEVAL_DOCUMENT");if(this.apiKey=e?.apiKey??sr("GOOGLE_API_KEY"),!this.apiKey)throw new Error("Please set an API key for Google GenerativeAI in the environmentb variable GOOGLE_API_KEY or in the `apiKey` field of the GoogleGenerativeAIEmbeddings constructor");this.client=new Yp(this.apiKey).getGenerativeModel({model:this.model},{baseUrl:e?.baseUrl})}_convertToContent(e){return{content:{role:"user",parts:[{text:this.stripNewLines?e.replace(/\n/g," "):e}]},taskType:this.taskType,title:this.title}}async _embedQueryContent(e){const t=this._convertToContent(e);return(await this.client.embedContent(t)).embedding.values??[]}async _embedDocumentsContent(e){const t=DP(e,this.maxBatchSize),i=t.map(l=>({requests:l.map(c=>this._convertToContent(c))}));return(await Promise.allSettled(i.map(l=>this.client.batchEmbedContents(l)))).flatMap((l,c)=>l.status==="fulfilled"?l.value.embeddings.map(f=>f.values||[]):Array(t[c].length).fill([]))}embedQuery(e){return this.caller.call(this._embedQueryContent.bind(this),e)}embedDocuments(e){return this.caller.call(this._embedDocumentsContent.bind(this),e)}}const qw=new kP({model:"gemini-2.5-flash-lite",temperature:1,apiKey:"AIzaSyAjFV0WG-QfB-01RFHe25a4VJY8FH1znpA"}),UP=new LP({apiKey:"AIzaSyAjFV0WG-QfB-01RFHe25a4VJY8FH1znpA"});class $P extends lt{constructor(e){super(e),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.callbacks=e?.callbacks,this.tags=e?.tags??[],this.metadata=e?.metadata??{},this.verbose=e?.verbose??!1}_getRelevantDocuments(e,t){throw new Error("Not implemented!")}async invoke(e,t){return this.getRelevantDocuments(e,De(t))}async getRelevantDocuments(e,t){const i=De(nO(t)),a=await(await $t.configure(i.callbacks,this.callbacks,i.tags,this.tags,i.metadata,this.metadata,{verbose:this.verbose}))?.handleRetrieverStart(this.toJSON(),e,i.runId,void 0,void 0,void 0,i.runName);try{const l=await this._getRelevantDocuments(e,a);return await a?.handleRetrieverEnd(l),l}catch(l){throw await a?.handleRetrieverError(l),l}}}class _p extends $P{static lc_name(){return"VectorStoreRetriever"}get lc_namespace(){return["langchain_core","vectorstores"]}_vectorstoreType(){return this.vectorStore._vectorstoreType()}constructor(e){super(e),Object.defineProperty(this,"vectorStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"searchType",{enumerable:!0,configurable:!0,writable:!0,value:"similarity"}),Object.defineProperty(this,"searchKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.vectorStore=e.vectorStore,this.k=e.k??this.k,this.searchType=e.searchType??this.searchType,this.filter=e.filter,e.searchType==="mmr"&&(this.searchKwargs=e.searchKwargs)}async _getRelevantDocuments(e,t){if(this.searchType==="mmr"){if(typeof this.vectorStore.maxMarginalRelevanceSearch!="function")throw new Error(`The vector store backing this retriever, ${this._vectorstoreType()} does not support max marginal relevance search.`);return this.vectorStore.maxMarginalRelevanceSearch(e,{k:this.k,filter:this.filter,...this.searchKwargs},t?.getChild("vectorstore"))}return this.vectorStore.similaritySearch(e,this.k,this.filter,t?.getChild("vectorstore"))}async addDocuments(e,t){return this.vectorStore.addDocuments(e,t)}}class qP extends ur{constructor(e,t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","vectorstores",this._vectorstoreType()]}),Object.defineProperty(this,"embeddings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.embeddings=e}async delete(e){throw new Error("Not implemented.")}async similaritySearch(e,t=4,i=void 0,r=void 0){return(await this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),t,i)).map(l=>l[0])}async similaritySearchWithScore(e,t=4,i=void 0,r=void 0){return this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),t,i)}static fromTexts(e,t,i,r){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}static fromDocuments(e,t,i){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}asRetriever(e,t,i,r,a,l){if(typeof e=="number")return new _p({vectorStore:this,k:e,filter:t,tags:[...r??[],this._vectorstoreType()],metadata:a,verbose:l,callbacks:i});{const c={vectorStore:this,k:e?.k,filter:e?.filter,tags:[...e?.tags??[],this._vectorstoreType()],metadata:e?.metadata,verbose:e?.verbose,callbacks:e?.callbacks,searchType:e?.searchType};return e?.searchType==="mmr"?new _p({...c,searchKwargs:e.searchKwargs}):new _p({...c})}}}class vp{constructor(e){Object.defineProperty(this,"pageContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.pageContent=e.pageContent!==void 0?e.pageContent.toString():"",this.metadata=e.metadata??{},this.id=e.id}}function BP(n,e){let t=0,i=0,r=0;for(let a=0;a<n.length;a++)t+=n[a]*e[a],i+=n[a]*n[a],r+=e[a]*e[a];return t/(Math.sqrt(i)*Math.sqrt(r))}function GP(n,e,t){if(n.length===0||n[0].length===0||e.length===0||e[0].length===0)return[[]];if(n[0].length!==e[0].length)throw new Error(`Number of columns in X and Y must be the same. X has shape ${[n.length,n[0].length]} and Y has shape ${[e.length,e[0].length]}.`);return n.map(i=>e.map(r=>t(i,r)).map(r=>Number.isNaN(r)?0:r))}function Bw(n,e){return GP(n,e,BP)}function VP(n,e,t=.5,i=4){if(Math.min(i,e.length)<=0)return[];const r=Array.isArray(n[0])?n:[n],a=Bw(r,e)[0],l=FP(a).maxIndex,c=[e[l]],f=[l];for(;f.length<Math.min(i,e.length);){let d=-1/0,g=-1;const _=Bw(e,c);a.forEach((v,w)=>{if(f.includes(w))return;const T=Math.max(..._[w]),S=t*v-(1-t)*T;S>d&&(d=S,g=w)}),c.push(e[g]),f.push(g)}return f}function FP(n){if(n.length===0)return{maxIndex:-1,maxValue:NaN};let e=n[0],t=0;for(let i=1;i<n.length;i+=1)n[i]>e&&(t=i,e=n[i]);return{maxIndex:t,maxValue:e}}class Hm extends qP{_vectorstoreType(){return"supabase"}constructor(e,t){super(e,t),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tableName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queryName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"upsertBatchSize",{enumerable:!0,configurable:!0,writable:!0,value:500}),this.client=t.client,this.tableName=t.tableName||"documents",this.queryName=t.queryName||"match_documents",this.filter=t.filter,this.upsertBatchSize=t.upsertBatchSize??this.upsertBatchSize}async addDocuments(e,t){const i=e.map(({pageContent:r})=>r);return this.addVectors(await this.embeddings.embedDocuments(i),e,t)}async addVectors(e,t,i){const r=e.map((l,c)=>({content:t[c].pageContent,embedding:l,metadata:t[c].metadata}));let a=[];for(let l=0;l<r.length;l+=this.upsertBatchSize){const c=r.slice(l,l+this.upsertBatchSize).map((d,g)=>i?.ids?{id:i.ids[l+g],...d}:d),f=await this.client.from(this.tableName).upsert(c).select();if(f.error)throw new Error(`Error inserting: ${f.error.message} ${f.status} ${f.statusText}`);f.data&&(a=a.concat(f.data.map(d=>d.id)))}return a}async delete(e){const{ids:t}=e;for(const i of t)await this.client.from(this.tableName).delete().eq("id",i)}async _searchSupabase(e,t,i){if(i&&this.filter)throw new Error("cannot provide both `filter` and `this.filter`");const r=i??this.filter??{},a={query_embedding:e};let l;if(typeof r=="function")l=g=>r(g).limit(t);else if(typeof r=="object")a.filter=r,a.match_count=t,l=g=>g;else throw new Error("invalid filter type");const c=this.client.rpc(this.queryName,a),{data:f,error:d}=await l(c);if(d)throw new Error(`Error searching for documents: ${d.code} ${d.message} ${d.details}`);return f}async similaritySearchVectorWithScore(e,t,i){return(await this._searchSupabase(e,t,i)).map(l=>[new vp({metadata:l.metadata,pageContent:l.content}),l.similarity])}async maxMarginalRelevanceSearch(e,t){const i=await this.embeddings.embedQuery(e),r=await this._searchSupabase(i,t.fetchK??20,t.filter),a=r.map(c=>c.embedding);return VP(i,a,t.lambda,t.k).map(c=>new vp({metadata:r[c].metadata,pageContent:r[c].content}))}static async fromTexts(e,t,i,r){const a=[];for(let l=0;l<e.length;l+=1){const c=Array.isArray(t)?t[l]:t,f=new vp({pageContent:e[l],metadata:c});a.push(f)}return Hm.fromDocuments(a,i,r)}static async fromDocuments(e,t,i){const r=new this(t,i);return await r.addDocuments(e),r}static async fromExistingIndex(e,t){return new this(e,t)}}const HP=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>ir(async()=>{const{default:i}=await Promise.resolve().then(()=>ha);return{default:i}},void 0).then(({default:i})=>i(...t)):e=fetch,(...t)=>e(...t)};class zm extends Error{constructor(e,t="FunctionsError",i){super(e),this.name=t,this.context=i}}class zP extends zm{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Gw extends zm{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Vw extends zm{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Xp;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Xp||(Xp={}));var jP=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(g){try{d(i.next(g))}catch(_){l(_)}}function f(g){try{d(i.throw(g))}catch(_){l(_)}}function d(g){g.done?a(g.value):r(g.value).then(c,f)}d((i=i.apply(n,e||[])).next())})};class JP{constructor(e,{headers:t={},customFetch:i,region:r=Xp.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=HP(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var i;return jP(this,void 0,void 0,function*(){try{const{headers:r,method:a,body:l}=t;let c={},{region:f}=t;f||(f=this.region);const d=new URL(`${this.url}/${e}`);f&&f!=="any"&&(c["x-region"]=f,d.searchParams.set("forceFunctionRegion",f));let g;l&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",g=l):typeof l=="string"?(c["Content-Type"]="text/plain",g=l):typeof FormData<"u"&&l instanceof FormData?g=l:(c["Content-Type"]="application/json",g=JSON.stringify(l)));const _=yield this.fetch(d.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),r),body:g}).catch(S=>{throw new zP(S)}),v=_.headers.get("x-relay-error");if(v&&v==="true")throw new Gw(_);if(!_.ok)throw new Vw(_);let w=((i=_.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),T;return w==="application/json"?T=yield _.json():w==="application/octet-stream"?T=yield _.blob():w==="text/event-stream"?T=_:w==="multipart/form-data"?T=yield _.formData():T=yield _.text(),{data:T,error:null,response:_}}catch(r){return{data:null,error:r,response:r instanceof Vw||r instanceof Gw?r.context:void 0}}})}}var _t={},Ns={},Os={},ks={},Ps={},Ds={},KP=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},sa=KP();const YP=sa.fetch,LS=sa.fetch.bind(sa),US=sa.Headers,ZP=sa.Request,QP=sa.Response,ha=Object.freeze(Object.defineProperty({__proto__:null,Headers:US,Request:ZP,Response:QP,default:LS,fetch:YP},Symbol.toStringTag,{value:"Module"})),XP=tx(ha);var Du={},Fw;function $S(){if(Fw)return Du;Fw=1,Object.defineProperty(Du,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Du.default=n,Du}var Hw;function qS(){if(Hw)return Ds;Hw=1;var n=Ds&&Ds.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ds,"__esModule",{value:!0});const e=n(XP),t=n($S());class i{constructor(a){this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=a.headers,this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=a.shouldThrowOnError,this.signal=a.signal,this.isMaybeSingle=a.isMaybeSingle,a.fetch?this.fetch=a.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,l){return this.headers=Object.assign({},this.headers),this.headers[a]=l,this}then(a,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const c=this.fetch;let f=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{var g,_,v;let w=null,T=null,S=null,C=d.status,x=d.statusText;if(d.ok){if(this.method!=="HEAD"){const O=await d.text();O===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?T=O:T=JSON.parse(O))}const R=(g=this.headers.Prefer)===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),P=(_=d.headers.get("content-range"))===null||_===void 0?void 0:_.split("/");R&&P&&P.length>1&&(S=parseInt(P[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(T)&&(T.length>1?(w={code:"PGRST116",details:`Results contain ${T.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},T=null,S=null,C=406,x="Not Acceptable"):T.length===1?T=T[0]:T=null)}else{const R=await d.text();try{w=JSON.parse(R),Array.isArray(w)&&d.status===404&&(T=[],w=null,C=200,x="OK")}catch{d.status===404&&R===""?(C=204,x="No Content"):w={message:R}}if(w&&this.isMaybeSingle&&(!((v=w?.details)===null||v===void 0)&&v.includes("0 rows"))&&(w=null,C=200,x="OK"),w&&this.shouldThrowOnError)throw new t.default(w)}return{error:w,data:T,count:S,status:C,statusText:x}});return this.shouldThrowOnError||(f=f.catch(d=>{var g,_,v;return{error:{message:`${(g=d?.name)!==null&&g!==void 0?g:"FetchError"}: ${d?.message}`,details:`${(_=d?.stack)!==null&&_!==void 0?_:""}`,hint:"",code:`${(v=d?.code)!==null&&v!==void 0?v:""}`},data:null,count:null,status:0,statusText:""}})),f.then(a,l)}returns(){return this}overrideTypes(){return this}}return Ds.default=i,Ds}var zw;function BS(){if(zw)return Ps;zw=1;var n=Ps&&Ps.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Ps,"__esModule",{value:!0});const e=n(qS());class t extends e.default{select(r){let a=!1;const l=(r??"*").split("").map(c=>/\s/.test(c)&&!a?"":(c==='"'&&(a=!a),c)).join("");return this.url.searchParams.set("select",l),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(r,{ascending:a=!0,nullsFirst:l,foreignTable:c,referencedTable:f=c}={}){const d=f?`${f}.order`:"order",g=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${g?`${g},`:""}${r}.${a?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:a,referencedTable:l=a}={}){const c=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${r}`),this}range(r,a,{foreignTable:l,referencedTable:c=l}={}){const f=typeof c>"u"?"offset":`${c}.offset`,d=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(f,`${r}`),this.url.searchParams.set(d,`${a-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:r=!1,verbose:a=!1,settings:l=!1,buffers:c=!1,wal:f=!1,format:d="text"}={}){var g;const _=[r?"analyze":null,a?"verbose":null,l?"settings":null,c?"buffers":null,f?"wal":null].filter(Boolean).join("|"),v=(g=this.headers.Accept)!==null&&g!==void 0?g:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${d}; for="${v}"; options=${_};`,d==="json"?this:this}rollback(){var r;return((r=this.headers.Prefer)!==null&&r!==void 0?r:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Ps.default=t,Ps}var jw;function jm(){if(jw)return ks;jw=1;var n=ks&&ks.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(ks,"__esModule",{value:!0});const e=n(BS());class t extends e.default{eq(r,a){return this.url.searchParams.append(r,`eq.${a}`),this}neq(r,a){return this.url.searchParams.append(r,`neq.${a}`),this}gt(r,a){return this.url.searchParams.append(r,`gt.${a}`),this}gte(r,a){return this.url.searchParams.append(r,`gte.${a}`),this}lt(r,a){return this.url.searchParams.append(r,`lt.${a}`),this}lte(r,a){return this.url.searchParams.append(r,`lte.${a}`),this}like(r,a){return this.url.searchParams.append(r,`like.${a}`),this}likeAllOf(r,a){return this.url.searchParams.append(r,`like(all).{${a.join(",")}}`),this}likeAnyOf(r,a){return this.url.searchParams.append(r,`like(any).{${a.join(",")}}`),this}ilike(r,a){return this.url.searchParams.append(r,`ilike.${a}`),this}ilikeAllOf(r,a){return this.url.searchParams.append(r,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(r,a){return this.url.searchParams.append(r,`ilike(any).{${a.join(",")}}`),this}is(r,a){return this.url.searchParams.append(r,`is.${a}`),this}in(r,a){const l=Array.from(new Set(a)).map(c=>typeof c=="string"&&new RegExp("[,()]").test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(r,`in.(${l})`),this}contains(r,a){return typeof a=="string"?this.url.searchParams.append(r,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(r,`cs.{${a.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(a)}`),this}containedBy(r,a){return typeof a=="string"?this.url.searchParams.append(r,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(r,`cd.{${a.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(a)}`),this}rangeGt(r,a){return this.url.searchParams.append(r,`sr.${a}`),this}rangeGte(r,a){return this.url.searchParams.append(r,`nxl.${a}`),this}rangeLt(r,a){return this.url.searchParams.append(r,`sl.${a}`),this}rangeLte(r,a){return this.url.searchParams.append(r,`nxr.${a}`),this}rangeAdjacent(r,a){return this.url.searchParams.append(r,`adj.${a}`),this}overlaps(r,a){return typeof a=="string"?this.url.searchParams.append(r,`ov.${a}`):this.url.searchParams.append(r,`ov.{${a.join(",")}}`),this}textSearch(r,a,{config:l,type:c}={}){let f="";c==="plain"?f="pl":c==="phrase"?f="ph":c==="websearch"&&(f="w");const d=l===void 0?"":`(${l})`;return this.url.searchParams.append(r,`${f}fts${d}.${a}`),this}match(r){return Object.entries(r).forEach(([a,l])=>{this.url.searchParams.append(a,`eq.${l}`)}),this}not(r,a,l){return this.url.searchParams.append(r,`not.${a}.${l}`),this}or(r,{foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${r})`),this}filter(r,a,l){return this.url.searchParams.append(r,`${a}.${l}`),this}}return ks.default=t,ks}var Jw;function GS(){if(Jw)return Os;Jw=1;var n=Os&&Os.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Os,"__esModule",{value:!0});const e=n(jm());class t{constructor(r,{headers:a={},schema:l,fetch:c}){this.url=r,this.headers=a,this.schema=l,this.fetch=c}select(r,{head:a=!1,count:l}={}){const c=a?"HEAD":"GET";let f=!1;const d=(r??"*").split("").map(g=>/\s/.test(g)&&!f?"":(g==='"'&&(f=!f),g)).join("");return this.url.searchParams.set("select",d),l&&(this.headers.Prefer=`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(r,{count:a,defaultToNull:l=!0}={}){const c="POST",f=[];if(this.headers.Prefer&&f.push(this.headers.Prefer),a&&f.push(`count=${a}`),l||f.push("missing=default"),this.headers.Prefer=f.join(","),Array.isArray(r)){const d=r.reduce((g,_)=>g.concat(Object.keys(_)),[]);if(d.length>0){const g=[...new Set(d)].map(_=>`"${_}"`);this.url.searchParams.set("columns",g.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}upsert(r,{onConflict:a,ignoreDuplicates:l=!1,count:c,defaultToNull:f=!0}={}){const d="POST",g=[`resolution=${l?"ignore":"merge"}-duplicates`];if(a!==void 0&&this.url.searchParams.set("on_conflict",a),this.headers.Prefer&&g.push(this.headers.Prefer),c&&g.push(`count=${c}`),f||g.push("missing=default"),this.headers.Prefer=g.join(","),Array.isArray(r)){const _=r.reduce((v,w)=>v.concat(Object.keys(w)),[]);if(_.length>0){const v=[...new Set(_)].map(w=>`"${w}"`);this.url.searchParams.set("columns",v.join(","))}}return new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}update(r,{count:a}={}){const l="PATCH",c=[];return this.headers.Prefer&&c.push(this.headers.Prefer),a&&c.push(`count=${a}`),this.headers.Prefer=c.join(","),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}delete({count:r}={}){const a="DELETE",l=[];return r&&l.push(`count=${r}`),this.headers.Prefer&&l.unshift(this.headers.Prefer),this.headers.Prefer=l.join(","),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Os.default=t,Os}var To={},Eo={},Kw;function WP(){return Kw||(Kw=1,Object.defineProperty(Eo,"__esModule",{value:!0}),Eo.version=void 0,Eo.version="0.0.0-automated"),Eo}var Yw;function eD(){if(Yw)return To;Yw=1,Object.defineProperty(To,"__esModule",{value:!0}),To.DEFAULT_HEADERS=void 0;const n=WP();return To.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`},To}var Zw;function tD(){if(Zw)return Ns;Zw=1;var n=Ns&&Ns.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Ns,"__esModule",{value:!0});const e=n(GS()),t=n(jm()),i=eD();class r{constructor(l,{headers:c={},schema:f,fetch:d}={}){this.url=l,this.headers=Object.assign(Object.assign({},i.DEFAULT_HEADERS),c),this.schemaName=f,this.fetch=d}from(l){const c=new URL(`${this.url}/${l}`);return new e.default(c,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new r(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:f=!1,get:d=!1,count:g}={}){let _;const v=new URL(`${this.url}/rpc/${l}`);let w;f||d?(_=f?"HEAD":"GET",Object.entries(c).filter(([S,C])=>C!==void 0).map(([S,C])=>[S,Array.isArray(C)?`{${C.join(",")}}`:`${C}`]).forEach(([S,C])=>{v.searchParams.append(S,C)})):(_="POST",w=c);const T=Object.assign({},this.headers);return g&&(T.Prefer=`count=${g}`),new t.default({method:_,url:v,headers:T,schema:this.schemaName,body:w,fetch:this.fetch,allowEmpty:!1})}}return Ns.default=r,Ns}var Qw;function nD(){if(Qw)return _t;Qw=1;var n=_t&&_t.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(_t,"__esModule",{value:!0}),_t.PostgrestError=_t.PostgrestBuilder=_t.PostgrestTransformBuilder=_t.PostgrestFilterBuilder=_t.PostgrestQueryBuilder=_t.PostgrestClient=void 0;const e=n(tD());_t.PostgrestClient=e.default;const t=n(GS());_t.PostgrestQueryBuilder=t.default;const i=n(jm());_t.PostgrestFilterBuilder=i.default;const r=n(BS());_t.PostgrestTransformBuilder=r.default;const a=n(qS());_t.PostgrestBuilder=a.default;const l=n($S());return _t.PostgrestError=l.default,_t.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:r.default,PostgrestBuilder:a.default,PostgrestError:l.default},_t}var iD=nD();const rD=aa(iD),{PostgrestClient:sD,PostgrestQueryBuilder:gH,PostgrestFilterBuilder:yH,PostgrestTransformBuilder:_H,PostgrestBuilder:vH,PostgrestError:bH}=rD;function aD(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const oD=aD(),lD="2.11.15",uD=`realtime-js/${lD}`,cD="1.0.0",VS=1e4,fD=1e3;var Lo;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Lo||(Lo={}));var It;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(It||(It={}));var kn;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(kn||(kn={}));var Wp;(function(n){n.websocket="websocket"})(Wp||(Wp={}));var Pr;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Pr||(Pr={}));class dD{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),i=new TextDecoder;return this._decodeBroadcast(e,t,i)}_decodeBroadcast(e,t,i){const r=t.getUint8(1),a=t.getUint8(2);let l=this.HEADER_LENGTH+2;const c=i.decode(e.slice(l,l+r));l=l+r;const f=i.decode(e.slice(l,l+a));l=l+a;const d=JSON.parse(i.decode(e.slice(l,e.byteLength)));return{ref:null,topic:c,event:f,payload:d}}}class FS{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ye;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Ye||(Ye={}));const Xw=(n,e,t={})=>{var i;const r=(i=t.skipTypes)!==null&&i!==void 0?i:[];return Object.keys(e).reduce((a,l)=>(a[l]=hD(l,n,e,r),a),{})},hD=(n,e,t,i)=>{const r=e.find(c=>c.name===n),a=r?.type,l=t[n];return a&&!i.includes(a)?HS(a,l):em(l)},HS=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return yD(e,t)}switch(n){case Ye.bool:return pD(e);case Ye.float4:case Ye.float8:case Ye.int2:case Ye.int4:case Ye.int8:case Ye.numeric:case Ye.oid:return mD(e);case Ye.json:case Ye.jsonb:return gD(e);case Ye.timestamp:return _D(e);case Ye.abstime:case Ye.date:case Ye.daterange:case Ye.int4range:case Ye.int8range:case Ye.money:case Ye.reltime:case Ye.text:case Ye.time:case Ye.timestamptz:case Ye.timetz:case Ye.tsrange:case Ye.tstzrange:return em(e);default:return em(e)}},em=n=>n,pD=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},mD=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},gD=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},yD=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,i=n[t];if(n[0]==="{"&&i==="}"){let a;const l=n.slice(1,t);try{a=JSON.parse("["+l+"]")}catch{a=l?l.split(","):[]}return a.map(c=>HS(e,c))}return n},_D=n=>typeof n=="string"?n.replace(" ","T"):n,zS=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class bp{constructor(e,t,i={},r=VS){this.channel=e,this.event=t,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var i;return this._hasReceived(e)&&t((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ww;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Ww||(Ww={}));class Uo{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},r=>{const{onJoin:a,onLeave:l,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Uo.syncState(this.state,r,a,l),this.pendingDiffs.forEach(f=>{this.state=Uo.syncDiff(this.state,f,a,l)}),this.pendingDiffs=[],c()}),this.channel._on(i.diff,{},r=>{const{onJoin:a,onLeave:l,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=Uo.syncDiff(this.state,r,a,l),c())}),this.onJoin((r,a,l)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:a,newPresences:l})}),this.onLeave((r,a,l)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:a,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,i,r){const a=this.cloneDeep(e),l=this.transformState(t),c={},f={};return this.map(a,(d,g)=>{l[d]||(f[d]=g)}),this.map(l,(d,g)=>{const _=a[d];if(_){const v=g.map(C=>C.presence_ref),w=_.map(C=>C.presence_ref),T=g.filter(C=>w.indexOf(C.presence_ref)<0),S=_.filter(C=>v.indexOf(C.presence_ref)<0);T.length>0&&(c[d]=T),S.length>0&&(f[d]=S)}else c[d]=g}),this.syncDiff(a,{joins:c,leaves:f},i,r)}static syncDiff(e,t,i,r){const{joins:a,leaves:l}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(a,(c,f)=>{var d;const g=(d=e[c])!==null&&d!==void 0?d:[];if(e[c]=this.cloneDeep(f),g.length>0){const _=e[c].map(w=>w.presence_ref),v=g.filter(w=>_.indexOf(w.presence_ref)<0);e[c].unshift(...v)}i(c,g,f)}),this.map(l,(c,f)=>{let d=e[c];if(!d)return;const g=f.map(_=>_.presence_ref);d=d.filter(_=>g.indexOf(_.presence_ref)<0),e[c]=d,r(c,d,f),d.length===0&&delete e[c]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(i=>t(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,i)=>{const r=e[i];return"metas"in r?t[i]=r.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[i]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var eT;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(eT||(eT={}));var tT;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(tT||(tT={}));var hi;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(hi||(hi={}));class Jm{constructor(e,t={config:{}},i){this.topic=e,this.params=t,this.socket=i,this.bindings={},this.state=It.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new bp(this,kn.join,this.params,this.timeout),this.rejoinTimer=new FS(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=It.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=It.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=It.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=It.errored,this.rejoinTimer.scheduleTimeout())}),this._on(kn.reply,{},(r,a)=>{this._trigger(this._replyEventName(a),r)}),this.presence=new Uo(this),this.broadcastEndpointURL=zS(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var i,r;if(this.socket.isConnected()||this.socket.connect(),this.state==It.closed){const{config:{broadcast:a,presence:l,private:c}}=this.params;this._onError(g=>e?.(hi.CHANNEL_ERROR,g)),this._onClose(()=>e?.(hi.CLOSED));const f={},d={broadcast:a,presence:l,postgres_changes:(r=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(g=>g.filter))!==null&&r!==void 0?r:[],private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:d},f)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:g})=>{var _;if(this.socket.setAuth(),g===void 0){e?.(hi.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,w=(_=v?.length)!==null&&_!==void 0?_:0,T=[];for(let S=0;S<w;S++){const C=v[S],{filter:{event:x,schema:M,table:R,filter:P}}=C,O=g&&g[S];if(O&&O.event===x&&O.schema===M&&O.table===R&&O.filter===P)T.push(Object.assign(Object.assign({},C),{id:O.id}));else{this.unsubscribe(),this.state=It.errored,e?.(hi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=T,e&&e(hi.SUBSCRIBED);return}}).receive("error",g=>{this.state=It.errored,e?.(hi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e?.(hi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,i){return this._on(e,t,i)}async send(e,t={}){var i,r;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:l}=e,f={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:l,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(i=t.timeout)!==null&&i!==void 0?i:this.timeout);return await((r=d.body)===null||r===void 0?void 0:r.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var l,c,f;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((f=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||f===void 0)&&f.ack)&&a("ok"),d.receive("ok",()=>a("ok")),d.receive("error",()=>a("error")),d.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=It.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(kn.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(r=>{i=new bp(this,kn.leave,{},e),i.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,i){const r=new AbortController,a=setTimeout(()=>r.abort(),i),l=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(a),l}_push(e,t,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new bp(this,e,t,i);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,i){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,i){var r,a;const l=e.toLocaleLowerCase(),{close:c,error:f,leave:d,join:g}=kn;if(i&&[c,f,d,g].indexOf(l)>=0&&i!==this._joinRef())return;let v=this._onMessage(l,t,i);if(t&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(w=>{var T,S,C;return((T=w.filter)===null||T===void 0?void 0:T.event)==="*"||((C=(S=w.filter)===null||S===void 0?void 0:S.event)===null||C===void 0?void 0:C.toLocaleLowerCase())===l}).map(w=>w.callback(v,i)):(a=this.bindings[l])===null||a===void 0||a.filter(w=>{var T,S,C,x,M,R;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in w){const P=w.id,O=(T=w.filter)===null||T===void 0?void 0:T.event;return P&&((S=t.ids)===null||S===void 0?void 0:S.includes(P))&&(O==="*"||O?.toLocaleLowerCase()===((C=t.data)===null||C===void 0?void 0:C.type.toLocaleLowerCase()))}else{const P=(M=(x=w?.filter)===null||x===void 0?void 0:x.event)===null||M===void 0?void 0:M.toLocaleLowerCase();return P==="*"||P===((R=t?.event)===null||R===void 0?void 0:R.toLocaleLowerCase())}else return w.type.toLocaleLowerCase()===l}).map(w=>{if(typeof v=="object"&&"ids"in v){const T=v.data,{schema:S,table:C,commit_timestamp:x,type:M,errors:R}=T;v=Object.assign(Object.assign({},{schema:S,table:C,commit_timestamp:x,eventType:M,new:{},old:{},errors:R}),this._getPayloadRecords(T))}w.callback(v,i)})}_isClosed(){return this.state===It.closed}_isJoined(){return this.state===It.joined}_isJoining(){return this.state===It.joining}_isLeaving(){return this.state===It.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,i){const r=e.toLocaleLowerCase(),a={type:r,filter:t,callback:i};return this.bindings[r]?this.bindings[r].push(a):this.bindings[r]=[a],this}_off(e,t){const i=e.toLocaleLowerCase();return this.bindings[i]=this.bindings[i].filter(r=>{var a;return!(((a=r.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===i&&Jm.isEqual(r.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(e[i]!==t[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(kn.close,{},e)}_onError(e){this._on(kn.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=It.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Xw(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Xw(e.columns,e.old_record)),t}}const nT=()=>{},vD=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class bD{constructor(e,t){var i;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=VS,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=nT,this.ref=0,this.logger=nT,this.conn=null,this.sendBuffer=[],this.serializer=new dD,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=a=>{let l;return a?l=a:typeof fetch>"u"?l=(...c)=>ir(async()=>{const{default:f}=await Promise.resolve().then(()=>ha);return{default:f}},void 0).then(({default:f})=>f(...c)):l=fetch,(...c)=>l(...c)},this.endPoint=`${e}/${Wp.websocket}`,this.httpEndpoint=zS(e),t?.transport?this.transport=t.transport:this.transport=null,t?.params&&(this.params=t.params),t?.timeout&&(this.timeout=t.timeout),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const r=(i=t?.params)===null||i===void 0?void 0:i.apikey;if(r&&(this.accessTokenValue=r,this.apiKey=r),this.reconnectAfterMs=t?.reconnectAfterMs?t.reconnectAfterMs:a=>[1e3,2e3,5e3,1e4][a-1]||1e4,this.encode=t?.encode?t.encode:(a,l)=>l(JSON.stringify(a)),this.decode=t?.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new FS(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t?.fetch),t?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=t?.worker||!1,this.workerUrl=t?.workerUrl}this.accessToken=t?.accessToken||null}connect(){if(!this.conn){if(this.transport||(this.transport=oD),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:cD}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(i=>i.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,i){this.logger(e,t,i)}connectionState(){switch(this.conn&&this.conn.readyState){case Lo.connecting:return Pr.Connecting;case Lo.open:return Pr.Open;case Lo.closing:return Pr.Closing;default:return Pr.Closed}}isConnected(){return this.connectionState()===Pr.Open}channel(e,t={config:{}}){const i=`realtime:${e}`,r=this.getChannels().find(a=>a.topic===i);if(r)return r;{const a=new Jm(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:i,payload:r,ref:a}=e,l=()=>{this.encode(e,c=>{var f;(f=this.conn)===null||f===void 0||f.send(c)})};this.log("push",`${t} ${i} (${a})`,r),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(i=>{const r={access_token:t,version:uD};t&&i.updateJoinPayload(r),i.joinedOnce&&i._isJoined()&&i._push(kn.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(fD,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:i,event:r,payload:a,ref:l}=t;i==="phoenix"&&r==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),l&&l===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${a.status||""} ${i} ${r} ${l&&"("+l+")"||""}`,a),Array.from(this.channels).filter(c=>c._isMember(i)).forEach(c=>c._trigger(r,a,l)),this.stateChangeCallbacks.message.forEach(c=>c(t))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(kn.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const i=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${i}${r}`}_workerObjectUrl(e){let t;if(e)t=e;else{const i=new Blob([vD],{type:"application/javascript"});t=URL.createObjectURL(i)}return t}}class Km extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function vt(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class wD extends Km{constructor(e,t,i){super(e),this.name="StorageApiError",this.status=t,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class tm extends Km{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var TD=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(g){try{d(i.next(g))}catch(_){l(_)}}function f(g){try{d(i.throw(g))}catch(_){l(_)}}function d(g){g.done?a(g.value):r(g.value).then(c,f)}d((i=i.apply(n,e||[])).next())})};const jS=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>ir(async()=>{const{default:i}=await Promise.resolve().then(()=>ha);return{default:i}},void 0).then(({default:i})=>i(...t)):e=fetch,(...t)=>e(...t)},ED=()=>TD(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ir(()=>Promise.resolve().then(()=>ha),void 0)).Response:Response}),nm=n=>{if(Array.isArray(n))return n.map(t=>nm(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,i])=>{const r=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[r]=nm(i)}),e},SD=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var Gr=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(g){try{d(i.next(g))}catch(_){l(_)}}function f(g){try{d(i.throw(g))}catch(_){l(_)}}function d(g){g.done?a(g.value):r(g.value).then(c,f)}d((i=i.apply(n,e||[])).next())})};const wp=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),CD=(n,e,t)=>Gr(void 0,void 0,void 0,function*(){const i=yield ED();n instanceof i&&!t?.noResolveJson?n.json().then(r=>{const a=n.status||500,l=r?.statusCode||a+"";e(new wD(wp(r),a,l))}).catch(r=>{e(new tm(wp(r),r))}):e(new tm(wp(n),n))}),AD=(n,e,t,i)=>{const r={method:n,headers:e?.headers||{}};return n==="GET"||!i?r:(SD(i)?(r.headers=Object.assign({"Content-Type":"application/json"},e?.headers),r.body=JSON.stringify(i)):r.body=i,Object.assign(Object.assign({},r),t))};function ol(n,e,t,i,r,a){return Gr(this,void 0,void 0,function*(){return new Promise((l,c)=>{n(t,AD(e,i,r,a)).then(f=>{if(!f.ok)throw f;return i?.noResolveJson?f:f.json()}).then(f=>l(f)).catch(f=>CD(f,c,i))})})}function oc(n,e,t,i){return Gr(this,void 0,void 0,function*(){return ol(n,"GET",e,t,i)})}function pi(n,e,t,i,r){return Gr(this,void 0,void 0,function*(){return ol(n,"POST",e,i,r,t)})}function im(n,e,t,i,r){return Gr(this,void 0,void 0,function*(){return ol(n,"PUT",e,i,r,t)})}function RD(n,e,t,i){return Gr(this,void 0,void 0,function*(){return ol(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),i)})}function JS(n,e,t,i,r){return Gr(this,void 0,void 0,function*(){return ol(n,"DELETE",e,i,r,t)})}var Kt=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(g){try{d(i.next(g))}catch(_){l(_)}}function f(g){try{d(i.throw(g))}catch(_){l(_)}}function d(g){g.done?a(g.value):r(g.value).then(c,f)}d((i=i.apply(n,e||[])).next())})};const xD={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},iT={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ID{constructor(e,t={},i,r){this.url=e,this.headers=t,this.bucketId=i,this.fetch=jS(r)}uploadOrUpdate(e,t,i,r){return Kt(this,void 0,void 0,function*(){try{let a;const l=Object.assign(Object.assign({},iT),r);let c=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const f=l.metadata;typeof Blob<"u"&&i instanceof Blob?(a=new FormData,a.append("cacheControl",l.cacheControl),f&&a.append("metadata",this.encodeMetadata(f)),a.append("",i)):typeof FormData<"u"&&i instanceof FormData?(a=i,a.append("cacheControl",l.cacheControl),f&&a.append("metadata",this.encodeMetadata(f))):(a=i,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType,f&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(f)))),r?.headers&&(c=Object.assign(Object.assign({},c),r.headers));const d=this._removeEmptyFolders(t),g=this._getFinalPath(d),_=yield(e=="PUT"?im:pi)(this.fetch,`${this.url}/object/${g}`,a,Object.assign({headers:c},l?.duplex?{duplex:l.duplex}:{}));return{data:{path:d,id:_.Id,fullPath:_.Key},error:null}}catch(a){if(vt(a))return{data:null,error:a};throw a}})}upload(e,t,i){return Kt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,i)})}uploadToSignedUrl(e,t,i,r){return Kt(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),l=this._getFinalPath(a),c=new URL(this.url+`/object/upload/sign/${l}`);c.searchParams.set("token",t);try{let f;const d=Object.assign({upsert:iT.upsert},r),g=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&i instanceof Blob?(f=new FormData,f.append("cacheControl",d.cacheControl),f.append("",i)):typeof FormData<"u"&&i instanceof FormData?(f=i,f.append("cacheControl",d.cacheControl)):(f=i,g["cache-control"]=`max-age=${d.cacheControl}`,g["content-type"]=d.contentType);const _=yield im(this.fetch,c.toString(),f,{headers:g});return{data:{path:a,fullPath:_.Key},error:null}}catch(f){if(vt(f))return{data:null,error:f};throw f}})}createSignedUploadUrl(e,t){return Kt(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e);const r=Object.assign({},this.headers);t?.upsert&&(r["x-upsert"]="true");const a=yield pi(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:r}),l=new URL(this.url+a.url),c=l.searchParams.get("token");if(!c)throw new Km("No token returned by API");return{data:{signedUrl:l.toString(),path:e,token:c},error:null}}catch(i){if(vt(i))return{data:null,error:i};throw i}})}update(e,t,i){return Kt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,i)})}move(e,t,i){return Kt(this,void 0,void 0,function*(){try{return{data:yield pi(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:i?.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(vt(r))return{data:null,error:r};throw r}})}copy(e,t,i){return Kt(this,void 0,void 0,function*(){try{return{data:{path:(yield pi(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:i?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(vt(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,i){return Kt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),a=yield pi(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},i?.transform?{transform:i.transform}:{}),{headers:this.headers});const l=i?.download?`&download=${i.download===!0?"":i.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${l}`)},{data:a,error:null}}catch(r){if(vt(r))return{data:null,error:r};throw r}})}createSignedUrls(e,t,i){return Kt(this,void 0,void 0,function*(){try{const r=yield pi(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=i?.download?`&download=${i.download===!0?"":i.download}`:"";return{data:r.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${a}`):null})),error:null}}catch(r){if(vt(r))return{data:null,error:r};throw r}})}download(e,t){return Kt(this,void 0,void 0,function*(){const r=typeof t?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(t?.transform||{}),l=a?`?${a}`:"";try{const c=this._getFinalPath(e);return{data:yield(yield oc(this.fetch,`${this.url}/${r}/${c}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(c){if(vt(c))return{data:null,error:c};throw c}})}info(e){return Kt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const i=yield oc(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:nm(i),error:null}}catch(i){if(vt(i))return{data:null,error:i};throw i}})}exists(e){return Kt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield RD(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(vt(i)&&i instanceof tm){const r=i.originalError;if([400,404].includes(r?.status))return{data:!1,error:i}}throw i}})}getPublicUrl(e,t){const i=this._getFinalPath(e),r=[],a=t?.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&r.push(a);const c=typeof t?.transform<"u"?"render/image":"object",f=this.transformOptsToQueryString(t?.transform||{});f!==""&&r.push(f);let d=r.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${i}${d}`)}}}remove(e){return Kt(this,void 0,void 0,function*(){try{return{data:yield JS(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(vt(t))return{data:null,error:t};throw t}})}list(e,t,i){return Kt(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},xD),t),{prefix:e||""});return{data:yield pi(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},i),error:null}}catch(r){if(vt(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const MD="2.10.4",ND={"X-Client-Info":`storage-js/${MD}`};var Ls=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(g){try{d(i.next(g))}catch(_){l(_)}}function f(g){try{d(i.throw(g))}catch(_){l(_)}}function d(g){g.done?a(g.value):r(g.value).then(c,f)}d((i=i.apply(n,e||[])).next())})};class OD{constructor(e,t={},i,r){const a=new URL(e);r?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},ND),t),this.fetch=jS(i)}listBuckets(){return Ls(this,void 0,void 0,function*(){try{return{data:yield oc(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(vt(e))return{data:null,error:e};throw e}})}getBucket(e){return Ls(this,void 0,void 0,function*(){try{return{data:yield oc(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(vt(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Ls(this,void 0,void 0,function*(){try{return{data:yield pi(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(vt(i))return{data:null,error:i};throw i}})}updateBucket(e,t){return Ls(this,void 0,void 0,function*(){try{return{data:yield im(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(vt(i))return{data:null,error:i};throw i}})}emptyBucket(e){return Ls(this,void 0,void 0,function*(){try{return{data:yield pi(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(vt(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Ls(this,void 0,void 0,function*(){try{return{data:yield JS(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(vt(t))return{data:null,error:t};throw t}})}}class kD extends OD{constructor(e,t={},i,r){super(e,t,i,r)}from(e){return new ID(this.url,this.headers,e,this.fetch)}}const PD="2.53.0";let Io="";typeof Deno<"u"?Io="deno":typeof document<"u"?Io="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Io="react-native":Io="node";const DD={"X-Client-Info":`supabase-js-${Io}/${PD}`},LD={headers:DD},UD={schema:"public"},$D={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},qD={};var BD=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(g){try{d(i.next(g))}catch(_){l(_)}}function f(g){try{d(i.throw(g))}catch(_){l(_)}}function d(g){g.done?a(g.value):r(g.value).then(c,f)}d((i=i.apply(n,e||[])).next())})};const GD=n=>{let e;return n?e=n:typeof fetch>"u"?e=LS:e=fetch,(...t)=>e(...t)},VD=()=>typeof Headers>"u"?US:Headers,FD=(n,e,t)=>{const i=GD(t),r=VD();return(a,l)=>BD(void 0,void 0,void 0,function*(){var c;const f=(c=yield e())!==null&&c!==void 0?c:n;let d=new r(l?.headers);return d.has("apikey")||d.set("apikey",n),d.has("Authorization")||d.set("Authorization",`Bearer ${f}`),i(a,Object.assign(Object.assign({},l),{headers:d}))})};var HD=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(g){try{d(i.next(g))}catch(_){l(_)}}function f(g){try{d(i.throw(g))}catch(_){l(_)}}function d(g){g.done?a(g.value):r(g.value).then(c,f)}d((i=i.apply(n,e||[])).next())})};function zD(n){return n.endsWith("/")?n:n+"/"}function jD(n,e){var t,i;const{db:r,auth:a,realtime:l,global:c}=n,{db:f,auth:d,realtime:g,global:_}=e,v={db:Object.assign(Object.assign({},f),r),auth:Object.assign(Object.assign({},d),a),realtime:Object.assign(Object.assign({},g),l),storage:{},global:Object.assign(Object.assign(Object.assign({},_),c),{headers:Object.assign(Object.assign({},(t=_?.headers)!==null&&t!==void 0?t:{}),(i=c?.headers)!==null&&i!==void 0?i:{})}),accessToken:()=>HD(this,void 0,void 0,function*(){return""})};return n.accessToken?v.accessToken=n.accessToken:delete v.accessToken,v}const KS="2.71.1",Vs=30*1e3,rm=3,Tp=rm*Vs,JD="http://localhost:9999",KD="supabase.auth.token",YD={"X-Client-Info":`gotrue-js/${KS}`},sm="X-Supabase-Api-Version",YS={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ZD=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,QD=600*1e3;class Ym extends Error{constructor(e,t,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=i}}function be(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class XD extends Ym{constructor(e,t,i){super(e,t,i),this.name="AuthApiError",this.status=t,this.code=i}}function WD(n){return be(n)&&n.name==="AuthApiError"}class ZS extends Ym{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class dr extends Ym{constructor(e,t,i,r){super(e,i,r),this.name=t,this.status=i}}class Ji extends dr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function eL(n){return be(n)&&n.name==="AuthSessionMissingError"}class Lu extends dr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Uu extends dr{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class $u extends dr{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function tL(n){return be(n)&&n.name==="AuthImplicitGrantRedirectError"}class rT extends dr{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class am extends dr{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Ep(n){return be(n)&&n.name==="AuthRetryableFetchError"}class sT extends dr{constructor(e,t,i){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=i}}class om extends dr{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const lc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),aT=` 	
\r=`.split(""),nL=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<aT.length;e+=1)n[aT[e].charCodeAt(0)]=-2;for(let e=0;e<lc.length;e+=1)n[lc[e].charCodeAt(0)]=e;return n})();function oT(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(lc[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(lc[i]),e.queuedBits-=6}}function QS(n,e,t){const i=nL[n];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function lT(n){const e=[],t=l=>{e.push(String.fromCodePoint(l))},i={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},a=l=>{sL(l,i,t)};for(let l=0;l<n.length;l+=1)QS(n.charCodeAt(l),r,a);return e.join("")}function iL(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function rL(n,e){for(let t=0;t<n.length;t+=1){let i=n.charCodeAt(t);if(i>55295&&i<=56319){const r=(i-55296)*1024&65535;i=(n.charCodeAt(t+1)-56320&65535|r)+65536,t+=1}iL(i,e)}}function sL(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let i=1;i<6;i+=1)if((n>>7-i&1)===0){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function aL(n){const e=[],t={queue:0,queuedBits:0},i=r=>{e.push(r)};for(let r=0;r<n.length;r+=1)QS(n.charCodeAt(r),t,i);return new Uint8Array(e)}function oL(n){const e=[];return rL(n,t=>e.push(t)),new Uint8Array(e)}function lL(n){const e=[],t={queue:0,queuedBits:0},i=r=>{e.push(r)};return n.forEach(r=>oT(r,t,i)),oT(null,t,i),e.join("")}function uL(n){return Math.round(Date.now()/1e3)+n}function cL(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const On=()=>typeof window<"u"&&typeof document<"u",Nr={tested:!1,writable:!1},XS=()=>{if(!On())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Nr.tested)return Nr.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Nr.tested=!0,Nr.writable=!0}catch{Nr.tested=!0,Nr.writable=!1}return Nr.writable};function fL(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((r,a)=>{e[a]=r})}catch{}return t.searchParams.forEach((i,r)=>{e[r]=i}),e}const WS=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>ir(async()=>{const{default:i}=await Promise.resolve().then(()=>ha);return{default:i}},void 0).then(({default:i})=>i(...t)):e=fetch,(...t)=>e(...t)},dL=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Fs=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Or=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},ji=async(n,e)=>{await n.removeItem(e)};class Ac{constructor(){this.promise=new Ac.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Ac.promiseConstructor=Promise;function Sp(n){const e=n.split(".");if(e.length!==3)throw new om("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!ZD.test(e[i]))throw new om("JWT not in base64url format");return{header:JSON.parse(lT(e[0])),payload:JSON.parse(lT(e[1])),signature:aL(e[2]),raw:{header:e[0],payload:e[1]}}}async function hL(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function pL(n,e){return new Promise((i,r)=>{(async()=>{for(let a=0;a<1/0;a++)try{const l=await n(a);if(!e(a,null,l)){i(l);return}}catch(l){if(!e(a,l)){r(l);return}}})()})}function mL(n){return("0"+n.toString(16)).substr(-2)}function gL(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=t.length;let r="";for(let a=0;a<56;a++)r+=t.charAt(Math.floor(Math.random()*i));return r}return crypto.getRandomValues(e),Array.from(e,mL).join("")}async function yL(n){const t=new TextEncoder().encode(n),i=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(i);return Array.from(r).map(a=>String.fromCharCode(a)).join("")}async function _L(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await yL(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Us(n,e,t=!1){const i=gL();let r=i;t&&(r+="/PASSWORD_RECOVERY"),await Fs(n,`${e}-code-verifier`,r);const a=await _L(i);return[a,i===a?"plain":"s256"]}const vL=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function bL(n){const e=n.headers.get(sm);if(!e||!e.match(vL))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function wL(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function TL(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const EL=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function $s(n){if(!EL.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Cp(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const i=t.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function uT(n){return JSON.parse(JSON.stringify(n))}var SL=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t};const kr=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),CL=[502,503,504];async function cT(n){var e;if(!dL(n))throw new am(kr(n),0);if(CL.includes(n.status))throw new am(kr(n),n.status);let t;try{t=await n.json()}catch(a){throw new ZS(kr(a),a)}let i;const r=bL(n);if(r&&r.getTime()>=YS["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?i=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(i=t.error_code),i){if(i==="weak_password")throw new sT(kr(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new Ji}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,l)=>a&&typeof l=="string",!0))throw new sT(kr(t),n.status,t.weak_password.reasons);throw new XD(kr(t),n.status||500,i)}const AL=(n,e,t,i)=>{const r={method:n,headers:e?.headers||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),t))};async function Me(n,e,t,i){var r;const a=Object.assign({},i?.headers);a[sm]||(a[sm]=YS["2024-01-01"].name),i?.jwt&&(a.Authorization=`Bearer ${i.jwt}`);const l=(r=i?.query)!==null&&r!==void 0?r:{};i?.redirectTo&&(l.redirect_to=i.redirectTo);const c=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",f=await RL(n,e,t+c,{headers:a,noResolveJson:i?.noResolveJson},{},i?.body);return i?.xform?i?.xform(f):{data:Object.assign({},f),error:null}}async function RL(n,e,t,i,r,a){const l=AL(e,i,r,a);let c;try{c=await n(t,Object.assign({},l))}catch(f){throw console.error(f),new am(kr(f),0)}if(c.ok||await cT(c),i?.noResolveJson)return c;try{return await c.json()}catch(f){await cT(f)}}function di(n){var e;let t=null;NL(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=uL(n.expires_in)));const i=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:i},error:null}}function fT(n){const e=di(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,i)=>t&&typeof i=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Xi(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function xL(n){return{data:n,error:null}}function IL(n){const{action_link:e,email_otp:t,hashed_token:i,redirect_to:r,verification_type:a}=n,l=SL(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:t,hashed_token:i,redirect_to:r,verification_type:a},f=Object.assign({},l);return{data:{properties:c,user:f},error:null}}function ML(n){return n}function NL(n){return n.access_token&&n.refresh_token&&n.expires_in}const Ap=["global","local","others"];var OL=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t};class kL{constructor({url:e="",headers:t={},fetch:i}){this.url=e,this.headers=t,this.fetch=WS(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Ap[0]){if(Ap.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Ap.join(", ")}`);try{return await Me(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if(be(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,t={}){try{return await Me(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Xi})}catch(i){if(be(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:t}=e,i=OL(e,["options"]),r=Object.assign(Object.assign({},i),t);return"newEmail"in i&&(r.new_email=i?.newEmail,delete r.newEmail),await Me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:IL,redirectTo:t?.redirectTo})}catch(t){if(be(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Me(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Xi})}catch(t){if(be(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,i,r,a,l,c,f;try{const d={nextPage:null,lastPage:0,total:0},g=await Me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(a=(r=e?.perPage)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:""},xform:ML});if(g.error)throw g.error;const _=await g.json(),v=(l=g.headers.get("x-total-count"))!==null&&l!==void 0?l:0,w=(f=(c=g.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&f!==void 0?f:[];return w.length>0&&(w.forEach(T=>{const S=parseInt(T.split(";")[0].split("=")[1].substring(0,1)),C=JSON.parse(T.split(";")[1].split("=")[1]);d[`${C}Page`]=S}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},_),d),error:null}}catch(d){if(be(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){$s(e);try{return await Me(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Xi})}catch(t){if(be(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){$s(e);try{return await Me(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Xi})}catch(i){if(be(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,t=!1){$s(e);try{return await Me(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Xi})}catch(i){if(be(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){$s(e.userId);try{const{data:t,error:i}=await Me(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:t,error:i}}catch(t){if(be(t))return{data:null,error:t};throw t}}async _deleteFactor(e){$s(e.userId),$s(e.id);try{return{data:await Me(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(be(t))return{data:null,error:t};throw t}}}function dT(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function PL(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const qs={debug:!!(globalThis&&XS()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class eC extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class DL extends eC{}async function LL(n,e,t){qs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const i=new globalThis.AbortController;return e>0&&setTimeout(()=>{i.abort(),qs.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async r=>{if(r){qs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,r.name);try{return await t()}finally{qs.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,r.name)}}else{if(e===0)throw qs.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new DL(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(qs.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}PL();const UL={url:JD,storageKey:KD,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:YD,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function hT(n,e,t){return await t()}const Bs={};class Zo{constructor(e){var t,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Zo.nextInstanceID,Zo.nextInstanceID+=1,this.instanceID>0&&On()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},UL),e);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new kL({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=WS(r.fetch),this.lock=r.lock||hT,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:On()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=LL:this.lock=hT,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(r.storage?this.storage=r.storage:XS()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=dT(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=dT(this.memoryStorage)),On()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=Bs[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Bs[this.storageKey]=Object.assign(Object.assign({},Bs[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Bs[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Bs[this.storageKey]=Object.assign(Object.assign({},Bs[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${KS}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=fL(window.location.href);let i="none";if(this._isImplicitGrantCallback(t)?i="implicit":await this._isPKCECallback(t)&&(i="pkce"),On()&&this.detectSessionInUrl&&i!=="none"){const{data:r,error:a}=await this._getSessionFromURL(t,i);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),tL(a)){const f=(e=a.details)===null||e===void 0?void 0:e.code;if(f==="identity_already_exists"||f==="identity_not_found"||f==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:l,redirectType:c}=r;return this._debug("#_initialize()","detected session in URL",l,"redirect type",c),await this._saveSession(l),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return be(t)?{error:t}:{error:new ZS("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,i,r;try{const a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(r=e?.options)===null||r===void 0?void 0:r.captchaToken}},xform:di}),{data:l,error:c}=a;if(c||!l)return{data:{user:null,session:null},error:c};const f=l.session,d=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",f)),{data:{user:d,session:f},error:null}}catch(a){if(be(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,i,r;try{let a;if("email"in e){const{email:g,password:_,options:v}=e;let w=null,T=null;this.flowType==="pkce"&&([w,T]=await Us(this.storage,this.storageKey)),a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v?.emailRedirectTo,body:{email:g,password:_,data:(t=v?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:w,code_challenge_method:T},xform:di})}else if("phone"in e){const{phone:g,password:_,options:v}=e;a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:_,data:(i=v?.data)!==null&&i!==void 0?i:{},channel:(r=v?.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:v?.captchaToken}},xform:di})}else throw new Uu("You must provide either an email or phone number and a password");const{data:l,error:c}=a;if(c||!l)return{data:{user:null,session:null},error:c};const f=l.session,d=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",f)),{data:{user:d,session:f},error:null}}catch(a){if(be(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:l,options:c}=e;t=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:l,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:fT})}else if("phone"in e){const{phone:a,password:l,options:c}=e;t=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:l,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:fT})}else throw new Uu("You must provide either an email or phone number and a password");const{data:i,error:r}=t;return r?{data:{user:null,session:null},error:r}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new Lu}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:r})}catch(t){if(be(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,i,r,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,i,r,a,l,c,f,d,g,_,v,w;let T,S;if("message"in e)T=e.message,S=e.signature;else{const{chain:C,wallet:x,statement:M,options:R}=e;let P;if(On())if(typeof x=="object")P=x;else{const V=window;if("solana"in V&&typeof V.solana=="object"&&("signIn"in V.solana&&typeof V.solana.signIn=="function"||"signMessage"in V.solana&&typeof V.solana.signMessage=="function"))P=V.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!R?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");P=x}const O=new URL((t=R?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in P&&P.signIn){const V=await P.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},R?.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),M?{statement:M}:null));let J;if(Array.isArray(V)&&V[0]&&typeof V[0]=="object")J=V[0];else if(V&&typeof V=="object"&&"signedMessage"in V&&"signature"in V)J=V;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in J&&"signature"in J&&(typeof J.signedMessage=="string"||J.signedMessage instanceof Uint8Array)&&J.signature instanceof Uint8Array)T=typeof J.signedMessage=="string"?J.signedMessage:new TextDecoder().decode(J.signedMessage),S=J.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in P)||typeof P.signMessage!="function"||!("publicKey"in P)||typeof P!="object"||!P.publicKey||!("toBase58"in P.publicKey)||typeof P.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");T=[`${O.host} wants you to sign in with your Solana account:`,P.publicKey.toBase58(),...M?["",M,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(r=(i=R?.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((a=R?.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${R.signInWithSolana.notBefore}`]:[],...!((l=R?.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${R.signInWithSolana.expirationTime}`]:[],...!((c=R?.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${R.signInWithSolana.chainId}`]:[],...!((f=R?.signInWithSolana)===null||f===void 0)&&f.nonce?[`Nonce: ${R.signInWithSolana.nonce}`]:[],...!((d=R?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${R.signInWithSolana.requestId}`]:[],...!((_=(g=R?.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||_===void 0)&&_.length?["Resources",...R.signInWithSolana.resources.map(J=>`- ${J}`)]:[]].join(`
`);const V=await P.signMessage(new TextEncoder().encode(T),"utf8");if(!V||!(V instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");S=V}}try{const{data:C,error:x}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:T,signature:lL(S)},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(w=e.options)===null||w===void 0?void 0:w.captchaToken}}:null),xform:di});if(x)throw x;return!C||!C.session||!C.user?{data:{user:null,session:null},error:new Lu}:(C.session&&(await this._saveSession(C.session),await this._notifyAllSubscribers("SIGNED_IN",C.session)),{data:Object.assign({},C),error:x})}catch(C){if(be(C))return{data:{user:null,session:null},error:C};throw C}}async _exchangeCodeForSession(e){const t=await Or(this.storage,`${this.storageKey}-code-verifier`),[i,r]=(t??"").split("/");try{const{data:a,error:l}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:di});if(await ji(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Lu}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:r??null}),error:l})}catch(a){if(be(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:i,token:r,access_token:a,nonce:l}=e,c=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:r,access_token:a,nonce:l,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:di}),{data:f,error:d}=c;return d?{data:{user:null,session:null},error:d}:!f||!f.session||!f.user?{data:{user:null,session:null},error:new Lu}:(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),{data:f,error:d})}catch(t){if(be(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,i,r,a,l;try{if("email"in e){const{email:c,options:f}=e;let d=null,g=null;this.flowType==="pkce"&&([d,g]=await Us(this.storage,this.storageKey));const{error:_}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(t=f?.data)!==null&&t!==void 0?t:{},create_user:(i=f?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:d,code_challenge_method:g},redirectTo:f?.emailRedirectTo});return{data:{user:null,session:null},error:_}}if("phone"in e){const{phone:c,options:f}=e,{data:d,error:g}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(r=f?.data)!==null&&r!==void 0?r:{},create_user:(a=f?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},channel:(l=f?.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:d?.message_id},error:g}}throw new Uu("You must provide either an email or phone number.")}catch(c){if(be(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(e){var t,i;try{let r,a;"options"in e&&(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:l,error:c}=await Me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:r,xform:di});if(c)throw c;if(!l)throw new Error("An error occurred on token verification.");const f=l.session,d=l.user;return f?.access_token&&(await this._saveSession(f),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",f)),{data:{user:d,session:f},error:null}}catch(r){if(be(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,i,r;try{let a=null,l=null;return this.flowType==="pkce"&&([a,l]=await Us(this.storage,this.storageKey)),await Me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&i!==void 0?i:void 0}),!((r=e?.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:l}),headers:this.headers,xform:xL})}catch(a){if(be(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;if(i)throw i;if(!t)throw new Ji;const{error:r}=await Me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(be(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:i,type:r,options:a}=e,{error:l}=await Me(this.fetch,"POST",t,{headers:this.headers,body:{email:i,type:r,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in e){const{phone:i,type:r,options:a}=e,{data:l,error:c}=await Me(this.fetch,"POST",t,{headers:this.headers,body:{phone:i,type:r,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return{data:{user:null,session:null,messageId:l?.message_id},error:c}}throw new Uu("You must provide either an email or phone number and a type")}catch(t){if(be(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await i,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=t();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Or(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at*1e3-Date.now()<Tp:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){const l=await Or(this.userStorage,this.storageKey+"-user");l?.user?e.user=l.user:e.user=Cp()}if(this.storage.isServer&&e.user){let l=this.suppressGetSessionWarning;e=new Proxy(e,{get:(f,d,g)=>(!l&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(f,d,g))})}return{data:{session:e},error:null}}const{session:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Xi}):await this._useSession(async t=>{var i,r,a;const{data:l,error:c}=t;if(c)throw c;return!(!((i=l.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ji}:await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(r=l.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0,xform:Xi})})}catch(t){if(be(t))return eL(t)&&(await this._removeSession(),await ji(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async i=>{const{data:r,error:a}=i;if(a)throw a;if(!r.session)throw new Ji;const l=r.session;let c=null,f=null;this.flowType==="pkce"&&e.email!=null&&([c,f]=await Us(this.storage,this.storageKey));const{data:d,error:g}=await Me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:f}),jwt:l.access_token,xform:Xi});if(g)throw g;return l.user=d.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(i){if(be(i))return{data:{user:null},error:i};throw i}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ji;const t=Date.now()/1e3;let i=t,r=!0,a=null;const{payload:l}=Sp(e.access_token);if(l.exp&&(i=l.exp,r=i<=t),r){const{session:c,error:f}=await this._callRefreshToken(e.refresh_token);if(f)return{data:{user:null,session:null},error:f};if(!c)return{data:{user:null,session:null},error:null};a=c}else{const{data:c,error:f}=await this._getUser(e.access_token);if(f)throw f;a={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:i-t,expires_at:i},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(be(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var i;if(!e){const{data:l,error:c}=t;if(c)throw c;e=(i=l.session)!==null&&i!==void 0?i:void 0}if(!e?.refresh_token)throw new Ji;const{session:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(be(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!On())throw new $u("No browser detected.");if(e.error||e.error_description||e.error_code)throw new $u(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new rT("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new $u("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new rT("No code detected.");const{data:M,error:R}=await this._exchangeCodeForSession(e.code);if(R)throw R;const P=new URL(window.location.href);return P.searchParams.delete("code"),window.history.replaceState(window.history.state,"",P.toString()),{data:{session:M.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:r,access_token:a,refresh_token:l,expires_in:c,expires_at:f,token_type:d}=e;if(!a||!c||!l||!d)throw new $u("No session defined in URL");const g=Math.round(Date.now()/1e3),_=parseInt(c);let v=g+_;f&&(v=parseInt(f));const w=v-g;w*1e3<=Vs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${w}s, should have been closer to ${_}s`);const T=v-_;g-T>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",T,v,g):g-T<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",T,v,g);const{data:S,error:C}=await this._getUser(a);if(C)throw C;const x={provider_token:i,provider_refresh_token:r,access_token:a,expires_in:_,expires_at:v,refresh_token:l,token_type:d,user:S.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:e.type},error:null}}catch(i){if(be(i))return{data:{session:null,redirectType:null},error:i};throw i}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Or(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var i;const{data:r,error:a}=t;if(a)return{error:a};const l=(i=r.session)===null||i===void 0?void 0:i.access_token;if(l){const{error:c}=await this.admin.signOut(l,e);if(c&&!(WD(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return e!=="others"&&(await this._removeSession(),await ji(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=cL(),i={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async t=>{var i,r;try{const{data:{session:a},error:l}=t;if(l)throw l;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let i=null,r=null;this.flowType==="pkce"&&([i,r]=await Us(this.storage,this.storageKey,!0));try{return await Me(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(be(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:i}=await this.getUser();if(i)throw i;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(be(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:i,error:r}=await this._useSession(async a=>{var l,c,f,d,g;const{data:_,error:v}=a;if(v)throw v;const w=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(f=e.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return await Me(this.fetch,"GET",w,{headers:this.headers,jwt:(g=(d=_.session)===null||d===void 0?void 0:d.access_token)!==null&&g!==void 0?g:void 0})});if(r)throw r;return On()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(i?.url),{data:{provider:e.provider,url:i?.url},error:null}}catch(i){if(be(i))return{data:{provider:e.provider,url:null},error:i};throw i}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var i,r;const{data:a,error:l}=t;if(l)throw l;return await Me(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&r!==void 0?r:void 0})})}catch(t){if(be(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await pL(async r=>(r>0&&await hL(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await Me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:di})),(r,a)=>{const l=200*Math.pow(2,r);return a&&Ep(a)&&Date.now()+l-i<Vs})}catch(i){if(this._debug(t,"error",i),be(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",i),On()&&!t.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,t;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const r=await Or(this.storage,this.storageKey);if(r&&this.userStorage){let l=await Or(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:r.user},await Fs(this.userStorage,this.storageKey+"-user",l)),r.user=(e=l?.user)!==null&&e!==void 0?e:Cp()}else if(r&&!r.user&&!r.user){const l=await Or(this.storage,this.storageKey+"-user");l&&l?.user?(r.user=l.user,await ji(this.storage,this.storageKey+"-user"),await Fs(this.storage,this.storageKey,r)):r.user=Cp()}if(this._debug(i,"session from storage",r),!this._isValidSession(r)){this._debug(i,"session is not valid"),r!==null&&await this._removeSession();return}const a=((t=r.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Tp;if(this._debug(i,`session has${a?"":" not"} expired with margin of ${Tp}s`),a){if(this.autoRefreshToken&&r.refresh_token){const{error:l}=await this._callRefreshToken(r.refresh_token);l&&(console.error(l),Ep(l)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:c}=await this._getUser(r.access_token);!c&&l?.user?(r.user=l.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(i,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(i,"error",r),console.error(r);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var t,i;if(!e)throw new Ji;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Ac;const{data:a,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!a.session)throw new Ji;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const c={session:a.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(a){if(this._debug(r,"error",a),be(a)){const l={session:null,error:a};return Ep(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(l),l}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(a),a}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,i=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],l=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,t)}catch(f){a.push(f)}});if(await Promise.all(l),a.length>0){for(let c=0;c<a.length;c+=1)console.error(a[c]);throw a[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),i=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&t.user&&await Fs(this.userStorage,this.storageKey+"-user",{user:t.user});const r=Object.assign({},t);delete r.user;const a=uT(r);await Fs(this.storage,this.storageKey,a)}else{const r=uT(t);await Fs(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),await ji(this.storage,this.storageKey),await ji(this.storage,this.storageKey+"-code-verifier"),await ji(this.storage,this.storageKey+"-user"),this.userStorage&&await ji(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&On()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Vs);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:i}}=t;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((i.expires_at*1e3-e)/Vs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${Vs}ms, refresh threshold is ${rm} ticks`),r<=rm&&await this._callRefreshToken(i.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof eC)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!On()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,i){const r=[`provider=${encodeURIComponent(t)}`];if(i?.redirectTo&&r.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i?.scopes&&r.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[a,l]=await Us(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(l)}`});r.push(c.toString())}if(i?.queryParams){const a=new URLSearchParams(i.queryParams);r.push(a.toString())}return i?.skipBrowserRedirect&&r.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var i;const{data:r,error:a}=t;return a?{data:null,error:a}:await Me(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=r?.session)===null||i===void 0?void 0:i.access_token})})}catch(t){if(be(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var i,r;const{data:a,error:l}=t;if(l)return{data:null,error:l};const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:f,error:d}=await Me(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(i=a?.session)===null||i===void 0?void 0:i.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((r=f?.totp)===null||r===void 0)&&r.qr_code)&&(f.totp.qr_code=`data:image/svg+xml;utf-8,${f.totp.qr_code}`),{data:f,error:null})})}catch(t){if(be(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var i;const{data:r,error:a}=t;if(a)return{data:null,error:a};const{data:l,error:c}=await Me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(i=r?.session)===null||i===void 0?void 0:i.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:c})})}catch(t){if(be(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var i;const{data:r,error:a}=t;return a?{data:null,error:a}:await Me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(i=r?.session)===null||i===void 0?void 0:i.access_token})})}catch(t){if(be(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:i}=await this._challenge({factorId:e.factorId});return i?{data:null,error:i}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const i=e?.factors||[],r=i.filter(l=>l.factor_type==="totp"&&l.status==="verified"),a=i.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:i,totp:r,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,i;const{data:{session:r},error:a}=e;if(a)return{data:null,error:a};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=Sp(r.access_token);let c=null;l.aal&&(c=l.aal);let f=c;((i=(t=r.user.factors)===null||t===void 0?void 0:t.filter(_=>_.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(f="aal2");const g=l.amr||[];return{data:{currentLevel:c,nextLevel:f,currentAuthenticationMethods:g},error:null}}))}async fetchJwk(e,t={keys:[]}){let i=t.keys.find(c=>c.kid===e);if(i)return i;const r=Date.now();if(i=this.jwks.keys.find(c=>c.kid===e),i&&this.jwks_cached_at+QD>r)return i;const{data:a,error:l}=await Me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=r,i=a.keys.find(c=>c.kid===e),!i)?null:i}async getClaims(e,t={}){try{let i=e;if(!i){const{data:w,error:T}=await this.getSession();if(T||!w.session)return{data:null,error:T};i=w.session.access_token}const{header:r,payload:a,signature:l,raw:{header:c,payload:f}}=Sp(i);t?.allowExpired||wL(a.exp);const d=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!d){const{error:w}=await this.getUser(i);if(w)throw w;return{data:{claims:a,header:r,signature:l},error:null}}const g=TL(r.alg),_=await crypto.subtle.importKey("jwk",d,g,!0,["verify"]);if(!await crypto.subtle.verify(g,_,l,oL(`${c}.${f}`)))throw new om("Invalid JWT signature");return{data:{claims:a,header:r,signature:l},error:null}}catch(i){if(be(i))return{data:null,error:i};throw i}}}Zo.nextInstanceID=0;const $L=Zo;class qL extends $L{constructor(e){super(e)}}var BL=function(n,e,t,i){function r(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(g){try{d(i.next(g))}catch(_){l(_)}}function f(g){try{d(i.throw(g))}catch(_){l(_)}}function d(g){g.done?a(g.value):r(g.value).then(c,f)}d((i=i.apply(n,e||[])).next())})};class GL{constructor(e,t,i){var r,a,l;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const c=zD(e),f=new URL(c);this.realtimeUrl=new URL("realtime/v1",f),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",f),this.storageUrl=new URL("storage/v1",f),this.functionsUrl=new URL("functions/v1",f);const d=`sb-${f.hostname.split(".")[0]}-auth-token`,g={db:UD,realtime:qD,auth:Object.assign(Object.assign({},$D),{storageKey:d}),global:LD},_=jD(i??{},g);this.storageKey=(r=_.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(a=_.global.headers)!==null&&a!==void 0?a:{},_.accessToken?(this.accessToken=_.accessToken,this.auth=new Proxy({},{get:(v,w)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(w)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=_.auth)!==null&&l!==void 0?l:{},this.headers,_.global.fetch),this.fetch=FD(t,this._getAccessToken.bind(this),_.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},_.realtime)),this.rest=new sD(new URL("rest/v1",f).href,{headers:this.headers,schema:_.db.schema,fetch:this.fetch}),this.storage=new kD(this.storageUrl.href,this.headers,this.fetch,i?.storage),_.accessToken||this._listenForAuthEvents()}get functions(){return new JP(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},i={}){return this.rest.rpc(e,t,i)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return BL(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:i}=yield this.auth.getSession();return(t=(e=i.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:i,storage:r,storageKey:a,flowType:l,lock:c,debug:f},d,g){const _={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new qL({url:this.authUrl.href,headers:Object.assign(Object.assign({},_),d),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:i,storage:r,flowType:l,lock:c,debug:f,fetch:g,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new bD(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,i)=>{this._handleTokenChanged(t,"CLIENT",i?.access_token)})}_handleTokenChanged(e,t,i){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==i?this.changedAccessToken=i:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const VL=(n,e,t)=>new GL(n,e,t);function FL(){if(typeof window<"u"||typeof process>"u"||process.version===void 0||process.version===null)return!1;const n=process.version.match(/^v(\d+)\./);return n?parseInt(n[1],10)<=18:!1}FL()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const HL="https://pgcbytcrwhfwrqgxdwjl.supabase.co",zL="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBnY2J5dGNyd2hmd3JxZ3hkd2psIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQxMjI4NDQsImV4cCI6MjA2OTY5ODg0NH0.jZt0x5FQCGSfLWKf2X8K-WlLG9_KL2yR5CytERswCss",jL=VL(HL,zL),JL=new Hm(UP,{client:jL,tableName:"documents",queryName:"match_documents"}),KL=JL.asRetriever();async function pT(n,e){const i=tr.fromTemplate("Given a question, convert it to a standalone question. question: {question} standalone question:"),a=tr.fromTemplate(`You are a friendly DSA study buddy.

Rules:
- Use only the provided context & convo_history.
- Never repeat earlier answers.
- If unsure, say: "I’m sorry, I don’t know the answer to that."
- Reply like you’re texting a close friend.

context: {context}
convo_history: {convo_history}
question: {question}
answer: >>`),l=i.pipe(qw).pipe(new kw),c=Pn.from([v=>v.standalone_question,KL,v=>v.map(w=>w.pageContent).join(`
`)]),f=a.pipe(qw).pipe(new kw),d=Pn.from([{standalone_question:l,question:new Yo,convo_history:()=>e.map((v,w)=>w%2===0?`Human: ${v}`:`AI: ${v}`).join(`
`)},{context:c,question:({question:v})=>v,convo_history:({convo_history:v})=>v},f]),g=n;return await d.invoke({question:g})}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let YL,ZL;function QL(){return{geminiUrl:YL,vertexUrl:ZL}}function XL(n,e,t,i){var r,a;if(!n?.baseUrl){const l=QL();return e?(r=l.vertexUrl)!==null&&r!==void 0?r:t:(a=l.geminiUrl)!==null&&a!==void 0?a:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Vr{}function ue(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){const a=e[r];return a!=null?String(a):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function p(n,e,t){for(let a=0;a<e.length-1;a++){const l=e[a];if(l.endsWith("[]")){const c=l.slice(0,-2);if(!(c in n))if(Array.isArray(t))n[c]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(n[c])){const f=n[c];if(Array.isArray(t))for(let d=0;d<f.length;d++){const g=f[d];p(g,e.slice(a+1),t[d])}else for(const d of f)p(d,e.slice(a+1),t)}return}else if(l.endsWith("[0]")){const c=l.slice(0,-3);c in n||(n[c]=[{}]);const f=n[c];p(f[0],e.slice(a+1),t);return}(!n[l]||typeof n[l]!="object")&&(n[l]={}),n=n[l]}const i=e[e.length-1],r=n[i];if(r!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===r)return;if(typeof r=="object"&&typeof t=="object"&&r!==null&&t!==null)Object.assign(r,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else n[i]=t}function h(n,e){try{if(e.length===1&&e[0]==="_self")return n;for(let t=0;t<e.length;t++){if(typeof n!="object"||n===null)return;const i=e[t];if(i.endsWith("[]")){const r=i.slice(0,-2);if(r in n){const a=n[r];return Array.isArray(a)?a.map(l=>h(l,e.slice(t+1))):void 0}else return}else n=n[i]}return n}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function lm(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var mT;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(mT||(mT={}));var gT;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(gT||(gT={}));var nr;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(nr||(nr={}));var yT;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(yT||(yT={}));var _T;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(_T||(_T={}));var vT;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(vT||(vT={}));var bT;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(bT||(bT={}));var wT;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(wT||(wT={}));var TT;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(TT||(TT={}));var ET;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(ET||(ET={}));var ST;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(ST||(ST={}));var CT;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(CT||(CT={}));var AT;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(AT||(AT={}));var RT;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(RT||(RT={}));var xT;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY"})(xT||(xT={}));var IT;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(IT||(IT={}));var uc;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(uc||(uc={}));var MT;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(MT||(MT={}));var um;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(um||(um={}));var NT;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(NT||(NT={}));var OT;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(OT||(OT={}));var kT;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(kT||(kT={}));var PT;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(PT||(PT={}));var DT;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(DT||(DT={}));var LT;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(LT||(LT={}));var UT;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(UT||(UT={}));var $T;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})($T||($T={}));var qT;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(qT||(qT={}));var BT;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(BT||(BT={}));var GT;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(GT||(GT={}));var VT;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(VT||(VT={}));var FT;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(FT||(FT={}));var HT;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(HT||(HT={}));var zT;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(zT||(zT={}));var jT;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(jT||(jT={}));var JT;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(JT||(JT={}));var KT;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(KT||(KT={}));var YT;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(YT||(YT={}));var ZT;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(ZT||(ZT={}));var QT;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(QT||(QT={}));var XT;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(XT||(XT={}));var Js;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Js||(Js={}));class cm{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class So{get text(){var e,t,i,r,a,l,c,f;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",g=!1;const _=[];for(const v of(f=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&f!==void 0?f:[]){for(const[w,T]of Object.entries(v))w!=="text"&&w!=="thought"&&(T!==null||T!==void 0)&&_.push(w);if(typeof v.text=="string"){if(typeof v.thought=="boolean"&&v.thought)continue;g=!0,d+=v.text}}return _.length>0&&console.warn(`there are non-text parts ${_} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),g?d:void 0}get data(){var e,t,i,r,a,l,c,f;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const g=[];for(const _ of(f=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&f!==void 0?f:[]){for(const[v,w]of Object.entries(_))v!=="inlineData"&&(w!==null||w!==void 0)&&g.push(v);_.inlineData&&typeof _.inlineData.data=="string"&&(d+=atob(_.inlineData.data))}return g.length>0&&console.warn(`there are non-data parts ${g} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,t,i,r,a,l,c,f;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(f=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||f===void 0?void 0:f.filter(g=>g.functionCall).map(g=>g.functionCall).filter(g=>g!==void 0);if(d?.length!==0)return d}get executableCode(){var e,t,i,r,a,l,c,f,d;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const g=(f=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||f===void 0?void 0:f.filter(_=>_.executableCode).map(_=>_.executableCode).filter(_=>_!==void 0);if(g?.length!==0)return(d=g?.[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,t,i,r,a,l,c,f,d;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const g=(f=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||f===void 0?void 0:f.filter(_=>_.codeExecutionResult).map(_=>_.codeExecutionResult).filter(_=>_!==void 0);if(g?.length!==0)return(d=g?.[0])===null||d===void 0?void 0:d.output}}class WT{}class eE{}class WL{}class eU{}class tE{}class nE{}class iE{}class tU{}class rE{}class sE{}class aE{}class oE{}class nU{}class iU{}class rU{}class lE{}class sU{get text(){var e,t,i;let r="",a=!1;const l=[];for(const c of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[f,d]of Object.entries(c))f!=="text"&&f!=="thought"&&d!==null&&l.push(f);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;a=!0,r+=c.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?r:void 0}get data(){var e,t,i;let r="";const a=[];for(const l of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[c,f]of Object.entries(l))c!=="inlineData"&&f!==null&&a.push(c);l.inlineData&&typeof l.inlineData.data=="string"&&(r+=atob(l.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class cc{_fromAPIResponse({apiResponse:e,isVertexAI:t}){const i=new cc;if(i.name=e.name,i.metadata=e.metadata,i.done=e.done,i.error=e.error,t){const r=e.response;if(r){const a=new rE,l=r.videos;a.generatedVideos=l?.map(c=>({video:{uri:c.gcsUri,videoBytes:c.bytesBase64Encoded?lm(c.bytesBase64Encoded):void 0,mimeType:c.mimeType}})),a.raiMediaFilteredCount=r.raiMediaFilteredCount,a.raiMediaFilteredReasons=r.raiMediaFilteredReasons,i.response=a}}else{const r=e.response;if(r){const a=new rE,l=r.generateVideoResponse,c=l?.generatedSamples;a.generatedVideos=c?.map(f=>{const d=f.video;return{video:{uri:d?.uri,videoBytes:d?.encodedVideo?lm(d?.encodedVideo):void 0,mimeType:f.encoding}}}),a.raiMediaFilteredCount=l?.raiMediaFilteredCount,a.raiMediaFilteredReasons=l?.raiMediaFilteredReasons,i.response=a}}return i}}class aU{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Fe(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function tC(n,e){const t=Fe(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function nC(n){return Array.isArray(n)?n.map(e=>fc(e)):[fc(n)]}function fc(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function iC(n){const e=fc(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function rC(n){const e=fc(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function uE(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function sC(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>uE(e)):[uE(n)]}function fm(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function cE(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function fE(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function kt(n){if(n==null)throw new Error("ContentUnion is required");return fm(n)?n:{role:"user",parts:sC(n)}}function aC(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=kt(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=kt(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>kt(t)):[kt(e)]}function En(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(cE(n)||fE(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[kt(n)]}const e=[],t=[],i=fm(n[0]);for(const r of n){const a=fm(r);if(a!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(r);else{if(cE(r)||fE(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(r)}}return i||e.push({role:"user",parts:sC(t)}),e}function oU(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(nr).includes(t[0].toUpperCase())?t[0].toUpperCase():nr.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(nr).includes(i.toUpperCase())?i.toUpperCase():nr.TYPE_UNSPECIFIED})}}function Ks(n){const e={},t=["items"],i=["anyOf"],r=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=n.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,n=a[1]):a[1].type==="null"&&(e.nullable=!0,n=a[0])),n.type instanceof Array&&oU(n.type,e);for(const[l,c]of Object.entries(n))if(c!=null)if(l=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values(nr).includes(c.toUpperCase())?c.toUpperCase():nr.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=Ks(c);else if(i.includes(l)){const f=[];for(const d of c){if(d.type=="null"){e.nullable=!0;continue}f.push(Ks(d))}e[l]=f}else if(r.includes(l)){const f={};for(const[d,g]of Object.entries(c))f[d]=Ks(g);e[l]=f}else{if(l==="additionalProperties")continue;e[l]=c}return e}function Zm(n){return Ks(n)}function Qm(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Xm(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function pa(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Ks(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Ks(e.response));return n}function ma(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function lU(n,e,t,i=1){const r=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:r?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:r?`${t}/${e}`:e}function _i(n,e){if(typeof e!="string")throw new Error("name must be a string");return lU(n,e,"cachedContents")}function oC(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Fr(n){return lm(n)}function uU(n){return n!=null&&typeof n=="object"&&"name"in n}function cU(n){return n!=null&&typeof n=="object"&&"video"in n}function fU(n){return n!=null&&typeof n=="object"&&"uri"in n}function lC(n){var e;let t;if(uU(n)&&(t=n.name),!(fU(n)&&(t=n.uri,t===void 0))&&!(cU(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const r=t.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${t}`);t=r[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function uC(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function cC(n){for(const e of["models","tunedModels","publisherModels"])if(dU(n,e))return n[e];return[]}function dU(n,e){return n!==null&&typeof n=="object"&&e in n}function hU(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function pU(n,e={}){const t=[],i=new Set;for(const r of n){const a=r.name;if(i.has(a))throw new Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);i.add(a);const l=hU(r,e);l.functionDeclarations&&t.push(...l.functionDeclarations)}return{functionDeclarations:t}}function fC(n,e){if(typeof e!="string"&&!Array.isArray(e)){if(n&&n.isVertexAI()){if(e.gcsUri&&e.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!e.gcsUri&&!e.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(e.inlinedRequests&&e.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!e.inlinedRequests&&!e.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return e}else{if(Array.isArray(e))return{inlinedRequests:e};if(typeof e=="string"){if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:[e]};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};if(e.startsWith("files/"))return{fileName:e}}}throw new Error(`Unsupported source: ${e}`)}function mU(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function ga(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function dC(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gU(n){const e={},t=h(n,["fps"]);t!=null&&p(e,["fps"],t);const i=h(n,["endOffset"]);i!=null&&p(e,["endOffset"],i);const r=h(n,["startOffset"]);return r!=null&&p(e,["startOffset"],r),e}function yU(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&p(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function _U(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&p(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function vU(n){const e={},t=h(n,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],gU(t));const i=h(n,["thought"]);i!=null&&p(e,["thought"],i);const r=h(n,["inlineData"]);r!=null&&p(e,["inlineData"],yU(r));const a=h(n,["fileData"]);a!=null&&p(e,["fileData"],_U(a));const l=h(n,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(n,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(n,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(n,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(n,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const _=h(n,["text"]);return _!=null&&p(e,["text"],_),e}function hC(n){const e={},t=h(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>vU(a))),p(e,["parts"],r)}const i=h(n,["role"]);return i!=null&&p(e,["role"],i),e}function bU(n){const e={},t=h(n,["anyOf"]);t!=null&&p(e,["anyOf"],t);const i=h(n,["default"]);i!=null&&p(e,["default"],i);const r=h(n,["description"]);r!=null&&p(e,["description"],r);const a=h(n,["enum"]);a!=null&&p(e,["enum"],a);const l=h(n,["example"]);l!=null&&p(e,["example"],l);const c=h(n,["format"]);c!=null&&p(e,["format"],c);const f=h(n,["items"]);f!=null&&p(e,["items"],f);const d=h(n,["maxItems"]);d!=null&&p(e,["maxItems"],d);const g=h(n,["maxLength"]);g!=null&&p(e,["maxLength"],g);const _=h(n,["maxProperties"]);_!=null&&p(e,["maxProperties"],_);const v=h(n,["maximum"]);v!=null&&p(e,["maximum"],v);const w=h(n,["minItems"]);w!=null&&p(e,["minItems"],w);const T=h(n,["minLength"]);T!=null&&p(e,["minLength"],T);const S=h(n,["minProperties"]);S!=null&&p(e,["minProperties"],S);const C=h(n,["minimum"]);C!=null&&p(e,["minimum"],C);const x=h(n,["nullable"]);x!=null&&p(e,["nullable"],x);const M=h(n,["pattern"]);M!=null&&p(e,["pattern"],M);const R=h(n,["properties"]);R!=null&&p(e,["properties"],R);const P=h(n,["propertyOrdering"]);P!=null&&p(e,["propertyOrdering"],P);const O=h(n,["required"]);O!=null&&p(e,["required"],O);const V=h(n,["title"]);V!=null&&p(e,["title"],V);const J=h(n,["type"]);return J!=null&&p(e,["type"],J),e}function wU(n){const e={};if(h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=h(n,["category"]);t!=null&&p(e,["category"],t);const i=h(n,["threshold"]);return i!=null&&p(e,["threshold"],i),e}function TU(n){const e={},t=h(n,["behavior"]);t!=null&&p(e,["behavior"],t);const i=h(n,["description"]);i!=null&&p(e,["description"],i);const r=h(n,["name"]);r!=null&&p(e,["name"],r);const a=h(n,["parameters"]);a!=null&&p(e,["parameters"],a);const l=h(n,["parametersJsonSchema"]);l!=null&&p(e,["parametersJsonSchema"],l);const c=h(n,["response"]);c!=null&&p(e,["response"],c);const f=h(n,["responseJsonSchema"]);return f!=null&&p(e,["responseJsonSchema"],f),e}function EU(n){const e={},t=h(n,["startTime"]);t!=null&&p(e,["startTime"],t);const i=h(n,["endTime"]);return i!=null&&p(e,["endTime"],i),e}function SU(n){const e={},t=h(n,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],EU(t)),e}function CU(n){const e={},t=h(n,["mode"]);t!=null&&p(e,["mode"],t);const i=h(n,["dynamicThreshold"]);return i!=null&&p(e,["dynamicThreshold"],i),e}function AU(n){const e={},t=h(n,["dynamicRetrievalConfig"]);return t!=null&&p(e,["dynamicRetrievalConfig"],CU(t)),e}function RU(){return{}}function xU(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(d=>TU(d))),p(e,["functionDeclarations"],f)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&p(e,["googleSearch"],SU(i));const r=h(n,["googleSearchRetrieval"]);if(r!=null&&p(e,["googleSearchRetrieval"],AU(r)),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(n,["urlContext"])!=null&&p(e,["urlContext"],RU());const l=h(n,["codeExecution"]);l!=null&&p(e,["codeExecution"],l);const c=h(n,["computerUse"]);return c!=null&&p(e,["computerUse"],c),e}function IU(n){const e={},t=h(n,["mode"]);t!=null&&p(e,["mode"],t);const i=h(n,["allowedFunctionNames"]);return i!=null&&p(e,["allowedFunctionNames"],i),e}function MU(n){const e={},t=h(n,["latitude"]);t!=null&&p(e,["latitude"],t);const i=h(n,["longitude"]);return i!=null&&p(e,["longitude"],i),e}function NU(n){const e={},t=h(n,["latLng"]);t!=null&&p(e,["latLng"],MU(t));const i=h(n,["languageCode"]);return i!=null&&p(e,["languageCode"],i),e}function OU(n){const e={},t=h(n,["functionCallingConfig"]);t!=null&&p(e,["functionCallingConfig"],IU(t));const i=h(n,["retrievalConfig"]);return i!=null&&p(e,["retrievalConfig"],NU(i)),e}function kU(n){const e={},t=h(n,["voiceName"]);return t!=null&&p(e,["voiceName"],t),e}function pC(n){const e={},t=h(n,["prebuiltVoiceConfig"]);return t!=null&&p(e,["prebuiltVoiceConfig"],kU(t)),e}function PU(n){const e={},t=h(n,["speaker"]);t!=null&&p(e,["speaker"],t);const i=h(n,["voiceConfig"]);return i!=null&&p(e,["voiceConfig"],pC(i)),e}function DU(n){const e={},t=h(n,["speakerVoiceConfigs"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>PU(r))),p(e,["speakerVoiceConfigs"],i)}return e}function LU(n){const e={},t=h(n,["voiceConfig"]);t!=null&&p(e,["voiceConfig"],pC(t));const i=h(n,["multiSpeakerVoiceConfig"]);i!=null&&p(e,["multiSpeakerVoiceConfig"],DU(i));const r=h(n,["languageCode"]);return r!=null&&p(e,["languageCode"],r),e}function UU(n){const e={},t=h(n,["includeThoughts"]);t!=null&&p(e,["includeThoughts"],t);const i=h(n,["thinkingBudget"]);return i!=null&&p(e,["thinkingBudget"],i),e}function $U(n,e,t){const i={},r=h(e,["systemInstruction"]);t!==void 0&&r!=null&&p(t,["systemInstruction"],hC(kt(r)));const a=h(e,["temperature"]);a!=null&&p(i,["temperature"],a);const l=h(e,["topP"]);l!=null&&p(i,["topP"],l);const c=h(e,["topK"]);c!=null&&p(i,["topK"],c);const f=h(e,["candidateCount"]);f!=null&&p(i,["candidateCount"],f);const d=h(e,["maxOutputTokens"]);d!=null&&p(i,["maxOutputTokens"],d);const g=h(e,["stopSequences"]);g!=null&&p(i,["stopSequences"],g);const _=h(e,["responseLogprobs"]);_!=null&&p(i,["responseLogprobs"],_);const v=h(e,["logprobs"]);v!=null&&p(i,["logprobs"],v);const w=h(e,["presencePenalty"]);w!=null&&p(i,["presencePenalty"],w);const T=h(e,["frequencyPenalty"]);T!=null&&p(i,["frequencyPenalty"],T);const S=h(e,["seed"]);S!=null&&p(i,["seed"],S);const C=h(e,["responseMimeType"]);C!=null&&p(i,["responseMimeType"],C);const x=h(e,["responseSchema"]);x!=null&&p(i,["responseSchema"],bU(Zm(x)));const M=h(e,["responseJsonSchema"]);if(M!=null&&p(i,["responseJsonSchema"],M),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const R=h(e,["safetySettings"]);if(t!==void 0&&R!=null){let ye=R;Array.isArray(ye)&&(ye=ye.map(Ue=>wU(Ue))),p(t,["safetySettings"],ye)}const P=h(e,["tools"]);if(t!==void 0&&P!=null){let ye=ma(P);Array.isArray(ye)&&(ye=ye.map(Ue=>xU(pa(Ue)))),p(t,["tools"],ye)}const O=h(e,["toolConfig"]);if(t!==void 0&&O!=null&&p(t,["toolConfig"],OU(O)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const V=h(e,["cachedContent"]);t!==void 0&&V!=null&&p(t,["cachedContent"],_i(n,V));const J=h(e,["responseModalities"]);J!=null&&p(i,["responseModalities"],J);const Z=h(e,["mediaResolution"]);Z!=null&&p(i,["mediaResolution"],Z);const re=h(e,["speechConfig"]);if(re!=null&&p(i,["speechConfig"],LU(Qm(re))),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Se=h(e,["thinkingConfig"]);return Se!=null&&p(i,["thinkingConfig"],UU(Se)),i}function qU(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["request","model"],Fe(n,i));const r=h(e,["contents"]);if(r!=null){let l=En(r);Array.isArray(l)&&(l=l.map(c=>hC(c))),p(t,["request","contents"],l)}const a=h(e,["config"]);return a!=null&&p(t,["request","generationConfig"],$U(n,a,t)),t}function BU(n,e){const t={};if(h(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(h(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=h(e,["fileName"]);i!=null&&p(t,["fileName"],i);const r=h(e,["inlinedRequests"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>qU(n,l))),p(t,["requests","requests"],a)}return t}function GU(n,e){const t={},i=h(n,["displayName"]);if(e!==void 0&&i!=null&&p(e,["batch","displayName"],i),h(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function VU(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","model"],Fe(n,i));const r=h(e,["src"]);r!=null&&p(t,["batch","inputConfig"],BU(n,fC(n,r)));const a=h(e,["config"]);return a!=null&&p(t,["config"],GU(a,t)),t}function FU(n,e){const t={},i=h(e,["name"]);i!=null&&p(t,["_url","name"],ga(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],r),t}function HU(n,e){const t={},i=h(e,["name"]);i!=null&&p(t,["_url","name"],ga(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],r),t}function zU(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);const r=h(n,["pageToken"]);if(e!==void 0&&r!=null&&p(e,["_query","pageToken"],r),h(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function jU(n){const e={},t=h(n,["config"]);return t!=null&&p(e,["config"],zU(t,e)),e}function JU(n,e){const t={},i=h(e,["name"]);i!=null&&p(t,["_url","name"],ga(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],r),t}function KU(n){const e={},t=h(n,["format"]);t!=null&&p(e,["instancesFormat"],t);const i=h(n,["gcsUri"]);i!=null&&p(e,["gcsSource","uris"],i);const r=h(n,["bigqueryUri"]);if(r!=null&&p(e,["bigquerySource","inputUri"],r),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function YU(n){const e={},t=h(n,["format"]);t!=null&&p(e,["predictionsFormat"],t);const i=h(n,["gcsUri"]);i!=null&&p(e,["gcsDestination","outputUriPrefix"],i);const r=h(n,["bigqueryUri"]);if(r!=null&&p(e,["bigqueryDestination","outputUri"],r),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return e}function ZU(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&p(e,["displayName"],i);const r=h(n,["dest"]);return e!==void 0&&r!=null&&p(e,["outputConfig"],YU(mU(r))),t}function QU(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["model"],Fe(n,i));const r=h(e,["src"]);r!=null&&p(t,["inputConfig"],KU(fC(n,r)));const a=h(e,["config"]);return a!=null&&p(t,["config"],ZU(a,t)),t}function XU(n,e){const t={},i=h(e,["name"]);i!=null&&p(t,["_url","name"],ga(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],r),t}function WU(n,e){const t={},i=h(e,["name"]);i!=null&&p(t,["_url","name"],ga(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],r),t}function e$(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);const r=h(n,["pageToken"]);e!==void 0&&r!=null&&p(e,["_query","pageToken"],r);const a=h(n,["filter"]);return e!==void 0&&a!=null&&p(e,["_query","filter"],a),t}function t$(n){const e={},t=h(n,["config"]);return t!=null&&p(e,["config"],e$(t,e)),e}function n$(n,e){const t={},i=h(e,["name"]);i!=null&&p(t,["_url","name"],ga(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],r),t}function i$(n){const e={},t=h(n,["fps"]);t!=null&&p(e,["fps"],t);const i=h(n,["endOffset"]);i!=null&&p(e,["endOffset"],i);const r=h(n,["startOffset"]);return r!=null&&p(e,["startOffset"],r),e}function r$(n){const e={},t=h(n,["data"]);t!=null&&p(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function s$(n){const e={},t=h(n,["fileUri"]);t!=null&&p(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function a$(n){const e={},t=h(n,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],i$(t));const i=h(n,["thought"]);i!=null&&p(e,["thought"],i);const r=h(n,["inlineData"]);r!=null&&p(e,["inlineData"],r$(r));const a=h(n,["fileData"]);a!=null&&p(e,["fileData"],s$(a));const l=h(n,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(n,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(n,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(n,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(n,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const _=h(n,["text"]);return _!=null&&p(e,["text"],_),e}function o$(n){const e={},t=h(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>a$(a))),p(e,["parts"],r)}const i=h(n,["role"]);return i!=null&&p(e,["role"],i),e}function l$(n){const e={},t=h(n,["citationSources"]);return t!=null&&p(e,["citations"],t),e}function u$(n){const e={},t=h(n,["retrievedUrl"]);t!=null&&p(e,["retrievedUrl"],t);const i=h(n,["urlRetrievalStatus"]);return i!=null&&p(e,["urlRetrievalStatus"],i),e}function c$(n){const e={},t=h(n,["urlMetadata"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>u$(r))),p(e,["urlMetadata"],i)}return e}function f$(n){const e={},t=h(n,["content"]);t!=null&&p(e,["content"],o$(t));const i=h(n,["citationMetadata"]);i!=null&&p(e,["citationMetadata"],l$(i));const r=h(n,["tokenCount"]);r!=null&&p(e,["tokenCount"],r);const a=h(n,["finishReason"]);a!=null&&p(e,["finishReason"],a);const l=h(n,["urlContextMetadata"]);l!=null&&p(e,["urlContextMetadata"],c$(l));const c=h(n,["avgLogprobs"]);c!=null&&p(e,["avgLogprobs"],c);const f=h(n,["groundingMetadata"]);f!=null&&p(e,["groundingMetadata"],f);const d=h(n,["index"]);d!=null&&p(e,["index"],d);const g=h(n,["logprobsResult"]);g!=null&&p(e,["logprobsResult"],g);const _=h(n,["safetyRatings"]);return _!=null&&p(e,["safetyRatings"],_),e}function d$(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>f$(f))),p(e,["candidates"],c)}const r=h(n,["modelVersion"]);r!=null&&p(e,["modelVersion"],r);const a=h(n,["promptFeedback"]);a!=null&&p(e,["promptFeedback"],a);const l=h(n,["usageMetadata"]);return l!=null&&p(e,["usageMetadata"],l),e}function mC(n){const e={},t=h(n,["details"]);t!=null&&p(e,["details"],t);const i=h(n,["code"]);i!=null&&p(e,["code"],i);const r=h(n,["message"]);return r!=null&&p(e,["message"],r),e}function h$(n){const e={},t=h(n,["response"]);t!=null&&p(e,["response"],d$(t));const i=h(n,["error"]);return i!=null&&p(e,["error"],mC(i)),e}function p$(n){const e={},t=h(n,["responsesFile"]);t!=null&&p(e,["fileName"],t);const i=h(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>h$(a))),p(e,["inlinedResponses"],r)}return e}function dm(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const i=h(n,["metadata","displayName"]);i!=null&&p(e,["displayName"],i);const r=h(n,["metadata","state"]);r!=null&&p(e,["state"],dC(r));const a=h(n,["metadata","createTime"]);a!=null&&p(e,["createTime"],a);const l=h(n,["metadata","endTime"]);l!=null&&p(e,["endTime"],l);const c=h(n,["metadata","updateTime"]);c!=null&&p(e,["updateTime"],c);const f=h(n,["metadata","model"]);f!=null&&p(e,["model"],f);const d=h(n,["metadata","output"]);return d!=null&&p(e,["dest"],p$(d)),e}function m$(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&p(e,["nextPageToken"],i);const r=h(n,["operations"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>dm(l))),p(e,["batchJobs"],a)}return e}function g$(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const i=h(n,["done"]);i!=null&&p(e,["done"],i);const r=h(n,["error"]);return r!=null&&p(e,["error"],mC(r)),e}function gC(n){const e={},t=h(n,["details"]);t!=null&&p(e,["details"],t);const i=h(n,["code"]);i!=null&&p(e,["code"],i);const r=h(n,["message"]);return r!=null&&p(e,["message"],r),e}function y$(n){const e={},t=h(n,["instancesFormat"]);t!=null&&p(e,["format"],t);const i=h(n,["gcsSource","uris"]);i!=null&&p(e,["gcsUri"],i);const r=h(n,["bigquerySource","inputUri"]);return r!=null&&p(e,["bigqueryUri"],r),e}function _$(n){const e={},t=h(n,["predictionsFormat"]);t!=null&&p(e,["format"],t);const i=h(n,["gcsDestination","outputUriPrefix"]);i!=null&&p(e,["gcsUri"],i);const r=h(n,["bigqueryDestination","outputUri"]);return r!=null&&p(e,["bigqueryUri"],r),e}function hm(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const i=h(n,["displayName"]);i!=null&&p(e,["displayName"],i);const r=h(n,["state"]);r!=null&&p(e,["state"],dC(r));const a=h(n,["error"]);a!=null&&p(e,["error"],gC(a));const l=h(n,["createTime"]);l!=null&&p(e,["createTime"],l);const c=h(n,["startTime"]);c!=null&&p(e,["startTime"],c);const f=h(n,["endTime"]);f!=null&&p(e,["endTime"],f);const d=h(n,["updateTime"]);d!=null&&p(e,["updateTime"],d);const g=h(n,["model"]);g!=null&&p(e,["model"],g);const _=h(n,["inputConfig"]);_!=null&&p(e,["src"],y$(_));const v=h(n,["outputConfig"]);return v!=null&&p(e,["dest"],_$(v)),e}function v$(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&p(e,["nextPageToken"],i);const r=h(n,["batchPredictionJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>hm(l))),p(e,["batchJobs"],a)}return e}function b$(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const i=h(n,["done"]);i!=null&&p(e,["done"],i);const r=h(n,["error"]);return r!=null&&p(e,["error"],gC(r)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Br;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Br||(Br={}));class ll{constructor(e,t,i,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,r)}init(e,t,i){var r,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t?.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!i||Object.keys(i).length===0?l={config:{}}:typeof i=="object"?l=Object.assign({},i):l=i,l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(a=(r=l.config)===null||r===void 0?void 0:r.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class w$ extends Vr{constructor(e){super(),this.apiClient=e,this.create=async t=>{if(this.apiClient.isVertexAI()){const r=Date.now().toString();if(Array.isArray(t.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(t.config=t.config||{},t.config.displayName===void 0&&(t.config.displayName="genaiBatchJob_${timestampStr}"),t.config.dest===void 0&&typeof t.src=="string")if(t.src.startsWith("gs://")&&t.src.endsWith(".jsonl"))t.config.dest=`${t.src.slice(0,-6)}/dest`;else if(t.src.startsWith("bq://"))t.config.dest=`${t.src}_dest_${r}`;else throw new Error("Unsupported source:"+t.src)}return await this.createInternal(t)},this.list=async(t={})=>new ll(Br.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t)}async createInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=QU(this.apiClient,e);return c=ue("batchPredictionJobs",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>hm(g))}else{const d=VU(this.apiClient,e);return c=ue("{model}:batchGenerateContent",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json()),l.then(g=>dm(g))}}async get(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=XU(this.apiClient,e);return c=ue("batchPredictionJobs/{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>hm(g))}else{const d=FU(this.apiClient,e);return c=ue("batches/{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json()),l.then(g=>dm(g))}}async cancel(e){var t,i,r,a;let l="",c={};if(this.apiClient.isVertexAI()){const f=WU(this.apiClient,e);l=ue("batchPredictionJobs/{name}:cancel",f._url),c=f._query,delete f.config,delete f._url,delete f._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const f=HU(this.apiClient,e);l=ue("batches/{name}:cancel",f._url),c=f._query,delete f.config,delete f._url,delete f._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async listInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=t$(e);return c=ue("batchPredictionJobs",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(_=>{const v=_;return v.sdkHttpResponse={headers:g.headers},v})),l.then(g=>{const _=v$(g),v=new lE;return Object.assign(v,_),v})}else{const d=jU(e);return c=ue("batches",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json().then(_=>{const v=_;return v.sdkHttpResponse={headers:g.headers},v})),l.then(g=>{const _=m$(g),v=new lE;return Object.assign(v,_),v})}}async delete(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=n$(this.apiClient,e);return c=ue("batchPredictionJobs/{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>b$(g))}else{const d=JU(this.apiClient,e);return c=ue("batches/{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json()),l.then(g=>g$(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function T$(n){const e={},t=h(n,["fps"]);t!=null&&p(e,["fps"],t);const i=h(n,["endOffset"]);i!=null&&p(e,["endOffset"],i);const r=h(n,["startOffset"]);return r!=null&&p(e,["startOffset"],r),e}function E$(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&p(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function S$(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&p(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function C$(n){const e={},t=h(n,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],T$(t));const i=h(n,["thought"]);i!=null&&p(e,["thought"],i);const r=h(n,["inlineData"]);r!=null&&p(e,["inlineData"],E$(r));const a=h(n,["fileData"]);a!=null&&p(e,["fileData"],S$(a));const l=h(n,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(n,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(n,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(n,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(n,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const _=h(n,["text"]);return _!=null&&p(e,["text"],_),e}function dE(n){const e={},t=h(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>C$(a))),p(e,["parts"],r)}const i=h(n,["role"]);return i!=null&&p(e,["role"],i),e}function A$(n){const e={},t=h(n,["behavior"]);t!=null&&p(e,["behavior"],t);const i=h(n,["description"]);i!=null&&p(e,["description"],i);const r=h(n,["name"]);r!=null&&p(e,["name"],r);const a=h(n,["parameters"]);a!=null&&p(e,["parameters"],a);const l=h(n,["parametersJsonSchema"]);l!=null&&p(e,["parametersJsonSchema"],l);const c=h(n,["response"]);c!=null&&p(e,["response"],c);const f=h(n,["responseJsonSchema"]);return f!=null&&p(e,["responseJsonSchema"],f),e}function R$(n){const e={},t=h(n,["startTime"]);t!=null&&p(e,["startTime"],t);const i=h(n,["endTime"]);return i!=null&&p(e,["endTime"],i),e}function x$(n){const e={},t=h(n,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],R$(t)),e}function I$(n){const e={},t=h(n,["mode"]);t!=null&&p(e,["mode"],t);const i=h(n,["dynamicThreshold"]);return i!=null&&p(e,["dynamicThreshold"],i),e}function M$(n){const e={},t=h(n,["dynamicRetrievalConfig"]);return t!=null&&p(e,["dynamicRetrievalConfig"],I$(t)),e}function N$(){return{}}function O$(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(d=>A$(d))),p(e,["functionDeclarations"],f)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&p(e,["googleSearch"],x$(i));const r=h(n,["googleSearchRetrieval"]);if(r!=null&&p(e,["googleSearchRetrieval"],M$(r)),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(n,["urlContext"])!=null&&p(e,["urlContext"],N$());const l=h(n,["codeExecution"]);l!=null&&p(e,["codeExecution"],l);const c=h(n,["computerUse"]);return c!=null&&p(e,["computerUse"],c),e}function k$(n){const e={},t=h(n,["mode"]);t!=null&&p(e,["mode"],t);const i=h(n,["allowedFunctionNames"]);return i!=null&&p(e,["allowedFunctionNames"],i),e}function P$(n){const e={},t=h(n,["latitude"]);t!=null&&p(e,["latitude"],t);const i=h(n,["longitude"]);return i!=null&&p(e,["longitude"],i),e}function D$(n){const e={},t=h(n,["latLng"]);t!=null&&p(e,["latLng"],P$(t));const i=h(n,["languageCode"]);return i!=null&&p(e,["languageCode"],i),e}function L$(n){const e={},t=h(n,["functionCallingConfig"]);t!=null&&p(e,["functionCallingConfig"],k$(t));const i=h(n,["retrievalConfig"]);return i!=null&&p(e,["retrievalConfig"],D$(i)),e}function U$(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&p(e,["ttl"],i);const r=h(n,["expireTime"]);e!==void 0&&r!=null&&p(e,["expireTime"],r);const a=h(n,["displayName"]);e!==void 0&&a!=null&&p(e,["displayName"],a);const l=h(n,["contents"]);if(e!==void 0&&l!=null){let g=En(l);Array.isArray(g)&&(g=g.map(_=>dE(_))),p(e,["contents"],g)}const c=h(n,["systemInstruction"]);e!==void 0&&c!=null&&p(e,["systemInstruction"],dE(kt(c)));const f=h(n,["tools"]);if(e!==void 0&&f!=null){let g=f;Array.isArray(g)&&(g=g.map(_=>O$(_))),p(e,["tools"],g)}const d=h(n,["toolConfig"]);if(e!==void 0&&d!=null&&p(e,["toolConfig"],L$(d)),h(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function $$(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["model"],tC(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],U$(r,t)),t}function q$(n,e){const t={},i=h(e,["name"]);i!=null&&p(t,["_url","name"],_i(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],r),t}function B$(n,e){const t={},i=h(e,["name"]);i!=null&&p(t,["_url","name"],_i(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],r),t}function G$(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&p(e,["ttl"],i);const r=h(n,["expireTime"]);return e!==void 0&&r!=null&&p(e,["expireTime"],r),t}function V$(n,e){const t={},i=h(e,["name"]);i!=null&&p(t,["_url","name"],_i(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],G$(r,t)),t}function F$(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);const r=h(n,["pageToken"]);return e!==void 0&&r!=null&&p(e,["_query","pageToken"],r),t}function H$(n){const e={},t=h(n,["config"]);return t!=null&&p(e,["config"],F$(t,e)),e}function z$(n){const e={},t=h(n,["fps"]);t!=null&&p(e,["fps"],t);const i=h(n,["endOffset"]);i!=null&&p(e,["endOffset"],i);const r=h(n,["startOffset"]);return r!=null&&p(e,["startOffset"],r),e}function j$(n){const e={},t=h(n,["displayName"]);t!=null&&p(e,["displayName"],t);const i=h(n,["data"]);i!=null&&p(e,["data"],i);const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function J$(n){const e={},t=h(n,["displayName"]);t!=null&&p(e,["displayName"],t);const i=h(n,["fileUri"]);i!=null&&p(e,["fileUri"],i);const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function K$(n){const e={},t=h(n,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],z$(t));const i=h(n,["thought"]);i!=null&&p(e,["thought"],i);const r=h(n,["inlineData"]);r!=null&&p(e,["inlineData"],j$(r));const a=h(n,["fileData"]);a!=null&&p(e,["fileData"],J$(a));const l=h(n,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(n,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(n,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(n,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(n,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const _=h(n,["text"]);return _!=null&&p(e,["text"],_),e}function hE(n){const e={},t=h(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>K$(a))),p(e,["parts"],r)}const i=h(n,["role"]);return i!=null&&p(e,["role"],i),e}function Y$(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&p(e,["description"],t);const i=h(n,["name"]);i!=null&&p(e,["name"],i);const r=h(n,["parameters"]);r!=null&&p(e,["parameters"],r);const a=h(n,["parametersJsonSchema"]);a!=null&&p(e,["parametersJsonSchema"],a);const l=h(n,["response"]);l!=null&&p(e,["response"],l);const c=h(n,["responseJsonSchema"]);return c!=null&&p(e,["responseJsonSchema"],c),e}function Z$(n){const e={},t=h(n,["startTime"]);t!=null&&p(e,["startTime"],t);const i=h(n,["endTime"]);return i!=null&&p(e,["endTime"],i),e}function Q$(n){const e={},t=h(n,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],Z$(t)),e}function X$(n){const e={},t=h(n,["mode"]);t!=null&&p(e,["mode"],t);const i=h(n,["dynamicThreshold"]);return i!=null&&p(e,["dynamicThreshold"],i),e}function W$(n){const e={},t=h(n,["dynamicRetrievalConfig"]);return t!=null&&p(e,["dynamicRetrievalConfig"],X$(t)),e}function e2(){return{}}function t2(n){const e={},t=h(n,["apiKeyString"]);return t!=null&&p(e,["apiKeyString"],t),e}function n2(n){const e={},t=h(n,["apiKeyConfig"]);t!=null&&p(e,["apiKeyConfig"],t2(t));const i=h(n,["authType"]);i!=null&&p(e,["authType"],i);const r=h(n,["googleServiceAccountConfig"]);r!=null&&p(e,["googleServiceAccountConfig"],r);const a=h(n,["httpBasicAuthConfig"]);a!=null&&p(e,["httpBasicAuthConfig"],a);const l=h(n,["oauthConfig"]);l!=null&&p(e,["oauthConfig"],l);const c=h(n,["oidcConfig"]);return c!=null&&p(e,["oidcConfig"],c),e}function i2(n){const e={},t=h(n,["authConfig"]);return t!=null&&p(e,["authConfig"],n2(t)),e}function r2(){return{}}function s2(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(v=>Y$(v))),p(e,["functionDeclarations"],_)}const i=h(n,["retrieval"]);i!=null&&p(e,["retrieval"],i);const r=h(n,["googleSearch"]);r!=null&&p(e,["googleSearch"],Q$(r));const a=h(n,["googleSearchRetrieval"]);a!=null&&p(e,["googleSearchRetrieval"],W$(a)),h(n,["enterpriseWebSearch"])!=null&&p(e,["enterpriseWebSearch"],e2());const c=h(n,["googleMaps"]);c!=null&&p(e,["googleMaps"],i2(c)),h(n,["urlContext"])!=null&&p(e,["urlContext"],r2());const d=h(n,["codeExecution"]);d!=null&&p(e,["codeExecution"],d);const g=h(n,["computerUse"]);return g!=null&&p(e,["computerUse"],g),e}function a2(n){const e={},t=h(n,["mode"]);t!=null&&p(e,["mode"],t);const i=h(n,["allowedFunctionNames"]);return i!=null&&p(e,["allowedFunctionNames"],i),e}function o2(n){const e={},t=h(n,["latitude"]);t!=null&&p(e,["latitude"],t);const i=h(n,["longitude"]);return i!=null&&p(e,["longitude"],i),e}function l2(n){const e={},t=h(n,["latLng"]);t!=null&&p(e,["latLng"],o2(t));const i=h(n,["languageCode"]);return i!=null&&p(e,["languageCode"],i),e}function u2(n){const e={},t=h(n,["functionCallingConfig"]);t!=null&&p(e,["functionCallingConfig"],a2(t));const i=h(n,["retrievalConfig"]);return i!=null&&p(e,["retrievalConfig"],l2(i)),e}function c2(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&p(e,["ttl"],i);const r=h(n,["expireTime"]);e!==void 0&&r!=null&&p(e,["expireTime"],r);const a=h(n,["displayName"]);e!==void 0&&a!=null&&p(e,["displayName"],a);const l=h(n,["contents"]);if(e!==void 0&&l!=null){let _=En(l);Array.isArray(_)&&(_=_.map(v=>hE(v))),p(e,["contents"],_)}const c=h(n,["systemInstruction"]);e!==void 0&&c!=null&&p(e,["systemInstruction"],hE(kt(c)));const f=h(n,["tools"]);if(e!==void 0&&f!=null){let _=f;Array.isArray(_)&&(_=_.map(v=>s2(v))),p(e,["tools"],_)}const d=h(n,["toolConfig"]);e!==void 0&&d!=null&&p(e,["toolConfig"],u2(d));const g=h(n,["kmsKeyName"]);return e!==void 0&&g!=null&&p(e,["encryption_spec","kmsKeyName"],g),t}function f2(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["model"],tC(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],c2(r,t)),t}function d2(n,e){const t={},i=h(e,["name"]);i!=null&&p(t,["_url","name"],_i(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],r),t}function h2(n,e){const t={},i=h(e,["name"]);i!=null&&p(t,["_url","name"],_i(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],r),t}function p2(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&p(e,["ttl"],i);const r=h(n,["expireTime"]);return e!==void 0&&r!=null&&p(e,["expireTime"],r),t}function m2(n,e){const t={},i=h(e,["name"]);i!=null&&p(t,["_url","name"],_i(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],p2(r,t)),t}function g2(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);const r=h(n,["pageToken"]);return e!==void 0&&r!=null&&p(e,["_query","pageToken"],r),t}function y2(n){const e={},t=h(n,["config"]);return t!=null&&p(e,["config"],g2(t,e)),e}function Hu(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const i=h(n,["displayName"]);i!=null&&p(e,["displayName"],i);const r=h(n,["model"]);r!=null&&p(e,["model"],r);const a=h(n,["createTime"]);a!=null&&p(e,["createTime"],a);const l=h(n,["updateTime"]);l!=null&&p(e,["updateTime"],l);const c=h(n,["expireTime"]);c!=null&&p(e,["expireTime"],c);const f=h(n,["usageMetadata"]);return f!=null&&p(e,["usageMetadata"],f),e}function _2(){return{}}function v2(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&p(e,["nextPageToken"],i);const r=h(n,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>Hu(l))),p(e,["cachedContents"],a)}return e}function zu(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const i=h(n,["displayName"]);i!=null&&p(e,["displayName"],i);const r=h(n,["model"]);r!=null&&p(e,["model"],r);const a=h(n,["createTime"]);a!=null&&p(e,["createTime"],a);const l=h(n,["updateTime"]);l!=null&&p(e,["updateTime"],l);const c=h(n,["expireTime"]);c!=null&&p(e,["expireTime"],c);const f=h(n,["usageMetadata"]);return f!=null&&p(e,["usageMetadata"],f),e}function b2(){return{}}function w2(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&p(e,["nextPageToken"],i);const r=h(n,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>zu(l))),p(e,["cachedContents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class T2 extends Vr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ll(Br.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=f2(this.apiClient,e);return c=ue("cachedContents",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>zu(g))}else{const d=$$(this.apiClient,e);return c=ue("cachedContents",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json()),l.then(g=>Hu(g))}}async get(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=d2(this.apiClient,e);return c=ue("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>zu(g))}else{const d=q$(this.apiClient,e);return c=ue("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json()),l.then(g=>Hu(g))}}async delete(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=h2(this.apiClient,e);return c=ue("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(()=>{const g=b2(),_=new aE;return Object.assign(_,g),_})}else{const d=B$(this.apiClient,e);return c=ue("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json()),l.then(()=>{const g=_2(),_=new aE;return Object.assign(_,g),_})}}async update(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=m2(this.apiClient,e);return c=ue("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>zu(g))}else{const d=V$(this.apiClient,e);return c=ue("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json()),l.then(g=>Hu(g))}}async listInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=y2(e);return c=ue("cachedContents",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(_=>{const v=_;return v.sdkHttpResponse={headers:g.headers},v})),l.then(g=>{const _=w2(g),v=new oE;return Object.assign(v,_),v})}else{const d=H$(e);return c=ue("cachedContents",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json().then(_=>{const v=_;return v.sdkHttpResponse={headers:g.headers},v})),l.then(g=>{const _=v2(g),v=new oE;return Object.assign(v,_),v})}}}function pE(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ze(n){return this instanceof Ze?(this.v=n,this):new Ze(n)}function Ys(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,a=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),r[Symbol.asyncIterator]=function(){return this},r;function l(w){return function(T){return Promise.resolve(T).then(w,_)}}function c(w,T){i[w]&&(r[w]=function(S){return new Promise(function(C,x){a.push([w,S,C,x])>1||f(w,S)})},T&&(r[w]=T(r[w])))}function f(w,T){try{d(i[w](T))}catch(S){v(a[0][3],S)}}function d(w){w.value instanceof Ze?Promise.resolve(w.value.v).then(g,_):v(a[0][2],w)}function g(w){f("next",w)}function _(w){f("throw",w)}function v(w,T){w(T),a.shift(),a.length&&f(a[0][0],a[0][1])}}function $o(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof pE=="function"?pE(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(a){t[a]=n[a]&&function(l){return new Promise(function(c,f){l=n[a](l),r(c,f,l.done,l.value)})}}function r(a,l,c,f){Promise.resolve(f).then(function(d){a({value:d,done:c})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function E2(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:yC(t)}function yC(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function S2(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function mE(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const r=[];let a=!0;for(;i<t&&n[i].role==="model";)r.push(n[i]),a&&!yC(n[i])&&(a=!1),i++;a?e.push(...r):e.pop()}return e}class C2{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new A2(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}let A2=class{constructor(e,t,i,r={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=r,this.history=a,this.sendPromise=Promise.resolve(),S2(a)}async sendMessage(e){var t;await this.sendPromise;const i=kt(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var a,l,c;const f=await r,d=(l=(a=f.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content,g=f.automaticFunctionCallingHistory,_=this.getHistory(!0).length;let v=[];g!=null&&(v=(c=g.slice(_))!==null&&c!==void 0?c:[]);const w=d?[d]:[];this.recordHistory(i,w,v)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var t;await this.sendPromise;const i=kt(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const a=await r;return this.processStreamResponse(a,i)}getHistory(e=!1){const t=e?mE(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var i,r;return Ys(this,arguments,function*(){var l,c,f,d;const g=[];try{for(var _=!0,v=$o(e),w;w=yield Ze(v.next()),l=w.done,!l;_=!0){d=w.value,_=!1;const T=d;if(E2(T)){const S=(r=(i=T.candidates)===null||i===void 0?void 0:i[0])===null||r===void 0?void 0:r.content;S!==void 0&&g.push(S)}yield yield Ze(T)}}catch(T){c={error:T}}finally{try{!_&&!l&&(f=v.return)&&(yield Ze(f.call(v)))}finally{if(c)throw c.error}}this.recordHistory(t,g)})}recordHistory(e,t,i){let r=[];t.length>0&&t.every(a=>a.role!==void 0)?r=t:r.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...mE(i)):this.history.push(e),this.history.push(...r)}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Rc extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Rc.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function R2(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);const r=h(n,["pageToken"]);return e!==void 0&&r!=null&&p(e,["_query","pageToken"],r),t}function x2(n){const e={},t=h(n,["config"]);return t!=null&&p(e,["config"],R2(t,e)),e}function I2(n){const e={},t=h(n,["details"]);t!=null&&p(e,["details"],t);const i=h(n,["message"]);i!=null&&p(e,["message"],i);const r=h(n,["code"]);return r!=null&&p(e,["code"],r),e}function M2(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const i=h(n,["displayName"]);i!=null&&p(e,["displayName"],i);const r=h(n,["mimeType"]);r!=null&&p(e,["mimeType"],r);const a=h(n,["sizeBytes"]);a!=null&&p(e,["sizeBytes"],a);const l=h(n,["createTime"]);l!=null&&p(e,["createTime"],l);const c=h(n,["expirationTime"]);c!=null&&p(e,["expirationTime"],c);const f=h(n,["updateTime"]);f!=null&&p(e,["updateTime"],f);const d=h(n,["sha256Hash"]);d!=null&&p(e,["sha256Hash"],d);const g=h(n,["uri"]);g!=null&&p(e,["uri"],g);const _=h(n,["downloadUri"]);_!=null&&p(e,["downloadUri"],_);const v=h(n,["state"]);v!=null&&p(e,["state"],v);const w=h(n,["source"]);w!=null&&p(e,["source"],w);const T=h(n,["videoMetadata"]);T!=null&&p(e,["videoMetadata"],T);const S=h(n,["error"]);return S!=null&&p(e,["error"],I2(S)),e}function N2(n){const e={},t=h(n,["file"]);t!=null&&p(e,["file"],M2(t));const i=h(n,["config"]);return i!=null&&p(e,["config"],i),e}function O2(n){const e={},t=h(n,["name"]);t!=null&&p(e,["_url","file"],lC(t));const i=h(n,["config"]);return i!=null&&p(e,["config"],i),e}function k2(n){const e={},t=h(n,["name"]);t!=null&&p(e,["_url","file"],lC(t));const i=h(n,["config"]);return i!=null&&p(e,["config"],i),e}function P2(n){const e={},t=h(n,["details"]);t!=null&&p(e,["details"],t);const i=h(n,["message"]);i!=null&&p(e,["message"],i);const r=h(n,["code"]);return r!=null&&p(e,["code"],r),e}function pm(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const i=h(n,["displayName"]);i!=null&&p(e,["displayName"],i);const r=h(n,["mimeType"]);r!=null&&p(e,["mimeType"],r);const a=h(n,["sizeBytes"]);a!=null&&p(e,["sizeBytes"],a);const l=h(n,["createTime"]);l!=null&&p(e,["createTime"],l);const c=h(n,["expirationTime"]);c!=null&&p(e,["expirationTime"],c);const f=h(n,["updateTime"]);f!=null&&p(e,["updateTime"],f);const d=h(n,["sha256Hash"]);d!=null&&p(e,["sha256Hash"],d);const g=h(n,["uri"]);g!=null&&p(e,["uri"],g);const _=h(n,["downloadUri"]);_!=null&&p(e,["downloadUri"],_);const v=h(n,["state"]);v!=null&&p(e,["state"],v);const w=h(n,["source"]);w!=null&&p(e,["source"],w);const T=h(n,["videoMetadata"]);T!=null&&p(e,["videoMetadata"],T);const S=h(n,["error"]);return S!=null&&p(e,["error"],P2(S)),e}function D2(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&p(e,["nextPageToken"],i);const r=h(n,["files"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>pm(l))),p(e,["files"],a)}return e}function L2(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&p(e,["sdkHttpResponse"],t),e}function U2(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $2 extends Vr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ll(Br.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>pm(t))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=x2(e);return a=ue("files",c._url),l=c._query,delete c.config,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(d=>{const g=d;return g.sdkHttpResponse={headers:f.headers},g})),r.then(f=>{const d=D2(f),g=new nU;return Object.assign(g,d),g})}}async createInternal(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=N2(e);return a=ue("upload/v1beta/files",c._url),l=c._query,delete c.config,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),r.then(f=>{const d=L2(f),g=new iU;return Object.assign(g,d),g})}}async get(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=O2(e);return a=ue("files/{file}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),r.then(f=>pm(f))}}async delete(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=k2(e);return a=ue("files/{file}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),r.then(()=>{const f=U2(),d=new rU;return Object.assign(d,f),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function q2(n){const e={},t=h(n,["voiceName"]);return t!=null&&p(e,["voiceName"],t),e}function _C(n){const e={},t=h(n,["prebuiltVoiceConfig"]);return t!=null&&p(e,["prebuiltVoiceConfig"],q2(t)),e}function B2(n){const e={},t=h(n,["speaker"]);t!=null&&p(e,["speaker"],t);const i=h(n,["voiceConfig"]);return i!=null&&p(e,["voiceConfig"],_C(i)),e}function G2(n){const e={},t=h(n,["speakerVoiceConfigs"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>B2(r))),p(e,["speakerVoiceConfigs"],i)}return e}function V2(n){const e={},t=h(n,["voiceConfig"]);t!=null&&p(e,["voiceConfig"],_C(t));const i=h(n,["multiSpeakerVoiceConfig"]);i!=null&&p(e,["multiSpeakerVoiceConfig"],G2(i));const r=h(n,["languageCode"]);return r!=null&&p(e,["languageCode"],r),e}function F2(n){const e={},t=h(n,["fps"]);t!=null&&p(e,["fps"],t);const i=h(n,["endOffset"]);i!=null&&p(e,["endOffset"],i);const r=h(n,["startOffset"]);return r!=null&&p(e,["startOffset"],r),e}function H2(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&p(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function z2(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&p(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function j2(n){const e={},t=h(n,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],F2(t));const i=h(n,["thought"]);i!=null&&p(e,["thought"],i);const r=h(n,["inlineData"]);r!=null&&p(e,["inlineData"],H2(r));const a=h(n,["fileData"]);a!=null&&p(e,["fileData"],z2(a));const l=h(n,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(n,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(n,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(n,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(n,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const _=h(n,["text"]);return _!=null&&p(e,["text"],_),e}function J2(n){const e={},t=h(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>j2(a))),p(e,["parts"],r)}const i=h(n,["role"]);return i!=null&&p(e,["role"],i),e}function K2(n){const e={},t=h(n,["behavior"]);t!=null&&p(e,["behavior"],t);const i=h(n,["description"]);i!=null&&p(e,["description"],i);const r=h(n,["name"]);r!=null&&p(e,["name"],r);const a=h(n,["parameters"]);a!=null&&p(e,["parameters"],a);const l=h(n,["parametersJsonSchema"]);l!=null&&p(e,["parametersJsonSchema"],l);const c=h(n,["response"]);c!=null&&p(e,["response"],c);const f=h(n,["responseJsonSchema"]);return f!=null&&p(e,["responseJsonSchema"],f),e}function Y2(n){const e={},t=h(n,["startTime"]);t!=null&&p(e,["startTime"],t);const i=h(n,["endTime"]);return i!=null&&p(e,["endTime"],i),e}function Z2(n){const e={},t=h(n,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],Y2(t)),e}function Q2(n){const e={},t=h(n,["mode"]);t!=null&&p(e,["mode"],t);const i=h(n,["dynamicThreshold"]);return i!=null&&p(e,["dynamicThreshold"],i),e}function X2(n){const e={},t=h(n,["dynamicRetrievalConfig"]);return t!=null&&p(e,["dynamicRetrievalConfig"],Q2(t)),e}function W2(){return{}}function eq(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(d=>K2(d))),p(e,["functionDeclarations"],f)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&p(e,["googleSearch"],Z2(i));const r=h(n,["googleSearchRetrieval"]);if(r!=null&&p(e,["googleSearchRetrieval"],X2(r)),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(n,["urlContext"])!=null&&p(e,["urlContext"],W2());const l=h(n,["codeExecution"]);l!=null&&p(e,["codeExecution"],l);const c=h(n,["computerUse"]);return c!=null&&p(e,["computerUse"],c),e}function tq(n){const e={},t=h(n,["handle"]);if(t!=null&&p(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function gE(){return{}}function nq(n){const e={},t=h(n,["disabled"]);t!=null&&p(e,["disabled"],t);const i=h(n,["startOfSpeechSensitivity"]);i!=null&&p(e,["startOfSpeechSensitivity"],i);const r=h(n,["endOfSpeechSensitivity"]);r!=null&&p(e,["endOfSpeechSensitivity"],r);const a=h(n,["prefixPaddingMs"]);a!=null&&p(e,["prefixPaddingMs"],a);const l=h(n,["silenceDurationMs"]);return l!=null&&p(e,["silenceDurationMs"],l),e}function iq(n){const e={},t=h(n,["automaticActivityDetection"]);t!=null&&p(e,["automaticActivityDetection"],nq(t));const i=h(n,["activityHandling"]);i!=null&&p(e,["activityHandling"],i);const r=h(n,["turnCoverage"]);return r!=null&&p(e,["turnCoverage"],r),e}function rq(n){const e={},t=h(n,["targetTokens"]);return t!=null&&p(e,["targetTokens"],t),e}function sq(n){const e={},t=h(n,["triggerTokens"]);t!=null&&p(e,["triggerTokens"],t);const i=h(n,["slidingWindow"]);return i!=null&&p(e,["slidingWindow"],rq(i)),e}function aq(n){const e={},t=h(n,["proactiveAudio"]);return t!=null&&p(e,["proactiveAudio"],t),e}function oq(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&p(e,["setup","generationConfig"],i);const r=h(n,["responseModalities"]);e!==void 0&&r!=null&&p(e,["setup","generationConfig","responseModalities"],r);const a=h(n,["temperature"]);e!==void 0&&a!=null&&p(e,["setup","generationConfig","temperature"],a);const l=h(n,["topP"]);e!==void 0&&l!=null&&p(e,["setup","generationConfig","topP"],l);const c=h(n,["topK"]);e!==void 0&&c!=null&&p(e,["setup","generationConfig","topK"],c);const f=h(n,["maxOutputTokens"]);e!==void 0&&f!=null&&p(e,["setup","generationConfig","maxOutputTokens"],f);const d=h(n,["mediaResolution"]);e!==void 0&&d!=null&&p(e,["setup","generationConfig","mediaResolution"],d);const g=h(n,["seed"]);e!==void 0&&g!=null&&p(e,["setup","generationConfig","seed"],g);const _=h(n,["speechConfig"]);e!==void 0&&_!=null&&p(e,["setup","generationConfig","speechConfig"],V2(Xm(_)));const v=h(n,["enableAffectiveDialog"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],v);const w=h(n,["systemInstruction"]);e!==void 0&&w!=null&&p(e,["setup","systemInstruction"],J2(kt(w)));const T=h(n,["tools"]);if(e!==void 0&&T!=null){let O=ma(T);Array.isArray(O)&&(O=O.map(V=>eq(pa(V)))),p(e,["setup","tools"],O)}const S=h(n,["sessionResumption"]);e!==void 0&&S!=null&&p(e,["setup","sessionResumption"],tq(S));const C=h(n,["inputAudioTranscription"]);e!==void 0&&C!=null&&p(e,["setup","inputAudioTranscription"],gE());const x=h(n,["outputAudioTranscription"]);e!==void 0&&x!=null&&p(e,["setup","outputAudioTranscription"],gE());const M=h(n,["realtimeInputConfig"]);e!==void 0&&M!=null&&p(e,["setup","realtimeInputConfig"],iq(M));const R=h(n,["contextWindowCompression"]);e!==void 0&&R!=null&&p(e,["setup","contextWindowCompression"],sq(R));const P=h(n,["proactivity"]);return e!==void 0&&P!=null&&p(e,["setup","proactivity"],aq(P)),t}function lq(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["setup","model"],Fe(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],oq(r,t)),t}function uq(){return{}}function cq(){return{}}function fq(n){const e={},t=h(n,["media"]);t!=null&&p(e,["mediaChunks"],nC(t));const i=h(n,["audio"]);i!=null&&p(e,["audio"],rC(i));const r=h(n,["audioStreamEnd"]);r!=null&&p(e,["audioStreamEnd"],r);const a=h(n,["video"]);a!=null&&p(e,["video"],iC(a));const l=h(n,["text"]);return l!=null&&p(e,["text"],l),h(n,["activityStart"])!=null&&p(e,["activityStart"],uq()),h(n,["activityEnd"])!=null&&p(e,["activityEnd"],cq()),e}function vC(n){const e={},t=h(n,["text"]);t!=null&&p(e,["text"],t);const i=h(n,["weight"]);return i!=null&&p(e,["weight"],i),e}function dq(n){const e={},t=h(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>vC(r))),p(e,["weightedPrompts"],i)}return e}function bC(n){const e={},t=h(n,["temperature"]);t!=null&&p(e,["temperature"],t);const i=h(n,["topK"]);i!=null&&p(e,["topK"],i);const r=h(n,["seed"]);r!=null&&p(e,["seed"],r);const a=h(n,["guidance"]);a!=null&&p(e,["guidance"],a);const l=h(n,["bpm"]);l!=null&&p(e,["bpm"],l);const c=h(n,["density"]);c!=null&&p(e,["density"],c);const f=h(n,["brightness"]);f!=null&&p(e,["brightness"],f);const d=h(n,["scale"]);d!=null&&p(e,["scale"],d);const g=h(n,["muteBass"]);g!=null&&p(e,["muteBass"],g);const _=h(n,["muteDrums"]);_!=null&&p(e,["muteDrums"],_);const v=h(n,["onlyBassAndDrums"]);return v!=null&&p(e,["onlyBassAndDrums"],v),e}function hq(n){const e={},t=h(n,["musicGenerationConfig"]);return t!=null&&p(e,["musicGenerationConfig"],bC(t)),e}function wC(n){const e={},t=h(n,["model"]);return t!=null&&p(e,["model"],t),e}function TC(n){const e={},t=h(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>vC(r))),p(e,["weightedPrompts"],i)}return e}function mm(n){const e={},t=h(n,["setup"]);t!=null&&p(e,["setup"],wC(t));const i=h(n,["clientContent"]);i!=null&&p(e,["clientContent"],TC(i));const r=h(n,["musicGenerationConfig"]);r!=null&&p(e,["musicGenerationConfig"],bC(r));const a=h(n,["playbackControl"]);return a!=null&&p(e,["playbackControl"],a),e}function pq(n){const e={},t=h(n,["voiceName"]);return t!=null&&p(e,["voiceName"],t),e}function mq(n){const e={},t=h(n,["prebuiltVoiceConfig"]);return t!=null&&p(e,["prebuiltVoiceConfig"],pq(t)),e}function gq(n){const e={},t=h(n,["voiceConfig"]);if(t!=null&&p(e,["voiceConfig"],mq(t)),h(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=h(n,["languageCode"]);return i!=null&&p(e,["languageCode"],i),e}function yq(n){const e={},t=h(n,["fps"]);t!=null&&p(e,["fps"],t);const i=h(n,["endOffset"]);i!=null&&p(e,["endOffset"],i);const r=h(n,["startOffset"]);return r!=null&&p(e,["startOffset"],r),e}function _q(n){const e={},t=h(n,["displayName"]);t!=null&&p(e,["displayName"],t);const i=h(n,["data"]);i!=null&&p(e,["data"],i);const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function vq(n){const e={},t=h(n,["displayName"]);t!=null&&p(e,["displayName"],t);const i=h(n,["fileUri"]);i!=null&&p(e,["fileUri"],i);const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function bq(n){const e={},t=h(n,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],yq(t));const i=h(n,["thought"]);i!=null&&p(e,["thought"],i);const r=h(n,["inlineData"]);r!=null&&p(e,["inlineData"],_q(r));const a=h(n,["fileData"]);a!=null&&p(e,["fileData"],vq(a));const l=h(n,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(n,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(n,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(n,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(n,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const _=h(n,["text"]);return _!=null&&p(e,["text"],_),e}function wq(n){const e={},t=h(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>bq(a))),p(e,["parts"],r)}const i=h(n,["role"]);return i!=null&&p(e,["role"],i),e}function Tq(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&p(e,["description"],t);const i=h(n,["name"]);i!=null&&p(e,["name"],i);const r=h(n,["parameters"]);r!=null&&p(e,["parameters"],r);const a=h(n,["parametersJsonSchema"]);a!=null&&p(e,["parametersJsonSchema"],a);const l=h(n,["response"]);l!=null&&p(e,["response"],l);const c=h(n,["responseJsonSchema"]);return c!=null&&p(e,["responseJsonSchema"],c),e}function Eq(n){const e={},t=h(n,["startTime"]);t!=null&&p(e,["startTime"],t);const i=h(n,["endTime"]);return i!=null&&p(e,["endTime"],i),e}function Sq(n){const e={},t=h(n,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],Eq(t)),e}function Cq(n){const e={},t=h(n,["mode"]);t!=null&&p(e,["mode"],t);const i=h(n,["dynamicThreshold"]);return i!=null&&p(e,["dynamicThreshold"],i),e}function Aq(n){const e={},t=h(n,["dynamicRetrievalConfig"]);return t!=null&&p(e,["dynamicRetrievalConfig"],Cq(t)),e}function Rq(){return{}}function xq(n){const e={},t=h(n,["apiKeyString"]);return t!=null&&p(e,["apiKeyString"],t),e}function Iq(n){const e={},t=h(n,["apiKeyConfig"]);t!=null&&p(e,["apiKeyConfig"],xq(t));const i=h(n,["authType"]);i!=null&&p(e,["authType"],i);const r=h(n,["googleServiceAccountConfig"]);r!=null&&p(e,["googleServiceAccountConfig"],r);const a=h(n,["httpBasicAuthConfig"]);a!=null&&p(e,["httpBasicAuthConfig"],a);const l=h(n,["oauthConfig"]);l!=null&&p(e,["oauthConfig"],l);const c=h(n,["oidcConfig"]);return c!=null&&p(e,["oidcConfig"],c),e}function Mq(n){const e={},t=h(n,["authConfig"]);return t!=null&&p(e,["authConfig"],Iq(t)),e}function Nq(){return{}}function Oq(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(v=>Tq(v))),p(e,["functionDeclarations"],_)}const i=h(n,["retrieval"]);i!=null&&p(e,["retrieval"],i);const r=h(n,["googleSearch"]);r!=null&&p(e,["googleSearch"],Sq(r));const a=h(n,["googleSearchRetrieval"]);a!=null&&p(e,["googleSearchRetrieval"],Aq(a)),h(n,["enterpriseWebSearch"])!=null&&p(e,["enterpriseWebSearch"],Rq());const c=h(n,["googleMaps"]);c!=null&&p(e,["googleMaps"],Mq(c)),h(n,["urlContext"])!=null&&p(e,["urlContext"],Nq());const d=h(n,["codeExecution"]);d!=null&&p(e,["codeExecution"],d);const g=h(n,["computerUse"]);return g!=null&&p(e,["computerUse"],g),e}function kq(n){const e={},t=h(n,["handle"]);t!=null&&p(e,["handle"],t);const i=h(n,["transparent"]);return i!=null&&p(e,["transparent"],i),e}function yE(){return{}}function Pq(n){const e={},t=h(n,["disabled"]);t!=null&&p(e,["disabled"],t);const i=h(n,["startOfSpeechSensitivity"]);i!=null&&p(e,["startOfSpeechSensitivity"],i);const r=h(n,["endOfSpeechSensitivity"]);r!=null&&p(e,["endOfSpeechSensitivity"],r);const a=h(n,["prefixPaddingMs"]);a!=null&&p(e,["prefixPaddingMs"],a);const l=h(n,["silenceDurationMs"]);return l!=null&&p(e,["silenceDurationMs"],l),e}function Dq(n){const e={},t=h(n,["automaticActivityDetection"]);t!=null&&p(e,["automaticActivityDetection"],Pq(t));const i=h(n,["activityHandling"]);i!=null&&p(e,["activityHandling"],i);const r=h(n,["turnCoverage"]);return r!=null&&p(e,["turnCoverage"],r),e}function Lq(n){const e={},t=h(n,["targetTokens"]);return t!=null&&p(e,["targetTokens"],t),e}function Uq(n){const e={},t=h(n,["triggerTokens"]);t!=null&&p(e,["triggerTokens"],t);const i=h(n,["slidingWindow"]);return i!=null&&p(e,["slidingWindow"],Lq(i)),e}function $q(n){const e={},t=h(n,["proactiveAudio"]);return t!=null&&p(e,["proactiveAudio"],t),e}function qq(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&p(e,["setup","generationConfig"],i);const r=h(n,["responseModalities"]);e!==void 0&&r!=null&&p(e,["setup","generationConfig","responseModalities"],r);const a=h(n,["temperature"]);e!==void 0&&a!=null&&p(e,["setup","generationConfig","temperature"],a);const l=h(n,["topP"]);e!==void 0&&l!=null&&p(e,["setup","generationConfig","topP"],l);const c=h(n,["topK"]);e!==void 0&&c!=null&&p(e,["setup","generationConfig","topK"],c);const f=h(n,["maxOutputTokens"]);e!==void 0&&f!=null&&p(e,["setup","generationConfig","maxOutputTokens"],f);const d=h(n,["mediaResolution"]);e!==void 0&&d!=null&&p(e,["setup","generationConfig","mediaResolution"],d);const g=h(n,["seed"]);e!==void 0&&g!=null&&p(e,["setup","generationConfig","seed"],g);const _=h(n,["speechConfig"]);e!==void 0&&_!=null&&p(e,["setup","generationConfig","speechConfig"],gq(Xm(_)));const v=h(n,["enableAffectiveDialog"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],v);const w=h(n,["systemInstruction"]);e!==void 0&&w!=null&&p(e,["setup","systemInstruction"],wq(kt(w)));const T=h(n,["tools"]);if(e!==void 0&&T!=null){let O=ma(T);Array.isArray(O)&&(O=O.map(V=>Oq(pa(V)))),p(e,["setup","tools"],O)}const S=h(n,["sessionResumption"]);e!==void 0&&S!=null&&p(e,["setup","sessionResumption"],kq(S));const C=h(n,["inputAudioTranscription"]);e!==void 0&&C!=null&&p(e,["setup","inputAudioTranscription"],yE());const x=h(n,["outputAudioTranscription"]);e!==void 0&&x!=null&&p(e,["setup","outputAudioTranscription"],yE());const M=h(n,["realtimeInputConfig"]);e!==void 0&&M!=null&&p(e,["setup","realtimeInputConfig"],Dq(M));const R=h(n,["contextWindowCompression"]);e!==void 0&&R!=null&&p(e,["setup","contextWindowCompression"],Uq(R));const P=h(n,["proactivity"]);return e!==void 0&&P!=null&&p(e,["setup","proactivity"],$q(P)),t}function Bq(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["setup","model"],Fe(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],qq(r,t)),t}function Gq(){return{}}function Vq(){return{}}function Fq(n){const e={},t=h(n,["media"]);t!=null&&p(e,["mediaChunks"],nC(t));const i=h(n,["audio"]);i!=null&&p(e,["audio"],rC(i));const r=h(n,["audioStreamEnd"]);r!=null&&p(e,["audioStreamEnd"],r);const a=h(n,["video"]);a!=null&&p(e,["video"],iC(a));const l=h(n,["text"]);return l!=null&&p(e,["text"],l),h(n,["activityStart"])!=null&&p(e,["activityStart"],Gq()),h(n,["activityEnd"])!=null&&p(e,["activityEnd"],Vq()),e}function Hq(){return{}}function zq(n){const e={},t=h(n,["fps"]);t!=null&&p(e,["fps"],t);const i=h(n,["endOffset"]);i!=null&&p(e,["endOffset"],i);const r=h(n,["startOffset"]);return r!=null&&p(e,["startOffset"],r),e}function jq(n){const e={},t=h(n,["data"]);t!=null&&p(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function Jq(n){const e={},t=h(n,["fileUri"]);t!=null&&p(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function Kq(n){const e={},t=h(n,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],zq(t));const i=h(n,["thought"]);i!=null&&p(e,["thought"],i);const r=h(n,["inlineData"]);r!=null&&p(e,["inlineData"],jq(r));const a=h(n,["fileData"]);a!=null&&p(e,["fileData"],Jq(a));const l=h(n,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(n,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(n,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(n,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(n,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const _=h(n,["text"]);return _!=null&&p(e,["text"],_),e}function Yq(n){const e={},t=h(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>Kq(a))),p(e,["parts"],r)}const i=h(n,["role"]);return i!=null&&p(e,["role"],i),e}function _E(n){const e={},t=h(n,["text"]);t!=null&&p(e,["text"],t);const i=h(n,["finished"]);return i!=null&&p(e,["finished"],i),e}function Zq(n){const e={},t=h(n,["retrievedUrl"]);t!=null&&p(e,["retrievedUrl"],t);const i=h(n,["urlRetrievalStatus"]);return i!=null&&p(e,["urlRetrievalStatus"],i),e}function Qq(n){const e={},t=h(n,["urlMetadata"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>Zq(r))),p(e,["urlMetadata"],i)}return e}function Xq(n){const e={},t=h(n,["modelTurn"]);t!=null&&p(e,["modelTurn"],Yq(t));const i=h(n,["turnComplete"]);i!=null&&p(e,["turnComplete"],i);const r=h(n,["interrupted"]);r!=null&&p(e,["interrupted"],r);const a=h(n,["groundingMetadata"]);a!=null&&p(e,["groundingMetadata"],a);const l=h(n,["generationComplete"]);l!=null&&p(e,["generationComplete"],l);const c=h(n,["inputTranscription"]);c!=null&&p(e,["inputTranscription"],_E(c));const f=h(n,["outputTranscription"]);f!=null&&p(e,["outputTranscription"],_E(f));const d=h(n,["urlContextMetadata"]);return d!=null&&p(e,["urlContextMetadata"],Qq(d)),e}function Wq(n){const e={},t=h(n,["id"]);t!=null&&p(e,["id"],t);const i=h(n,["args"]);i!=null&&p(e,["args"],i);const r=h(n,["name"]);return r!=null&&p(e,["name"],r),e}function e4(n){const e={},t=h(n,["functionCalls"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>Wq(r))),p(e,["functionCalls"],i)}return e}function t4(n){const e={},t=h(n,["ids"]);return t!=null&&p(e,["ids"],t),e}function qu(n){const e={},t=h(n,["modality"]);t!=null&&p(e,["modality"],t);const i=h(n,["tokenCount"]);return i!=null&&p(e,["tokenCount"],i),e}function n4(n){const e={},t=h(n,["promptTokenCount"]);t!=null&&p(e,["promptTokenCount"],t);const i=h(n,["cachedContentTokenCount"]);i!=null&&p(e,["cachedContentTokenCount"],i);const r=h(n,["responseTokenCount"]);r!=null&&p(e,["responseTokenCount"],r);const a=h(n,["toolUsePromptTokenCount"]);a!=null&&p(e,["toolUsePromptTokenCount"],a);const l=h(n,["thoughtsTokenCount"]);l!=null&&p(e,["thoughtsTokenCount"],l);const c=h(n,["totalTokenCount"]);c!=null&&p(e,["totalTokenCount"],c);const f=h(n,["promptTokensDetails"]);if(f!=null){let v=f;Array.isArray(v)&&(v=v.map(w=>qu(w))),p(e,["promptTokensDetails"],v)}const d=h(n,["cacheTokensDetails"]);if(d!=null){let v=d;Array.isArray(v)&&(v=v.map(w=>qu(w))),p(e,["cacheTokensDetails"],v)}const g=h(n,["responseTokensDetails"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(w=>qu(w))),p(e,["responseTokensDetails"],v)}const _=h(n,["toolUsePromptTokensDetails"]);if(_!=null){let v=_;Array.isArray(v)&&(v=v.map(w=>qu(w))),p(e,["toolUsePromptTokensDetails"],v)}return e}function i4(n){const e={},t=h(n,["timeLeft"]);return t!=null&&p(e,["timeLeft"],t),e}function r4(n){const e={},t=h(n,["newHandle"]);t!=null&&p(e,["newHandle"],t);const i=h(n,["resumable"]);i!=null&&p(e,["resumable"],i);const r=h(n,["lastConsumedClientMessageIndex"]);return r!=null&&p(e,["lastConsumedClientMessageIndex"],r),e}function s4(n){const e={};h(n,["setupComplete"])!=null&&p(e,["setupComplete"],Hq());const i=h(n,["serverContent"]);i!=null&&p(e,["serverContent"],Xq(i));const r=h(n,["toolCall"]);r!=null&&p(e,["toolCall"],e4(r));const a=h(n,["toolCallCancellation"]);a!=null&&p(e,["toolCallCancellation"],t4(a));const l=h(n,["usageMetadata"]);l!=null&&p(e,["usageMetadata"],n4(l));const c=h(n,["goAway"]);c!=null&&p(e,["goAway"],i4(c));const f=h(n,["sessionResumptionUpdate"]);return f!=null&&p(e,["sessionResumptionUpdate"],r4(f)),e}function a4(){return{}}function o4(n){const e={},t=h(n,["text"]);t!=null&&p(e,["text"],t);const i=h(n,["weight"]);return i!=null&&p(e,["weight"],i),e}function l4(n){const e={},t=h(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>o4(r))),p(e,["weightedPrompts"],i)}return e}function u4(n){const e={},t=h(n,["temperature"]);t!=null&&p(e,["temperature"],t);const i=h(n,["topK"]);i!=null&&p(e,["topK"],i);const r=h(n,["seed"]);r!=null&&p(e,["seed"],r);const a=h(n,["guidance"]);a!=null&&p(e,["guidance"],a);const l=h(n,["bpm"]);l!=null&&p(e,["bpm"],l);const c=h(n,["density"]);c!=null&&p(e,["density"],c);const f=h(n,["brightness"]);f!=null&&p(e,["brightness"],f);const d=h(n,["scale"]);d!=null&&p(e,["scale"],d);const g=h(n,["muteBass"]);g!=null&&p(e,["muteBass"],g);const _=h(n,["muteDrums"]);_!=null&&p(e,["muteDrums"],_);const v=h(n,["onlyBassAndDrums"]);return v!=null&&p(e,["onlyBassAndDrums"],v),e}function c4(n){const e={},t=h(n,["clientContent"]);t!=null&&p(e,["clientContent"],l4(t));const i=h(n,["musicGenerationConfig"]);return i!=null&&p(e,["musicGenerationConfig"],u4(i)),e}function f4(n){const e={},t=h(n,["data"]);t!=null&&p(e,["data"],t);const i=h(n,["mimeType"]);i!=null&&p(e,["mimeType"],i);const r=h(n,["sourceMetadata"]);return r!=null&&p(e,["sourceMetadata"],c4(r)),e}function d4(n){const e={},t=h(n,["audioChunks"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>f4(r))),p(e,["audioChunks"],i)}return e}function h4(n){const e={},t=h(n,["text"]);t!=null&&p(e,["text"],t);const i=h(n,["filteredReason"]);return i!=null&&p(e,["filteredReason"],i),e}function p4(n){const e={};h(n,["setupComplete"])!=null&&p(e,["setupComplete"],a4());const i=h(n,["serverContent"]);i!=null&&p(e,["serverContent"],d4(i));const r=h(n,["filteredPrompt"]);return r!=null&&p(e,["filteredPrompt"],h4(r)),e}function m4(n){const e={},t=h(n,["sessionId"]);return t!=null&&p(e,["sessionId"],t),e}function g4(n){const e={},t=h(n,["fps"]);t!=null&&p(e,["fps"],t);const i=h(n,["endOffset"]);i!=null&&p(e,["endOffset"],i);const r=h(n,["startOffset"]);return r!=null&&p(e,["startOffset"],r),e}function y4(n){const e={},t=h(n,["displayName"]);t!=null&&p(e,["displayName"],t);const i=h(n,["data"]);i!=null&&p(e,["data"],i);const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function _4(n){const e={},t=h(n,["displayName"]);t!=null&&p(e,["displayName"],t);const i=h(n,["fileUri"]);i!=null&&p(e,["fileUri"],i);const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function v4(n){const e={},t=h(n,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],g4(t));const i=h(n,["thought"]);i!=null&&p(e,["thought"],i);const r=h(n,["inlineData"]);r!=null&&p(e,["inlineData"],y4(r));const a=h(n,["fileData"]);a!=null&&p(e,["fileData"],_4(a));const l=h(n,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(n,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(n,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(n,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(n,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const _=h(n,["text"]);return _!=null&&p(e,["text"],_),e}function b4(n){const e={},t=h(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>v4(a))),p(e,["parts"],r)}const i=h(n,["role"]);return i!=null&&p(e,["role"],i),e}function vE(n){const e={},t=h(n,["text"]);t!=null&&p(e,["text"],t);const i=h(n,["finished"]);return i!=null&&p(e,["finished"],i),e}function w4(n){const e={},t=h(n,["modelTurn"]);t!=null&&p(e,["modelTurn"],b4(t));const i=h(n,["turnComplete"]);i!=null&&p(e,["turnComplete"],i);const r=h(n,["interrupted"]);r!=null&&p(e,["interrupted"],r);const a=h(n,["groundingMetadata"]);a!=null&&p(e,["groundingMetadata"],a);const l=h(n,["generationComplete"]);l!=null&&p(e,["generationComplete"],l);const c=h(n,["inputTranscription"]);c!=null&&p(e,["inputTranscription"],vE(c));const f=h(n,["outputTranscription"]);return f!=null&&p(e,["outputTranscription"],vE(f)),e}function T4(n){const e={},t=h(n,["args"]);t!=null&&p(e,["args"],t);const i=h(n,["name"]);return i!=null&&p(e,["name"],i),e}function E4(n){const e={},t=h(n,["functionCalls"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>T4(r))),p(e,["functionCalls"],i)}return e}function S4(n){const e={},t=h(n,["ids"]);return t!=null&&p(e,["ids"],t),e}function Bu(n){const e={},t=h(n,["modality"]);t!=null&&p(e,["modality"],t);const i=h(n,["tokenCount"]);return i!=null&&p(e,["tokenCount"],i),e}function C4(n){const e={},t=h(n,["promptTokenCount"]);t!=null&&p(e,["promptTokenCount"],t);const i=h(n,["cachedContentTokenCount"]);i!=null&&p(e,["cachedContentTokenCount"],i);const r=h(n,["candidatesTokenCount"]);r!=null&&p(e,["responseTokenCount"],r);const a=h(n,["toolUsePromptTokenCount"]);a!=null&&p(e,["toolUsePromptTokenCount"],a);const l=h(n,["thoughtsTokenCount"]);l!=null&&p(e,["thoughtsTokenCount"],l);const c=h(n,["totalTokenCount"]);c!=null&&p(e,["totalTokenCount"],c);const f=h(n,["promptTokensDetails"]);if(f!=null){let w=f;Array.isArray(w)&&(w=w.map(T=>Bu(T))),p(e,["promptTokensDetails"],w)}const d=h(n,["cacheTokensDetails"]);if(d!=null){let w=d;Array.isArray(w)&&(w=w.map(T=>Bu(T))),p(e,["cacheTokensDetails"],w)}const g=h(n,["candidatesTokensDetails"]);if(g!=null){let w=g;Array.isArray(w)&&(w=w.map(T=>Bu(T))),p(e,["responseTokensDetails"],w)}const _=h(n,["toolUsePromptTokensDetails"]);if(_!=null){let w=_;Array.isArray(w)&&(w=w.map(T=>Bu(T))),p(e,["toolUsePromptTokensDetails"],w)}const v=h(n,["trafficType"]);return v!=null&&p(e,["trafficType"],v),e}function A4(n){const e={},t=h(n,["timeLeft"]);return t!=null&&p(e,["timeLeft"],t),e}function R4(n){const e={},t=h(n,["newHandle"]);t!=null&&p(e,["newHandle"],t);const i=h(n,["resumable"]);i!=null&&p(e,["resumable"],i);const r=h(n,["lastConsumedClientMessageIndex"]);return r!=null&&p(e,["lastConsumedClientMessageIndex"],r),e}function x4(n){const e={},t=h(n,["setupComplete"]);t!=null&&p(e,["setupComplete"],m4(t));const i=h(n,["serverContent"]);i!=null&&p(e,["serverContent"],w4(i));const r=h(n,["toolCall"]);r!=null&&p(e,["toolCall"],E4(r));const a=h(n,["toolCallCancellation"]);a!=null&&p(e,["toolCallCancellation"],S4(a));const l=h(n,["usageMetadata"]);l!=null&&p(e,["usageMetadata"],C4(l));const c=h(n,["goAway"]);c!=null&&p(e,["goAway"],A4(c));const f=h(n,["sessionResumptionUpdate"]);return f!=null&&p(e,["sessionResumptionUpdate"],R4(f)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function I4(n){const e={},t=h(n,["fps"]);t!=null&&p(e,["fps"],t);const i=h(n,["endOffset"]);i!=null&&p(e,["endOffset"],i);const r=h(n,["startOffset"]);return r!=null&&p(e,["startOffset"],r),e}function M4(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&p(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function N4(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&p(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function O4(n){const e={},t=h(n,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],I4(t));const i=h(n,["thought"]);i!=null&&p(e,["thought"],i);const r=h(n,["inlineData"]);r!=null&&p(e,["inlineData"],M4(r));const a=h(n,["fileData"]);a!=null&&p(e,["fileData"],N4(a));const l=h(n,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(n,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(n,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(n,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(n,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const _=h(n,["text"]);return _!=null&&p(e,["text"],_),e}function xc(n){const e={},t=h(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>O4(a))),p(e,["parts"],r)}const i=h(n,["role"]);return i!=null&&p(e,["role"],i),e}function k4(n){const e={},t=h(n,["anyOf"]);t!=null&&p(e,["anyOf"],t);const i=h(n,["default"]);i!=null&&p(e,["default"],i);const r=h(n,["description"]);r!=null&&p(e,["description"],r);const a=h(n,["enum"]);a!=null&&p(e,["enum"],a);const l=h(n,["example"]);l!=null&&p(e,["example"],l);const c=h(n,["format"]);c!=null&&p(e,["format"],c);const f=h(n,["items"]);f!=null&&p(e,["items"],f);const d=h(n,["maxItems"]);d!=null&&p(e,["maxItems"],d);const g=h(n,["maxLength"]);g!=null&&p(e,["maxLength"],g);const _=h(n,["maxProperties"]);_!=null&&p(e,["maxProperties"],_);const v=h(n,["maximum"]);v!=null&&p(e,["maximum"],v);const w=h(n,["minItems"]);w!=null&&p(e,["minItems"],w);const T=h(n,["minLength"]);T!=null&&p(e,["minLength"],T);const S=h(n,["minProperties"]);S!=null&&p(e,["minProperties"],S);const C=h(n,["minimum"]);C!=null&&p(e,["minimum"],C);const x=h(n,["nullable"]);x!=null&&p(e,["nullable"],x);const M=h(n,["pattern"]);M!=null&&p(e,["pattern"],M);const R=h(n,["properties"]);R!=null&&p(e,["properties"],R);const P=h(n,["propertyOrdering"]);P!=null&&p(e,["propertyOrdering"],P);const O=h(n,["required"]);O!=null&&p(e,["required"],O);const V=h(n,["title"]);V!=null&&p(e,["title"],V);const J=h(n,["type"]);return J!=null&&p(e,["type"],J),e}function P4(n){const e={};if(h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=h(n,["category"]);t!=null&&p(e,["category"],t);const i=h(n,["threshold"]);return i!=null&&p(e,["threshold"],i),e}function D4(n){const e={},t=h(n,["behavior"]);t!=null&&p(e,["behavior"],t);const i=h(n,["description"]);i!=null&&p(e,["description"],i);const r=h(n,["name"]);r!=null&&p(e,["name"],r);const a=h(n,["parameters"]);a!=null&&p(e,["parameters"],a);const l=h(n,["parametersJsonSchema"]);l!=null&&p(e,["parametersJsonSchema"],l);const c=h(n,["response"]);c!=null&&p(e,["response"],c);const f=h(n,["responseJsonSchema"]);return f!=null&&p(e,["responseJsonSchema"],f),e}function L4(n){const e={},t=h(n,["startTime"]);t!=null&&p(e,["startTime"],t);const i=h(n,["endTime"]);return i!=null&&p(e,["endTime"],i),e}function U4(n){const e={},t=h(n,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],L4(t)),e}function $4(n){const e={},t=h(n,["mode"]);t!=null&&p(e,["mode"],t);const i=h(n,["dynamicThreshold"]);return i!=null&&p(e,["dynamicThreshold"],i),e}function q4(n){const e={},t=h(n,["dynamicRetrievalConfig"]);return t!=null&&p(e,["dynamicRetrievalConfig"],$4(t)),e}function B4(){return{}}function G4(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(d=>D4(d))),p(e,["functionDeclarations"],f)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&p(e,["googleSearch"],U4(i));const r=h(n,["googleSearchRetrieval"]);if(r!=null&&p(e,["googleSearchRetrieval"],q4(r)),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(n,["urlContext"])!=null&&p(e,["urlContext"],B4());const l=h(n,["codeExecution"]);l!=null&&p(e,["codeExecution"],l);const c=h(n,["computerUse"]);return c!=null&&p(e,["computerUse"],c),e}function V4(n){const e={},t=h(n,["mode"]);t!=null&&p(e,["mode"],t);const i=h(n,["allowedFunctionNames"]);return i!=null&&p(e,["allowedFunctionNames"],i),e}function F4(n){const e={},t=h(n,["latitude"]);t!=null&&p(e,["latitude"],t);const i=h(n,["longitude"]);return i!=null&&p(e,["longitude"],i),e}function H4(n){const e={},t=h(n,["latLng"]);t!=null&&p(e,["latLng"],F4(t));const i=h(n,["languageCode"]);return i!=null&&p(e,["languageCode"],i),e}function z4(n){const e={},t=h(n,["functionCallingConfig"]);t!=null&&p(e,["functionCallingConfig"],V4(t));const i=h(n,["retrievalConfig"]);return i!=null&&p(e,["retrievalConfig"],H4(i)),e}function j4(n){const e={},t=h(n,["voiceName"]);return t!=null&&p(e,["voiceName"],t),e}function EC(n){const e={},t=h(n,["prebuiltVoiceConfig"]);return t!=null&&p(e,["prebuiltVoiceConfig"],j4(t)),e}function J4(n){const e={},t=h(n,["speaker"]);t!=null&&p(e,["speaker"],t);const i=h(n,["voiceConfig"]);return i!=null&&p(e,["voiceConfig"],EC(i)),e}function K4(n){const e={},t=h(n,["speakerVoiceConfigs"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>J4(r))),p(e,["speakerVoiceConfigs"],i)}return e}function Y4(n){const e={},t=h(n,["voiceConfig"]);t!=null&&p(e,["voiceConfig"],EC(t));const i=h(n,["multiSpeakerVoiceConfig"]);i!=null&&p(e,["multiSpeakerVoiceConfig"],K4(i));const r=h(n,["languageCode"]);return r!=null&&p(e,["languageCode"],r),e}function Z4(n){const e={},t=h(n,["includeThoughts"]);t!=null&&p(e,["includeThoughts"],t);const i=h(n,["thinkingBudget"]);return i!=null&&p(e,["thinkingBudget"],i),e}function Q4(n,e,t){const i={},r=h(e,["systemInstruction"]);t!==void 0&&r!=null&&p(t,["systemInstruction"],xc(kt(r)));const a=h(e,["temperature"]);a!=null&&p(i,["temperature"],a);const l=h(e,["topP"]);l!=null&&p(i,["topP"],l);const c=h(e,["topK"]);c!=null&&p(i,["topK"],c);const f=h(e,["candidateCount"]);f!=null&&p(i,["candidateCount"],f);const d=h(e,["maxOutputTokens"]);d!=null&&p(i,["maxOutputTokens"],d);const g=h(e,["stopSequences"]);g!=null&&p(i,["stopSequences"],g);const _=h(e,["responseLogprobs"]);_!=null&&p(i,["responseLogprobs"],_);const v=h(e,["logprobs"]);v!=null&&p(i,["logprobs"],v);const w=h(e,["presencePenalty"]);w!=null&&p(i,["presencePenalty"],w);const T=h(e,["frequencyPenalty"]);T!=null&&p(i,["frequencyPenalty"],T);const S=h(e,["seed"]);S!=null&&p(i,["seed"],S);const C=h(e,["responseMimeType"]);C!=null&&p(i,["responseMimeType"],C);const x=h(e,["responseSchema"]);x!=null&&p(i,["responseSchema"],k4(Zm(x)));const M=h(e,["responseJsonSchema"]);if(M!=null&&p(i,["responseJsonSchema"],M),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const R=h(e,["safetySettings"]);if(t!==void 0&&R!=null){let ye=R;Array.isArray(ye)&&(ye=ye.map(Ue=>P4(Ue))),p(t,["safetySettings"],ye)}const P=h(e,["tools"]);if(t!==void 0&&P!=null){let ye=ma(P);Array.isArray(ye)&&(ye=ye.map(Ue=>G4(pa(Ue)))),p(t,["tools"],ye)}const O=h(e,["toolConfig"]);if(t!==void 0&&O!=null&&p(t,["toolConfig"],z4(O)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const V=h(e,["cachedContent"]);t!==void 0&&V!=null&&p(t,["cachedContent"],_i(n,V));const J=h(e,["responseModalities"]);J!=null&&p(i,["responseModalities"],J);const Z=h(e,["mediaResolution"]);Z!=null&&p(i,["mediaResolution"],Z);const re=h(e,["speechConfig"]);if(re!=null&&p(i,["speechConfig"],Y4(Qm(re))),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Se=h(e,["thinkingConfig"]);return Se!=null&&p(i,["thinkingConfig"],Z4(Se)),i}function bE(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","model"],Fe(n,i));const r=h(e,["contents"]);if(r!=null){let l=En(r);Array.isArray(l)&&(l=l.map(c=>xc(c))),p(t,["contents"],l)}const a=h(e,["config"]);return a!=null&&p(t,["generationConfig"],Q4(n,a,t)),t}function X4(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&p(e,["requests[]","taskType"],i);const r=h(n,["title"]);e!==void 0&&r!=null&&p(e,["requests[]","title"],r);const a=h(n,["outputDimensionality"]);if(e!==void 0&&a!=null&&p(e,["requests[]","outputDimensionality"],a),h(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function W4(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","model"],Fe(n,i));const r=h(e,["contents"]);r!=null&&p(t,["requests[]","content"],aC(n,r));const a=h(e,["config"]);a!=null&&p(t,["config"],X4(a,t));const l=h(e,["model"]);return l!==void 0&&p(t,["requests[]","model"],Fe(n,l)),t}function eB(n,e){const t={};if(h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=h(n,["numberOfImages"]);e!==void 0&&i!=null&&p(e,["parameters","sampleCount"],i);const r=h(n,["aspectRatio"]);e!==void 0&&r!=null&&p(e,["parameters","aspectRatio"],r);const a=h(n,["guidanceScale"]);if(e!==void 0&&a!=null&&p(e,["parameters","guidanceScale"],a),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=h(n,["safetyFilterLevel"]);e!==void 0&&l!=null&&p(e,["parameters","safetySetting"],l);const c=h(n,["personGeneration"]);e!==void 0&&c!=null&&p(e,["parameters","personGeneration"],c);const f=h(n,["includeSafetyAttributes"]);e!==void 0&&f!=null&&p(e,["parameters","includeSafetyAttributes"],f);const d=h(n,["includeRaiReason"]);e!==void 0&&d!=null&&p(e,["parameters","includeRaiReason"],d);const g=h(n,["language"]);e!==void 0&&g!=null&&p(e,["parameters","language"],g);const _=h(n,["outputMimeType"]);e!==void 0&&_!=null&&p(e,["parameters","outputOptions","mimeType"],_);const v=h(n,["outputCompressionQuality"]);if(e!==void 0&&v!=null&&p(e,["parameters","outputOptions","compressionQuality"],v),h(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(h(n,["imageSize"])!==void 0)throw new Error("imageSize parameter is not supported in Gemini API.");if(h(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function tB(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","model"],Fe(n,i));const r=h(e,["prompt"]);r!=null&&p(t,["instances[0]","prompt"],r);const a=h(e,["config"]);return a!=null&&p(t,["config"],eB(a,t)),t}function nB(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","name"],Fe(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],r),t}function iB(n,e,t){const i={},r=h(e,["pageSize"]);t!==void 0&&r!=null&&p(t,["_query","pageSize"],r);const a=h(e,["pageToken"]);t!==void 0&&a!=null&&p(t,["_query","pageToken"],a);const l=h(e,["filter"]);t!==void 0&&l!=null&&p(t,["_query","filter"],l);const c=h(e,["queryBase"]);return t!==void 0&&c!=null&&p(t,["_url","models_url"],uC(n,c)),i}function rB(n,e){const t={},i=h(e,["config"]);return i!=null&&p(t,["config"],iB(n,i,t)),t}function sB(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&p(e,["displayName"],i);const r=h(n,["description"]);e!==void 0&&r!=null&&p(e,["description"],r);const a=h(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&p(e,["defaultCheckpointId"],a),t}function aB(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","name"],Fe(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],sB(r,t)),t}function oB(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","name"],Fe(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],r),t}function lB(n){const e={};if(h(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(h(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(h(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function uB(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","model"],Fe(n,i));const r=h(e,["contents"]);if(r!=null){let l=En(r);Array.isArray(l)&&(l=l.map(c=>xc(c))),p(t,["contents"],l)}const a=h(e,["config"]);return a!=null&&p(t,["config"],lB(a)),t}function cB(n){const e={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=h(n,["imageBytes"]);t!=null&&p(e,["bytesBase64Encoded"],Fr(t));const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function fB(n,e){const t={},i=h(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&p(e,["parameters","sampleCount"],i),h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const r=h(n,["durationSeconds"]);if(e!==void 0&&r!=null&&p(e,["parameters","durationSeconds"],r),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=h(n,["aspectRatio"]);if(e!==void 0&&a!=null&&p(e,["parameters","aspectRatio"],a),h(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=h(n,["personGeneration"]);if(e!==void 0&&l!=null&&p(e,["parameters","personGeneration"],l),h(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=h(n,["negativePrompt"]);e!==void 0&&c!=null&&p(e,["parameters","negativePrompt"],c);const f=h(n,["enhancePrompt"]);if(e!==void 0&&f!=null&&p(e,["parameters","enhancePrompt"],f),h(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(h(n,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(h(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function dB(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","model"],Fe(n,i));const r=h(e,["prompt"]);r!=null&&p(t,["instances[0]","prompt"],r);const a=h(e,["image"]);if(a!=null&&p(t,["instances[0]","image"],cB(a)),h(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const l=h(e,["config"]);return l!=null&&p(t,["config"],fB(l,t)),t}function hB(n){const e={},t=h(n,["fps"]);t!=null&&p(e,["fps"],t);const i=h(n,["endOffset"]);i!=null&&p(e,["endOffset"],i);const r=h(n,["startOffset"]);return r!=null&&p(e,["startOffset"],r),e}function pB(n){const e={},t=h(n,["displayName"]);t!=null&&p(e,["displayName"],t);const i=h(n,["data"]);i!=null&&p(e,["data"],i);const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function mB(n){const e={},t=h(n,["displayName"]);t!=null&&p(e,["displayName"],t);const i=h(n,["fileUri"]);i!=null&&p(e,["fileUri"],i);const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function gB(n){const e={},t=h(n,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],hB(t));const i=h(n,["thought"]);i!=null&&p(e,["thought"],i);const r=h(n,["inlineData"]);r!=null&&p(e,["inlineData"],pB(r));const a=h(n,["fileData"]);a!=null&&p(e,["fileData"],mB(a));const l=h(n,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(n,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(n,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(n,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(n,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const _=h(n,["text"]);return _!=null&&p(e,["text"],_),e}function ya(n){const e={},t=h(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>gB(a))),p(e,["parts"],r)}const i=h(n,["role"]);return i!=null&&p(e,["role"],i),e}function yB(n){const e={},t=h(n,["anyOf"]);t!=null&&p(e,["anyOf"],t);const i=h(n,["default"]);i!=null&&p(e,["default"],i);const r=h(n,["description"]);r!=null&&p(e,["description"],r);const a=h(n,["enum"]);a!=null&&p(e,["enum"],a);const l=h(n,["example"]);l!=null&&p(e,["example"],l);const c=h(n,["format"]);c!=null&&p(e,["format"],c);const f=h(n,["items"]);f!=null&&p(e,["items"],f);const d=h(n,["maxItems"]);d!=null&&p(e,["maxItems"],d);const g=h(n,["maxLength"]);g!=null&&p(e,["maxLength"],g);const _=h(n,["maxProperties"]);_!=null&&p(e,["maxProperties"],_);const v=h(n,["maximum"]);v!=null&&p(e,["maximum"],v);const w=h(n,["minItems"]);w!=null&&p(e,["minItems"],w);const T=h(n,["minLength"]);T!=null&&p(e,["minLength"],T);const S=h(n,["minProperties"]);S!=null&&p(e,["minProperties"],S);const C=h(n,["minimum"]);C!=null&&p(e,["minimum"],C);const x=h(n,["nullable"]);x!=null&&p(e,["nullable"],x);const M=h(n,["pattern"]);M!=null&&p(e,["pattern"],M);const R=h(n,["properties"]);R!=null&&p(e,["properties"],R);const P=h(n,["propertyOrdering"]);P!=null&&p(e,["propertyOrdering"],P);const O=h(n,["required"]);O!=null&&p(e,["required"],O);const V=h(n,["title"]);V!=null&&p(e,["title"],V);const J=h(n,["type"]);return J!=null&&p(e,["type"],J),e}function _B(n){const e={},t=h(n,["featureSelectionPreference"]);return t!=null&&p(e,["featureSelectionPreference"],t),e}function vB(n){const e={},t=h(n,["method"]);t!=null&&p(e,["method"],t);const i=h(n,["category"]);i!=null&&p(e,["category"],i);const r=h(n,["threshold"]);return r!=null&&p(e,["threshold"],r),e}function bB(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&p(e,["description"],t);const i=h(n,["name"]);i!=null&&p(e,["name"],i);const r=h(n,["parameters"]);r!=null&&p(e,["parameters"],r);const a=h(n,["parametersJsonSchema"]);a!=null&&p(e,["parametersJsonSchema"],a);const l=h(n,["response"]);l!=null&&p(e,["response"],l);const c=h(n,["responseJsonSchema"]);return c!=null&&p(e,["responseJsonSchema"],c),e}function wB(n){const e={},t=h(n,["startTime"]);t!=null&&p(e,["startTime"],t);const i=h(n,["endTime"]);return i!=null&&p(e,["endTime"],i),e}function TB(n){const e={},t=h(n,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],wB(t)),e}function EB(n){const e={},t=h(n,["mode"]);t!=null&&p(e,["mode"],t);const i=h(n,["dynamicThreshold"]);return i!=null&&p(e,["dynamicThreshold"],i),e}function SB(n){const e={},t=h(n,["dynamicRetrievalConfig"]);return t!=null&&p(e,["dynamicRetrievalConfig"],EB(t)),e}function CB(){return{}}function AB(n){const e={},t=h(n,["apiKeyString"]);return t!=null&&p(e,["apiKeyString"],t),e}function RB(n){const e={},t=h(n,["apiKeyConfig"]);t!=null&&p(e,["apiKeyConfig"],AB(t));const i=h(n,["authType"]);i!=null&&p(e,["authType"],i);const r=h(n,["googleServiceAccountConfig"]);r!=null&&p(e,["googleServiceAccountConfig"],r);const a=h(n,["httpBasicAuthConfig"]);a!=null&&p(e,["httpBasicAuthConfig"],a);const l=h(n,["oauthConfig"]);l!=null&&p(e,["oauthConfig"],l);const c=h(n,["oidcConfig"]);return c!=null&&p(e,["oidcConfig"],c),e}function xB(n){const e={},t=h(n,["authConfig"]);return t!=null&&p(e,["authConfig"],RB(t)),e}function IB(){return{}}function SC(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(v=>bB(v))),p(e,["functionDeclarations"],_)}const i=h(n,["retrieval"]);i!=null&&p(e,["retrieval"],i);const r=h(n,["googleSearch"]);r!=null&&p(e,["googleSearch"],TB(r));const a=h(n,["googleSearchRetrieval"]);a!=null&&p(e,["googleSearchRetrieval"],SB(a)),h(n,["enterpriseWebSearch"])!=null&&p(e,["enterpriseWebSearch"],CB());const c=h(n,["googleMaps"]);c!=null&&p(e,["googleMaps"],xB(c)),h(n,["urlContext"])!=null&&p(e,["urlContext"],IB());const d=h(n,["codeExecution"]);d!=null&&p(e,["codeExecution"],d);const g=h(n,["computerUse"]);return g!=null&&p(e,["computerUse"],g),e}function MB(n){const e={},t=h(n,["mode"]);t!=null&&p(e,["mode"],t);const i=h(n,["allowedFunctionNames"]);return i!=null&&p(e,["allowedFunctionNames"],i),e}function NB(n){const e={},t=h(n,["latitude"]);t!=null&&p(e,["latitude"],t);const i=h(n,["longitude"]);return i!=null&&p(e,["longitude"],i),e}function OB(n){const e={},t=h(n,["latLng"]);t!=null&&p(e,["latLng"],NB(t));const i=h(n,["languageCode"]);return i!=null&&p(e,["languageCode"],i),e}function kB(n){const e={},t=h(n,["functionCallingConfig"]);t!=null&&p(e,["functionCallingConfig"],MB(t));const i=h(n,["retrievalConfig"]);return i!=null&&p(e,["retrievalConfig"],OB(i)),e}function PB(n){const e={},t=h(n,["voiceName"]);return t!=null&&p(e,["voiceName"],t),e}function DB(n){const e={},t=h(n,["prebuiltVoiceConfig"]);return t!=null&&p(e,["prebuiltVoiceConfig"],PB(t)),e}function LB(n){const e={},t=h(n,["voiceConfig"]);if(t!=null&&p(e,["voiceConfig"],DB(t)),h(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=h(n,["languageCode"]);return i!=null&&p(e,["languageCode"],i),e}function UB(n){const e={},t=h(n,["includeThoughts"]);t!=null&&p(e,["includeThoughts"],t);const i=h(n,["thinkingBudget"]);return i!=null&&p(e,["thinkingBudget"],i),e}function $B(n,e,t){const i={},r=h(e,["systemInstruction"]);t!==void 0&&r!=null&&p(t,["systemInstruction"],ya(kt(r)));const a=h(e,["temperature"]);a!=null&&p(i,["temperature"],a);const l=h(e,["topP"]);l!=null&&p(i,["topP"],l);const c=h(e,["topK"]);c!=null&&p(i,["topK"],c);const f=h(e,["candidateCount"]);f!=null&&p(i,["candidateCount"],f);const d=h(e,["maxOutputTokens"]);d!=null&&p(i,["maxOutputTokens"],d);const g=h(e,["stopSequences"]);g!=null&&p(i,["stopSequences"],g);const _=h(e,["responseLogprobs"]);_!=null&&p(i,["responseLogprobs"],_);const v=h(e,["logprobs"]);v!=null&&p(i,["logprobs"],v);const w=h(e,["presencePenalty"]);w!=null&&p(i,["presencePenalty"],w);const T=h(e,["frequencyPenalty"]);T!=null&&p(i,["frequencyPenalty"],T);const S=h(e,["seed"]);S!=null&&p(i,["seed"],S);const C=h(e,["responseMimeType"]);C!=null&&p(i,["responseMimeType"],C);const x=h(e,["responseSchema"]);x!=null&&p(i,["responseSchema"],yB(Zm(x)));const M=h(e,["responseJsonSchema"]);M!=null&&p(i,["responseJsonSchema"],M);const R=h(e,["routingConfig"]);R!=null&&p(i,["routingConfig"],R);const P=h(e,["modelSelectionConfig"]);P!=null&&p(i,["modelConfig"],_B(P));const O=h(e,["safetySettings"]);if(t!==void 0&&O!=null){let Y=O;Array.isArray(Y)&&(Y=Y.map(L=>vB(L))),p(t,["safetySettings"],Y)}const V=h(e,["tools"]);if(t!==void 0&&V!=null){let Y=ma(V);Array.isArray(Y)&&(Y=Y.map(L=>SC(pa(L)))),p(t,["tools"],Y)}const J=h(e,["toolConfig"]);t!==void 0&&J!=null&&p(t,["toolConfig"],kB(J));const Z=h(e,["labels"]);t!==void 0&&Z!=null&&p(t,["labels"],Z);const re=h(e,["cachedContent"]);t!==void 0&&re!=null&&p(t,["cachedContent"],_i(n,re));const Se=h(e,["responseModalities"]);Se!=null&&p(i,["responseModalities"],Se);const ye=h(e,["mediaResolution"]);ye!=null&&p(i,["mediaResolution"],ye);const Ue=h(e,["speechConfig"]);Ue!=null&&p(i,["speechConfig"],LB(Qm(Ue)));const Gt=h(e,["audioTimestamp"]);Gt!=null&&p(i,["audioTimestamp"],Gt);const ne=h(e,["thinkingConfig"]);return ne!=null&&p(i,["thinkingConfig"],UB(ne)),i}function wE(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","model"],Fe(n,i));const r=h(e,["contents"]);if(r!=null){let l=En(r);Array.isArray(l)&&(l=l.map(c=>ya(c))),p(t,["contents"],l)}const a=h(e,["config"]);return a!=null&&p(t,["generationConfig"],$B(n,a,t)),t}function qB(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&p(e,["instances[]","task_type"],i);const r=h(n,["title"]);e!==void 0&&r!=null&&p(e,["instances[]","title"],r);const a=h(n,["outputDimensionality"]);e!==void 0&&a!=null&&p(e,["parameters","outputDimensionality"],a);const l=h(n,["mimeType"]);e!==void 0&&l!=null&&p(e,["instances[]","mimeType"],l);const c=h(n,["autoTruncate"]);return e!==void 0&&c!=null&&p(e,["parameters","autoTruncate"],c),t}function BB(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","model"],Fe(n,i));const r=h(e,["contents"]);r!=null&&p(t,["instances[]","content"],aC(n,r));const a=h(e,["config"]);return a!=null&&p(t,["config"],qB(a,t)),t}function GB(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&p(e,["parameters","storageUri"],i);const r=h(n,["negativePrompt"]);e!==void 0&&r!=null&&p(e,["parameters","negativePrompt"],r);const a=h(n,["numberOfImages"]);e!==void 0&&a!=null&&p(e,["parameters","sampleCount"],a);const l=h(n,["aspectRatio"]);e!==void 0&&l!=null&&p(e,["parameters","aspectRatio"],l);const c=h(n,["guidanceScale"]);e!==void 0&&c!=null&&p(e,["parameters","guidanceScale"],c);const f=h(n,["seed"]);e!==void 0&&f!=null&&p(e,["parameters","seed"],f);const d=h(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&p(e,["parameters","safetySetting"],d);const g=h(n,["personGeneration"]);e!==void 0&&g!=null&&p(e,["parameters","personGeneration"],g);const _=h(n,["includeSafetyAttributes"]);e!==void 0&&_!=null&&p(e,["parameters","includeSafetyAttributes"],_);const v=h(n,["includeRaiReason"]);e!==void 0&&v!=null&&p(e,["parameters","includeRaiReason"],v);const w=h(n,["language"]);e!==void 0&&w!=null&&p(e,["parameters","language"],w);const T=h(n,["outputMimeType"]);e!==void 0&&T!=null&&p(e,["parameters","outputOptions","mimeType"],T);const S=h(n,["outputCompressionQuality"]);e!==void 0&&S!=null&&p(e,["parameters","outputOptions","compressionQuality"],S);const C=h(n,["addWatermark"]);e!==void 0&&C!=null&&p(e,["parameters","addWatermark"],C);const x=h(n,["imageSize"]);e!==void 0&&x!=null&&p(e,["parameters","sampleImageSize"],x);const M=h(n,["enhancePrompt"]);return e!==void 0&&M!=null&&p(e,["parameters","enhancePrompt"],M),t}function VB(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","model"],Fe(n,i));const r=h(e,["prompt"]);r!=null&&p(t,["instances[0]","prompt"],r);const a=h(e,["config"]);return a!=null&&p(t,["config"],GB(a,t)),t}function Ic(n){const e={},t=h(n,["gcsUri"]);t!=null&&p(e,["gcsUri"],t);const i=h(n,["imageBytes"]);i!=null&&p(e,["bytesBase64Encoded"],Fr(i));const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function FB(n){const e={},t=h(n,["maskMode"]);t!=null&&p(e,["maskMode"],t);const i=h(n,["segmentationClasses"]);i!=null&&p(e,["maskClasses"],i);const r=h(n,["maskDilation"]);return r!=null&&p(e,["dilation"],r),e}function HB(n){const e={},t=h(n,["controlType"]);t!=null&&p(e,["controlType"],t);const i=h(n,["enableControlImageComputation"]);return i!=null&&p(e,["computeControl"],i),e}function zB(n){const e={},t=h(n,["styleDescription"]);return t!=null&&p(e,["styleDescription"],t),e}function jB(n){const e={},t=h(n,["subjectType"]);t!=null&&p(e,["subjectType"],t);const i=h(n,["subjectDescription"]);return i!=null&&p(e,["subjectDescription"],i),e}function JB(n){const e={},t=h(n,["referenceImage"]);t!=null&&p(e,["referenceImage"],Ic(t));const i=h(n,["referenceId"]);i!=null&&p(e,["referenceId"],i);const r=h(n,["referenceType"]);r!=null&&p(e,["referenceType"],r);const a=h(n,["maskImageConfig"]);a!=null&&p(e,["maskImageConfig"],FB(a));const l=h(n,["controlImageConfig"]);l!=null&&p(e,["controlImageConfig"],HB(l));const c=h(n,["styleImageConfig"]);c!=null&&p(e,["styleImageConfig"],zB(c));const f=h(n,["subjectImageConfig"]);return f!=null&&p(e,["subjectImageConfig"],jB(f)),e}function KB(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&p(e,["parameters","storageUri"],i);const r=h(n,["negativePrompt"]);e!==void 0&&r!=null&&p(e,["parameters","negativePrompt"],r);const a=h(n,["numberOfImages"]);e!==void 0&&a!=null&&p(e,["parameters","sampleCount"],a);const l=h(n,["aspectRatio"]);e!==void 0&&l!=null&&p(e,["parameters","aspectRatio"],l);const c=h(n,["guidanceScale"]);e!==void 0&&c!=null&&p(e,["parameters","guidanceScale"],c);const f=h(n,["seed"]);e!==void 0&&f!=null&&p(e,["parameters","seed"],f);const d=h(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&p(e,["parameters","safetySetting"],d);const g=h(n,["personGeneration"]);e!==void 0&&g!=null&&p(e,["parameters","personGeneration"],g);const _=h(n,["includeSafetyAttributes"]);e!==void 0&&_!=null&&p(e,["parameters","includeSafetyAttributes"],_);const v=h(n,["includeRaiReason"]);e!==void 0&&v!=null&&p(e,["parameters","includeRaiReason"],v);const w=h(n,["language"]);e!==void 0&&w!=null&&p(e,["parameters","language"],w);const T=h(n,["outputMimeType"]);e!==void 0&&T!=null&&p(e,["parameters","outputOptions","mimeType"],T);const S=h(n,["outputCompressionQuality"]);e!==void 0&&S!=null&&p(e,["parameters","outputOptions","compressionQuality"],S);const C=h(n,["addWatermark"]);e!==void 0&&C!=null&&p(e,["parameters","addWatermark"],C);const x=h(n,["editMode"]);e!==void 0&&x!=null&&p(e,["parameters","editMode"],x);const M=h(n,["baseSteps"]);return e!==void 0&&M!=null&&p(e,["parameters","editConfig","baseSteps"],M),t}function YB(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","model"],Fe(n,i));const r=h(e,["prompt"]);r!=null&&p(t,["instances[0]","prompt"],r);const a=h(e,["referenceImages"]);if(a!=null){let c=a;Array.isArray(c)&&(c=c.map(f=>JB(f))),p(t,["instances[0]","referenceImages"],c)}const l=h(e,["config"]);return l!=null&&p(t,["config"],KB(l,t)),t}function ZB(n,e){const t={},i=h(n,["includeRaiReason"]);e!==void 0&&i!=null&&p(e,["parameters","includeRaiReason"],i);const r=h(n,["outputMimeType"]);e!==void 0&&r!=null&&p(e,["parameters","outputOptions","mimeType"],r);const a=h(n,["outputCompressionQuality"]);e!==void 0&&a!=null&&p(e,["parameters","outputOptions","compressionQuality"],a);const l=h(n,["enhanceInputImage"]);e!==void 0&&l!=null&&p(e,["parameters","upscaleConfig","enhanceInputImage"],l);const c=h(n,["imagePreservationFactor"]);e!==void 0&&c!=null&&p(e,["parameters","upscaleConfig","imagePreservationFactor"],c);const f=h(n,["numberOfImages"]);e!==void 0&&f!=null&&p(e,["parameters","sampleCount"],f);const d=h(n,["mode"]);return e!==void 0&&d!=null&&p(e,["parameters","mode"],d),t}function QB(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","model"],Fe(n,i));const r=h(e,["image"]);r!=null&&p(t,["instances[0]","image"],Ic(r));const a=h(e,["upscaleFactor"]);a!=null&&p(t,["parameters","upscaleConfig","upscaleFactor"],a);const l=h(e,["config"]);return l!=null&&p(t,["config"],ZB(l,t)),t}function XB(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","name"],Fe(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],r),t}function WB(n,e,t){const i={},r=h(e,["pageSize"]);t!==void 0&&r!=null&&p(t,["_query","pageSize"],r);const a=h(e,["pageToken"]);t!==void 0&&a!=null&&p(t,["_query","pageToken"],a);const l=h(e,["filter"]);t!==void 0&&l!=null&&p(t,["_query","filter"],l);const c=h(e,["queryBase"]);return t!==void 0&&c!=null&&p(t,["_url","models_url"],uC(n,c)),i}function eG(n,e){const t={},i=h(e,["config"]);return i!=null&&p(t,["config"],WB(n,i,t)),t}function tG(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&p(e,["displayName"],i);const r=h(n,["description"]);e!==void 0&&r!=null&&p(e,["description"],r);const a=h(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&p(e,["defaultCheckpointId"],a),t}function nG(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","model"],Fe(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],tG(r,t)),t}function iG(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","name"],Fe(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],r),t}function rG(n,e){const t={},i=h(n,["systemInstruction"]);e!==void 0&&i!=null&&p(e,["systemInstruction"],ya(kt(i)));const r=h(n,["tools"]);if(e!==void 0&&r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>SC(c))),p(e,["tools"],l)}const a=h(n,["generationConfig"]);return e!==void 0&&a!=null&&p(e,["generationConfig"],a),t}function sG(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","model"],Fe(n,i));const r=h(e,["contents"]);if(r!=null){let l=En(r);Array.isArray(l)&&(l=l.map(c=>ya(c))),p(t,["contents"],l)}const a=h(e,["config"]);return a!=null&&p(t,["config"],rG(a,t)),t}function aG(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","model"],Fe(n,i));const r=h(e,["contents"]);if(r!=null){let l=En(r);Array.isArray(l)&&(l=l.map(c=>ya(c))),p(t,["contents"],l)}const a=h(e,["config"]);return a!=null&&p(t,["config"],a),t}function oG(n){const e={},t=h(n,["uri"]);t!=null&&p(e,["gcsUri"],t);const i=h(n,["videoBytes"]);i!=null&&p(e,["bytesBase64Encoded"],Fr(i));const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function lG(n,e){const t={},i=h(n,["numberOfVideos"]);e!==void 0&&i!=null&&p(e,["parameters","sampleCount"],i);const r=h(n,["outputGcsUri"]);e!==void 0&&r!=null&&p(e,["parameters","storageUri"],r);const a=h(n,["fps"]);e!==void 0&&a!=null&&p(e,["parameters","fps"],a);const l=h(n,["durationSeconds"]);e!==void 0&&l!=null&&p(e,["parameters","durationSeconds"],l);const c=h(n,["seed"]);e!==void 0&&c!=null&&p(e,["parameters","seed"],c);const f=h(n,["aspectRatio"]);e!==void 0&&f!=null&&p(e,["parameters","aspectRatio"],f);const d=h(n,["resolution"]);e!==void 0&&d!=null&&p(e,["parameters","resolution"],d);const g=h(n,["personGeneration"]);e!==void 0&&g!=null&&p(e,["parameters","personGeneration"],g);const _=h(n,["pubsubTopic"]);e!==void 0&&_!=null&&p(e,["parameters","pubsubTopic"],_);const v=h(n,["negativePrompt"]);e!==void 0&&v!=null&&p(e,["parameters","negativePrompt"],v);const w=h(n,["enhancePrompt"]);e!==void 0&&w!=null&&p(e,["parameters","enhancePrompt"],w);const T=h(n,["generateAudio"]);e!==void 0&&T!=null&&p(e,["parameters","generateAudio"],T);const S=h(n,["lastFrame"]);e!==void 0&&S!=null&&p(e,["instances[0]","lastFrame"],Ic(S));const C=h(n,["compressionQuality"]);return e!==void 0&&C!=null&&p(e,["parameters","compressionQuality"],C),t}function uG(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["_url","model"],Fe(n,i));const r=h(e,["prompt"]);r!=null&&p(t,["instances[0]","prompt"],r);const a=h(e,["image"]);a!=null&&p(t,["instances[0]","image"],Ic(a));const l=h(e,["video"]);l!=null&&p(t,["instances[0]","video"],oG(l));const c=h(e,["config"]);return c!=null&&p(t,["config"],lG(c,t)),t}function cG(n){const e={},t=h(n,["fps"]);t!=null&&p(e,["fps"],t);const i=h(n,["endOffset"]);i!=null&&p(e,["endOffset"],i);const r=h(n,["startOffset"]);return r!=null&&p(e,["startOffset"],r),e}function fG(n){const e={},t=h(n,["data"]);t!=null&&p(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function dG(n){const e={},t=h(n,["fileUri"]);t!=null&&p(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function hG(n){const e={},t=h(n,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],cG(t));const i=h(n,["thought"]);i!=null&&p(e,["thought"],i);const r=h(n,["inlineData"]);r!=null&&p(e,["inlineData"],fG(r));const a=h(n,["fileData"]);a!=null&&p(e,["fileData"],dG(a));const l=h(n,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(n,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(n,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(n,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(n,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const _=h(n,["text"]);return _!=null&&p(e,["text"],_),e}function pG(n){const e={},t=h(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>hG(a))),p(e,["parts"],r)}const i=h(n,["role"]);return i!=null&&p(e,["role"],i),e}function mG(n){const e={},t=h(n,["citationSources"]);return t!=null&&p(e,["citations"],t),e}function gG(n){const e={},t=h(n,["retrievedUrl"]);t!=null&&p(e,["retrievedUrl"],t);const i=h(n,["urlRetrievalStatus"]);return i!=null&&p(e,["urlRetrievalStatus"],i),e}function yG(n){const e={},t=h(n,["urlMetadata"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>gG(r))),p(e,["urlMetadata"],i)}return e}function _G(n){const e={},t=h(n,["content"]);t!=null&&p(e,["content"],pG(t));const i=h(n,["citationMetadata"]);i!=null&&p(e,["citationMetadata"],mG(i));const r=h(n,["tokenCount"]);r!=null&&p(e,["tokenCount"],r);const a=h(n,["finishReason"]);a!=null&&p(e,["finishReason"],a);const l=h(n,["urlContextMetadata"]);l!=null&&p(e,["urlContextMetadata"],yG(l));const c=h(n,["avgLogprobs"]);c!=null&&p(e,["avgLogprobs"],c);const f=h(n,["groundingMetadata"]);f!=null&&p(e,["groundingMetadata"],f);const d=h(n,["index"]);d!=null&&p(e,["index"],d);const g=h(n,["logprobsResult"]);g!=null&&p(e,["logprobsResult"],g);const _=h(n,["safetyRatings"]);return _!=null&&p(e,["safetyRatings"],_),e}function TE(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>_G(f))),p(e,["candidates"],c)}const r=h(n,["modelVersion"]);r!=null&&p(e,["modelVersion"],r);const a=h(n,["promptFeedback"]);a!=null&&p(e,["promptFeedback"],a);const l=h(n,["usageMetadata"]);return l!=null&&p(e,["usageMetadata"],l),e}function vG(n){const e={},t=h(n,["values"]);return t!=null&&p(e,["values"],t),e}function bG(){return{}}function wG(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["embeddings"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>vG(l))),p(e,["embeddings"],a)}return h(n,["metadata"])!=null&&p(e,["metadata"],bG()),e}function TG(n){const e={},t=h(n,["bytesBase64Encoded"]);t!=null&&p(e,["imageBytes"],Fr(t));const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function CC(n){const e={},t=h(n,["safetyAttributes","categories"]);t!=null&&p(e,["categories"],t);const i=h(n,["safetyAttributes","scores"]);i!=null&&p(e,["scores"],i);const r=h(n,["contentType"]);return r!=null&&p(e,["contentType"],r),e}function EG(n){const e={},t=h(n,["_self"]);t!=null&&p(e,["image"],TG(t));const i=h(n,["raiFilteredReason"]);i!=null&&p(e,["raiFilteredReason"],i);const r=h(n,["_self"]);return r!=null&&p(e,["safetyAttributes"],CC(r)),e}function SG(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>EG(l))),p(e,["generatedImages"],a)}const r=h(n,["positivePromptSafetyAttributes"]);return r!=null&&p(e,["positivePromptSafetyAttributes"],CC(r)),e}function CG(n){const e={},t=h(n,["baseModel"]);t!=null&&p(e,["baseModel"],t);const i=h(n,["createTime"]);i!=null&&p(e,["createTime"],i);const r=h(n,["updateTime"]);return r!=null&&p(e,["updateTime"],r),e}function gm(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const i=h(n,["displayName"]);i!=null&&p(e,["displayName"],i);const r=h(n,["description"]);r!=null&&p(e,["description"],r);const a=h(n,["version"]);a!=null&&p(e,["version"],a);const l=h(n,["_self"]);l!=null&&p(e,["tunedModelInfo"],CG(l));const c=h(n,["inputTokenLimit"]);c!=null&&p(e,["inputTokenLimit"],c);const f=h(n,["outputTokenLimit"]);f!=null&&p(e,["outputTokenLimit"],f);const d=h(n,["supportedGenerationMethods"]);return d!=null&&p(e,["supportedActions"],d),e}function AG(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&p(e,["nextPageToken"],i);const r=h(n,["_self"]);if(r!=null){let a=cC(r);Array.isArray(a)&&(a=a.map(l=>gm(l))),p(e,["models"],a)}return e}function RG(){return{}}function xG(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["totalTokens"]);i!=null&&p(e,["totalTokens"],i);const r=h(n,["cachedContentTokenCount"]);return r!=null&&p(e,["cachedContentTokenCount"],r),e}function IG(n){const e={},t=h(n,["video","uri"]);t!=null&&p(e,["uri"],t);const i=h(n,["video","encodedVideo"]);i!=null&&p(e,["videoBytes"],Fr(i));const r=h(n,["encoding"]);return r!=null&&p(e,["mimeType"],r),e}function MG(n){const e={},t=h(n,["_self"]);return t!=null&&p(e,["video"],IG(t)),e}function NG(n){const e={},t=h(n,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>MG(l))),p(e,["generatedVideos"],a)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&p(e,["raiMediaFilteredCount"],i);const r=h(n,["raiMediaFilteredReasons"]);return r!=null&&p(e,["raiMediaFilteredReasons"],r),e}function OG(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const i=h(n,["metadata"]);i!=null&&p(e,["metadata"],i);const r=h(n,["done"]);r!=null&&p(e,["done"],r);const a=h(n,["error"]);a!=null&&p(e,["error"],a);const l=h(n,["response","generateVideoResponse"]);return l!=null&&p(e,["response"],NG(l)),e}function kG(n){const e={},t=h(n,["fps"]);t!=null&&p(e,["fps"],t);const i=h(n,["endOffset"]);i!=null&&p(e,["endOffset"],i);const r=h(n,["startOffset"]);return r!=null&&p(e,["startOffset"],r),e}function PG(n){const e={},t=h(n,["displayName"]);t!=null&&p(e,["displayName"],t);const i=h(n,["data"]);i!=null&&p(e,["data"],i);const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function DG(n){const e={},t=h(n,["displayName"]);t!=null&&p(e,["displayName"],t);const i=h(n,["fileUri"]);i!=null&&p(e,["fileUri"],i);const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function LG(n){const e={},t=h(n,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],kG(t));const i=h(n,["thought"]);i!=null&&p(e,["thought"],i);const r=h(n,["inlineData"]);r!=null&&p(e,["inlineData"],PG(r));const a=h(n,["fileData"]);a!=null&&p(e,["fileData"],DG(a));const l=h(n,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(n,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(n,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(n,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(n,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const _=h(n,["text"]);return _!=null&&p(e,["text"],_),e}function UG(n){const e={},t=h(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>LG(a))),p(e,["parts"],r)}const i=h(n,["role"]);return i!=null&&p(e,["role"],i),e}function $G(n){const e={},t=h(n,["citations"]);return t!=null&&p(e,["citations"],t),e}function qG(n){const e={},t=h(n,["retrievedUrl"]);t!=null&&p(e,["retrievedUrl"],t);const i=h(n,["urlRetrievalStatus"]);return i!=null&&p(e,["urlRetrievalStatus"],i),e}function BG(n){const e={},t=h(n,["urlMetadata"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>qG(r))),p(e,["urlMetadata"],i)}return e}function GG(n){const e={},t=h(n,["content"]);t!=null&&p(e,["content"],UG(t));const i=h(n,["citationMetadata"]);i!=null&&p(e,["citationMetadata"],$G(i));const r=h(n,["finishMessage"]);r!=null&&p(e,["finishMessage"],r);const a=h(n,["finishReason"]);a!=null&&p(e,["finishReason"],a);const l=h(n,["urlContextMetadata"]);l!=null&&p(e,["urlContextMetadata"],BG(l));const c=h(n,["avgLogprobs"]);c!=null&&p(e,["avgLogprobs"],c);const f=h(n,["groundingMetadata"]);f!=null&&p(e,["groundingMetadata"],f);const d=h(n,["index"]);d!=null&&p(e,["index"],d);const g=h(n,["logprobsResult"]);g!=null&&p(e,["logprobsResult"],g);const _=h(n,["safetyRatings"]);return _!=null&&p(e,["safetyRatings"],_),e}function EE(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let d=i;Array.isArray(d)&&(d=d.map(g=>GG(g))),p(e,["candidates"],d)}const r=h(n,["createTime"]);r!=null&&p(e,["createTime"],r);const a=h(n,["responseId"]);a!=null&&p(e,["responseId"],a);const l=h(n,["modelVersion"]);l!=null&&p(e,["modelVersion"],l);const c=h(n,["promptFeedback"]);c!=null&&p(e,["promptFeedback"],c);const f=h(n,["usageMetadata"]);return f!=null&&p(e,["usageMetadata"],f),e}function VG(n){const e={},t=h(n,["truncated"]);t!=null&&p(e,["truncated"],t);const i=h(n,["token_count"]);return i!=null&&p(e,["tokenCount"],i),e}function FG(n){const e={},t=h(n,["values"]);t!=null&&p(e,["values"],t);const i=h(n,["statistics"]);return i!=null&&p(e,["statistics"],VG(i)),e}function HG(n){const e={},t=h(n,["billableCharacterCount"]);return t!=null&&p(e,["billableCharacterCount"],t),e}function zG(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["predictions[]","embeddings"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>FG(l))),p(e,["embeddings"],a)}const r=h(n,["metadata"]);return r!=null&&p(e,["metadata"],HG(r)),e}function jG(n){const e={},t=h(n,["gcsUri"]);t!=null&&p(e,["gcsUri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&p(e,["imageBytes"],Fr(i));const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function AC(n){const e={},t=h(n,["safetyAttributes","categories"]);t!=null&&p(e,["categories"],t);const i=h(n,["safetyAttributes","scores"]);i!=null&&p(e,["scores"],i);const r=h(n,["contentType"]);return r!=null&&p(e,["contentType"],r),e}function Wm(n){const e={},t=h(n,["_self"]);t!=null&&p(e,["image"],jG(t));const i=h(n,["raiFilteredReason"]);i!=null&&p(e,["raiFilteredReason"],i);const r=h(n,["_self"]);r!=null&&p(e,["safetyAttributes"],AC(r));const a=h(n,["prompt"]);return a!=null&&p(e,["enhancedPrompt"],a),e}function JG(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>Wm(l))),p(e,["generatedImages"],a)}const r=h(n,["positivePromptSafetyAttributes"]);return r!=null&&p(e,["positivePromptSafetyAttributes"],AC(r)),e}function KG(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>Wm(a))),p(e,["generatedImages"],r)}return e}function YG(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>Wm(a))),p(e,["generatedImages"],r)}return e}function ZG(n){const e={},t=h(n,["endpoint"]);t!=null&&p(e,["name"],t);const i=h(n,["deployedModelId"]);return i!=null&&p(e,["deployedModelId"],i),e}function QG(n){const e={},t=h(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&p(e,["baseModel"],t);const i=h(n,["createTime"]);i!=null&&p(e,["createTime"],i);const r=h(n,["updateTime"]);return r!=null&&p(e,["updateTime"],r),e}function XG(n){const e={},t=h(n,["checkpointId"]);t!=null&&p(e,["checkpointId"],t);const i=h(n,["epoch"]);i!=null&&p(e,["epoch"],i);const r=h(n,["step"]);return r!=null&&p(e,["step"],r),e}function ym(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const i=h(n,["displayName"]);i!=null&&p(e,["displayName"],i);const r=h(n,["description"]);r!=null&&p(e,["description"],r);const a=h(n,["versionId"]);a!=null&&p(e,["version"],a);const l=h(n,["deployedModels"]);if(l!=null){let _=l;Array.isArray(_)&&(_=_.map(v=>ZG(v))),p(e,["endpoints"],_)}const c=h(n,["labels"]);c!=null&&p(e,["labels"],c);const f=h(n,["_self"]);f!=null&&p(e,["tunedModelInfo"],QG(f));const d=h(n,["defaultCheckpointId"]);d!=null&&p(e,["defaultCheckpointId"],d);const g=h(n,["checkpoints"]);if(g!=null){let _=g;Array.isArray(_)&&(_=_.map(v=>XG(v))),p(e,["checkpoints"],_)}return e}function WG(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&p(e,["nextPageToken"],i);const r=h(n,["_self"]);if(r!=null){let a=cC(r);Array.isArray(a)&&(a=a.map(l=>ym(l))),p(e,["models"],a)}return e}function eV(){return{}}function tV(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["totalTokens"]);return i!=null&&p(e,["totalTokens"],i),e}function nV(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["tokensInfo"]);return i!=null&&p(e,["tokensInfo"],i),e}function iV(n){const e={},t=h(n,["gcsUri"]);t!=null&&p(e,["uri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&p(e,["videoBytes"],Fr(i));const r=h(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function rV(n){const e={},t=h(n,["_self"]);return t!=null&&p(e,["video"],iV(t)),e}function sV(n){const e={},t=h(n,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>rV(l))),p(e,["generatedVideos"],a)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&p(e,["raiMediaFilteredCount"],i);const r=h(n,["raiMediaFilteredReasons"]);return r!=null&&p(e,["raiMediaFilteredReasons"],r),e}function aV(n){const e={},t=h(n,["name"]);t!=null&&p(e,["name"],t);const i=h(n,["metadata"]);i!=null&&p(e,["metadata"],i);const r=h(n,["done"]);r!=null&&p(e,["done"],r);const a=h(n,["error"]);a!=null&&p(e,["error"],a);const l=h(n,["response"]);return l!=null&&p(e,["response"],sV(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const oV="Content-Type",lV="X-Server-Timeout",uV="User-Agent",_m="x-goog-api-client",cV="1.12.0",fV=`google-genai-sdk/${cV}`,dV="v1beta1",hV="v1beta",SE=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class pV{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:dV,r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:hV,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const r=[this.getRequestUrlInternal(t)];return i&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[l,c]of Object.entries(e.queryParams))r.searchParams.append(l,String(c));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,e.abortSignal),this.unaryApiCall(r,a,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[r,a]of Object.entries(t))typeof a=="object"?i[r]=Object.assign(Object.assign({},i[r]),a):a!==void 0&&(i[r]=a);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,i);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,e.abortSignal),this.streamApiCall(r,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i){if(t&&t.timeout||i){const r=new AbortController,a=r.signal;if(t.timeout&&t?.timeout>0){const l=setTimeout(()=>r.abort(),t.timeout);l&&typeof l.unref=="function"&&l.unref()}i&&i.addEventListener("abort",()=>{r.abort()}),e.signal=a}return t&&t.extraBody!==null&&mV(e,t.extraBody),e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await CE(r),new cm(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await CE(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){var t;return Ys(this,arguments,function*(){const r=(t=e?.body)===null||t===void 0?void 0:t.getReader(),a=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let l="";for(;;){const{done:c,value:f}=yield Ze(r.read());if(c){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=a.decode(f,{stream:!0});try{const _=JSON.parse(d);if("error"in _){const v=JSON.parse(JSON.stringify(_.error)),w=v.status,T=v.code,S=`got status: ${w}. ${JSON.stringify(_)}`;if(T>=400&&T<600)throw new Rc({message:S,status:T})}}catch(_){if(_.name==="ApiError")throw _}l+=d;let g=l.match(SE);for(;g;){const _=g[1];try{const v=new Response(_,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield Ze(new cm(v)),l=l.slice(g[0].length),g=l.match(SE)}catch(v){throw new Error(`exception parsing stream chunk ${_}. ${v}`)}}}}finally{r.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=fV+" "+this.clientOptions.userAgentExtra;return e[uV]=t,e[_m]=t,e[oV]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[i,r]of Object.entries(e.headers))t.append(i,r);e.timeout&&e.timeout>0&&t.append(lV,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var i;const r={};t!=null&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const a=this.clientOptions.uploader,l=await a.stat(e);r.sizeBytes=String(l.size);const c=(i=t?.mimeType)!==null&&i!==void 0?i:l.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=c;const f=await this.fetchUploadUrl(r,t);return a.upload(e,f,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var i;let r={};t?.httpOptions?r=t.httpOptions:r={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const a={file:e},l=await this.request({path:ue("upload/v1beta/files",a._url),body:JSON.stringify(a),httpMethod:"POST",httpOptions:r});if(!l||!l?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const c=(i=l?.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(c===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return c}}async function CE(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const r=JSON.stringify(i);throw t>=400&&t<600?new Rc({message:r,status:t}):new Error(r)}}function mV(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const a=JSON.parse(n.body);if(typeof a=="object"&&a!==null&&!Array.isArray(a))t=a;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(a,l){const c=Object.assign({},a);for(const f in l)if(Object.prototype.hasOwnProperty.call(l,f)){const d=l[f],g=c[f];d&&typeof d=="object"&&!Array.isArray(d)&&g&&typeof g=="object"&&!Array.isArray(g)?c[f]=i(g,d):(g&&d&&typeof g!=typeof d&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${f}". Original type: ${typeof g}, New type: ${typeof d}. Overwriting.`),c[f]=d)}return c}const r=i(t,e);n.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gV="mcp_used/unknown";let yV=!1;function RC(n){for(const e of n)if(_V(e)||typeof e=="object"&&"inputSchema"in e)return!0;return yV}function xC(n){var e;const t=(e=n[_m])!==null&&e!==void 0?e:"";n[_m]=(t+` ${gV}`).trimStart()}function _V(n){return n!==null&&typeof n=="object"&&n instanceof eg}function vV(n,e=100){return Ys(this,arguments,function*(){let i,r=0;for(;r<e;){const a=yield Ze(n.listTools({cursor:i}));for(const l of a.tools)yield yield Ze(l),r++;if(!a.nextCursor)break;i=a.nextCursor}})}class eg{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new eg(e,t)}async initialize(){var e,t,i,r;if(this.mcpTools.length>0)return;const a={},l=[];for(const g of this.mcpClients)try{for(var c=!0,f=(t=void 0,$o(vV(g))),d;d=await f.next(),e=d.done,!e;c=!0){r=d.value,c=!1;const _=r;l.push(_);const v=_.name;if(a[v])throw new Error(`Duplicate function name ${v} found in MCP tools. Please ensure function names are unique.`);a[v]=g}}catch(_){t={error:_}}finally{try{!c&&!e&&(i=f.return)&&await i.call(f)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=a}async tool(){return await this.initialize(),pU(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[i.name];let a;this.config.timeout&&(a={timeout:this.config.timeout});const l=await r.callTool({name:i.name,arguments:i.args},void 0,a);t.push({functionResponse:{name:i.name,response:l.isError?{error:l}:l}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function bV(n,e,t){const i=new aU;let r;t.data instanceof Blob?r=JSON.parse(await t.data.text()):r=JSON.parse(t.data);const a=p4(r);Object.assign(i,a),e(i)}class wV{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),l=SV(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),f=`${r}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${c}`;let d=()=>{};const g=new Promise(R=>{d=R}),_=e.callbacks,v=function(){d({})},w=this.apiClient,T={onopen:v,onmessage:R=>{bV(w,_.onmessage,R)},onerror:(t=_?.onerror)!==null&&t!==void 0?t:function(R){},onclose:(i=_?.onclose)!==null&&i!==void 0?i:function(R){}},S=this.webSocketFactory.create(f,EV(l),T);S.connect(),await g;const C=Fe(this.apiClient,e.model),x=wC({model:C}),M=mm({setup:x});return S.send(JSON.stringify(M)),new TV(S,this.apiClient)}}class TV{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=dq(e),i=TC(t);this.conn.send(JSON.stringify({clientContent:i}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=hq(e),i=mm(t);this.conn.send(JSON.stringify(i))}sendPlaybackControl(e){const t=mm({playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Js.PLAY)}pause(){this.sendPlaybackControl(Js.PAUSE)}stop(){this.sendPlaybackControl(Js.STOP)}resetContext(){this.sendPlaybackControl(Js.RESET_CONTEXT)}close(){this.conn.close()}}function EV(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function SV(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const CV="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function AV(n,e,t){const i=new sU;let r;t.data instanceof Blob?r=await t.data.text():t.data instanceof ArrayBuffer?r=new TextDecoder().decode(t.data):r=t.data;const a=JSON.parse(r);if(n.isVertexAI()){const l=x4(a);Object.assign(i,l)}else{const l=s4(a);Object.assign(i,l)}e(i)}class RV{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new wV(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,r,a,l,c;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const f=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let g;const _=this.apiClient.getHeaders();e.config&&e.config.tools&&RC(e.config.tools)&&xC(_);const v=NV(_);if(this.apiClient.isVertexAI())g=`${f}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(v);else{const re=this.apiClient.getApiKey();let Se="BidiGenerateContent",ye="key";re?.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),d!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),Se="BidiGenerateContentConstrained",ye="access_token"),g=`${f}/ws/google.ai.generativelanguage.${d}.GenerativeService.${Se}?${ye}=${re}`}let w=()=>{};const T=new Promise(re=>{w=re}),S=e.callbacks,C=function(){var re;(re=S?.onopen)===null||re===void 0||re.call(S),w({})},x=this.apiClient,M={onopen:C,onmessage:re=>{AV(x,S.onmessage,re)},onerror:(t=S?.onerror)!==null&&t!==void 0?t:function(re){},onclose:(i=S?.onclose)!==null&&i!==void 0?i:function(re){}},R=this.webSocketFactory.create(g,MV(v),M);R.connect(),await T;let P=Fe(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&P.startsWith("publishers/")){const re=this.apiClient.getProject(),Se=this.apiClient.getLocation();P=`projects/${re}/locations/${Se}/`+P}let O={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[uc.AUDIO]}:e.config.responseModalities=[uc.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const V=(c=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[],J=[];for(const re of V)if(this.isCallableTool(re)){const Se=re;J.push(await Se.tool())}else J.push(re);J.length>0&&(e.config.tools=J);const Z={model:P,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?O=Bq(this.apiClient,Z):O=lq(this.apiClient,Z),delete O.config,R.send(JSON.stringify(O)),new IV(R,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const xV={turnComplete:!0};class IV{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=En(t.turns),e.isVertexAI()?i=i.map(r=>ya(r)):i=i.map(r=>xc(r))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const a of i){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(CV)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},xV),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:Fq(e)}:t={realtimeInput:fq(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function MV(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function NV(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const AE=10;function RE(n){var e,t,i;if(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(const l of(t=n?.tools)!==null&&t!==void 0?t:[])if(Zs(l)){r=!0;break}if(!r)return!0;const a=(i=n?.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function Zs(n){return"callTool"in n&&typeof n.callTool=="function"}function OV(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>Zs(r)))!==null&&i!==void 0?i:!1}function kV(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>!Zs(r)))!==null&&i!==void 0?i:!1}function xE(n){var e;return!(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class PV extends Vr{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,r,a,l,c;const f=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!OV(t)||RE(t.config))return await this.generateContentInternal(f);if(kV(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let d,g;const _=En(f.contents),v=(a=(r=(i=f.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&a!==void 0?a:AE;let w=0;for(;w<v&&(d=await this.generateContentInternal(f),!(!d.functionCalls||d.functionCalls.length===0));){const T=d.candidates[0].content,S=[];for(const C of(c=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[])if(Zs(C)){const M=await C.callTool(d.functionCalls);S.push(...M)}w++,g={role:"user",parts:S},f.contents=En(f.contents),f.contents.push(T),f.contents.push(g),xE(f.config)&&(_.push(T),_.push(g))}return xE(f.config)&&(d.automaticFunctionCallingHistory=_),d},this.generateContentStream=async t=>{if(this.maybeMoveToResponseJsonSchem(t),RE(t.config)){const i=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(i)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var r;let a;const l=[];if(i?.generatedImages)for(const f of i.generatedImages)f&&f?.safetyAttributes&&((r=f?.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?a=f?.safetyAttributes:l.push(f);let c;return a?c={generatedImages:l,positivePromptSafetyAttributes:a,sdkHttpResponse:i.sdkHttpResponse}:c={generatedImages:l,sdkHttpResponse:i.sdkHttpResponse},c}),this.list=async t=>{var i;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t?.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((i=l.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new ll(Br.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(l),l)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const r={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(r)},this.generateVideos=async t=>await this.generateVideosInternal(t)}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,r;const a=(t=e.config)===null||t===void 0?void 0:t.tools;if(!a)return e;const l=await Promise.all(a.map(async f=>Zs(f)?await f.tool():f)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(c.config.tools=l,e.config&&e.config.tools&&RC(e.config.tools)){const f=(r=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&r!==void 0?r:{};let d=Object.assign({},f);Object.keys(d).length===0&&(d=this.apiClient.getDefaultHeaders()),xC(d),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:d})}return c}async initAfcToolsMap(e){var t,i,r;const a=new Map;for(const l of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(Zs(l)){const c=l,f=await c.tool();for(const d of(r=f.functionDeclarations)!==null&&r!==void 0?r:[]){if(!d.name)throw new Error("Function declaration name is required.");if(a.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);a.set(d.name,c)}}return a}async processAfcStream(e){var t,i,r;const a=(r=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&r!==void 0?r:AE;let l=!1,c=0;const f=await this.initAfcToolsMap(e);return function(d,g,_){var v,w;return Ys(this,arguments,function*(){for(var T,S,C,x;c<a;){l&&(c++,l=!1);const O=yield Ze(d.processParamsMaybeAddMcpUsage(_)),V=yield Ze(d.generateContentStreamInternal(O)),J=[],Z=[];try{for(var M=!0,R=(S=void 0,$o(V)),P;P=yield Ze(R.next()),T=P.done,!T;M=!0){x=P.value,M=!1;const re=x;if(yield yield Ze(re),re.candidates&&(!((v=re.candidates[0])===null||v===void 0)&&v.content)){Z.push(re.candidates[0].content);for(const Se of(w=re.candidates[0].content.parts)!==null&&w!==void 0?w:[])if(c<a&&Se.functionCall){if(!Se.functionCall.name)throw new Error("Function call name was not returned by the model.");if(g.has(Se.functionCall.name)){const ye=yield Ze(g.get(Se.functionCall.name).callTool([Se.functionCall]));J.push(...ye)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${g.keys()}, mising tool: ${Se.functionCall.name}`)}}}}catch(re){S={error:re}}finally{try{!M&&!T&&(C=R.return)&&(yield Ze(C.call(R)))}finally{if(S)throw S.error}}if(J.length>0){l=!0;const re=new So;re.candidates=[{content:{role:"user",parts:J}}],yield yield Ze(re);const Se=[];Se.push(...Z),Se.push({role:"user",parts:J});const ye=En(_.contents).concat(Se);_.contents=ye}else break}})}(this,f,e)}async generateContentInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=wE(this.apiClient,e);return c=ue("{model}:generateContent",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(_=>{const v=_;return v.sdkHttpResponse={headers:g.headers},v})),l.then(g=>{const _=EE(g),v=new So;return Object.assign(v,_),v})}else{const d=bE(this.apiClient,e);return c=ue("{model}:generateContent",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json().then(_=>{const v=_;return v.sdkHttpResponse={headers:g.headers},v})),l.then(g=>{const _=TE(g),v=new So;return Object.assign(v,_),v})}}async generateContentStreamInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=wE(this.apiClient,e);return c=ue("{model}:streamGenerateContent?alt=sse",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.requestStream({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),l.then(function(_){return Ys(this,arguments,function*(){var v,w,T,S;try{for(var C=!0,x=$o(_),M;M=yield Ze(x.next()),v=M.done,!v;C=!0){S=M.value,C=!1;const R=S,P=EE(yield Ze(R.json()));P.sdkHttpResponse={headers:R.headers};const O=new So;Object.assign(O,P),yield yield Ze(O)}}catch(R){w={error:R}}finally{try{!C&&!v&&(T=x.return)&&(yield Ze(T.call(x)))}finally{if(w)throw w.error}}})})}else{const d=bE(this.apiClient,e);return c=ue("{model}:streamGenerateContent?alt=sse",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.requestStream({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),l.then(function(_){return Ys(this,arguments,function*(){var v,w,T,S;try{for(var C=!0,x=$o(_),M;M=yield Ze(x.next()),v=M.done,!v;C=!0){S=M.value,C=!1;const R=S,P=TE(yield Ze(R.json()));P.sdkHttpResponse={headers:R.headers};const O=new So;Object.assign(O,P),yield yield Ze(O)}}catch(R){w={error:R}}finally{try{!C&&!v&&(T=x.return)&&(yield Ze(T.call(x)))}finally{if(w)throw w.error}}})})}}async embedContent(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=BB(this.apiClient,e);return c=ue("{model}:predict",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(_=>{const v=_;return v.sdkHttpResponse={headers:g.headers},v})),l.then(g=>{const _=zG(g),v=new WT;return Object.assign(v,_),v})}else{const d=W4(this.apiClient,e);return c=ue("{model}:batchEmbedContents",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json().then(_=>{const v=_;return v.sdkHttpResponse={headers:g.headers},v})),l.then(g=>{const _=wG(g),v=new WT;return Object.assign(v,_),v})}}async generateImagesInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=VB(this.apiClient,e);return c=ue("{model}:predict",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(_=>{const v=_;return v.sdkHttpResponse={headers:g.headers},v})),l.then(g=>{const _=JG(g),v=new eE;return Object.assign(v,_),v})}else{const d=tB(this.apiClient,e);return c=ue("{model}:predict",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json().then(_=>{const v=_;return v.sdkHttpResponse={headers:g.headers},v})),l.then(g=>{const _=SG(g),v=new eE;return Object.assign(v,_),v})}}async editImageInternal(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI()){const c=YB(this.apiClient,e);return a=ue("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(d=>{const g=d;return g.sdkHttpResponse={headers:f.headers},g})),r.then(f=>{const d=KG(f),g=new WL;return Object.assign(g,d),g})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI()){const c=QB(this.apiClient,e);return a=ue("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(d=>{const g=d;return g.sdkHttpResponse={headers:f.headers},g})),r.then(f=>{const d=YG(f),g=new eU;return Object.assign(g,d),g})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=XB(this.apiClient,e);return c=ue("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>ym(g))}else{const d=nB(this.apiClient,e);return c=ue("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json()),l.then(g=>gm(g))}}async listInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=eG(this.apiClient,e);return c=ue("{models_url}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(_=>{const v=_;return v.sdkHttpResponse={headers:g.headers},v})),l.then(g=>{const _=WG(g),v=new tE;return Object.assign(v,_),v})}else{const d=rB(this.apiClient,e);return c=ue("{models_url}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json().then(_=>{const v=_;return v.sdkHttpResponse={headers:g.headers},v})),l.then(g=>{const _=AG(g),v=new tE;return Object.assign(v,_),v})}}async update(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=nG(this.apiClient,e);return c=ue("{model}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>ym(g))}else{const d=aB(this.apiClient,e);return c=ue("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json()),l.then(g=>gm(g))}}async delete(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=iG(this.apiClient,e);return c=ue("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(()=>{const g=eV(),_=new nE;return Object.assign(_,g),_})}else{const d=oB(this.apiClient,e);return c=ue("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json()),l.then(()=>{const g=RG(),_=new nE;return Object.assign(_,g),_})}}async countTokens(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=sG(this.apiClient,e);return c=ue("{model}:countTokens",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(_=>{const v=_;return v.sdkHttpResponse={headers:g.headers},v})),l.then(g=>{const _=tV(g),v=new iE;return Object.assign(v,_),v})}else{const d=uB(this.apiClient,e);return c=ue("{model}:countTokens",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json().then(_=>{const v=_;return v.sdkHttpResponse={headers:g.headers},v})),l.then(g=>{const _=xG(g),v=new iE;return Object.assign(v,_),v})}}async computeTokens(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI()){const c=aG(this.apiClient,e);return a=ue("{model}:computeTokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(d=>{const g=d;return g.sdkHttpResponse={headers:f.headers},g})),r.then(f=>{const d=nV(f),g=new tU;return Object.assign(g,d),g})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=uG(this.apiClient,e);return c=ue("{model}:predictLongRunning",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const _=aV(g),v=new cc;return Object.assign(v,_),v})}else{const d=dB(this.apiClient,e);return c=ue("{model}:predictLongRunning",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json()),l.then(g=>{const _=OG(g),v=new cc;return Object.assign(v,_),v})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function DV(n){const e={},t=h(n,["operationName"]);t!=null&&p(e,["_url","operationName"],t);const i=h(n,["config"]);return i!=null&&p(e,["config"],i),e}function LV(n){const e={},t=h(n,["operationName"]);t!=null&&p(e,["_url","operationName"],t);const i=h(n,["config"]);return i!=null&&p(e,["config"],i),e}function UV(n){const e={},t=h(n,["operationName"]);t!=null&&p(e,["operationName"],t);const i=h(n,["resourceName"]);i!=null&&p(e,["_url","resourceName"],i);const r=h(n,["config"]);return r!=null&&p(e,["config"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $V extends Vr{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:l,isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:l,isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=LV(e);return c=ue("{operationName}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l}else{const d=DV(e);return c=ue("{operationName}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json()),l}}async fetchPredictVideosOperationInternal(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI()){const c=UV(e);return a=ue("{resourceName}:fetchPredictOperation",c._url),l=c._query,delete c.config,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qV(n){const e={},t=h(n,["voiceName"]);return t!=null&&p(e,["voiceName"],t),e}function IC(n){const e={},t=h(n,["prebuiltVoiceConfig"]);return t!=null&&p(e,["prebuiltVoiceConfig"],qV(t)),e}function BV(n){const e={},t=h(n,["speaker"]);t!=null&&p(e,["speaker"],t);const i=h(n,["voiceConfig"]);return i!=null&&p(e,["voiceConfig"],IC(i)),e}function GV(n){const e={},t=h(n,["speakerVoiceConfigs"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>BV(r))),p(e,["speakerVoiceConfigs"],i)}return e}function VV(n){const e={},t=h(n,["voiceConfig"]);t!=null&&p(e,["voiceConfig"],IC(t));const i=h(n,["multiSpeakerVoiceConfig"]);i!=null&&p(e,["multiSpeakerVoiceConfig"],GV(i));const r=h(n,["languageCode"]);return r!=null&&p(e,["languageCode"],r),e}function FV(n){const e={},t=h(n,["fps"]);t!=null&&p(e,["fps"],t);const i=h(n,["endOffset"]);i!=null&&p(e,["endOffset"],i);const r=h(n,["startOffset"]);return r!=null&&p(e,["startOffset"],r),e}function HV(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&p(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function zV(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&p(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function jV(n){const e={},t=h(n,["videoMetadata"]);t!=null&&p(e,["videoMetadata"],FV(t));const i=h(n,["thought"]);i!=null&&p(e,["thought"],i);const r=h(n,["inlineData"]);r!=null&&p(e,["inlineData"],HV(r));const a=h(n,["fileData"]);a!=null&&p(e,["fileData"],zV(a));const l=h(n,["thoughtSignature"]);l!=null&&p(e,["thoughtSignature"],l);const c=h(n,["codeExecutionResult"]);c!=null&&p(e,["codeExecutionResult"],c);const f=h(n,["executableCode"]);f!=null&&p(e,["executableCode"],f);const d=h(n,["functionCall"]);d!=null&&p(e,["functionCall"],d);const g=h(n,["functionResponse"]);g!=null&&p(e,["functionResponse"],g);const _=h(n,["text"]);return _!=null&&p(e,["text"],_),e}function JV(n){const e={},t=h(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>jV(a))),p(e,["parts"],r)}const i=h(n,["role"]);return i!=null&&p(e,["role"],i),e}function KV(n){const e={},t=h(n,["behavior"]);t!=null&&p(e,["behavior"],t);const i=h(n,["description"]);i!=null&&p(e,["description"],i);const r=h(n,["name"]);r!=null&&p(e,["name"],r);const a=h(n,["parameters"]);a!=null&&p(e,["parameters"],a);const l=h(n,["parametersJsonSchema"]);l!=null&&p(e,["parametersJsonSchema"],l);const c=h(n,["response"]);c!=null&&p(e,["response"],c);const f=h(n,["responseJsonSchema"]);return f!=null&&p(e,["responseJsonSchema"],f),e}function YV(n){const e={},t=h(n,["startTime"]);t!=null&&p(e,["startTime"],t);const i=h(n,["endTime"]);return i!=null&&p(e,["endTime"],i),e}function ZV(n){const e={},t=h(n,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],YV(t)),e}function QV(n){const e={},t=h(n,["mode"]);t!=null&&p(e,["mode"],t);const i=h(n,["dynamicThreshold"]);return i!=null&&p(e,["dynamicThreshold"],i),e}function XV(n){const e={},t=h(n,["dynamicRetrievalConfig"]);return t!=null&&p(e,["dynamicRetrievalConfig"],QV(t)),e}function WV(){return{}}function eF(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(d=>KV(d))),p(e,["functionDeclarations"],f)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&p(e,["googleSearch"],ZV(i));const r=h(n,["googleSearchRetrieval"]);if(r!=null&&p(e,["googleSearchRetrieval"],XV(r)),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(n,["urlContext"])!=null&&p(e,["urlContext"],WV());const l=h(n,["codeExecution"]);l!=null&&p(e,["codeExecution"],l);const c=h(n,["computerUse"]);return c!=null&&p(e,["computerUse"],c),e}function tF(n){const e={},t=h(n,["handle"]);if(t!=null&&p(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function IE(){return{}}function nF(n){const e={},t=h(n,["disabled"]);t!=null&&p(e,["disabled"],t);const i=h(n,["startOfSpeechSensitivity"]);i!=null&&p(e,["startOfSpeechSensitivity"],i);const r=h(n,["endOfSpeechSensitivity"]);r!=null&&p(e,["endOfSpeechSensitivity"],r);const a=h(n,["prefixPaddingMs"]);a!=null&&p(e,["prefixPaddingMs"],a);const l=h(n,["silenceDurationMs"]);return l!=null&&p(e,["silenceDurationMs"],l),e}function iF(n){const e={},t=h(n,["automaticActivityDetection"]);t!=null&&p(e,["automaticActivityDetection"],nF(t));const i=h(n,["activityHandling"]);i!=null&&p(e,["activityHandling"],i);const r=h(n,["turnCoverage"]);return r!=null&&p(e,["turnCoverage"],r),e}function rF(n){const e={},t=h(n,["targetTokens"]);return t!=null&&p(e,["targetTokens"],t),e}function sF(n){const e={},t=h(n,["triggerTokens"]);t!=null&&p(e,["triggerTokens"],t);const i=h(n,["slidingWindow"]);return i!=null&&p(e,["slidingWindow"],rF(i)),e}function aF(n){const e={},t=h(n,["proactiveAudio"]);return t!=null&&p(e,["proactiveAudio"],t),e}function oF(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&p(e,["setup","generationConfig"],i);const r=h(n,["responseModalities"]);e!==void 0&&r!=null&&p(e,["setup","generationConfig","responseModalities"],r);const a=h(n,["temperature"]);e!==void 0&&a!=null&&p(e,["setup","generationConfig","temperature"],a);const l=h(n,["topP"]);e!==void 0&&l!=null&&p(e,["setup","generationConfig","topP"],l);const c=h(n,["topK"]);e!==void 0&&c!=null&&p(e,["setup","generationConfig","topK"],c);const f=h(n,["maxOutputTokens"]);e!==void 0&&f!=null&&p(e,["setup","generationConfig","maxOutputTokens"],f);const d=h(n,["mediaResolution"]);e!==void 0&&d!=null&&p(e,["setup","generationConfig","mediaResolution"],d);const g=h(n,["seed"]);e!==void 0&&g!=null&&p(e,["setup","generationConfig","seed"],g);const _=h(n,["speechConfig"]);e!==void 0&&_!=null&&p(e,["setup","generationConfig","speechConfig"],VV(Xm(_)));const v=h(n,["enableAffectiveDialog"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],v);const w=h(n,["systemInstruction"]);e!==void 0&&w!=null&&p(e,["setup","systemInstruction"],JV(kt(w)));const T=h(n,["tools"]);if(e!==void 0&&T!=null){let O=ma(T);Array.isArray(O)&&(O=O.map(V=>eF(pa(V)))),p(e,["setup","tools"],O)}const S=h(n,["sessionResumption"]);e!==void 0&&S!=null&&p(e,["setup","sessionResumption"],tF(S));const C=h(n,["inputAudioTranscription"]);e!==void 0&&C!=null&&p(e,["setup","inputAudioTranscription"],IE());const x=h(n,["outputAudioTranscription"]);e!==void 0&&x!=null&&p(e,["setup","outputAudioTranscription"],IE());const M=h(n,["realtimeInputConfig"]);e!==void 0&&M!=null&&p(e,["setup","realtimeInputConfig"],iF(M));const R=h(n,["contextWindowCompression"]);e!==void 0&&R!=null&&p(e,["setup","contextWindowCompression"],sF(R));const P=h(n,["proactivity"]);return e!==void 0&&P!=null&&p(e,["setup","proactivity"],aF(P)),t}function lF(n,e){const t={},i=h(e,["model"]);i!=null&&p(t,["setup","model"],Fe(n,i));const r=h(e,["config"]);return r!=null&&p(t,["config"],oF(r,t)),t}function uF(n,e,t){const i={},r=h(e,["expireTime"]);t!==void 0&&r!=null&&p(t,["expireTime"],r);const a=h(e,["newSessionExpireTime"]);t!==void 0&&a!=null&&p(t,["newSessionExpireTime"],a);const l=h(e,["uses"]);t!==void 0&&l!=null&&p(t,["uses"],l);const c=h(e,["liveConnectConstraints"]);t!==void 0&&c!=null&&p(t,["bidiGenerateContentSetup"],lF(n,c));const f=h(e,["lockAdditionalFields"]);return t!==void 0&&f!=null&&p(t,["fieldMask"],f),i}function cF(n,e){const t={},i=h(e,["config"]);return i!=null&&p(t,["config"],uF(n,i,t)),t}function fF(n){const e={},t=h(n,["name"]);return t!=null&&p(e,["name"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dF(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const r=Object.keys(i).map(a=>`${t}.${a}`);e.push(...r)}else e.push(t)}return e.join(",")}function hF(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const a=i.setup;typeof a=="object"&&a!==null?(n.bidiGenerateContentSetup=a,t=a):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const r=n.fieldMask;if(t){const a=dF(t);if(Array.isArray(e?.lockAdditionalFields)&&e?.lockAdditionalFields.length===0)a?n.fieldMask=a:delete n.fieldMask;else if(e?.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];r.length>0&&(c=r.map(d=>l.includes(d)?`generationConfig.${d}`:d));const f=[];a&&f.push(a),c.length>0&&f.push(...c),f.length>0?n.fieldMask=f.join(","):delete n.fieldMask}else delete n.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?n.fieldMask=r.join(","):delete n.fieldMask;return n}class pF extends Vr{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=cF(this.apiClient,e);a=ue("auth_tokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const f=hF(c,e.config);return r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>fF(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mF(n){const e={},t=h(n,["name"]);t!=null&&p(e,["_url","name"],t);const i=h(n,["config"]);return i!=null&&p(e,["config"],i),e}function gF(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);const r=h(n,["pageToken"]);e!==void 0&&r!=null&&p(e,["_query","pageToken"],r);const a=h(n,["filter"]);return e!==void 0&&a!=null&&p(e,["_query","filter"],a),t}function yF(n){const e={},t=h(n,["config"]);return t!=null&&p(e,["config"],gF(t,e)),e}function _F(n){const e={},t=h(n,["textInput"]);t!=null&&p(e,["textInput"],t);const i=h(n,["output"]);return i!=null&&p(e,["output"],i),e}function vF(n){const e={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const t=h(n,["examples"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>_F(r))),p(e,["examples","examples"],i)}return e}function bF(n,e){const t={};if(h(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=h(n,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&p(e,["displayName"],i),h(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const r=h(n,["epochCount"]);e!==void 0&&r!=null&&p(e,["tuningTask","hyperparameters","epochCount"],r);const a=h(n,["learningRateMultiplier"]);if(a!=null&&p(t,["tuningTask","hyperparameters","learningRateMultiplier"],a),h(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(h(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=h(n,["batchSize"]);e!==void 0&&l!=null&&p(e,["tuningTask","hyperparameters","batchSize"],l);const c=h(n,["learningRate"]);return e!==void 0&&c!=null&&p(e,["tuningTask","hyperparameters","learningRate"],c),t}function wF(n){const e={},t=h(n,["baseModel"]);t!=null&&p(e,["baseModel"],t);const i=h(n,["trainingDataset"]);i!=null&&p(e,["tuningTask","trainingData"],vF(i));const r=h(n,["config"]);return r!=null&&p(e,["config"],bF(r,e)),e}function TF(n){const e={},t=h(n,["name"]);t!=null&&p(e,["_url","name"],t);const i=h(n,["config"]);return i!=null&&p(e,["config"],i),e}function EF(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);const r=h(n,["pageToken"]);e!==void 0&&r!=null&&p(e,["_query","pageToken"],r);const a=h(n,["filter"]);return e!==void 0&&a!=null&&p(e,["_query","filter"],a),t}function SF(n){const e={},t=h(n,["config"]);return t!=null&&p(e,["config"],EF(t,e)),e}function CF(n,e){const t={},i=h(n,["gcsUri"]);e!==void 0&&i!=null&&p(e,["supervisedTuningSpec","trainingDatasetUri"],i);const r=h(n,["vertexDatasetResource"]);if(e!==void 0&&r!=null&&p(e,["supervisedTuningSpec","trainingDatasetUri"],r),h(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return t}function AF(n,e){const t={},i=h(n,["gcsUri"]);i!=null&&p(t,["validationDatasetUri"],i);const r=h(n,["vertexDatasetResource"]);return e!==void 0&&r!=null&&p(e,["supervisedTuningSpec","trainingDatasetUri"],r),t}function RF(n,e){const t={},i=h(n,["validationDataset"]);e!==void 0&&i!=null&&p(e,["supervisedTuningSpec"],AF(i,t));const r=h(n,["tunedModelDisplayName"]);e!==void 0&&r!=null&&p(e,["tunedModelDisplayName"],r);const a=h(n,["description"]);e!==void 0&&a!=null&&p(e,["description"],a);const l=h(n,["epochCount"]);e!==void 0&&l!=null&&p(e,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=h(n,["learningRateMultiplier"]);e!==void 0&&c!=null&&p(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const f=h(n,["exportLastCheckpointOnly"]);e!==void 0&&f!=null&&p(e,["supervisedTuningSpec","exportLastCheckpointOnly"],f);const d=h(n,["adapterSize"]);if(e!==void 0&&d!=null&&p(e,["supervisedTuningSpec","hyperParameters","adapterSize"],d),h(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(h(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return t}function xF(n){const e={},t=h(n,["baseModel"]);t!=null&&p(e,["baseModel"],t);const i=h(n,["trainingDataset"]);i!=null&&p(e,["supervisedTuningSpec","trainingDatasetUri"],CF(i,e));const r=h(n,["config"]);return r!=null&&p(e,["config"],RF(r,e)),e}function IF(n){const e={},t=h(n,["name"]);t!=null&&p(e,["model"],t);const i=h(n,["name"]);return i!=null&&p(e,["endpoint"],i),e}function MC(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&p(e,["name"],i);const r=h(n,["state"]);r!=null&&p(e,["state"],oC(r));const a=h(n,["createTime"]);a!=null&&p(e,["createTime"],a);const l=h(n,["tuningTask","startTime"]);l!=null&&p(e,["startTime"],l);const c=h(n,["tuningTask","completeTime"]);c!=null&&p(e,["endTime"],c);const f=h(n,["updateTime"]);f!=null&&p(e,["updateTime"],f);const d=h(n,["description"]);d!=null&&p(e,["description"],d);const g=h(n,["baseModel"]);g!=null&&p(e,["baseModel"],g);const _=h(n,["_self"]);_!=null&&p(e,["tunedModel"],IF(_));const v=h(n,["distillationSpec"]);v!=null&&p(e,["distillationSpec"],v);const w=h(n,["experiment"]);w!=null&&p(e,["experiment"],w);const T=h(n,["labels"]);T!=null&&p(e,["labels"],T);const S=h(n,["pipelineJob"]);S!=null&&p(e,["pipelineJob"],S);const C=h(n,["satisfiesPzi"]);C!=null&&p(e,["satisfiesPzi"],C);const x=h(n,["satisfiesPzs"]);x!=null&&p(e,["satisfiesPzs"],x);const M=h(n,["serviceAccount"]);M!=null&&p(e,["serviceAccount"],M);const R=h(n,["tunedModelDisplayName"]);return R!=null&&p(e,["tunedModelDisplayName"],R),e}function MF(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&p(e,["nextPageToken"],i);const r=h(n,["tunedModels"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>MC(l))),p(e,["tuningJobs"],a)}return e}function NF(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&p(e,["name"],i);const r=h(n,["metadata"]);r!=null&&p(e,["metadata"],r);const a=h(n,["done"]);a!=null&&p(e,["done"],a);const l=h(n,["error"]);return l!=null&&p(e,["error"],l),e}function OF(n){const e={},t=h(n,["checkpointId"]);t!=null&&p(e,["checkpointId"],t);const i=h(n,["epoch"]);i!=null&&p(e,["epoch"],i);const r=h(n,["step"]);r!=null&&p(e,["step"],r);const a=h(n,["endpoint"]);return a!=null&&p(e,["endpoint"],a),e}function kF(n){const e={},t=h(n,["model"]);t!=null&&p(e,["model"],t);const i=h(n,["endpoint"]);i!=null&&p(e,["endpoint"],i);const r=h(n,["checkpoints"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>OF(l))),p(e,["checkpoints"],a)}return e}function vm(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&p(e,["name"],i);const r=h(n,["state"]);r!=null&&p(e,["state"],oC(r));const a=h(n,["createTime"]);a!=null&&p(e,["createTime"],a);const l=h(n,["startTime"]);l!=null&&p(e,["startTime"],l);const c=h(n,["endTime"]);c!=null&&p(e,["endTime"],c);const f=h(n,["updateTime"]);f!=null&&p(e,["updateTime"],f);const d=h(n,["error"]);d!=null&&p(e,["error"],d);const g=h(n,["description"]);g!=null&&p(e,["description"],g);const _=h(n,["baseModel"]);_!=null&&p(e,["baseModel"],_);const v=h(n,["tunedModel"]);v!=null&&p(e,["tunedModel"],kF(v));const w=h(n,["supervisedTuningSpec"]);w!=null&&p(e,["supervisedTuningSpec"],w);const T=h(n,["tuningDataStats"]);T!=null&&p(e,["tuningDataStats"],T);const S=h(n,["encryptionSpec"]);S!=null&&p(e,["encryptionSpec"],S);const C=h(n,["partnerModelTuningSpec"]);C!=null&&p(e,["partnerModelTuningSpec"],C);const x=h(n,["distillationSpec"]);x!=null&&p(e,["distillationSpec"],x);const M=h(n,["experiment"]);M!=null&&p(e,["experiment"],M);const R=h(n,["labels"]);R!=null&&p(e,["labels"],R);const P=h(n,["pipelineJob"]);P!=null&&p(e,["pipelineJob"],P);const O=h(n,["satisfiesPzi"]);O!=null&&p(e,["satisfiesPzi"],O);const V=h(n,["satisfiesPzs"]);V!=null&&p(e,["satisfiesPzs"],V);const J=h(n,["serviceAccount"]);J!=null&&p(e,["serviceAccount"],J);const Z=h(n,["tunedModelDisplayName"]);return Z!=null&&p(e,["tunedModelDisplayName"],Z),e}function PF(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&p(e,["nextPageToken"],i);const r=h(n,["tuningJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>vm(l))),p(e,["tuningJobs"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class DF extends Vr{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new ll(Br.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const i=await this.tuneMldevInternal(t);let r="";return i.metadata!==void 0&&i.metadata.tunedModel!==void 0?r=i.metadata.tunedModel:i.name!==void 0&&i.name.includes("/operations/")&&(r=i.name.split("/operations/")[0]),{name:r,state:um.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=TF(e);return c=ue("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(_=>{const v=_;return v.sdkHttpResponse={headers:g.headers},v})),l.then(g=>vm(g))}else{const d=mF(e);return c=ue("{name}",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json().then(_=>{const v=_;return v.sdkHttpResponse={headers:g.headers},v})),l.then(g=>MC(g))}}async listInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const d=SF(e);return c=ue("tuningJobs",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(_=>{const v=_;return v.sdkHttpResponse={headers:g.headers},v})),l.then(g=>{const _=PF(g),v=new sE;return Object.assign(v,_),v})}else{const d=yF(e);return c=ue("tunedModels",d._url),f=d._query,delete d.config,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(g=>g.json().then(_=>{const v=_;return v.sdkHttpResponse={headers:g.headers},v})),l.then(g=>{const _=MF(g),v=new sE;return Object.assign(v,_),v})}}async tuneInternal(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI()){const c=xF(e);return a=ue("tuningJobs",c._url),l=c._query,delete c.config,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(d=>{const g=d;return g.sdkHttpResponse={headers:f.headers},g})),r.then(f=>vm(f))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=wF(e);return a=ue("tunedModels",c._url),l=c._query,delete c.config,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(d=>{const g=d;return g.sdkHttpResponse={headers:f.headers},g})),r.then(f=>NF(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class LF{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const UF=1024*1024*8,$F=3,qF=1e3,BF=2,Rp="x-goog-upload-status";async function GF(n,e,t){var i,r,a;let l=0,c=0,f=new cm(new Response),d="upload";for(l=n.size;c<l;){const _=Math.min(UF,l-c),v=n.slice(c,c+_);c+_>=l&&(d+=", finalize");let w=0,T=qF;for(;w<$F&&(f=await t.request({path:"",body:v,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(c),"Content-Length":String(_)}}}),!(!((i=f?.headers)===null||i===void 0)&&i[Rp]));)w++,await FF(T),T=T*BF;if(c+=_,((r=f?.headers)===null||r===void 0?void 0:r[Rp])!=="active")break;if(l<=c)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const g=await f?.json();if(((a=f?.headers)===null||a===void 0?void 0:a[Rp])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return g.file}async function VF(n){return{size:n.size,type:n.type}}function FF(n){return new Promise(e=>setTimeout(e,n))}class HF{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await GF(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await VF(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zF{create(e,t,i){return new jF(e,t,i)}}class jF{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ME="x-goog-api-key";class JF{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(ME)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(ME,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const KF="gl-node/";class YF{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=XL(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const r=new JF(this.apiKey);this.apiClient=new pV({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:KF+"web",uploader:new HF,downloader:new LF}),this.models=new PV(this.apiClient),this.live=new RV(this.apiClient,r,new zF),this.batches=new w$(this.apiClient),this.chats=new C2(this.models,this.apiClient),this.caches=new T2(this.apiClient),this.files=new $2(this.apiClient),this.operations=new $V(this.apiClient),this.authTokens=new pF(this.apiClient),this.tunings=new DF(this.apiClient)}}const ZF=new YF({apiKey:"AIzaSyAjFV0WG-QfB-01RFHe25a4VJY8FH1znpA"});async function QF(){try{return await ZF.models.generateContent({model:"gemini-2.5-flash-lite",contents:"Hi"}),!1}catch(n){return console.error("Error generating content:",n),!0}}const NC=Mt.createContext(void 0);function XF({children:n}){const[e,t]=Mt.useState(!1),i=async()=>{const P=await QF();t(P)},[r,a]=Mt.useState(!1),[l,c]=Mt.useState(!1),f=Mt.useRef(null),d="Stuck on a data structure? Let’s simplify it together!",[g,_]=Mt.useState([]);function v(P){a(!0),_(O=>[...O,P])}const[w,T]=Mt.useState([]),[S,C]=Mt.useState(""),x=async P=>{if(P.preventDefault(),S.trim()==="")return;v(S.trim()),T(V=>[...V,S]),C("");const O=await pT(S,w);v(O),console.log(O)},M={1:"Can you give a real-life example of how Stacks work? ",2:"What are Arrays and how do they make coding easier?",3:"Where do we actually use Queues in everyday life?"};async function R(P){_(V=>[...V,P]),a(!0);const O=await pT(P,w);v(O)}return Mt.useEffect(()=>{const P=f.current;P&&setTimeout(()=>{P.parentElement.scrollTop=P.scrollHeight},100),c(!0),setTimeout(()=>{c(!1)},1e3),i()},[g]),Ne.jsx(NC.Provider,{value:{responses:g,setSubmitted:v,scrollref:f,delay:l,setdelay:c,submited:r,setIsSubmitted:a,setResponses:_,handleSubmit:x,convoHistory:w,setconvoHistory:T,human:S,sethuman:C,promptslist:M,handlePromptClick:R,title:d,Error:e},children:n})}function ul(){const n=Mt.useContext(NC);if(!n)throw new Error("useBotContext must be used within a BotProvider");return n}const WF=()=>{const{responses:n,scrollref:e,delay:t}=ul();return Ne.jsx("div",{className:"scroll-smooth py-2 flex flex-col gap-4 w-[90%] overflow-y-auto scrollbar-hide items-center",style:{scrollbarWidth:"none"},children:Ne.jsx("div",{className:"md:py-8 py-4 flex flex-col justify-end md:w-[90%] lg:w-[88%] w-[100%] gap-3 md:text-[17px] text-[14px] lg:text-[19px] font-medium  my-1",ref:e,children:n.map((i,r)=>r%2!=0?Ne.jsx("div",{className:"self-start  rounded-2xl p-3 px-2 ",children:t&&r===n.length-1?" ... ":i},r):Ne.jsx("div",{className:"self-end  rounded-2xl p-3 px-2 bg-gray-200 ",children:" "+i},r))})})};/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eH=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),tH=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),NE=n=>{const e=tH(n);return e.charAt(0).toUpperCase()+e.slice(1)},OC=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),nH=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var iH={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rH=Mt.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:a,iconNode:l,...c},f)=>Mt.createElement("svg",{ref:f,...iH,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:OC("lucide",r),...!a&&!nH(c)&&{"aria-hidden":"true"},...c},[...l.map(([d,g])=>Mt.createElement(d,g)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sH=(n,e)=>{const t=Mt.forwardRef(({className:i,...r},a)=>Mt.createElement(rH,{ref:a,iconNode:e,className:OC(`lucide-${eH(NE(n))}`,`lucide-${n}`,i),...r}));return t.displayName=NE(n),t};/**
 * @license lucide-react v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aH=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m10 8 4 4-4 4",key:"1wy4r4"}]],oH=sH("circle-chevron-right",aH),lH=()=>{const{handleSubmit:n,sethuman:e,human:t}=ul();return Ne.jsxs("form",{className:"rounded-4xl md:w-[80%] w-[85%] flex items-center gap-2 py-2 px-4 border-2 border-black backdrop-blur-lg ",onSubmit:i=>n(i),children:[Ne.jsx("input",{type:"text",value:t,onChange:i=>e(i.target.value),className:" w-full px-3 h-12 lg:h-20 lg:text-xl md:text-md text-sm  outline-none shadow-none",placeholder:"Ask me anything about Data Structures..."}),Ne.jsx("button",{"aria-label":"Send",children:Ne.jsx(oH,{className:`size-8 md:size-10 cursor-pointer ${t.length>0?" transition-all duration-300":" transition-all duration-300 opacity-50 cursor-not-allowed"}`})})]})},uH=()=>{const{title:n}=ul();return Ne.jsx("center",{className:"flex flex-col justify-center text-center h-full items-center",children:Ne.jsx("h1",{className:"text-2xl md:text-3xl lg:text-4xl font-semibold",children:n})})},cH=()=>{const{promptslist:n,handlePromptClick:e}=ul();return Ne.jsx("div",{className:"flex md:mb-10 flex-col gap-5 items-center justify-end h-full",children:Ne.jsxs("div",{className:"flex *:cursor-pointer flex-wrap justify-center gap-2 text-center *:bg-gray-200 *:hover:bg-gray-300 *:hover:transition-colors:duration-300 *:text-gray-800 *:font-semibold *:py-5 *:px-6 *:rounded-3xl md:text-[18px] text-[15px]  ",children:[Ne.jsx("p",{onClick:()=>e(n[1]),className:"md:py-10 md:h-25  ",children:n[1]}),Ne.jsxs("p",{onClick:()=>e(n[2]),className:"md:py-10 md:h-25 ",children:[n[2]," "]}),Ne.jsxs("p",{onClick:()=>e(n[3]),className:"md:py-10 md:h-25 ",children:[n[3]," "]})]})})},fH=()=>Ne.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-gray-800 bg-opacity-50 z-50",children:Ne.jsxs("div",{className:"bg-gray-900 p-6 rounded-lg shadow-lg w-[70%] md:w-[60%] md:font-bold md:text-2xl text-md h-[50%] flex flex-col justify-center items-center text-center",children:[Ne.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"API Limit Reached"}),Ne.jsx("p",{className:"text-gray-300 mb-6",children:"You've reached your free API call limit. Please try again later."}),Ne.jsxs("p",{className:"text-gray-300 mb-6",children:["If you want to set it up locally, you can find the repository"," ",Ne.jsx("a",{href:"https://github.com/khadarbashajilan/dsa-buddy",className:"text-blue-500 hover:underline",children:"here"}),"."]})]})}),dH=()=>{const{submited:n,Error:e}=ul();return Ne.jsx(Ne.Fragment,{children:Ne.jsx("main",{className:"justify-around p-2 h-screen",children:e?Ne.jsx(fH,{}):Ne.jsxs("div",{className:"h-[88vh] justify-end md:h-[95vh] bg-gray-100 gap-3 border-3 w-full flex flex-col items-center rounded-2xl p-4",children:[n?Ne.jsx(WF,{}):Ne.jsxs(Ne.Fragment,{children:[Ne.jsx(uH,{}),Ne.jsx(cH,{})]}),Ne.jsx(lH,{})]})})})};fx.createRoot(document.getElementById("root")).render(Ne.jsx(Mt.StrictMode,{children:Ne.jsx(XF,{children:Ne.jsx(dH,{})})}));export{Gk as B,tr as P,c1 as c,xo as r};
